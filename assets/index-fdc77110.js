var cF=Object.defineProperty;var uF=(xr,Cn,Wn)=>Cn in xr?cF(xr,Cn,{enumerable:!0,configurable:!0,writable:!0,value:Wn}):xr[Cn]=Wn;var Ua=(xr,Cn,Wn)=>(uF(xr,typeof Cn!="symbol"?Cn+"":Cn,Wn),Wn);let Hn,Cc,Qe,te,Ke,mt,mm,gm,Ha,is,Oc,le,he,Tc,ym,vr,ze,br,Me,vm,eo,Wa,wr,bm,wm,so,Ge,Pc,As,Bs,Mc,no,xm,Ic,ro,_m,Ec,ps,$c,Am,Rc,An,Bt,Vt,km,Sm,yA,Cm,kn,ks,Om,Dc,Je,ke,Tm,Se,Pm,Mm,Nc,dF=(async()=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();const xr="modulepreload",Cn=function(e,t){return new URL(e,t).href},Wn={},Za=function(e,t,s){if(!t||t.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map(r=>{if(r=Cn(r,s),r in Wn)return;Wn[r]=!0;const o=r.endsWith(".css"),i=o?'[rel="stylesheet"]':"";if(s)for(let l=n.length-1;l>=0;l--){const c=n[l];if(c.href===r&&(!o||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${i}`))return;const a=document.createElement("link");if(a.rel=o?"stylesheet":xr,o||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),o)return new Promise((l,c)=>{a.addEventListener("load",l),a.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e()).catch(r=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r})};mt=(e=>(e.Application="application",e.WebGLPipes="webgl-pipes",e.WebGLPipesAdaptor="webgl-pipes-adaptor",e.WebGLSystem="webgl-system",e.WebGPUPipes="webgpu-pipes",e.WebGPUPipesAdaptor="webgpu-pipes-adaptor",e.WebGPUSystem="webgpu-system",e.CanvasSystem="canvas-system",e.CanvasPipesAdaptor="canvas-pipes-adaptor",e.CanvasPipes="canvas-pipes",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e.MaskEffect="mask-effect",e.BlendMode="blend-mode",e.TextureSource="texture-source",e.Environment="environment",e))(mt||{});let qa,mi,Dm,Nm;qa=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},mi=(e,t)=>qa(e).priority??t,ps={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(qa).forEach(t=>{t.type.forEach(s=>{var n,r;return(r=(n=this._removeHandlers)[s])==null?void 0:r.call(n,t)})}),this},add(...e){return e.map(qa).forEach(t=>{t.type.forEach(s=>{var o,i;const n=this._addHandlers,r=this._queue;n[s]?(o=n[s])==null||o.call(n,t):(r[s]=r[s]||[],(i=r[s])==null||i.push(t))})}),this},handle(e,t,s){var i;const n=this._addHandlers,r=this._removeHandlers;if(n[e]||r[e])throw new Error(`Extension type ${e} already has a handler`);n[e]=t,r[e]=s;const o=this._queue;return o[e]&&((i=o[e])==null||i.forEach(a=>t(a)),delete o[e]),this},handleByMap(e,t){return this.handle(e,s=>{s.name&&(t[s.name]=s.ref)},s=>{s.name&&delete t[s.name]})},handleByNamedList(e,t,s=-1){return this.handle(e,n=>{t.findIndex(r=>r.name===n.name)>=0||(t.push({name:n.name,value:n.ref}),t.sort((r,o)=>mi(o.value,s)-mi(r.value,s)))},n=>{const r=t.findIndex(o=>o.name===n.name);r!==-1&&t.splice(r,1)})},handleByList(e,t,s=-1){return this.handle(e,n=>{t.includes(n.ref)||(t.push(n.ref),t.sort((r,o)=>mi(o,s)-mi(r,s)))},n=>{const r=t.indexOf(n.ref);r!==-1&&t.splice(r,1)})}},Dm={extension:{type:mt.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Za(()=>import("./browserAll-5044b55c.js").then(async e=>(await e.__tla,e)),["./browserAll-5044b55c.js","./init-be8545f5.js","./colorToUniform-ed2b0528.js","./CanvasPool-a96dd244.js","./batchSamplersUniformGroup-61d9f335.js"],import.meta.url)}},Nm={extension:{type:mt.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Za(()=>import("./webworkerAll-6ecf97a8.js").then(async e=>(await e.__tla,e)),["./webworkerAll-6ecf97a8.js","./init-be8545f5.js","./colorToUniform-ed2b0528.js","./CanvasPool-a96dd244.js","./batchSamplersUniformGroup-61d9f335.js"],import.meta.url)}};class ms{constructor(t,s,n){this._x=s||0,this._y=n||0,this._observer=t}clone(t){return new ms(t??this._observer,this._x,this._y)}set(t=0,s=t){return(this._x!==t||this._y!==s)&&(this._x=t,this._y=s,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var oo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function kA(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var s=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(s,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),s}var Lm={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,s="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(s=!1));function r(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function o(l,c,u,h,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new r(u,h||l,d),p=s?s+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function i(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(s?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=s?s+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var h=0,d=u.length,f=new Array(d);h<d;h++)f[h]=u[h].fn;return f},a.prototype.listenerCount=function(l){var c=s?s+l:l,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(l,c,u,h,d,f){var p=s?s+l:l;if(!this._events[p])return!1;var g=this._events[p],m=arguments.length,y,v;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),m){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,u),!0;case 4:return g.fn.call(g.context,c,u,h),!0;case 5:return g.fn.call(g.context,c,u,h,d),!0;case 6:return g.fn.call(g.context,c,u,h,d,f),!0}for(v=1,y=new Array(m-1);v<m;v++)y[v-1]=arguments[v];g.fn.apply(g.context,y)}else{var b=g.length,w;for(v=0;v<b;v++)switch(g[v].once&&this.removeListener(l,g[v].fn,void 0,!0),m){case 1:g[v].fn.call(g[v].context);break;case 2:g[v].fn.call(g[v].context,c);break;case 3:g[v].fn.call(g[v].context,c,u);break;case 4:g[v].fn.call(g[v].context,c,u,h);break;default:if(!y)for(w=1,y=new Array(m-1);w<m;w++)y[w-1]=arguments[w];g[v].fn.apply(g[v].context,y)}}return!0},a.prototype.on=function(l,c,u){return o(this,l,c,u,!1)},a.prototype.once=function(l,c,u){return o(this,l,c,u,!0)},a.prototype.removeListener=function(l,c,u,h){var d=s?s+l:l;if(!this._events[d])return this;if(!c)return i(this,d),this;var f=this._events[d];if(f.fn)f.fn===c&&(!h||f.once)&&(!u||f.context===u)&&i(this,d);else{for(var p=0,g=[],m=f.length;p<m;p++)(f[p].fn!==c||h&&!f[p].once||u&&f[p].context!==u)&&g.push(f[p]);g.length?this._events[d]=g.length===1?g[0]:g:i(this,d)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=s?s+l:l,this._events[c]&&i(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,e.exports=a})(Lm);var SA=Lm.exports;let Bm,jm,Fm;As=gi(SA),Bm=Math.PI*2,jm=180/Math.PI,Fm=Math.PI/180,ze=class{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new ze(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Lc.x=0,Lc.y=0,Lc}};const Lc=new ze;Bt=class{constructor(e=1,t=0,s=0,n=1,r=0,o=0){this.array=null,this.a=e,this.b=t,this.c=s,this.d=n,this.tx=r,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,s,n,r,o){return this.a=e,this.b=t,this.c=s,this.d=n,this.tx=r,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const s=t||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,t){t=t||new ze;const s=e.x,n=e.y;return t.x=this.a*s+this.c*n+this.tx,t.y=this.b*s+this.d*n+this.ty,t}applyInverse(e,t){t=t||new ze;const s=this.a,n=this.b,r=this.c,o=this.d,i=this.tx,a=this.ty,l=1/(s*o+r*-n),c=e.x,u=e.y;return t.x=o*l*c+-r*l*u+(a*r-i*o)*l,t.y=s*l*u+-n*l*c+(-a*s+i*n)*l,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),s=Math.sin(e),n=this.a,r=this.c,o=this.tx;return this.a=n*t-this.b*s,this.b=n*s+this.b*t,this.c=r*t-this.d*s,this.d=r*s+this.d*t,this.tx=o*t-this.ty*s,this.ty=o*s+this.ty*t,this}append(e){const t=this.a,s=this.b,n=this.c,r=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*s+e.b*r,this.c=e.c*t+e.d*n,this.d=e.c*s+e.d*r,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*s+e.ty*r+this.ty,this}appendFrom(e,t){const s=e.a,n=e.b,r=e.c,o=e.d,i=e.tx,a=e.ty,l=t.a,c=t.b,u=t.c,h=t.d;return this.a=s*l+n*u,this.b=s*c+n*h,this.c=r*l+o*u,this.d=r*c+o*h,this.tx=i*l+a*u+t.tx,this.ty=i*c+a*h+t.ty,this}setTransform(e,t,s,n,r,o,i,a,l){return this.a=Math.cos(i+l)*r,this.b=Math.sin(i+l)*r,this.c=-Math.sin(i-a)*o,this.d=Math.cos(i-a)*o,this.tx=e-(s*this.a+n*this.c),this.ty=t-(s*this.b+n*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,n=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,s=this.b,n=this.c,r=this.d,o=e.pivot,i=-Math.atan2(-n,r),a=Math.atan2(s,t),l=Math.abs(i+a);return l<1e-5||Math.abs(Bm-l)<1e-5?(e.rotation=a,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=i,e.skew.y=a),e.scale.x=Math.sqrt(t*t+s*s),e.scale.y=Math.sqrt(n*n+r*r),e.position.x=this.tx+(o.x*t+o.y*n),e.position.y=this.ty+(o.x*s+o.y*r),e}invert(){const e=this.a,t=this.b,s=this.c,n=this.d,r=this.tx,o=e*n-t*s;return this.a=n/o,this.b=-t/o,this.c=-s/o,this.d=e/o,this.tx=(s*this.ty-n*r)/o,this.ty=-(e*this.ty-t*r)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Bt;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return OA.identity()}static get shared(){return CA.identity()}};const CA=new Bt,OA=new Bt,_r=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ar=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],kr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Sr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Bc=[],Vm=[],Qa=Math.sign;function TA(){for(let e=0;e<16;e++){const t=[];Bc.push(t);for(let s=0;s<16;s++){const n=Qa(_r[e]*_r[s]+kr[e]*Ar[s]),r=Qa(Ar[e]*_r[s]+Sr[e]*Ar[s]),o=Qa(_r[e]*kr[s]+kr[e]*Sr[s]),i=Qa(Ar[e]*kr[s]+Sr[e]*Sr[s]);for(let a=0;a<16;a++)if(_r[a]===n&&Ar[a]===r&&kr[a]===o&&Sr[a]===i){t.push(a);break}}}for(let e=0;e<16;e++){const t=new Bt;t.set(_r[e],Ar[e],kr[e],Sr[e],0,0),Vm.push(t)}}TA();const ee={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>_r[e],uY:e=>Ar[e],vX:e=>kr[e],vY:e=>Sr[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Bc[e][t],sub:(e,t)=>Bc[e][ee.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?ee.S:ee.N:Math.abs(t)*2<=Math.abs(e)?e>0?ee.E:ee.W:t>0?e>0?ee.SE:ee.SW:e>0?ee.NE:ee.NW,matrixAppendRotationInv:(e,t,s=0,n=0)=>{const r=Vm[ee.inv(t)];r.tx=s,r.ty=n,e.append(r)}},Ka=[new ze,new ze,new ze,new ze];Me=class{constructor(e=0,t=0,s=0,n=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(s),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Me(0,0,0,0)}clone(){return new Me(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}strokeContains(e,t,s){const{width:n,height:r}=this;if(n<=0||r<=0)return!1;const o=this.x,i=this.y,a=o-s/2,l=o+n+s/2,c=i-s/2,u=i+r+s/2,h=o+s/2,d=o+n-s/2,f=i+s/2,p=i+r-s/2;return e>=a&&e<=l&&t>=c&&t<=u&&!(e>h&&e<d&&t>f&&t<p)}intersects(e,t){if(!t){const A=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=A)return!1;const O=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>O}const s=this.left,n=this.right,r=this.top,o=this.bottom;if(n<=s||o<=r)return!1;const i=Ka[0].set(e.left,e.top),a=Ka[1].set(e.left,e.bottom),l=Ka[2].set(e.right,e.top),c=Ka[3].set(e.right,e.bottom);if(l.x<=i.x||a.y<=i.y)return!1;const u=Math.sign(t.a*t.d-t.b*t.c);if(u===0||(t.apply(i,i),t.apply(a,a),t.apply(l,l),t.apply(c,c),Math.max(i.x,a.x,l.x,c.x)<=s||Math.min(i.x,a.x,l.x,c.x)>=n||Math.max(i.y,a.y,l.y,c.y)<=r||Math.min(i.y,a.y,l.y,c.y)>=o))return!1;const h=u*(a.y-i.y),d=u*(i.x-a.x),f=h*s+d*r,p=h*n+d*r,g=h*s+d*o,m=h*n+d*o;if(Math.max(f,p,g,m)<=h*i.x+d*i.y||Math.min(f,p,g,m)>=h*c.x+d*c.y)return!1;const y=u*(i.y-l.y),v=u*(l.x-i.x),b=y*s+v*r,w=y*n+v*r,S=y*s+v*o,_=y*n+v*o;return!(Math.max(b,w,S,_)<=y*i.x+v*i.y||Math.min(b,w,S,_)>=y*c.x+v*c.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),r=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(s-t,0),this.y=n,this.height=Math.max(r-n,0),this}ceil(e=1,t=.001){const s=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=s-this.x,this.height=n-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),r=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=s-t,this.y=n,this.height=r-n,this}getBounds(e){return e=e||new Me,e.copyFrom(this),e}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};const jc={default:-1};ke=function(e="default"){return jc[e]===void 0&&(jc[e]=-1),++jc[e]};let Fc;Fc={},he="8.0.0",le=function(e,t,s=3){if(Fc[t])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(n=n.split(`
`).splice(s).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(n))),Fc[t]=!0};const zm=()=>{};yA=function(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1};function Gm(e){return!(e&e-1)&&!!e}function PA(e){const t={};for(const s in e)e[s]!==void 0&&(t[s]=e[s]);return t}const Um=Object.create(null);function MA(e){const t=Um[e];return t===void 0&&(Um[e]=ke("resource")),t}const Hm=class vA extends As{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...vA.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){le(he,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=MA(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Hm.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let IA=Hm;const Wm=class bA extends As{constructor(t={}){super(),this.options=t,this.uid=ke("textureSource"),this._resourceType="textureSource",this._resourceId=ke("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...bA.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new IA(PA(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var s,n;this.style!==t&&((s=this._style)==null||s.off("change",this._onStyleChange,this),this._style=t,(n=this._style)==null||n.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=ke("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,s,n){n=n||this._resolution,t=t||this.width,s=s||this.height;const r=Math.round(t*n),o=Math.round(s*n);return this.width=r/n,this.height=o/n,this._resolution=n,this.pixelWidth===r&&this.pixelHeight===o?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=o,this.emit("resize",this),this._resourceId=ke("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Gm(this.pixelWidth)&&Gm(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Wm.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1},An=Wm;class Vc extends An{constructor(t){const s=t.resource||new Float32Array(t.width*t.height*4);let n=t.format;n||(s instanceof Float32Array?n="rgba32float":s instanceof Int32Array||s instanceof Uint32Array?n="rgba32uint":s instanceof Int16Array||s instanceof Uint16Array?n="rgba16uint":(s instanceof Int8Array,n="bgra8unorm")),super({...t,resource:s,format:n}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}Vc.extension=mt.TextureSource;const Xm=new Bt;km=class{constructor(e,t){this.mapCoord=new Bt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof t>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){var t;this.texture!==e&&((t=this._texture)==null||t.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){t===void 0&&(t=e);const s=this.mapCoord;for(let n=0;n<e.length;n+=2){const r=e[n],o=e[n+1];t[n]=r*s.a+o*s.c+s.tx,t[n+1]=r*s.b+o*s.d+s.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const s=e.orig,n=e.trim;n&&(Xm.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Xm));const r=e.source,o=this.uClampFrame,i=this.clampMargin/r._resolution,a=this.clampOffset;return o[0]=(e.frame.x+i+a)/r.width,o[1]=(e.frame.y+i+a)/r.height,o[2]=(e.frame.x+e.frame.width-i+a)/r.width,o[3]=(e.frame.y+e.frame.height-i+a)/r.height,this.uClampOffset[0]=a/r.pixelWidth,this.uClampOffset[1]=a/r.pixelHeight,this.isSimple=e.frame.width===r.width&&e.frame.height===r.height&&e.rotate===0,!0}},Vt=class extends As{constructor({source:e,label:t,frame:s,orig:n,trim:r,defaultAnchor:o,defaultBorders:i,rotate:a,dynamic:l}={}){if(super(),this.uid=ke("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Me,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=(e==null?void 0:e.source)??new An,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=n||this.frame,this.trim=r,this.rotate=a??0,this.defaultAnchor=o,this.defaultBorders=i,this.destroyed=!1,this.dynamic=l||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new km(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:s,height:n}=this._source,r=t.x/s,o=t.y/n,i=t.width/s,a=t.height/n;let l=this.rotate;if(l){const c=i/2,u=a/2,h=r+c,d=o+u;l=ee.add(l,ee.NW),e.x0=h+c*ee.uX(l),e.y0=d+u*ee.uY(l),l=ee.add(l,2),e.x1=h+c*ee.uX(l),e.y1=d+u*ee.uY(l),l=ee.add(l,2),e.x2=h+c*ee.uX(l),e.y2=d+u*ee.uY(l),l=ee.add(l,2),e.x3=h+c*ee.uX(l),e.y3=d+u*ee.uY(l)}else e.x0=r,e.y0=o,e.x1=r+i,e.y1=o,e.x2=r+i,e.y2=o+a,e.x3=r,e.y3=o+a}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return le(he,"Texture.baseTexture is now Texture.source"),this._source}},Vt.EMPTY=new Vt({label:"EMPTY",source:new An({label:"EMPTY"})}),Vt.EMPTY.destroy=zm,Vt.WHITE=new Vt({source:new Vc({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"}),Vt.WHITE.destroy=zm,xm=function(e,t,s,n){const{width:r,height:o}=s.orig,i=s.trim;if(i){const a=i.width,l=i.height;e.minX=i.x-t._x*r-n,e.maxX=e.minX+a,e.minY=i.y-t._y*o-n,e.maxY=e.minY+l}else e.minX=-t._x*r-n,e.maxX=e.minX+r,e.minY=-t._y*o-n,e.maxY=e.minY+o};var EA={grad:.9,turn:360,rad:360/(2*Math.PI)},On=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},Ce=function(e,t,s){return t===void 0&&(t=0),s===void 0&&(s=Math.pow(10,t)),Math.round(s*e)/s+0},Cs=function(e,t,s){return t===void 0&&(t=0),s===void 0&&(s=1),e>s?s:e>t?e:t},Ym=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Zm=function(e){return{r:Cs(e.r,0,255),g:Cs(e.g,0,255),b:Cs(e.b,0,255),a:Cs(e.a)}},zc=function(e){return{r:Ce(e.r),g:Ce(e.g),b:Ce(e.b),a:Ce(e.a,3)}},$A=/^#([0-9a-f]{3,8})$/i,Ja=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},qm=function(e){var t=e.r,s=e.g,n=e.b,r=e.a,o=Math.max(t,s,n),i=o-Math.min(t,s,n),a=i?o===t?(s-n)/i:o===s?2+(n-t)/i:4+(t-s)/i:0;return{h:60*(a<0?a+6:a),s:o?i/o*100:0,v:o/255*100,a:r}},Qm=function(e){var t=e.h,s=e.s,n=e.v,r=e.a;t=t/360*6,s/=100,n/=100;var o=Math.floor(t),i=n*(1-s),a=n*(1-(t-o)*s),l=n*(1-(1-t+o)*s),c=o%6;return{r:255*[n,a,i,i,l,n][c],g:255*[l,n,n,a,i,i][c],b:255*[i,i,l,n,n,a][c],a:r}},Km=function(e){return{h:Ym(e.h),s:Cs(e.s,0,100),l:Cs(e.l,0,100),a:Cs(e.a)}},Jm=function(e){return{h:Ce(e.h),s:Ce(e.s),l:Ce(e.l),a:Ce(e.a,3)}},tg=function(e){return Qm((s=(t=e).s,{h:t.h,s:(s*=((n=t.l)<50?n:100-n)/100)>0?2*s/(n+s)*100:0,v:n+s,a:t.a}));var t,s,n},yi=function(e){return{h:(t=qm(e)).h,s:(r=(200-(s=t.s))*(n=t.v)/100)>0&&r<200?s*n/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,s,n,r},RA=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,DA=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,NA=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,LA=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Gc={string:[[function(e){var t=$A.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?Ce(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?Ce(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=NA.exec(e)||LA.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Zm({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=RA.exec(e)||DA.exec(e);if(!t)return null;var s,n,r=Km({h:(s=t[1],n=t[2],n===void 0&&(n="deg"),Number(s)*(EA[n]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return tg(r)},"hsl"]],object:[[function(e){var t=e.r,s=e.g,n=e.b,r=e.a,o=r===void 0?1:r;return On(t)&&On(s)&&On(n)?Zm({r:Number(t),g:Number(s),b:Number(n),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,s=e.s,n=e.l,r=e.a,o=r===void 0?1:r;if(!On(t)||!On(s)||!On(n))return null;var i=Km({h:Number(t),s:Number(s),l:Number(n),a:Number(o)});return tg(i)},"hsl"],[function(e){var t=e.h,s=e.s,n=e.v,r=e.a,o=r===void 0?1:r;if(!On(t)||!On(s)||!On(n))return null;var i=function(a){return{h:Ym(a.h),s:Cs(a.s,0,100),v:Cs(a.v,0,100),a:Cs(a.a)}}({h:Number(t),s:Number(s),v:Number(n),a:Number(o)});return Qm(i)},"hsv"]]},eg=function(e,t){for(var s=0;s<t.length;s++){var n=t[s][0](e);if(n)return[n,t[s][1]]}return[null,void 0]},BA=function(e){return typeof e=="string"?eg(e.trim(),Gc.string):typeof e=="object"&&e!==null?eg(e,Gc.object):[null,void 0]},Uc=function(e,t){var s=yi(e);return{h:s.h,s:Cs(s.s+100*t,0,100),l:s.l,a:s.a}},Hc=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},sg=function(e,t){var s=yi(e);return{h:s.h,s:s.s,l:Cs(s.l+100*t,0,100),a:s.a}},Wc=function(){function e(t){this.parsed=BA(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return Ce(Hc(this.rgba),2)},e.prototype.isDark=function(){return Hc(this.rgba)<.5},e.prototype.isLight=function(){return Hc(this.rgba)>=.5},e.prototype.toHex=function(){return t=zc(this.rgba),s=t.r,n=t.g,r=t.b,i=(o=t.a)<1?Ja(Ce(255*o)):"","#"+Ja(s)+Ja(n)+Ja(r)+i;var t,s,n,r,o,i},e.prototype.toRgb=function(){return zc(this.rgba)},e.prototype.toRgbString=function(){return t=zc(this.rgba),s=t.r,n=t.g,r=t.b,(o=t.a)<1?"rgba("+s+", "+n+", "+r+", "+o+")":"rgb("+s+", "+n+", "+r+")";var t,s,n,r,o},e.prototype.toHsl=function(){return Jm(yi(this.rgba))},e.prototype.toHslString=function(){return t=Jm(yi(this.rgba)),s=t.h,n=t.s,r=t.l,(o=t.a)<1?"hsla("+s+", "+n+"%, "+r+"%, "+o+")":"hsl("+s+", "+n+"%, "+r+"%)";var t,s,n,r,o},e.prototype.toHsv=function(){return t=qm(this.rgba),{h:Ce(t.h),s:Ce(t.s),v:Ce(t.v),a:Ce(t.a,3)};var t},e.prototype.invert=function(){return Js({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Js(Uc(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Js(Uc(this.rgba,-t))},e.prototype.grayscale=function(){return Js(Uc(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Js(sg(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Js(sg(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Js({r:(s=this.rgba).r,g:s.g,b:s.b,a:t}):Ce(this.rgba.a,3);var s},e.prototype.hue=function(t){var s=yi(this.rgba);return typeof t=="number"?Js({h:t,s:s.s,l:s.l,a:s.a}):Ce(s.h)},e.prototype.isEqual=function(t){return this.toHex()===Js(t).toHex()},e}(),Js=function(e){return e instanceof Wc?e:new Wc(e)},ng=[],jA=function(e){e.forEach(function(t){ng.indexOf(t)<0&&(t(Wc,Gc),ng.push(t))})};function FA(e,t){var s={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var r in s)n[s[r]]=r;var o={};e.prototype.toName=function(i){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=n[this.toHex()];if(c)return c;if(i!=null&&i.closest){var u=this.toRgb(),h=1/0,d="black";if(!o.length)for(var f in s)o[f]=new e(s[f]).toRgb();for(var p in s){var g=(a=u,l=o[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));g<h&&(h=g,d=p)}return d}},t.string.push([function(i){var a=i.toLowerCase(),l=a==="transparent"?"#0000":s[a];return l?new e(l).toRgb():null},"name"])}jA([FA]);const io=class Xa{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Xa)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._normalize(t),this._value=this._cloneSource(t))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,s){const n=typeof t;if(n!==typeof s)return!1;if(n==="number"||n==="string"||t instanceof Number)return t===s;if(Array.isArray(t)&&Array.isArray(s)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(s))return t.length!==s.length?!1:t.every((r,o)=>r===s[o]);if(t!==null&&s!==null){const r=Object.keys(t),o=Object.keys(s);return r.length!==o.length?!1:r.every(i=>t[i]===s[i])}return t===s}toRgba(){const[t,s,n,r]=this._components;return{r:t,g:s,b:n,a:r}}toRgb(){const[t,s,n]=this._components;return{r:t,g:s,b:n}}toRgbaString(){const[t,s,n]=this.toUint8RgbArray();return`rgba(${t},${s},${n},${this.alpha})`}toUint8RgbArray(t){const[s,n,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t=t||this._arrayRgb,t[0]=Math.round(s*255),t[1]=Math.round(n*255),t[2]=Math.round(r*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t=t||this._arrayRgba;const[s,n,r,o]=this._components;return t[0]=s,t[1]=n,t[2]=r,t[3]=o,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t=t||this._arrayRgb;const[s,n,r]=this._components;return t[0]=s,t[1]=n,t[2]=r,t}toNumber(){return this._int}toBgrNumber(){const[t,s,n]=this.toUint8RgbArray();return(n<<16)+(s<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[s,n,r,o]=Xa._temp.setValue(t)._components;return this._components[0]*=s,this._components[1]*=n,this._components[2]*=r,this._components[3]*=o,this._refreshInt(),this._value=null,this}premultiply(t,s=!0){return s&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,s=!0){if(t===1)return(255<<24)+this._int;if(t===0)return s?0:this._int;let n=this._int>>16&255,r=this._int>>8&255,o=this._int&255;return s&&(n=n*t+.5|0,r=r*t+.5|0,o=o*t+.5|0),(t*255<<24)+(n<<16)+(r<<8)+o}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let s,n,r,o;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const i=t;s=(i>>16&255)/255,n=(i>>8&255)/255,r=(i&255)/255,o=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[s,n,r,o=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[s,n,r,o=255]=t,s/=255,n/=255,r/=255,o/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=Xa.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const i=Js(t);i.isValid()&&({r:s,g:n,b:r,a:o}=i.rgba,s/=255,n/=255,r/=255)}if(s!==void 0)this._components[0]=s,this._components[1]=n,this._components[2]=r,this._components[3]=o,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,s,n]=this._components;this._int=(t*255<<16)+(s*255<<8)+(n*255|0)}_clamp(t,s=0,n=1){return typeof t=="number"?Math.min(Math.max(t,s),n):(t.forEach((r,o)=>{t[o]=Math.min(Math.max(r,s),n)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof Xa||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};io.shared=new io,io._temp=new io,io.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i,is=io;const VA={cullArea:null,cullable:!1,cullableChildren:!0};Om=function(e,t,s){const n=e.length;let r;if(t>=n||s===0)return;s=t+s>n?n-t:s;const o=n-s;for(r=t;r<o;++r)e[r]=e[r+s];e.length=o};const zA={allowChildren:!0,removeChildren(e=0,t){const s=t??this.children.length,n=s-e,r=[];if(n>0&&n<=s){for(let o=s-1;o>=e;o--){const i=this.children[o];i&&(this.renderGroup&&this.renderGroup.removeChild(i),r.push(i),i.parent=null)}Om(this.children,e,s);for(let o=0;o<r.length;++o)this.emit("childRemoved",r[o],this,o),r[o].emit("removed",this);return r}else if(n===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(e){const t=this.getChildAt(e);return this.removeChild(t)},getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]},setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(e),this.addChildAt(e,t)},getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(e,t){this.allowChildren||le(he,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:s}=this;if(t<0||t>s.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${s.length}`);if(e.parent){const n=e.parent.children.indexOf(e);if(e.parent===this&&n===t)return e;n!==-1&&e.parent.children.splice(n,1)}return t===s.length?s.push(e):s.splice(t,0,e),e.parent=this,e.didChange=!0,e.didViewUpdate=!1,e._updateFlags=15,this.renderGroup&&this.renderGroup.addChild(e),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",e,this,t),e.emit("added",this),e},swapChildren(e,t){if(e===t)return;const s=this.getChildIndex(e),n=this.getChildIndex(t);this.children[s]=t,this.children[n]=e},removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}};mm=class{constructor(e){this.pipe="filter",this.priority=1,this.filters=e==null?void 0:e.filters,this.filterArea=e==null?void 0:e.filterArea}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}};class Xc{constructor(t,s){this._pool=[],this._count=0,this._index=0,this._classType=t,s&&this.prepopulate(s)}prepopulate(t){for(let s=0;s<t;s++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var n;let s;return this._index>0?s=this._pool[--this._index]:s=new this._classType,(n=s.init)==null||n.call(s,t),s}return(t){var s;(s=t.reset)==null||s.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}}class GA{constructor(){this._poolsByClass=new Map}prepopulate(t,s){this.getPool(t).prepopulate(s)}get(t,s){return this.getPool(t).get(s)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Xc(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(s=>{const n=t[s._classType.name]?s._classType.name+s._classType.ID:s._classType.name;t[n]={free:s.totalFree,used:s.totalUsed,size:s.totalSize}}),t}}ks=new GA;class UA{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let s=0;s<this._tests.length;s++){const n=this._tests[s];if(n.test(t))return ks.get(n.maskClass,t)}return t}returnMaskEffect(t){ks.return(t)}}const Yc=new UA;ps.handleByList(mt.MaskEffect,Yc._effectClasses);const HA={_mask:null,_filters:null,effects:[],addEffect(e){this.effects.indexOf(e)===-1&&(this.effects.push(e),this.effects.sort((t,s)=>t.priority-s.priority),this.renderGroup&&(this.renderGroup.structureDidChange=!0),this._updateIsSimple())},removeEffect(e){const t=this.effects.indexOf(e);t!==-1&&(this.effects.splice(t,1),!this.isRenderGroupRoot&&this.renderGroup&&(this.renderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(e){if(this._mask||(this._mask={mask:null,effect:null}),this._mask.mask===e||(this._mask.effect&&(this.removeEffect(this._mask.effect),Yc.returnMaskEffect(this._mask.effect),this._mask.effect=null),this._mask.mask=e,e==null))return;const t=Yc.getMaskEffect(e);this._mask.effect=t,this.addEffect(t)},get mask(){var e;return(e=this._mask)==null?void 0:e.mask},set filters(e){!Array.isArray(e)&&e&&(e=[e]),e=e,this._filters||(this._filters={filters:null,effect:null,filterArea:null});const t=(e==null?void 0:e.length)>0,s=this._filters.effect&&!t||!this._filters.effect&&t;if(e=Array.isArray(e)?e.slice(0):e,this._filters.filters=Object.freeze(e),s)if(t){const n=ks.get(mm);this._filters.effect=n,this.addEffect(n)}else{const n=this._filters.effect;this.removeEffect(n),n.filterArea=null,n.filters=null,this._filters.effect=null,ks.return(n)}t&&(this._filters.effect.filters=e,this._filters.effect.filterArea=this.filterArea)},get filters(){var e;return(e=this._filters)==null?void 0:e.filters},set filterArea(e){this._filters||(this._filters={filters:null,effect:null,filterArea:null}),this._filters.filterArea=e},get filterArea(){var e;return(e=this._filters)==null?void 0:e.filterArea}},WA={label:null,get name(){return le(he,"Container.name property has been removed, use Container.label instead"),this.label},set name(e){le(he,"Container.name property has been removed, use Container.label instead"),this.label=e},getChildByName(e,t=!1){return this.getChildByLabel(e,t)},getChildByLabel(e,t=!1){const s=this.children;for(let n=0;n<s.length;n++){const r=s[n];if(r.label===e||e instanceof RegExp&&e.test(r.label))return r}if(t)for(let n=0;n<s.length;n++){const r=s[n].getChildByLabel(e,!0);if(r)return r}return null},getChildrenByLabel(e,t=!1,s=[]){const n=this.children;for(let r=0;r<n.length;r++){const o=n[r];(o.label===e||e instanceof RegExp&&e.test(o.label))&&s.push(o)}if(t)for(let r=0;r<n.length;r++)n[r].getChildrenByLabel(e,!0,s);return s}},rg=new Bt;kn=class{constructor(e=1/0,t=1/0,s=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=rg,this.minX=e,this.minY=t,this.maxX=s,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Me);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=rg,this}set(e,t,s,n){this.minX=e,this.minY=t,this.maxX=s,this.maxY=n}addFrame(e,t,s,n,r){r||(r=this.matrix);const o=r.a,i=r.b,a=r.c,l=r.d,c=r.tx,u=r.ty;let h=this.minX,d=this.minY,f=this.maxX,p=this.maxY,g=o*e+a*t+c,m=i*e+l*t+u;g<h&&(h=g),m<d&&(d=m),g>f&&(f=g),m>p&&(p=m),g=o*s+a*t+c,m=i*s+l*t+u,g<h&&(h=g),m<d&&(d=m),g>f&&(f=g),m>p&&(p=m),g=o*e+a*n+c,m=i*e+l*n+u,g<h&&(h=g),m<d&&(d=m),g>f&&(f=g),m>p&&(p=m),g=o*s+a*n+c,m=i*s+l*n+u,g<h&&(h=g),m<d&&(d=m),g>f&&(f=g),m>p&&(p=m),this.minX=h,this.minY=d,this.maxX=f,this.maxY=p}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,s=this.minY,n=this.maxX,r=this.maxY,{a:o,b:i,c:a,d:l,tx:c,ty:u}=e;let h=o*t+a*s+c,d=i*t+l*s+u;this.minX=h,this.minY=d,this.maxX=h,this.maxY=d,h=o*n+a*s+c,d=i*n+l*s+u,this.minX=h<this.minX?h:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=d>this.maxY?d:this.maxY,h=o*t+a*r+c,d=i*t+l*r+u,this.minX=h<this.minX?h:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=d>this.maxY?d:this.maxY,h=o*n+a*r+c,d=i*n+l*r+u,this.minX=h<this.minX?h:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,s,n){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<s&&(this.minY=s),this.maxY>n&&(this.maxY=n),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new kn(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,s,n){let r=this.minX,o=this.minY,i=this.maxX,a=this.maxY;n||(n=this.matrix);const l=n.a,c=n.b,u=n.c,h=n.d,d=n.tx,f=n.ty;for(let p=t;p<s;p+=2){const g=e[p],m=e[p+1],y=l*g+u*m+d,v=c*g+h*m+f;r=y<r?y:r,o=v<o?v:o,i=y>i?y:i,a=v>a?v:a}this.minX=r,this.minY=o,this.maxX=i,this.maxY=a}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}};let tn;tn=new Xc(Bt),vr=new Xc(kn),Dc=function(e,t,s){s.clear();let n,r;return e.parent?t?n=e.parent.worldTransform:(r=tn.get().identity(),n=tl(e,r)):n=Bt.IDENTITY,og(e,s,n,t),r&&tn.return(r),s.isValid||s.set(0,0,0,0),s};function og(e,t,s,n){var a,l;if(!e.visible||!e.measurable)return;let r;n?r=e.worldTransform:(e.updateLocalTransform(),r=tn.get(),r.appendFrom(e.localTransform,s));const o=t,i=!!e.effects.length;if(i&&(t=vr.get().clear()),e.boundsArea)t.addRect(e.boundsArea,r);else{e.addBounds&&(t.matrix=r,e.addBounds(t));for(let c=0;c<e.children.length;c++)og(e.children[c],t,r,n)}if(i){for(let c=0;c<e.effects.length;c++)(l=(a=e.effects[c]).addBounds)==null||l.call(a,t);o.addBounds(t,Bt.IDENTITY),vr.return(t)}n||tn.return(r)}function tl(e,t){const s=e.parent;return s&&(tl(s,t),s.updateLocalTransform(),t.append(s.localTransform)),t}let Zc=0;const ig=500;Se=function(...e){Zc!==ig&&(Zc++,Zc===ig?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...e))},Oc=function(e,t,s){return t.clear(),s||(s=Bt.IDENTITY),ag(e,t,s,e,!0),t.isValid||t.set(0,0,0,0),t};function ag(e,t,s,n,r){var l,c;let o;if(r)o=tn.get(),o=s.copyTo(o);else{if(!e.visible||!e.measurable)return;e.updateLocalTransform();const u=e.localTransform;o=tn.get(),o.appendFrom(u,s)}const i=t,a=!!e.effects.length;if(a&&(t=vr.get().clear()),e.boundsArea)t.addRect(e.boundsArea,o);else{e.renderPipeId&&(t.matrix=o,e.addBounds(t));const u=e.children;for(let h=0;h<u.length;h++)ag(u[h],t,o,n,!1)}if(a){for(let u=0;u<e.effects.length;u++)(c=(l=e.effects[u]).addLocalBounds)==null||c.call(l,t,n);i.addBounds(t,Bt.IDENTITY),vr.return(t)}tn.return(o)}function lg(e,t){const s=e.children;for(let n=0;n<s.length;n++){const r=s[n],o=(r.uid&255)<<24|r._didChangeId&16777215;t.data[t.index]!==o&&(t.data[t.index]=o,t.didChange=!0),t.index++,r.children.length&&lg(r,t)}return t.didChange}const XA=new Bt,YA={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(e,t){const s=Math.sign(this.scale.x)||1;t!==0?this.scale.x=e/t*s:this.scale.x=s},_setHeight(e,t){const s=Math.sign(this.scale.y)||1;t!==0?this.scale.y=e/t*s:this.scale.y=s},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new kn});const e=this._localBoundsCacheData;return e.index=1,e.didChange=!1,e.data[0]!==this._didChangeId>>12&&(e.didChange=!0,e.data[0]=this._didChangeId>>12),lg(this,e),e.didChange&&Oc(this,e.localBounds,XA),e.localBounds},getBounds(e,t){return Dc(this,e,t||new kn)}},ZA={_onRender:null,set onRender(e){const t=this.renderGroup;if(!e){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||(t==null||t.addOnRender(this)),this._onRender=e},get onRender(){return this._onRender}},qA={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(QA))}};function QA(e,t){return e._zIndex-t._zIndex}const KA={getGlobalPosition(e=new ze,t=!1){return this.parent?this.parent.toGlobal(this._position,e,t):(e.x=this._position.x,e.y=this._position.y),e},toGlobal(e,t,s=!1){if(!s){this.updateLocalTransform();const n=tl(this,new Bt);return n.append(this.localTransform),n.apply(e,t)}return this.worldTransform.apply(e,t)},toLocal(e,t,s,n){if(t&&(e=t.toGlobal(e,s,n)),!n){this.updateLocalTransform();const r=tl(this,new Bt);return r.append(this.localTransform),r.applyInverse(e,s)}return this.worldTransform.applyInverse(e,s)}};class hg{constructor(){this.uid=ke("instructionSet"),this.instructions=[],this.instructionSize=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}class JA{constructor(t){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this._children=[],this.worldTransform=new Bt,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new hg,this._onRenderContainers=[],this.root=t,this.addChild(t)}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.onChildUpdate(t.root),this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){t.root.didChange&&this._removeChildFromUpdate(t.root);const s=this.renderGroupChildren.indexOf(t);s>-1&&this.renderGroupChildren.splice(s,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t!==this.root&&(this._children.push(t),t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t._onRender&&this.addOnRender(t)),t.renderGroup){if(t.renderGroup.root===t){this.addRenderGroupChild(t.renderGroup);return}}else t.renderGroup=this,t.didChange=!0;const s=t.children;t.isRenderGroupRoot||this.onChildUpdate(t);for(let n=0;n<s.length;n++)this.addChild(s[n])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&this.removeOnRender(t),t.renderGroup.root!==t){const n=t.children;for(let r=0;r<n.length;r++)this.removeChild(n[r]);t.didChange&&t.renderGroup._removeChildFromUpdate(t),t.renderGroup=null}else this._removeRenderGroupChild(t.renderGroup);const s=this._children.indexOf(t);s>-1&&this._children.splice(s,1)}onChildUpdate(t){let s=this.childrenToUpdate[t.relativeRenderGroupDepth];s||(s=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),s.list[s.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(t.didViewUpdate=!1,this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t))}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}_removeChildFromUpdate(t){const s=this.childrenToUpdate[t.relativeRenderGroupDepth];if(!s)return;const n=s.list.indexOf(t);n>-1&&s.list.splice(n,1),s.index--}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender()}}function tk(e,t,s={}){for(const n in t)!s[n]&&t[n]!==void 0&&(e[n]=t[n])}let el,sl,nl;el=new ms(null),sl=new ms(null),nl=new ms(null,1,1),Nc=1,gm=2,Ha=4,te=class extends As{constructor(e={}){var t,s;super(),this.uid=ke("renderable"),this._updateFlags=15,this.isRenderGroupRoot=!1,this.renderGroup=null,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new Bt,this.relativeGroupTransform=new Bt,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ms(this,0,0),this._scale=nl,this._pivot=sl,this._skew=el,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didChangeId=0,this._didLocalTransformChangeId=-1,tk(this,e,{children:!0,parent:!0,effects:!0}),(t=e.children)==null||t.forEach(n=>this.addChild(n)),this.effects=[],(s=e.parent)==null||s.addChild(this)}static mixin(e){Object.defineProperties(te.prototype,Object.getOwnPropertyDescriptors(e))}addChild(...e){if(this.allowChildren||le(he,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let s=0;s<e.length;s++)this.addChild(e[s]);return e[0]}const t=e[0];return t.parent===this?(this.children.splice(this.children.indexOf(t),1),this.children.push(t),this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),t):(t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t.didViewUpdate=!1,t._updateFlags=15,this.renderGroup&&this.renderGroup.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),t._zIndex!==0&&t.depthOfChildModified(),t)}removeChild(...e){if(e.length>1){for(let n=0;n<e.length;n++)this.removeChild(e[n]);return e[0]}const t=e[0],s=this.children.indexOf(t);return s>-1&&(this.children.splice(s,1),this.renderGroup&&this.renderGroup.removeChild(t),t.parent=null,this.emit("childRemoved",t,this,s),t.emit("removed",this)),t}_onUpdate(e){if(e&&e===this._skew&&this._updateSkew(),this._didChangeId++,!this.didChange)if(this.didChange=!0,this.isRenderGroupRoot){const t=this.renderGroup.renderGroupParent;t&&t.onChildUpdate(this)}else this.renderGroup&&this.renderGroup.onChildUpdate(this)}set isRenderGroup(e){if(this.isRenderGroupRoot&&e===!1)throw new Error("[Pixi] cannot undo a render group just yet");e&&this.enableRenderGroup()}get isRenderGroup(){return this.isRenderGroupRoot}enableRenderGroup(){if(this.renderGroup&&this.renderGroup.root===this)return;this.isRenderGroupRoot=!0;const e=this.renderGroup;if(e&&e.removeChild(this),this.renderGroup=new JA(this),e){for(let t=0;t<e.renderGroupChildren.length;t++){const s=e.renderGroupChildren[t];let n=s.root;for(;n;){if(n===this){this.renderGroup.addRenderGroupChild(s);break}n=n.parent}}e.addRenderGroupChild(this.renderGroup)}this._updateIsSimple(),this.groupTransform=Bt.IDENTITY}_updateIsSimple(){this.isSimple=!this.isRenderGroupRoot&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new Bt),this.renderGroup&&(this.isRenderGroupRoot?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this._worldTransform.appendFrom(this.relativeGroupTransform,this.renderGroup.worldTransform)),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*jm}set angle(e){this.rotation=e*Fm}get pivot(){return this._pivot===sl&&(this._pivot=new ms(this,0,0)),this._pivot}set pivot(e){this._pivot===sl&&(this._pivot=new ms(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===el&&(this._skew=new ms(this,0,0)),this._skew}set skew(e){this._skew===el&&(this._skew=new ms(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===nl&&(this._scale=new ms(this,1,1)),this._scale}set scale(e){this._scale===nl&&(this._scale=new ms(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const s=this.getLocalBounds();let n,r;typeof e!="object"?(n=e,r=t??e):(n=e.width,r=e.height??e.width),n!==void 0&&this._setWidth(n,s.width),r!==void 0&&this._setHeight(r,s.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){if((this._didLocalTransformChangeId&15)===this._didChangeId)return;this._didLocalTransformChangeId=this._didChangeId;const e=this.localTransform,t=this._scale,s=this._pivot,n=this._position,r=t._x,o=t._y,i=s._x,a=s._y;e.a=this._cx*r,e.b=this._sx*r,e.c=this._cy*o,e.d=this._sy*o,e.tx=n._x-(i*e.a+a*e.c),e.ty=n._y-(i*e.b+a*e.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Nc,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const t=is.shared.setValue(e??16777215).toBgrNumber();t!==this.localColor&&(this.localColor=t,this._updateFlags|=Nc,this._onUpdate())}get tint(){const e=this.localColor;return((e&255)<<16)+(e&65280)+(e>>16&255)}set blendMode(e){this.localBlendMode!==e&&(this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),this._updateFlags|=gm,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const t=e?1:0;(this.localDisplayStatus&2)>>1!==t&&(this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),this._updateFlags|=Ha,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const t=e?1:0;(this.localDisplayStatus&4)>>2!==t&&(this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),this._updateFlags|=Ha,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const t=e?1:0;(this.localDisplayStatus&1)!==t&&(this._updateFlags|=Ha,this.localDisplayStatus^=1,this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0,this.removeFromParent(),this.parent=null,this._mask=null,this._filters=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners();const t=typeof e=="boolean"?e:e==null?void 0:e.children,s=this.removeChildren(0,this.children.length);if(t)for(let n=0;n<s.length;++n)s[n].destroy(e)}},te.mixin(zA),te.mixin(KA),te.mixin(ZA),te.mixin(YA),te.mixin(HA),te.mixin(WA),te.mixin(qA),te.mixin(VA),Je=class extends te{constructor(e=Vt.EMPTY){e instanceof Vt&&(e={texture:e});const{texture:t,anchor:s,roundPixels:n,width:r,height:o,...i}=e;super({label:"Sprite",...i}),this.renderPipeId="sprite",this.batched=!0,this._didSpriteUpdate=!1,this._bounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._boundsDirty=!0,this._sourceBoundsDirty=!0,this._roundPixels=0,this._anchor=new ms({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=n??!1,r&&(this.width=r),o&&(this.height=o)}static from(e,t=!1){return e instanceof Vt?new Je(e):new Je(Vt.from(e,t))}set texture(e){e||(e=Vt.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(e){const t=this.sourceBounds;return e.x>=t.maxX&&e.x<=t.minX&&e.y>=t.maxY&&e.y<=t.minY}addBounds(e){const t=this._texture.trim?this.sourceBounds:this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}onViewUpdate(){this._didChangeId+=4096,this._didSpriteUpdate=!0,this._sourceBoundsDirty=this._boundsDirty=!0,!this.didViewUpdate&&(this.didViewUpdate=!0,this.renderGroup&&this.renderGroup.onChildViewUpdate(this))}_updateBounds(){xm(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const e=this._anchor,t=this._texture,s=this._sourceBounds,{width:n,height:r}=t.orig;s.maxX=-e._x*n,s.minX=s.maxX+n,s.maxY=-e._y*r,s.minY=s.maxY+r}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e==null?void 0:e.texture){const t=typeof e=="boolean"?e:e==null?void 0:e.textureSource;this._texture.destroy(t)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width)}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){let s,n;typeof e!="object"?(s=e,n=t??e):(s=e.width,n=e.height??e.width),s!==void 0&&this._setWidth(s,this._texture.orig.width),n!==void 0&&this._setHeight(n,this._texture.orig.height)}};const ek=new kn;function cg(e,t,s){const n=ek;e.measurable=!0,Dc(e,s,n),t.addBoundsMask(n),e.measurable=!1}function ug(e,t,s){const n=vr.get();e.measurable=!0;const r=tn.get().identity(),o=dg(e,s,r);Oc(e,n,o),e.measurable=!1,t.addBoundsMask(n),tn.return(r),vr.return(n)}function dg(e,t,s){return e?(e!==t&&(dg(e.parent,t,s),e.updateLocalTransform(),s.append(e.localTransform)),s):(Se("Mask bounds, renderable is not inside the root container"),s)}class fg{constructor(t){this.priority=0,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Je),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,s){cg(this.mask,t,s)}addLocalBounds(t,s){ug(this.mask,t,s)}containsPoint(t,s){const n=this.mask;return s(n,t)}destroy(){this.reset()}static test(t){return t instanceof Je}}fg.extension=mt.MaskEffect;class pg{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}pg.extension=mt.MaskEffect;class mg{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,s){cg(this.mask,t,s)}addLocalBounds(t,s){ug(this.mask,t,s)}containsPoint(t,s){const n=this.mask;return s(n,t)}destroy(){this.reset()}static test(t){return t instanceof te}}mg.extension=mt.MaskEffect;let gg={createCanvas:(e,t)=>{const s=document.createElement("canvas");return s.width=e,s.height=t,s},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")};Ke={get(){return gg},set(e){gg=e}},Rc=class extends An{constructor(e){e.resource||(e.resource=Ke.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity;const t=e.resource;(this.pixelWidth!==t.width||this.pixelWidth!==t.height)&&this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,s=this._resolution){const n=super.resize(e,t,s);return n&&this.resizeCanvas(),n}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}},Rc.extension=mt.TextureSource,so=class extends An{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const t=Ke.get().createCanvas(e.resource.width,e.resource.height);t.getContext("2d").drawImage(e.resource,0,0),e.resource=t,Se("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap}},so.extension=mt.TextureSource,Wa=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(Wa||{});class qc{constructor(t,s=null,n=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=s,this.priority=n,this._once=r}match(t,s=null){return this._fn===t&&this._context===s}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const s=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),s}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const s=this.next;return this.next=t?null:s,this.previous=null,s}}const yg=class Ss{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new qc(null,null,1/0),this.deltaMS=1/Ss.targetFPMS,this.elapsedMS=1/Ss.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,s,n=Wa.NORMAL){return this._addListener(new qc(t,s,n))}addOnce(t,s,n=Wa.NORMAL){return this._addListener(new qc(t,s,n,!0))}_addListener(t){let s=this._head.next,n=this._head;if(!s)t.connect(n);else{for(;s;){if(t.priority>s.priority){t.connect(n);break}n=s,s=s.next}t.previous||t.connect(n)}return this._startIfPossible(),this}remove(t,s){let n=this._head.next;for(;n;)n.match(t,s)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,s=this._head;for(;s=s.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let s;if(t>this.lastTime){if(s=this.elapsedMS=t-this.lastTime,s>this._maxElapsedMS&&(s=this._maxElapsedMS),s*=this.speed,this._minElapsedMS){const o=t-this._lastFrame|0;if(o<this._minElapsedMS)return;this._lastFrame=t-o%this._minElapsedMS}this.deltaMS=s,this.deltaTime=this.deltaMS*Ss.targetFPMS;const n=this._head;let r=n.next;for(;r;)r=r.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const s=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,s)/1e3,Ss.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const s=Math.max(this.minFPS,t);this._minElapsedMS=1/(s/1e3)}}static get shared(){if(!Ss._shared){const t=Ss._shared=new Ss;t.autoStart=!0,t._protected=!0}return Ss._shared}static get system(){if(!Ss._system){const t=Ss._system=new Ss;t.autoStart=!0,t._protected=!0}return Ss._system}};yg.targetFPMS=.06;let Qc;eo=yg;async function vg(){return Qc??(Qc=(async()=>{var o;const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(i=>{const a=document.createElement("video");a.onloadeddata=()=>i(a),a.onerror=()=>i(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!t)return"premultiply-alpha-on-upload";const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const r=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,r),e.deleteFramebuffer(n),e.deleteTexture(s),(o=e.getExtension("WEBGL_lose_context"))==null||o.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Qc}const rl=class wA extends An{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...wA.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=eo.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,s=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(s.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await vg(),this._load=new Promise((n,r)=>{this.isValid?n(this):(this._resolve=n,this._reject=r,s.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${s.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(eo.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(eo.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(eo.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||globalThis.VideoFrame&&t instanceof VideoFrame}};rl.extension=mt.TextureSource,rl.defaultOptions={...An.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1},rl.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let ol=rl;const js=(e,t,s=!1)=>(Array.isArray(e)||(e=[e]),t?e.map(n=>typeof n=="string"||s?t(n):n):e);class sk{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const s=this._cache.get(t);return s||Se(`[Assets] Asset id ${t} was not found in the Cache`),s}set(t,s){const n=js(t);let r;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(s)){r=c.getCacheableAssets(n,s);break}}const o=new Map(Object.entries(r||{}));r||n.forEach(l=>{o.set(l,s)});const i=[...o.keys()],a={cacheKeys:i,keys:n};n.forEach(l=>{this._cacheMap.set(l,a)}),i.forEach(l=>{const c=r?r[l]:s;this._cache.has(l)&&this._cache.get(l)!==c&&Se("[Cache] already has key:",l),this._cache.set(l,o.get(l))})}remove(t){if(!this._cacheMap.has(t)){Se(`[Assets] Asset id ${t} was not found in the Cache`);return}const s=this._cacheMap.get(t);s.cacheKeys.forEach(n=>{this._cache.delete(n)}),s.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}let il;Ge=new sk,il=[],ps.handleByList(mt.TextureSource,il);function nk(e={}){const t=e&&e.resource,s=t?e.resource:e,n=t?e:{resource:e};for(let r=0;r<il.length;r++){const o=il[r];if(o.test(s))return new o(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}function rk(e={},t=!1){const s=e&&e.resource,n=s?e.resource:e,r=s?e:{resource:e};if(!t&&Ge.has(n))return Ge.get(n);const o=new Vt({source:nk(r)});return o.on("destroy",()=>{Ge.has(n)&&Ge.remove(n)}),t||Ge.set(n,o),o}function ok(e,t=!1){return typeof e=="string"?Ge.get(e):e instanceof An?new Vt({source:e}):rk(e,t)}Vt.from=ok,ps.add(fg,pg,mg,ol,so,Rc,Vc),Hn=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(Hn||{});function Fs(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function vi(e){return e.split("?")[0].split("#")[0]}function ik(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ak(e,t,s){return e.replace(new RegExp(ik(t),"g"),s)}function lk(e,t){let s="",n=0,r=-1,o=0,i=-1;for(let a=0;a<=e.length;++a){if(a<e.length)i=e.charCodeAt(a);else{if(i===47)break;i=47}if(i===47){if(!(r===a-1||o===1))if(r!==a-1&&o===2){if(s.length<2||n!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){const l=s.lastIndexOf("/");if(l!==s.length-1){l===-1?(s="",n=0):(s=s.slice(0,l),n=s.length-1-s.lastIndexOf("/")),r=a,o=0;continue}}else if(s.length===2||s.length===1){s="",n=0,r=a,o=0;continue}}t&&(s.length>0?s+="/..":s="..",n=2)}else s.length>0?s+=`/${e.slice(r+1,a)}`:s=e.slice(r+1,a),n=a-r-1;r=a,o=0}else i===46&&o!==-1?++o:o=-1}return s}Bs={toPosix(e){return ak(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},isBlobUrl(e){return e.startsWith("blob:")},hasProtocol(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol(e){Fs(e),e=this.toPosix(e);const t=/^file:\/\/\//.exec(e);if(t)return t[0];const s=/^[^/:]+:\/{0,2}/.exec(e);return s?s[0]:""},toAbsolute(e,t,s){if(Fs(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;const n=vi(this.toPosix(t??Ke.get().getBaseUrl())),r=vi(this.toPosix(s??this.rootname(n)));return e=this.toPosix(e),e.startsWith("/")?Bs.join(r,e.slice(1)):this.isAbsolute(e)?e:this.join(n,e)},normalize(e){if(Fs(e),e.length===0)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;e=this.toPosix(e);let t="";const s=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const n=e.endsWith("/");return e=lk(e,!1),e.length>0&&n&&(e+="/"),s?`/${e}`:t+e},isAbsolute(e){return Fs(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let s=0;s<e.length;++s){const n=e[s];if(Fs(n),n.length>0)if(t===void 0)t=n;else{const r=e[s-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${n}`:t+=`/${n}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(Fs(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0);const s=t===47;let n=-1,r=!0;const o=this.getProtocol(e),i=e;e=e.slice(o.length);for(let a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!r){n=a;break}}else r=!1;return n===-1?s?"/":this.isUrl(i)?o+e:o:s&&n===1?"//":o+e.slice(0,n)},rootname(e){Fs(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){const s=e.indexOf("/",t.length);s!==-1?t=e.slice(0,s):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){Fs(e),t&&Fs(t),e=vi(this.toPosix(e));let s=0,n=-1,r=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let i=t.length-1,a=-1;for(o=e.length-1;o>=0;--o){const l=e.charCodeAt(o);if(l===47){if(!r){s=o+1;break}}else a===-1&&(r=!1,a=o+1),i>=0&&(l===t.charCodeAt(i)?--i===-1&&(n=o):(i=-1,n=a))}return s===n?n=a:n===-1&&(n=e.length),e.slice(s,n)}for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!r){s=o+1;break}}else n===-1&&(r=!1,n=o+1);return n===-1?"":e.slice(s,n)},extname(e){Fs(e),e=vi(this.toPosix(e));let t=-1,s=0,n=-1,r=!0,o=0;for(let i=e.length-1;i>=0;--i){const a=e.charCodeAt(i);if(a===47){if(!r){s=i+1;break}continue}n===-1&&(r=!1,n=i+1),a===46?t===-1?t=i:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===s+1?"":e.slice(t,n)},parse(e){Fs(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=vi(this.toPosix(e));let s=e.charCodeAt(0);const n=this.isAbsolute(e);let r;t.root=this.rootname(e),n||this.hasProtocol(e)?r=1:r=0;let o=-1,i=0,a=-1,l=!0,c=e.length-1,u=0;for(;c>=r;--c){if(s=e.charCodeAt(c),s===47){if(!l){i=c+1;break}continue}a===-1&&(l=!1,a=c+1),s===46?o===-1?o=c:u!==1&&(u=1):o!==-1&&(u=-1)}return o===-1||a===-1||u===0||u===1&&o===a-1&&o===i+1?a!==-1&&(i===0&&n?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(i,a)):(i===0&&n?(t.name=e.slice(1,o),t.base=e.slice(1,a)):(t.name=e.slice(i,o),t.base=e.slice(i,a)),t.ext=e.slice(o,a)),t.dir=this.dirname(e),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function bg(e,t,s,n,r){const o=t[s];for(let i=0;i<o.length;i++){const a=o[i];s<t.length-1?bg(e.replace(n[s],a),t,s+1,n,r):r.push(e.replace(n[s],a))}}function hk(e){const t=/\{(.*?)\}/g,s=e.match(t),n=[];if(s){const r=[];s.forEach(o=>{const i=o.substring(1,o.length-1).split(",");r.push(i)}),bg(e,r,0,s,n)}else n.push(e);return n}const al=e=>!Array.isArray(e);class ao{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,s)=>`${t}${this._bundleIdConnector}${s}`,extractAssetIdFromBundle:(t,s)=>s.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(s=>{this._preferredOrder.push(s),s.priority||(s.priority=Object.keys(s.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const s=t;this._defaultSearchParams=Object.keys(s).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(s[n])}`).join("&")}}getAlias(t){const{alias:s,src:n}=t;return js(s||n,r=>typeof r=="string"?r:Array.isArray(r)?r.map(o=>(o==null?void 0:o.src)??o):r!=null&&r.src?r.src:r,!0)}addManifest(t){this._manifest&&Se("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(s=>{this.addBundle(s.name,s.assets)})}addBundle(t,s){const n=[];let r=s;Array.isArray(s)||(r=Object.entries(s).map(([o,i])=>typeof i=="string"||Array.isArray(i)?{alias:o,src:i}:{alias:o,...i})),r.forEach(o=>{const i=o.src,a=o.alias;let l;if(typeof a=="string"){const c=this._createBundleAssetId(t,a);n.push(c),l=[a,c]}else{const c=a.map(u=>this._createBundleAssetId(t,u));n.push(...c),l=[...a,...c]}this.add({...o,alias:l,src:i})}),this._bundles[t]=n}add(t){const s=[];Array.isArray(t)?s.push(...t):s.push(t);let n;n=r=>{this.hasKey(r)&&Se(`[Resolver] already has key: ${r} overwriting`)},js(s).forEach(r=>{const{src:o}=r;let{data:i,format:a,loadParser:l}=r;const c=js(o).map(d=>typeof d=="string"?hk(d):Array.isArray(d)?d:[d]),u=this.getAlias(r);Array.isArray(u)?u.forEach(n):n(u);const h=[];c.forEach(d=>{d.forEach(f=>{let p={};if(typeof f!="object"){p.src=f;for(let g=0;g<this._parsers.length;g++){const m=this._parsers[g];if(m.test(f)){p=m.parse(f);break}}}else i=f.data??i,a=f.format??a,l=f.loadParser??l,p={...p,...f};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${p.src}`);p=this._buildResolvedAsset(p,{aliases:u,data:i,format:a,loadParser:l}),h.push(p)})}),u.forEach(d=>{this._assetMap[d]=h})})}resolveBundle(t){const s=al(t);t=js(t);const n={};return t.forEach(r=>{const o=this._bundles[r];if(o){const i=this.resolve(o),a={};for(const l in i){const c=i[l];a[this._extractAssetIdFromBundle(r,l)]=c}n[r]=a}}),s?n[t[0]]:n}resolveUrl(t){const s=this.resolve(t);if(typeof t!="string"){const n={};for(const r in s)n[r]=s[r].src;return n}return s.src}resolve(t){const s=al(t);t=js(t);const n={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let o=this._assetMap[r];const i=this._getPreferredOrder(o);i==null||i.priority.forEach(a=>{i.params[a].forEach(l=>{const c=o.filter(u=>u[a]?u[a]===l:!1);c.length&&(o=c)})}),this._resolverHash[r]=o[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});n[r]=this._resolverHash[r]}),s?n[t[0]]:n}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let s=0;s<t.length;s++){const n=t[0],r=this._preferredOrder.find(o=>o.params.format.includes(n.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const s=/\?/.test(t)?"&":"?";return`${t}${s}${this._defaultSearchParams}`}_buildResolvedAsset(t,s){const{aliases:n,data:r,loadParser:o,format:i}=s;return(this._basePath||this._rootPath)&&(t.src=Bs.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=n??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=o??t.loadParser,t.format=i??t.format??ck(t.src),t}}ao.RETINA_PREFIX=/@([0-9\.]+)x/;function ck(e){return e.split(".").pop().split("?").shift().split("#").shift()}let Kc;Mc=(e,t)=>{const s=t.split("?")[1];return s&&(e+=`?${s}`),e},Kc=class Ya{constructor(t,s){this.linkedSheets=[],this._texture=t instanceof Vt?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=s;const n=parseFloat(s.meta.scale);n?(this.resolution=n,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Ya.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let s=t;const n=Ya.BATCH_SIZE;for(;s-t<n&&s<this._frameKeys.length;){const r=this._frameKeys[s],o=this._frames[r],i=o.frame;if(i){let a=null,l=null;const c=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,u=new Me(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);o.rotated?a=new Me(Math.floor(i.x)/this.resolution,Math.floor(i.y)/this.resolution,Math.floor(i.h)/this.resolution,Math.floor(i.w)/this.resolution):a=new Me(Math.floor(i.x)/this.resolution,Math.floor(i.y)/this.resolution,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(l=new Me(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution)),this.textures[r]=new Vt({source:this.textureSource,frame:a,orig:u,trim:l,rotate:o.rotated?2:0,defaultAnchor:o.anchor,defaultBorders:o.borders,label:r.toString()})}s++}}_processAnimations(){const t=this.data.animations||{};for(const s in t){this.animations[s]=[];for(let n=0;n<t[s].length;n++){const r=t[s][n];this.animations[s].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Ya.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Ya.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var s;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((s=this._texture)==null||s.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}},Kc.BATCH_SIZE=1e3;let wg=Kc;const uk=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function xg(e,t,s){const n={};if(e.forEach(r=>{n[r]=t}),Object.keys(t.textures).forEach(r=>{n[r]=t.textures[r]}),!s){const r=Bs.dirname(e[0]);t.linkedSheets.forEach((o,i)=>{const a=xg([`${r}/${t.data.meta.related_multi_packs[i]}`],o,!0);Object.assign(n,a)})}return n}const dk={extension:mt.Asset,cache:{test:e=>e instanceof wg,getCacheableAssets:(e,t)=>xg(e,t,!1)},resolver:{test:e=>{const t=e.split("?")[0].split("."),s=t.pop(),n=t.pop();return s==="json"&&uk.includes(n)},parse:e=>{var s;const t=e.split(".");return{resolution:parseFloat(((s=ao.RETINA_PREFIX.exec(e))==null?void 0:s[1])??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:mt.LoadParser,priority:Hn.Normal},async testParse(e,t){return Bs.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,s){var c,u;const{texture:n,imageFilename:r}=(t==null?void 0:t.data)??{};let o=Bs.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let i;if(n instanceof Vt)i=n;else{const h=Mc(o+(r??e.meta.image),t.src);i=(await s.load([h]))[h]}const a=new wg(i.source,e);await a.parse();const l=(c=e==null?void 0:e.meta)==null?void 0:c.related_multi_packs;if(Array.isArray(l)){const h=[];for(const f of l){if(typeof f!="string")continue;let p=o+f;(u=t.data)!=null&&u.ignoreMultiPack||(p=Mc(p,t.src),h.push(s.load({src:p,data:{ignoreMultiPack:!0}})))}const d=await Promise.all(h);a.linkedSheets=d,d.forEach(f=>{f.linkedSheets=[a].concat(a.linkedSheets.filter(p=>p!==f))})}return a},async unload(e,t,s){await s.unload(e.textureSource._sourceOrigin),e.destroy(!1)}}};ps.add(dk),_m=class{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const s in e){const n=e[s];this.setResource(n,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const s in this.resources)e[t++]=this.resources[s]._resourceId;this._key=e.join("|")}setResource(e,t){var n,r;const s=this.resources[t];e!==s&&(s&&((n=e.off)==null||n.call(e,"change",this.onResourceChange,this)),(r=e.on)==null||r.call(e,"change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const s in t)t[s]._touched=e}destroy(){var t,s;const e=this.resources;for(const n in e)(s=(t=e[n]).off)==null||s.call(t,"change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const s in t)t[s]===e&&(t[s]=null)}else this._updateKey()}};const Jc=[];ps.handleByNamedList(mt.Environment,Jc);async function fk(e){if(e)for(let t=0;t<Jc.length;t++){const s=Jc[t];if(s.value.test()){await s.value.load();return}}}let bi;Tm=function(){if(typeof bi=="boolean")return bi;try{bi=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{bi=!1}return bi};var tu={exports:{}};tu.exports=ll,tu.exports.default=ll;function ll(e,t,s){s=s||2;var n=t&&t.length,r=n?t[0]*s:e.length,o=_g(e,0,r,s,!0),i=[];if(!o||o.next===o.prev)return i;var a,l,c,u,h,d,f;if(n&&(o=vk(e,t,o,s)),e.length>80*s){a=c=e[0],l=u=e[1];for(var p=s;p<r;p+=s)h=e[p],d=e[p+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-a,u-l),f=f!==0?32767/f:0}return wi(o,i,s,a,l,f,0),i}function _g(e,t,s,n,r){var o,i;if(r===nu(e,t,s,n)>0)for(o=t;o<s;o+=n)i=Sg(o,e[o],e[o+1],i);else for(o=s-n;o>=t;o-=n)i=Sg(o,e[o],e[o+1],i);return i&&hl(i,i.next)&&(_i(i),i=i.next),i}function Cr(e,t){if(!e)return e;t||(t=e);var s=e,n;do if(n=!1,!s.steiner&&(hl(s,s.next)||se(s.prev,s,s.next)===0)){if(_i(s),s=t=s.prev,s===s.next)break;n=!0}else s=s.next;while(n||s!==t);return t}function wi(e,t,s,n,r,o,i){if(e){!i&&o&&Ak(e,n,r,o);for(var a=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,o?mk(e,n,r,o):pk(e)){t.push(l.i/s|0),t.push(e.i/s|0),t.push(c.i/s|0),_i(e),e=c.next,a=c.next;continue}if(e=c,e===a){i?i===1?(e=gk(Cr(e),t,s),wi(e,t,s,n,r,o,2)):i===2&&yk(e,t,s,n,r,o):wi(Cr(e),t,s,n,r,o,1);break}}}}function pk(e){var t=e.prev,s=e,n=e.next;if(se(t,s,n)>=0)return!1;for(var r=t.x,o=s.x,i=n.x,a=t.y,l=s.y,c=n.y,u=r<o?r<i?r:i:o<i?o:i,h=a<l?a<c?a:c:l<c?l:c,d=r>o?r>i?r:i:o>i?o:i,f=a>l?a>c?a:c:l>c?l:c,p=n.next;p!==t;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&lo(r,a,o,l,i,c,p.x,p.y)&&se(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function mk(e,t,s,n){var r=e.prev,o=e,i=e.next;if(se(r,o,i)>=0)return!1;for(var a=r.x,l=o.x,c=i.x,u=r.y,h=o.y,d=i.y,f=a<l?a<c?a:c:l<c?l:c,p=u<h?u<d?u:d:h<d?h:d,g=a>l?a>c?a:c:l>c?l:c,m=u>h?u>d?u:d:h>d?h:d,y=eu(f,p,t,s,n),v=eu(g,m,t,s,n),b=e.prevZ,w=e.nextZ;b&&b.z>=y&&w&&w.z<=v;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==i&&lo(a,u,l,h,c,d,b.x,b.y)&&se(b.prev,b,b.next)>=0||(b=b.prevZ,w.x>=f&&w.x<=g&&w.y>=p&&w.y<=m&&w!==r&&w!==i&&lo(a,u,l,h,c,d,w.x,w.y)&&se(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;b&&b.z>=y;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==i&&lo(a,u,l,h,c,d,b.x,b.y)&&se(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=v;){if(w.x>=f&&w.x<=g&&w.y>=p&&w.y<=m&&w!==r&&w!==i&&lo(a,u,l,h,c,d,w.x,w.y)&&se(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function gk(e,t,s){var n=e;do{var r=n.prev,o=n.next.next;!hl(r,o)&&Ag(r,n,n.next,o)&&xi(r,o)&&xi(o,r)&&(t.push(r.i/s|0),t.push(n.i/s|0),t.push(o.i/s|0),_i(n),_i(n.next),n=e=o),n=n.next}while(n!==e);return Cr(n)}function yk(e,t,s,n,r,o){var i=e;do{for(var a=i.next.next;a!==i.prev;){if(i.i!==a.i&&Ck(i,a)){var l=kg(i,a);i=Cr(i,i.next),l=Cr(l,l.next),wi(i,t,s,n,r,o,0),wi(l,t,s,n,r,o,0);return}a=a.next}i=i.next}while(i!==e)}function vk(e,t,s,n){var r=[],o,i,a,l,c;for(o=0,i=t.length;o<i;o++)a=t[o]*n,l=o<i-1?t[o+1]*n:e.length,c=_g(e,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(Sk(c));for(r.sort(bk),o=0;o<r.length;o++)s=wk(r[o],s);return s}function bk(e,t){return e.x-t.x}function wk(e,t){var s=xk(e,t);if(!s)return t;var n=kg(s,e);return Cr(n,n.next),Cr(s,s.next)}function xk(e,t){var s=t,n=e.x,r=e.y,o=-1/0,i;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){var a=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=n&&a>o&&(o=a,i=s.x<s.next.x?s:s.next,a===n))return i}s=s.next}while(s!==t);if(!i)return null;var l=i,c=i.x,u=i.y,h=1/0,d;s=i;do n>=s.x&&s.x>=c&&n!==s.x&&lo(r<u?n:o,r,c,u,r<u?o:n,r,s.x,s.y)&&(d=Math.abs(r-s.y)/(n-s.x),xi(s,e)&&(d<h||d===h&&(s.x>i.x||s.x===i.x&&_k(i,s)))&&(i=s,h=d)),s=s.next;while(s!==l);return i}function _k(e,t){return se(e.prev,e,t.prev)<0&&se(t.next,e,e.next)<0}function Ak(e,t,s,n){var r=e;do r.z===0&&(r.z=eu(r.x,r.y,t,s,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,kk(r)}function kk(e){var t,s,n,r,o,i,a,l,c=1;do{for(s=e,e=null,o=null,i=0;s;){for(i++,n=s,a=0,t=0;t<c&&(a++,n=n.nextZ,!!n);t++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||s.z<=n.z)?(r=s,s=s.nextZ,a--):(r=n,n=n.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;s=n}o.nextZ=null,c*=2}while(i>1);return e}function eu(e,t,s,n,r){return e=(e-s)*r|0,t=(t-n)*r|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Sk(e){var t=e,s=e;do(t.x<s.x||t.x===s.x&&t.y<s.y)&&(s=t),t=t.next;while(t!==e);return s}function lo(e,t,s,n,r,o,i,a){return(r-i)*(t-a)>=(e-i)*(o-a)&&(e-i)*(n-a)>=(s-i)*(t-a)&&(s-i)*(o-a)>=(r-i)*(n-a)}function Ck(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Ok(e,t)&&(xi(e,t)&&xi(t,e)&&Tk(e,t)&&(se(e.prev,e,t.prev)||se(e,t.prev,t))||hl(e,t)&&se(e.prev,e,e.next)>0&&se(t.prev,t,t.next)>0)}function se(e,t,s){return(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)}function hl(e,t){return e.x===t.x&&e.y===t.y}function Ag(e,t,s,n){var r=ul(se(e,t,s)),o=ul(se(e,t,n)),i=ul(se(s,n,e)),a=ul(se(s,n,t));return!!(r!==o&&i!==a||r===0&&cl(e,s,t)||o===0&&cl(e,n,t)||i===0&&cl(s,e,n)||a===0&&cl(s,t,n))}function cl(e,t,s){return t.x<=Math.max(e.x,s.x)&&t.x>=Math.min(e.x,s.x)&&t.y<=Math.max(e.y,s.y)&&t.y>=Math.min(e.y,s.y)}function ul(e){return e>0?1:e<0?-1:0}function Ok(e,t){var s=e;do{if(s.i!==e.i&&s.next.i!==e.i&&s.i!==t.i&&s.next.i!==t.i&&Ag(s,s.next,e,t))return!0;s=s.next}while(s!==e);return!1}function xi(e,t){return se(e.prev,e,e.next)<0?se(e,t,e.next)>=0&&se(e,e.prev,t)>=0:se(e,t,e.prev)<0||se(e,e.next,t)<0}function Tk(e,t){var s=e,n=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do s.y>o!=s.next.y>o&&s.next.y!==s.y&&r<(s.next.x-s.x)*(o-s.y)/(s.next.y-s.y)+s.x&&(n=!n),s=s.next;while(s!==e);return n}function kg(e,t){var s=new su(e.i,e.x,e.y),n=new su(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,s.next=r,r.prev=s,n.next=s,s.prev=n,o.next=n,n.prev=o,n}function Sg(e,t,s,n){var r=new su(e,t,s);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function _i(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function su(e,t,s){this.i=e,this.x=t,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ll.deviation=function(e,t,s,n){var r=t&&t.length,o=r?t[0]*s:e.length,i=Math.abs(nu(e,0,o,s));if(r)for(var a=0,l=t.length;a<l;a++){var c=t[a]*s,u=a<l-1?t[a+1]*s:e.length;i-=Math.abs(nu(e,c,u,s))}var h=0;for(a=0;a<n.length;a+=3){var d=n[a]*s,f=n[a+1]*s,p=n[a+2]*s;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return i===0&&h===0?0:Math.abs((h-i)/i)};function nu(e,t,s,n){for(var r=0,o=t,i=s-n;o<s;o+=n)r+=(e[i]-e[o])*(e[o+1]+e[i+1]),i=o;return r}ll.flatten=function(e){for(var t=e[0][0].length,s={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var o=0;o<e[r].length;o++)for(var i=0;i<t;i++)s.vertices.push(e[r][o][i]);r>0&&(n+=e[r-1].length,s.holes.push(n))}return s};var Pk=tu.exports;const Mk=gi(Pk);Ec=(e=>(e[e.NONE=0]="NONE",e[e.COLOR=16384]="COLOR",e[e.STENCIL=1024]="STENCIL",e[e.DEPTH=256]="DEPTH",e[e.COLOR_DEPTH=16640]="COLOR_DEPTH",e[e.COLOR_STENCIL=17408]="COLOR_STENCIL",e[e.DEPTH_STENCIL=1280]="DEPTH_STENCIL",e[e.ALL=17664]="ALL",e))(Ec||{}),Pm=class{constructor(e){this.items=[],this._name=e}emit(e,t,s,n,r,o,i,a){const{name:l,items:c}=this;for(let u=0,h=c.length;u<h;u++)c[u][l](e,t,s,n,r,o,i,a);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&this.items.splice(t,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};const Ik=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],Cg=class xA extends As{constructor(t){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name;const s=[...Ik,...t.runners??[]];this._addRunners(...s),this._addSystems(t.systems),this._addPipes(t.renderPipes,t.renderPipeAdaptors),this._unsafeEvalCheck()}async init(t={}){for(const s in this._systemsHash)t={...this._systemsHash[s].constructor.defaultOptions,...t};t={...xA.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let s=0;s<this.runners.init.items.length;s++)await this.runners.init.items[s].init(t);this._initOptions=t}render(t,s){let n=t;if(n instanceof te&&(n={container:n},s&&(le(he,"passing a second argument is deprecated, please use render options instead"),n.target=s.renderTexture)),n.target||(n.target=this.view.renderTarget),n.target===this.view.renderTarget&&(this._lastObjectRendered=n.container,n.clearColor=this.background.colorRgba),n.clearColor){const r=Array.isArray(n.clearColor)&&n.clearColor.length===4;n.clearColor=r?n.clearColor:is.shared.setValue(n.clearColor).toArray()}n.transform||(n.container.updateLocalTransform(),n.transform=n.container.localTransform),this.runners.prerender.emit(n),this.runners.renderStart.emit(n),this.runners.render.emit(n),this.runners.renderEnd.emit(n),this.runners.postrender.emit(n)}resize(t,s,n){this.view.resize(t,s,n),this.emit("resize",this.view.screen.width,this.view.screen.height)}clear(t={}){const s=this;t.target||(t.target=s.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=Ec.ALL);const{clear:n,clearColor:r,target:o}=t;is.shared.setValue(r??this.background.colorRgba),s.renderTarget.clear(o,n,is.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(s=>{this.runners[s]=new Pm(s)})}_addSystems(t){let s;for(s in t){const n=t[s];this._addSystem(n.value,n.name)}}_addSystem(t,s){const n=new t(this);if(this[s])throw new Error(`Whoops! The name "${s}" is already in use`);this[s]=n,this._systemsHash[s]=n;for(const r in this.runners)this.runners[r].add(n);return this}_addPipes(t,s){const n=s.reduce((r,o)=>(r[o.name]=o.value,r),{});t.forEach(r=>{const o=r.value,i=r.name,a=n[i];this.renderPipes[i]=new o(this,a?new a:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(s=>{s.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Tm())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};Cg.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let ru;Cc=Cg;function Ek(e){return ru!==void 0||(ru=(()=>{var s;const t={stencil:!0,failIfMajorPerformanceCaveat:e??Cc.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Ke.get().getWebGLRenderingContext())return!1;let n=Ke.get().createCanvas().getContext("webgl",t);const r=!!((s=n==null?void 0:n.getContextAttributes())!=null&&s.stencil);if(n){const o=n.getExtension("WEBGL_lose_context");o&&o.loseContext()}return n=null,r}catch{return!1}})()),ru}let ou;async function $k(e={}){return ou!==void 0||(ou=await(async()=>{if(!Ke.get().getNavigator().gpu)return!1;try{return await(await navigator.gpu.requestAdapter(e)).requestDevice(),!0}catch{return!1}})()),ou}const Og=["webgl","webgpu","canvas"];async function Rk(e){let t=[];e.preference?(t.push(e.preference),Og.forEach(o=>{o!==e.preference&&t.push(o)})):t=Og.slice();let s;await fk(e.manageImports??!0);let n={};for(let o=0;o<t.length;o++){const i=t[o];if(i==="webgpu"&&await $k()){const{WebGPURenderer:a}=await Za(()=>import("./WebGPURenderer-d5ea0e61.js").then(async l=>(await l.__tla,l)),["./WebGPURenderer-d5ea0e61.js","./colorToUniform-ed2b0528.js","./SharedSystems-a86c5ab1.js","./CanvasPool-a96dd244.js"],import.meta.url);s=a,n={...e,...e.webgpu};break}else if(i==="webgl"&&Ek(e.failIfMajorPerformanceCaveat??Cc.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Za(()=>import("./WebGLRenderer-25eef5bc.js").then(async l=>(await l.__tla,l)),["./WebGLRenderer-25eef5bc.js","./colorToUniform-ed2b0528.js","./batchSamplersUniformGroup-61d9f335.js","./SharedSystems-a86c5ab1.js"],import.meta.url);s=a,n={...e,...e.webgl};break}else if(i==="canvas"){n={...e};break}}delete n.webgpu,delete n.webgl;const r=new s;return await r.init(n),r}const Tg=class Im{constructor(...t){this.stage=new te,t[0]!==void 0&&le(he,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await Rk(t),Im._plugins.forEach(s=>{s.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return le(he,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,s=!1){const n=Im._plugins.slice(0);n.reverse(),n.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(s),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Tg._plugins=[];let Pg=Tg;ps.handleByList(mt.Application,Pg._plugins);class Dk{constructor(t,s=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=s}add(t){t.forEach(s=>{this._assetList.push(s)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],s=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<s;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Nk={extension:mt.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof Vt),getCacheableAssets:(e,t)=>{const s={};return e.forEach(n=>{t.forEach((r,o)=>{s[n+(o===0?"":o+1)]=r})}),s}};async function Mg(e){if("Image"in globalThis)return new Promise(t=>{const s=new Image;s.onload=()=>{t(!0)},s.onerror=()=>{t(!1)},s.src=e});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(e)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Lk={extension:{type:mt.DetectionParser,priority:1},test:async()=>Mg("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")},Ig=["png","jpg","jpeg"],Bk={extension:{type:mt.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...Ig],remove:async e=>e.filter(t=>!Ig.includes(t))},jk="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function iu(e){return jk?!1:document.createElement("video").canPlayType(e)!==""}const Fk={extension:{type:mt.DetectionParser,priority:0},test:async()=>iu("video/mp4"),add:async e=>[...e,"mp4","m4v"],remove:async e=>e.filter(t=>t!=="mp4"&&t!=="m4v")},Vk={extension:{type:mt.DetectionParser,priority:0},test:async()=>iu("video/ogg"),add:async e=>[...e,"ogv"],remove:async e=>e.filter(t=>t!=="ogv")},zk={extension:{type:mt.DetectionParser,priority:0},test:async()=>iu("video/webm"),add:async e=>[...e,"webm"],remove:async e=>e.filter(t=>t!=="webm")},Gk={extension:{type:mt.DetectionParser,priority:0},test:async()=>Mg("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};class Uk{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,s,n)=>(this._parsersValidated=!1,t[s]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,s){const n={promise:null,parser:null};return n.promise=(async()=>{var i,a;let r=null,o=null;if(s.loadParser&&(o=this._parserHash[s.loadParser],o||Se(`[Assets] specified load parser "${s.loadParser}" not found while loading ${t}`)),!o){for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.load&&((i=c.test)!=null&&i.call(c,t,s,this))){o=c;break}}if(!o)return Se(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await o.load(t,s,this),n.parser=o;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];c.parse&&c.parse&&await((a=c.testParse)==null?void 0:a.call(c,r,s,this))&&(r=await c.parse(r,s,this)||r,n.parser=c)}return r})(),n}async load(t,s){this._parsersValidated||this._validateParsers();let n=0;const r={},o=al(t),i=js(t,c=>({alias:[c],src:c})),a=i.length,l=i.map(async c=>{const u=Bs.toAbsolute(c.src);if(!r[c.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,c)),r[c.src]=await this.promiseCache[u].promise,s&&s(++n/a)}catch(h){throw delete this.promiseCache[u],delete r[c.src],new Error(`[Loader.load] Failed to load ${u}.
${h}`)}});return await Promise.all(l),o?r[i[0].src]:r}async unload(t){const s=js(t,n=>({alias:[n],src:n})).map(async n=>{var i,a;const r=Bs.toAbsolute(n.src),o=this.promiseCache[r];if(o){const l=await o.promise;delete this.promiseCache[r],await((a=(i=o.parser)==null?void 0:i.unload)==null?void 0:a.call(i,l,n,this))}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,s)=>(s.name?t[s.name]&&Se(`[Assets] loadParser name conflict "${s.name}"`):Se("[Assets] loadParser should have a name"),{...t,[s.name]:s}),{})}}function ho(e,t){if(Array.isArray(t)){for(const s of t)if(e.startsWith(`data:${s}`))return!0;return!1}return e.startsWith(`data:${t}`)}function co(e,t){const s=e.split("?")[0],n=Bs.extname(s).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const Hk=".json",Wk="application/json",Xk={extension:{type:mt.LoadParser,priority:Hn.Low},name:"loadJson",test(e){return ho(e,Wk)||co(e,Hk)},async load(e){return await(await Ke.get().fetch(e)).json()}},Yk=".txt",Zk="text/plain",qk={name:"loadTxt",extension:{type:mt.LoadParser,priority:Hn.Low},test(e){return ho(e,Zk)||co(e,Yk)},async load(e){return await(await Ke.get().fetch(e)).text()}},Qk=["normal","bold","100","200","300","400","500","600","700","800","900"],Kk=[".ttf",".otf",".woff",".woff2"],Jk=["font/ttf","font/otf","font/woff","font/woff2"],tS=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function eS(e){const t=Bs.extname(e),s=Bs.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let n=s.length>0;for(const o of s)if(!o.match(tS)){n=!1;break}let r=s.join(" ");return n||(r=`"${r.replace(/[\\"]/g,"\\$&")}"`),r}const sS=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function nS(e){return sS.test(e)?e:encodeURI(e)}const rS={extension:{type:mt.LoadParser,priority:Hn.Low},name:"loadWebFont",test(e){return ho(e,Jk)||co(e,Kk)},async load(e,t){var n,r,o;const s=Ke.get().getFontFaceSet();if(s){const i=[],a=((n=t.data)==null?void 0:n.family)??eS(e),l=((o=(r=t.data)==null?void 0:r.weights)==null?void 0:o.filter(u=>Qk.includes(u)))??["normal"],c=t.data??{};for(let u=0;u<l.length;u++){const h=l[u],d=new FontFace(a,`url(${nS(e)})`,{...c,weight:h});await d.load(),s.add(d),i.push(d)}return Ge.set(`${a}-and-url`,{url:e,fontFaces:i}),i.length===1?i[0]:i}return Se("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>{Ge.remove(t.family),Ke.get().getFontFaceSet().delete(t)})}};var oS=aS,au={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},iS=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function aS(e){var t=[];return e.replace(iS,function(s,n,r){var o=n.toLowerCase();for(r=hS(r),o=="m"&&r.length>2&&(t.push([n].concat(r.splice(0,2))),o="l",n=n=="m"?"l":"L");;){if(r.length==au[o])return r.unshift(n),t.push(r);if(r.length<au[o])throw new Error("malformed path data");t.push([n].concat(r.splice(0,au[o])))}}),t}var lS=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function hS(e){var t=e.match(lS);return t?t.map(Number):[]}const cS=gi(oS);function uS(e,t){const s=cS(e),n=[];let r=null,o=0,i=0;for(let a=0;a<s.length;a++){const l=s[a],c=l[0],u=l;switch(c){case"M":o=u[1],i=u[2],t.moveTo(o,i);break;case"m":o+=u[1],i+=u[2],t.moveTo(o,i);break;case"H":o=u[1],t.lineTo(o,i);break;case"h":o+=u[1],t.lineTo(o,i);break;case"V":i=u[1],t.lineTo(o,i);break;case"v":i+=u[1],t.lineTo(o,i);break;case"L":o=u[1],i=u[2],t.lineTo(o,i);break;case"l":o+=u[1],i+=u[2],t.lineTo(o,i);break;case"C":o=u[5],i=u[6],t.bezierCurveTo(u[1],u[2],u[3],u[4],o,i);break;case"c":t.bezierCurveTo(o+u[1],i+u[2],o+u[3],i+u[4],o+u[5],i+u[6]),o+=u[5],i+=u[6];break;case"S":o=u[3],i=u[4],t.bezierCurveToShort(u[1],u[2],o,i);break;case"s":t.bezierCurveToShort(o+u[1],i+u[2],o+u[3],i+u[4]),o+=u[3],i+=u[4];break;case"Q":o=u[3],i=u[4],t.quadraticCurveTo(u[1],u[2],o,i);break;case"q":t.quadraticCurveTo(o+u[1],i+u[2],o+u[3],i+u[4]),o+=u[3],i+=u[4];break;case"T":o=u[1],i=u[2],t.quadraticCurveToShort(o,i);break;case"t":o+=u[1],i+=u[2],t.quadraticCurveToShort(o,i);break;case"A":o=u[6],i=u[7],t.arcToSvg(u[1],u[2],u[3],u[4],u[5],o,i);break;case"a":o+=u[6],i+=u[7],t.arcToSvg(u[1],u[2],u[3],u[4],u[5],o,i);break;case"Z":case"z":t.closePath(),n.length>0&&(r=n.pop(),r?(o=r.startX,i=r.startY):(o=0,i=0)),r=null;break;default:Se(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&r===null&&(r={startX:o,startY:i},n.push(r))}return t}class lu{constructor(t=0,s=0,n=0){this.type="circle",this.x=t,this.y=s,this.radius=n}clone(){return new lu(this.x,this.y,this.radius)}contains(t,s){if(this.radius<=0)return!1;const n=this.radius*this.radius;let r=this.x-t,o=this.y-s;return r*=r,o*=o,r+o<=n}strokeContains(t,s,n){if(this.radius===0)return!1;const r=this.x-t,o=this.y-s,i=this.radius,a=n/2,l=Math.sqrt(r*r+o*o);return l<i+a&&l>i-a}getBounds(t){return t=t||new Me,t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class hu{constructor(t=0,s=0,n=0,r=0){this.type="ellipse",this.x=t,this.y=s,this.halfWidth=n,this.halfHeight=r}clone(){return new hu(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,s){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let n=(t-this.x)/this.halfWidth,r=(s-this.y)/this.halfHeight;return n*=n,r*=r,n+r<=1}strokeContains(t,s,n){const{halfWidth:r,halfHeight:o}=this;if(r<=0||o<=0)return!1;const i=n/2,a=r-i,l=o-i,c=r+i,u=o+i,h=t-this.x,d=s-this.y,f=h*h/(a*a)+d*d/(l*l),p=h*h/(c*c)+d*d/(u*u);return f>1&&p<=1}getBounds(){return new Me(this.x-this.halfWidth,this.y-this.halfHeight,this.halfWidth*2,this.halfHeight*2)}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function dS(e,t,s,n,r,o){const i=e-s,a=t-n,l=r-s,c=o-n,u=i*l+a*c,h=l*l+c*c;let d=-1;h!==0&&(d=u/h);let f,p;d<0?(f=s,p=n):d>1?(f=r,p=o):(f=s+d*l,p=n+d*c);const g=e-f,m=t-p;return g*g+m*m}class Ai{constructor(...t){this.type="polygon";let s=Array.isArray(t[0])?t[0]:t;if(typeof s[0]!="number"){const n=[];for(let r=0,o=s.length;r<o;r++)n.push(s[r].x,s[r].y);s=n}this.points=s,this.closePath=!0}clone(){const t=this.points.slice(),s=new Ai(t);return s.closePath=this.closePath,s}contains(t,s){let n=!1;const r=this.points.length/2;for(let o=0,i=r-1;o<r;i=o++){const a=this.points[o*2],l=this.points[o*2+1],c=this.points[i*2],u=this.points[i*2+1];l>s!=u>s&&t<(c-a)*((s-l)/(u-l))+a&&(n=!n)}return n}strokeContains(t,s,n){const r=n/2,o=r*r,{points:i}=this,a=i.length-(this.closePath?0:2);for(let l=0;l<a;l+=2){const c=i[l],u=i[l+1],h=i[(l+2)%i.length],d=i[(l+3)%i.length];if(dS(t,s,c,u,h,d)<=o)return!0}return!1}getBounds(t){t=t||new Me;const s=this.points;let n=1/0,r=-1/0,o=1/0,i=-1/0;for(let a=0,l=s.length;a<l;a+=2){const c=s[a],u=s[a+1];n=c<n?c:n,r=c>r?c:r,o=u<o?u:o,i=u>i?u:i}return t.x=n,t.width=r-n,t.y=o,t.height=i-o,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,s)=>`${t}, ${s}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const dl=(e,t,s,n,r,o)=>{const i=e-s,a=t-n,l=Math.sqrt(i*i+a*a);return l>=r-o&&l<=r+o};class cu{constructor(t=0,s=0,n=0,r=0,o=20){this.type="roundedRectangle",this.x=t,this.y=s,this.width=n,this.height=r,this.radius=o}getBounds(t){return t=t||new Me,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new cu(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,s){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&s>=this.y&&s<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(s>=this.y+n&&s<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let r=t-(this.x+n),o=s-(this.y+n);const i=n*n;if(r*r+o*o<=i||(r=t-(this.x+this.width-n),r*r+o*o<=i)||(o=s-(this.y+this.height-n),r*r+o*o<=i)||(r=t-(this.x+n),r*r+o*o<=i))return!0}return!1}strokeContains(t,s,n){const{x:r,y:o,width:i,height:a,radius:l}=this,c=n/2,u=r+l,h=o+l,d=i-l*2,f=a-l*2,p=r+i,g=o+a;return(t>=r-c&&t<=r+c||t>=p-c&&t<=p+c)&&s>=h&&s<=h+f||(s>=o-c&&s<=o+c||s>=g-c&&s<=g+c)&&t>=u&&t<=u+d?!0:t<u&&s<h&&dl(t,s,u,h,l,c)||t>p-l&&s<h&&dl(t,s,p-l,h,l,c)||t>p-l&&s>g-l&&dl(t,s,p-l,g-l,l,c)||t<u&&s>g-l&&dl(t,s,u,g-l,l,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}Qe=(e=>(e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE",e[e.STATIC=1024]="STATIC",e))(Qe||{}),ro=class extends As{constructor(e){let{data:t,size:s}=e;const{usage:n,label:r,shrinkToFit:o}=e;super(),this.uid=ke("buffer"),this._resourceType="buffer",this._resourceId=ke("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,s=s??(t==null?void 0:t.byteLength);const i=!!t;this.descriptor={size:s,usage:n,mappedAtCreation:i,label:r},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get static(){return!!(this.descriptor.usage&Qe.STATIC)}set static(e){e?this.descriptor.usage|=Qe.STATIC:this.descriptor.usage&=~Qe.STATIC}setDataWithSize(e,t,s){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e){s&&this.emit("update",this);return}const n=this._data;if(this._data=e,n.length!==e.length){!this.shrinkToFit&&e.byteLength<n.byteLength?s&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=ke("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function Eg(e,t){if(!(e instanceof ro)){let s=t?Qe.INDEX:Qe.VERTEX;e instanceof Array&&(t?(e=new Uint32Array(e),s=Qe.INDEX|Qe.COPY_DST):(e=new Float32Array(e),s=Qe.VERTEX|Qe.COPY_DST)),e=new ro({data:e,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:s})}return e}function fS(e,t,s){const n=e.getAttribute(t);if(!n)return s.minX=0,s.minY=0,s.maxX=0,s.maxY=0,s;const r=n.buffer.data;let o=1/0,i=1/0,a=-1/0,l=-1/0;const c=r.BYTES_PER_ELEMENT,u=(n.offset||0)/c,h=(n.stride||2*4)/c;for(let d=u;d<r.length;d+=h){const f=r[d],p=r[d+1];f>a&&(a=f),p>l&&(l=p),f<o&&(o=f),p<i&&(i=p)}return s.minX=o,s.minY=i,s.maxX=a,s.maxY=l,s}function pS(e){return(e instanceof ro||Array.isArray(e)||e.BYTES_PER_ELEMENT)&&(e={buffer:e}),e.buffer=Eg(e.buffer,!1),e}ym=class extends As{constructor(e){const{attributes:t,indexBuffer:s,topology:n}=e;super(),this.uid=ke("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new kn,this._boundsDirty=!0,this.attributes=t,this.buffers=[],this.instanceCount=e.instanceCount||1;for(const r in t){const o=t[r]=pS(t[r]);this.buffers.indexOf(o.buffer)===-1&&(this.buffers.push(o.buffer),o.buffer.on("update",this.onBufferUpdate,this),o.buffer.on("change",this.onBufferUpdate,this))}s&&(this.indexBuffer=Eg(s,!0),this.buffers.push(this.indexBuffer)),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,fS(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(t=>t.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}};const mS=new Float32Array(1),gS=new Uint32Array(1);Cm=class extends ym{constructor(){const e=new ro({data:mS,label:"attribute-batch-buffer",usage:Qe.VERTEX|Qe.COPY_DST,shrinkToFit:!1}),t=new ro({data:gS,label:"index-batch-buffer",usage:Qe.INDEX|Qe.COPY_DST,shrinkToFit:!1}),s=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:s,offset:0,location:1},aUV:{buffer:e,format:"float32x2",stride:s,offset:8,location:3},aColor:{buffer:e,format:"unorm8x4",stride:s,offset:16,location:0},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:s,offset:20,location:2}},indexBuffer:t})}};let uu;Tc=16,uu={},Am=function(e,t){let s=0;for(let n=0;n<t;n++)s=s*31+e[n].uid>>>0;return uu[s]||yS(e,s)};function yS(e,t){const s={};let n=0;for(let o=0;o<Tc;o++){const i=o<e.length?e[o]:Vt.EMPTY.source;s[n++]=i.source,s[n++]=i.style}const r=new _m(s);return uu[t]=r,r}class $g{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}$c=function(e,t){const s=e.byteLength/8|0,n=new Float64Array(e,0,s);new Float64Array(t,0,s).set(n);const r=e.byteLength-s*8;if(r>0){const o=new Uint8Array(e,s*8,r);new Uint8Array(t,s*8,r).set(o)}};const vS={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};vm=(e=>(e[e.DISABLED=0]="DISABLED",e[e.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",e[e.MASK_ACTIVE=2]="MASK_ACTIVE",e[e.RENDERING_MASK_REMOVE=3]="RENDERING_MASK_REMOVE",e[e.NONE=4]="NONE",e))(vm||{});function Rg(e,t){return t.alphaMode==="no-premultiply-alpha"&&vS[e]||e}class Dg{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const s=this.textures[t];this.textures[t]=null,this.ids[s.uid]=null}this.count=0}}class Ng{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}let ki=0;const Lg=class _A{constructor(t={}){this.uid=ke("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._vertexSize=6,this._elements=[],this._batchPool=[],this._batchPoolIndex=0,this._textureBatchPool=[],this._textureBatchPoolIndex=0,t={..._A.defaultOptions,...t};const{vertexSize:s,indexSize:n}=t;this.attributeBuffer=new $g(s*this._vertexSize*4),this.indexBuffer=new Uint16Array(n)}begin(){this.batchIndex=0,this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0,this._batchPoolIndex=0,this._textureBatchPoolIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t.indexStart=this.indexSize,t.location=this.attributeSize,t.batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.vertexSize*this._vertexSize}checkAndUpdateTexture(t,s){const n=t.batch.textures.ids[s._source.uid];return!n&&n!==0?!1:(t.textureId=n,t.texture=s,!0)}updateElement(t){this.dirty=!0,t.packAttributes(this.attributeBuffer.float32View,this.attributeBuffer.uint32View,t.location,t.textureId)}break(t){const s=this._elements;let n=this._textureBatchPool[this._textureBatchPoolIndex++]||new Dg;if(n.clear(),!s[this.elementStart])return;const r=s[this.elementStart];let o=Rg(r.blendMode,r.texture._source);this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const i=this.attributeBuffer.float32View,a=this.attributeBuffer.uint32View,l=this.indexBuffer;let c=this._batchIndexSize,u=this._batchIndexStart,h="startBatch",d=this._batchPool[this._batchPoolIndex++]||new Ng;for(let f=this.elementStart;f<this.elementSize;++f){const p=s[f];s[f]=null;const g=p.texture._source,m=Rg(p.blendMode,g),y=o!==m;if(g._batchTick===ki&&!y){p.textureId=g._textureBindLocation,c+=p.indexSize,p.packAttributes(i,a,p.location,p.textureId),p.packIndex(l,p.indexStart,p.location/this._vertexSize),p.batch=d;continue}g._batchTick=ki,(n.count>=Tc||y)&&(this._finishBatch(d,u,c-u,n,o,t,h),h="renderBatch",u=c,o=m,n=this._textureBatchPool[this._textureBatchPoolIndex++]||new Dg,n.clear(),d=this._batchPool[this._batchPoolIndex++]||new Ng,++ki),p.textureId=g._textureBindLocation=n.count,n.ids[g.uid]=n.count,n.textures[n.count++]=g,p.batch=d,c+=p.indexSize,p.packAttributes(i,a,p.location,p.textureId),p.packIndex(l,p.indexStart,p.location/this._vertexSize)}n.count>0&&(this._finishBatch(d,u,c-u,n,o,t,h),u=c,++ki),this.elementStart=this.elementSize,this._batchIndexStart=u,this._batchIndexSize=c}_finishBatch(t,s,n,r,o,i,a){t.gpuBindGroup=null,t.action=a,t.batcher=this,t.textures=r,t.blendMode=o,t.start=s,t.size=n,++ki,i.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const s=Math.max(t,this.attributeBuffer.size*2),n=new $g(s);$c(this.attributeBuffer.rawBinaryData,n.rawBinaryData),this.attributeBuffer=n}_resizeIndexBuffer(t){const s=this.indexBuffer;let n=Math.max(t,s.length*1.5);n+=n%2;const r=n>65535?new Uint32Array(n):new Uint16Array(n);if(r.BYTES_PER_ELEMENT!==s.BYTES_PER_ELEMENT)for(let o=0;o<s.length;o++)r[o]=s[o];else $c(s.buffer,r.buffer);this.indexBuffer=r}destroy(){for(let t=0;t<this.batches.length;t++)this.batches[t].destroy();this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t].batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};Lg.defaultOptions={vertexSize:4,indexSize:6},Sm=Lg;function bS(e,t,s,n,r,o,i,a=null){let l=0;s*=t,r*=o;const c=a.a,u=a.b,h=a.c,d=a.d,f=a.tx,p=a.ty;for(;l<i;){const g=e[s],m=e[s+1];n[r]=c*g+h*m+f,n[r+1]=u*g+d*m+p,r+=o,s+=t,l++}}function wS(e,t,s,n){let r=0;for(t*=s;r<n;)e[t]=0,e[t+1]=0,t+=s,r++}function Bg(e,t,s,n,r){const o=t.a,i=t.b,a=t.c,l=t.d,c=t.tx,u=t.ty;s=s||0,n=n||2,r=r||e.length/n-s;let h=s*n;for(let d=0;d<r;d++){const f=e[h],p=e[h+1];e[h]=o*f+a*p+c,e[h+1]=i*f+l*p+u,h+=n}}function xS(e,t,s){const n=e>>16&255,r=e>>8&255,o=e&255,i=t>>16&255,a=t>>8&255,l=t&255,c=n+(i-n)*s,u=r+(a-r)*s,h=o+(l-o)*s;return(c<<16)+(u<<8)+h}const du=16777215;Mm=function(e,t){return e===du||t===du?e+t-du:xS(e,t,.5)},Pc=class{constructor(){this.batcher=null,this.batch=null,this.applyTransform=!0,this.roundPixels=0}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}packIndex(e,t,s){const n=this.geometryData.indices;for(let r=0;r<this.indexSize;r++)e[t++]=n[r+this.indexOffset]+s-this.vertexOffset}packAttributes(e,t,s,n){const r=this.geometryData,o=this.renderable,i=r.vertices,a=r.uvs,l=this.vertexOffset*2,c=(this.vertexOffset+this.vertexSize)*2,u=this.color,h=u>>16|u&65280|(u&255)<<16;if(this.applyTransform){const d=Mm(h,o.groupColor)+(this.alpha*o.groupAlpha*255<<24),f=o.groupTransform,p=n<<16|this.roundPixels&65535,g=f.a,m=f.b,y=f.c,v=f.d,b=f.tx,w=f.ty;for(let S=l;S<c;S+=2){const _=i[S],A=i[S+1];e[s]=g*_+y*A+b,e[s+1]=m*_+v*A+w,e[s+2]=a[S],e[s+3]=a[S+1],t[s+4]=d,t[s+5]=p,s+=6}}else{const d=h+(this.alpha*255<<24);for(let f=l;f<c;f+=2)e[s]=i[f],e[s+1]=i[f+1],e[s+2]=a[f],e[s+3]=a[f+1],t[s+4]=d,t[s+5]=n<<16,s+=6}}get vertSize(){return this.vertexSize}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.vertexOffset=this.vertexOffset,e.vertexSize=this.vertexSize,e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData}reset(){this.applyTransform=!0}};const fu={build(e,t){let s,n,r,o,i,a;if(e.type==="circle"){const w=e;s=w.x,n=w.y,i=a=w.radius,r=o=0}else if(e.type==="ellipse"){const w=e;s=w.x,n=w.y,i=w.halfWidth,a=w.halfHeight,r=o=0}else{const w=e,S=w.width/2,_=w.height/2;s=w.x+S,n=w.y+_,i=a=Math.max(0,Math.min(w.radius,Math.min(S,_))),r=S-i,o=_-a}if(!(i>=0&&a>=0&&r>=0&&o>=0))return t;const l=Math.ceil(2.3*Math.sqrt(i+a)),c=l*8+(r?4:0)+(o?4:0);if(c===0)return t;if(l===0)return t[0]=t[6]=s+r,t[1]=t[3]=n+o,t[2]=t[4]=s-r,t[5]=t[7]=n-o,t;let u=0,h=l*4+(r?2:0)+2,d=h,f=c,p=r+i,g=o,m=s+p,y=s-p,v=n+g;if(t[u++]=m,t[u++]=v,t[--h]=v,t[--h]=y,o){const w=n-g;t[d++]=y,t[d++]=w,t[--f]=w,t[--f]=m}for(let w=1;w<l;w++){const S=Math.PI/2*(w/l),_=r+Math.cos(S)*i,A=o+Math.sin(S)*a,O=s+_,P=s-_,R=n+A,X=n-A;t[u++]=O,t[u++]=R,t[--h]=R,t[--h]=P,t[d++]=P,t[d++]=X,t[--f]=X,t[--f]=O}p=r,g=o+a,m=s+p,y=s-p,v=n+g;const b=n-g;return t[u++]=m,t[u++]=v,t[--f]=b,t[--f]=m,r&&(t[u++]=y,t[u++]=v,t[--f]=b,t[--f]=y),t},triangulate(e,t,s,n,r,o){if(e.length===0)return;let i=0,a=0;for(let u=0;u<e.length;u+=2)i+=e[u],a+=e[u+1];i/=e.length/2,a/=e.length/2;let l=n;t[l*s]=i,t[l*s+1]=a;const c=l++;for(let u=0;u<e.length;u+=2)t[l*s]=e[u],t[l*s+1]=e[u+1],u>0&&(r[o++]=l,r[o++]=c,r[o++]=l-1),l++;r[o++]=c+1,r[o++]=c,r[o++]=l-1}},_S=1e-4,jg=1e-4;function AS(e){const t=e.length;if(t<6)return 1;let s=0;for(let n=0,r=e[t-2],o=e[t-1];n<t;n+=2){const i=e[n],a=e[n+1];s+=(i-r)*(a+o),r=i,o=a}return s<0?-1:1}function Fg(e,t,s,n,r,o,i,a){const l=e-s*r,c=t-n*r,u=e+s*o,h=t+n*o;let d,f;i?(d=n,f=-s):(d=-n,f=s);const p=l+d,g=c+f,m=u+d,y=h+f;return a.push(p,g),a.push(m,y),2}function Or(e,t,s,n,r,o,i,a){const l=s-e,c=n-t;let u=Math.atan2(l,c),h=Math.atan2(r-e,o-t);a&&u<h?u+=Math.PI*2:!a&&u>h&&(h+=Math.PI*2);let d=u;const f=h-u,p=Math.abs(f),g=Math.sqrt(l*l+c*c),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,y=f/m;if(d+=y,a){i.push(e,t),i.push(s,n);for(let v=1,b=d;v<m;v++,b+=y)i.push(e,t),i.push(e+Math.sin(b)*g,t+Math.cos(b)*g);i.push(e,t),i.push(r,o)}else{i.push(s,n),i.push(e,t);for(let v=1,b=d;v<m;v++,b+=y)i.push(e+Math.sin(b)*g,t+Math.cos(b)*g),i.push(e,t);i.push(r,o),i.push(e,t)}return m*2}function kS(e,t,s,n,r,o,i,a,l){const c=_S;if(e.length===0)return;const u=t;let h=u.alignment;if(t.alignment!==.5){let L=AS(e);s&&(L*=-1),h=(h-.5)*L+.5}const d=new ze(e[0],e[1]),f=new ze(e[e.length-2],e[e.length-1]),p=n,g=Math.abs(d.x-f.x)<c&&Math.abs(d.y-f.y)<c;if(p){e=e.slice(),g&&(e.pop(),e.pop(),f.set(e[e.length-2],e[e.length-1]));const L=(d.x+f.x)*.5,D=(f.y+d.y)*.5;e.unshift(L,D),e.push(L,D)}const m=r,y=e.length/2;let v=e.length;const b=m.length/2,w=u.width/2,S=w*w,_=u.miterLimit*u.miterLimit;let A=e[0],O=e[1],P=e[2],R=e[3],X=0,B=0,H=-(O-R),j=A-P,K=0,nt=0,ht=Math.sqrt(H*H+j*j);H/=ht,j/=ht,H*=w,j*=w;const St=h,U=(1-St)*2,N=St*2;p||(u.cap==="round"?v+=Or(A-H*(U-N)*.5,O-j*(U-N)*.5,A-H*U,O-j*U,A+H*N,O+j*N,m,!0)+2:u.cap==="square"&&(v+=Fg(A,O,H,j,U,N,!0,m))),m.push(A-H*U,O-j*U),m.push(A+H*N,O+j*N);for(let L=1;L<y-1;++L){A=e[(L-1)*2],O=e[(L-1)*2+1],P=e[L*2],R=e[L*2+1],X=e[(L+1)*2],B=e[(L+1)*2+1],H=-(O-R),j=A-P,ht=Math.sqrt(H*H+j*j),H/=ht,j/=ht,H*=w,j*=w,K=-(R-B),nt=P-X,ht=Math.sqrt(K*K+nt*nt),K/=ht,nt/=ht,K*=w,nt*=w;const D=P-A,x=O-R,C=P-X,$=B-R,F=D*C+x*$,Y=x*C-$*D,ct=Y<0;if(Math.abs(Y)<.001*Math.abs(F)){m.push(P-H*U,R-j*U),m.push(P+H*N,R+j*N),F>=0&&(u.join==="round"?v+=Or(P,R,P-H*U,R-j*U,P-K*U,R-nt*U,m,!1)+4:v+=2,m.push(P-K*N,R-nt*N),m.push(P+K*U,R+nt*U));continue}const wt=(-H+A)*(-j+R)-(-H+P)*(-j+O),Ft=(-K+X)*(-nt+R)-(-K+P)*(-nt+B),Nt=(D*Ft-C*wt)/Y,J=($*wt-x*Ft)/Y,Gt=(Nt-P)*(Nt-P)+(J-R)*(J-R),Ve=P+(Nt-P)*U,Jt=R+(J-R)*U,qe=P-(Nt-P)*N,Ae=R-(J-R)*N,Qs=Math.min(D*D+x*x,C*C+$*$),zn=ct?U:N,Zr=Qs+zn*zn*S;Gt<=Zr?u.join==="bevel"||Gt/S>_?(ct?(m.push(Ve,Jt),m.push(P+H*N,R+j*N),m.push(Ve,Jt),m.push(P+K*N,R+nt*N)):(m.push(P-H*U,R-j*U),m.push(qe,Ae),m.push(P-K*U,R-nt*U),m.push(qe,Ae)),v+=2):u.join==="round"?ct?(m.push(Ve,Jt),m.push(P+H*N,R+j*N),v+=Or(P,R,P+H*N,R+j*N,P+K*N,R+nt*N,m,!0)+4,m.push(Ve,Jt),m.push(P+K*N,R+nt*N)):(m.push(P-H*U,R-j*U),m.push(qe,Ae),v+=Or(P,R,P-H*U,R-j*U,P-K*U,R-nt*U,m,!1)+4,m.push(P-K*U,R-nt*U),m.push(qe,Ae)):(m.push(Ve,Jt),m.push(qe,Ae)):(m.push(P-H*U,R-j*U),m.push(P+H*N,R+j*N),u.join==="round"?ct?v+=Or(P,R,P+H*N,R+j*N,P+K*N,R+nt*N,m,!0)+2:v+=Or(P,R,P-H*U,R-j*U,P-K*U,R-nt*U,m,!1)+2:u.join==="miter"&&Gt/S<=_&&(ct?(m.push(qe,Ae),m.push(qe,Ae)):(m.push(Ve,Jt),m.push(Ve,Jt)),v+=2),m.push(P-K*U,R-nt*U),m.push(P+K*N,R+nt*N),v+=2)}A=e[(y-2)*2],O=e[(y-2)*2+1],P=e[(y-1)*2],R=e[(y-1)*2+1],H=-(O-R),j=A-P,ht=Math.sqrt(H*H+j*j),H/=ht,j/=ht,H*=w,j*=w,m.push(P-H*U,R-j*U),m.push(P+H*N,R+j*N),p||(u.cap==="round"?v+=Or(P-H*(U-N)*.5,R-j*(U-N)*.5,P-H*U,R-j*U,P+H*N,R+j*N,m,!1)+2:u.cap==="square"&&(v+=Fg(P,R,H,j,U,N,!1,m)));const E=jg*jg;for(let L=b;L<v+b-2;++L)A=m[L*2],O=m[L*2+1],P=m[(L+1)*2],R=m[(L+1)*2+1],X=m[(L+2)*2],B=m[(L+2)*2+1],!(Math.abs(A*(R-B)+P*(B-O)+X*(O-R))<E)&&a.push(L,L+1,L+2)}function Vg(e,t,s,n,r,o,i){const a=Mk(e,t,2);if(!a)return;for(let c=0;c<a.length;c+=3)o[i++]=a[c]+r,o[i++]=a[c+1]+r,o[i++]=a[c+2]+r;let l=r*n;for(let c=0;c<e.length;c+=2)s[l]=e[c],s[l+1]=e[c+1],l+=n}const SS=[],CS={build(e,t){for(let s=0;s<e.points.length;s++)t[s]=e.points[s];return t},triangulate(e,t,s,n,r,o){Vg(e,SS,t,s,n,r,o)}},OS={build(e,t){const s=e,n=s.x,r=s.y,o=s.width,i=s.height;return o>=0&&i>=0&&(t[0]=n,t[1]=r,t[2]=n+o,t[3]=r,t[4]=n+o,t[5]=r+i,t[6]=n,t[7]=r+i),t},triangulate(e,t,s,n,r,o){let i=0;n*=s,t[n+i]=e[0],t[n+i+1]=e[1],i+=s,t[n+i]=e[2],t[n+i+1]=e[3],i+=s,t[n+i]=e[6],t[n+i+1]=e[7],i+=s,t[n+i]=e[4],t[n+i+1]=e[5],i+=s;const a=n/s;r[o++]=a,r[o++]=a+1,r[o++]=a+2,r[o++]=a+1,r[o++]=a+3,r[o++]=a+2}},TS={build(e,t){return t[0]=e.x,t[1]=e.y,t[2]=e.x2,t[3]=e.y2,t[4]=e.x3,t[5]=e.y3,t},triangulate(e,t,s,n,r,o){let i=0;n*=s,t[n+i]=e[0],t[n+i+1]=e[1],i+=s,t[n+i]=e[2],t[n+i+1]=e[3],i+=s,t[n+i]=e[4],t[n+i+1]=e[5];const a=n/s;r[o++]=a,r[o++]=a+1,r[o++]=a+2}},pu={rectangle:OS,polygon:CS,triangle:TS,circle:fu,ellipse:fu,roundedRectangle:fu},PS=new Me;function MS(e,t){const{geometryData:s,batches:n}=t;n.length=0,s.indices.length=0,s.vertices.length=0,s.uvs.length=0;for(let r=0;r<e.instructions.length;r++){const o=e.instructions[r];if(o.action==="texture")IS(o.data,n,s);else if(o.action==="fill"||o.action==="stroke"){const i=o.action==="stroke",a=o.data.path.shapePath,l=o.data.style,c=o.data.hole;i&&c&&zg(c.shapePath,l,null,!0,n,s),zg(a,l,c,i,n,s)}}}function IS(e,t,s){const{vertices:n,uvs:r,indices:o}=s,i=o.length,a=n.length/2,l=[],c=pu.rectangle,u=PS,h=e.image;u.x=e.dx,u.y=e.dy,u.width=e.dw,u.height=e.dh;const d=e.transform;c.build(u,l),d&&Bg(l,d),c.triangulate(l,n,2,a,o,i);const f=h.uvs;r.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=ks.get(Pc);p.indexOffset=i,p.indexSize=o.length-i,p.vertexOffset=a,p.vertexSize=n.length/2-a,p.color=e.style,p.alpha=e.alpha,p.texture=h,p.geometryData=s,t.push(p)}function zg(e,t,s,n,r,o){const{vertices:i,uvs:a,indices:l}=o,c=e.shapePrimitives.length-1;e.shapePrimitives.forEach(({shape:u,transform:h},d)=>{const f=l.length,p=i.length/2,g=[],m=pu[u.type];if(m.build(u,g),h&&Bg(g,h),n){const w=u.closePath??!0;kS(g,t,!1,w,i,2,p,l)}else if(s&&c===d){c!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const w=[],S=g.slice();ES(s.shapePath).forEach(_=>{w.push(S.length/2),S.push(..._)}),Vg(S,w,i,2,p,l,f)}else m.triangulate(g,i,2,p,l,f);const y=a.length/2,v=t.texture;if(v!==Vt.WHITE){const w=t.matrix;h&&w.append(h.clone().invert()),bS(i,2,p,a,y,2,i.length/2-p,w)}else wS(a,y,2,i.length/2-p);const b=ks.get(Pc);b.indexOffset=f,b.indexSize=l.length-f,b.vertexOffset=p,b.vertexSize=i.length/2-p,b.color=t.color,b.alpha=t.alpha,b.texture=v,b.geometryData=o,r.push(b)})}function ES(e){if(!e)return[];const t=e.shapePrimitives,s=[];for(let n=0;n<t.length;n++){const r=t[n].shape,o=[];pu[r.type].build(r,o),s.push(o)}return s}class $S{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class RS{constructor(){this.geometry=new Cm,this.instructions=new hg}init(){this.instructions.reset()}}const mu=class Em{constructor(){this._activeBatchers=[],this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._needsContextNeedsRebuild=[]}init(t){Em.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??Em.defaultOptions.bezierSmoothness}prerender(){this._returnActiveBatchers()}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let s=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){s?this._cleanGraphicsContextData(t):s=this._initContext(t),MS(t,s);const n=t.batchMode;t.customShader||n==="no-batch"?s.isBatchable=!1:n==="auto"&&(s.isBatchable=s.geometryData.vertices.length<400),t.dirty=!1}return s}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_returnActiveBatchers(){for(let t=0;t<this._activeBatchers.length;t++)ks.return(this._activeBatchers[t]);this._activeBatchers.length=0}_initContextRenderData(t){const s=ks.get(RS),{batches:n,geometryData:r}=this._gpuContextHash[t.uid],o=r.vertices.length,i=r.indices.length;for(let u=0;u<n.length;u++)n[u].applyTransform=!1;const a=ks.get(Sm);this._activeBatchers.push(a),a.ensureAttributeBuffer(o),a.ensureIndexBuffer(i),a.begin();for(let u=0;u<n.length;u++){const h=n[u];a.add(h)}a.finish(s.instructions);const l=s.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const c=a.batches;for(let u=0;u<c.length;u++){const h=c[u];h.bindGroup=Am(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[t.uid]=s,s}_initContext(t){const s=new $S;return this._gpuContextHash[t.uid]=s,t.on("update",this.onGraphicsContextUpdate,this),t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextUpdate(t){this._needsContextNeedsRebuild.push(t)}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("update",this.onGraphicsContextUpdate,this),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const s=this._gpuContextHash[t.uid];s.isBatchable||this._graphicsDataContextHash[t.uid]&&(ks.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),s.batches&&s.batches.forEach(n=>{ks.return(n)})}destroy(){for(const t of this._needsContextNeedsRebuild)this._gpuContextHash[t.uid]&&this.onGraphicsContextDestroy(t);this._needsContextNeedsRebuild.length=0}};mu.extension={type:[mt.WebGLSystem,mt.WebGPUSystem,mt.CanvasSystem],name:"graphicsContext"},mu.defaultOptions={bezierSmoothness:.5},Ic=mu;const DS=8,fl=11920929e-14,NS=1;function Gg(e,t,s,n,r,o,i,a,l,c){const u=Math.min(.99,Math.max(0,c??Ic.defaultOptions.bezierSmoothness));let h=(NS-u)/1;return h*=h,LS(t,s,n,r,o,i,a,l,e,h),e}function LS(e,t,s,n,r,o,i,a,l,c){gu(e,t,s,n,r,o,i,a,l,c,0),l.push(i,a)}function gu(e,t,s,n,r,o,i,a,l,c,u){if(u>DS)return;const h=(e+s)/2,d=(t+n)/2,f=(s+r)/2,p=(n+o)/2,g=(r+i)/2,m=(o+a)/2,y=(h+f)/2,v=(d+p)/2,b=(f+g)/2,w=(p+m)/2,S=(y+b)/2,_=(v+w)/2;if(u>0){let A=i-e,O=a-t;const P=Math.abs((s-i)*O-(n-a)*A),R=Math.abs((r-i)*O-(o-a)*A);if(P>fl&&R>fl){if((P+R)*(P+R)<=c*(A*A+O*O)){l.push(S,_);return}}else if(P>fl){if(P*P<=c*(A*A+O*O)){l.push(S,_);return}}else if(R>fl){if(R*R<=c*(A*A+O*O)){l.push(S,_);return}}else if(A=S-(e+i)/2,O=_-(t+a)/2,A*A+O*O<=c){l.push(S,_);return}}gu(e,t,h,d,y,v,S,_,l,c,u+1),gu(S,_,b,w,g,m,i,a,l,c,u+1)}const BS=8,jS=11920929e-14,FS=1;function VS(e,t,s,n,r,o,i,a){const l=Math.min(.99,Math.max(0,a??Ic.defaultOptions.bezierSmoothness));let c=(FS-l)/1;return c*=c,zS(t,s,n,r,o,i,e,c),e}function zS(e,t,s,n,r,o,i,a){yu(i,e,t,s,n,r,o,a,0),i.push(r,o)}function yu(e,t,s,n,r,o,i,a,l){if(l>BS)return;const c=(t+n)/2,u=(s+r)/2,h=(n+o)/2,d=(r+i)/2,f=(c+h)/2,p=(u+d)/2;let g=o-t,m=i-s;const y=Math.abs((n-o)*m-(r-i)*g);if(y>jS){if(y*y<=a*(g*g+m*m)){e.push(f,p);return}}else if(g=f-(t+o)/2,m=p-(s+i)/2,g*g+m*m<=a){e.push(f,p);return}yu(e,t,s,c,u,f,p,a,l+1),yu(e,f,p,h,d,o,i,a,l+1)}function Ug(e,t,s,n,r,o,i,a){let l=Math.abs(r-o);(!i&&r>o||i&&o>r)&&(l=2*Math.PI-l),a=a||Math.max(6,Math.floor(6*Math.pow(n,.3333333333333333)*(l/Math.PI))),a=Math.max(a,3);let c=l/a,u=r;c*=i?-1:1;for(let h=0;h<a+1;h++){const d=Math.cos(u),f=Math.sin(u),p=t+d*n,g=s+f*n;e.push(p,g),u+=c}}function GS(e,t,s,n,r,o){const i=e[e.length-2],a=e[e.length-1]-s,l=i-t,c=r-s,u=n-t,h=Math.abs(a*u-l*c);if(h<1e-8||o===0){(e[e.length-2]!==t||e[e.length-1]!==s)&&e.push(t,s);return}const d=a*a+l*l,f=c*c+u*u,p=a*c+l*u,g=o*Math.sqrt(d)/h,m=o*Math.sqrt(f)/h,y=g*p/d,v=m*p/f,b=g*u+m*l,w=g*c+m*a,S=l*(m+y),_=a*(m+y),A=u*(g+v),O=c*(g+v),P=Math.atan2(_-w,S-b),R=Math.atan2(O-w,A-b);Ug(e,b+t,w+s,o,P,R,l*c>u*a)}const Si=Math.PI*2,vu={centerX:0,centerY:0,ang1:0,ang2:0},bu=({x:e,y:t},s,n,r,o,i,a,l)=>{e*=s,t*=n;const c=r*e-o*t,u=o*e+r*t;return l.x=c+i,l.y=u+a,l};function US(e,t){const s=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),n=t===1.5707963267948966?.551915024494:s,r=Math.cos(e),o=Math.sin(e),i=Math.cos(e+t),a=Math.sin(e+t);return[{x:r-o*n,y:o+r*n},{x:i+a*n,y:a-i*n},{x:i,y:a}]}const Hg=(e,t,s,n)=>{const r=e*n-t*s<0?-1:1;let o=e*s+t*n;return o>1&&(o=1),o<-1&&(o=-1),r*Math.acos(o)},HS=(e,t,s,n,r,o,i,a,l,c,u,h,d)=>{const f=Math.pow(r,2),p=Math.pow(o,2),g=Math.pow(u,2),m=Math.pow(h,2);let y=f*p-f*m-p*g;y<0&&(y=0),y/=f*m+p*g,y=Math.sqrt(y)*(i===a?-1:1);const v=y*r/o*h,b=y*-o/r*u,w=c*v-l*b+(e+s)/2,S=l*v+c*b+(t+n)/2,_=(u-v)/r,A=(h-b)/o,O=(-u-v)/r,P=(-h-b)/o,R=Hg(1,0,_,A);let X=Hg(_,A,O,P);a===0&&X>0&&(X-=Si),a===1&&X<0&&(X+=Si),d.centerX=w,d.centerY=S,d.ang1=R,d.ang2=X};function WS(e,t,s,n,r,o,i,a=0,l=0,c=0){if(o===0||i===0)return;const u=Math.sin(a*Si/360),h=Math.cos(a*Si/360),d=h*(t-n)/2+u*(s-r)/2,f=-u*(t-n)/2+h*(s-r)/2;if(d===0&&f===0)return;o=Math.abs(o),i=Math.abs(i);const p=Math.pow(d,2)/Math.pow(o,2)+Math.pow(f,2)/Math.pow(i,2);p>1&&(o*=Math.sqrt(p),i*=Math.sqrt(p)),HS(t,s,n,r,o,i,l,c,u,h,d,f,vu);let{ang1:g,ang2:m}=vu;const{centerX:y,centerY:v}=vu;let b=Math.abs(m)/(Si/4);Math.abs(1-b)<1e-7&&(b=1);const w=Math.max(Math.ceil(b),1);m/=w;let S=e[e.length-2],_=e[e.length-1];const A={x:0,y:0};for(let O=0;O<w;O++){const P=US(g,m),{x:R,y:X}=bu(P[0],o,i,h,u,y,v,A),{x:B,y:H}=bu(P[1],o,i,h,u,y,v,A),{x:j,y:K}=bu(P[2],o,i,h,u,y,v,A);Gg(e,S,_,R,X,B,H,j,K),S=j,_=K,g+=m}}function XS(e,t,s){const n=(i,a)=>{const l=a.x-i.x,c=a.y-i.y,u=Math.sqrt(l*l+c*c),h=l/u,d=c/u;return{len:u,nx:h,ny:d}},r=(i,a)=>{i===0?e.moveTo(a.x,a.y):e.lineTo(a.x,a.y)};let o=t[t.length-1];for(let i=0;i<t.length;i++){const a=t[i%t.length],l=a.radius??s;if(l<=0){r(i,a),o=a;continue}const c=t[(i+1)%t.length],u=n(a,o),h=n(a,c);if(u.len<1e-4||h.len<1e-4){r(i,a),o=a;continue}let d=Math.asin(u.nx*h.ny-u.ny*h.nx),f=1,p=!1;u.nx*h.nx-u.ny*-h.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const g=d/2;let m,y=Math.abs(Math.cos(g)*l/Math.sin(g));y>Math.min(u.len/2,h.len/2)?(y=Math.min(u.len/2,h.len/2),m=Math.abs(y*Math.sin(g)/Math.cos(g))):m=l;const v=a.x+h.nx*y+-h.ny*m*f,b=a.y+h.ny*y+h.nx*m*f,w=Math.atan2(u.ny,u.nx)+Math.PI/2*f,S=Math.atan2(h.ny,h.nx)-Math.PI/2*f;i===0&&e.moveTo(v+Math.cos(w)*m,b+Math.sin(w)*m),e.arc(v,b,m,w,S,p),o=a}}function YS(e,t,s,n){const r=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),o=(a,l,c)=>({x:a.x+(l.x-a.x)*c,y:a.y+(l.y-a.y)*c}),i=t.length;for(let a=0;a<i;a++){const l=t[(a+1)%i],c=l.radius??s;if(c<=0){a===0?e.moveTo(l.x,l.y):e.lineTo(l.x,l.y);continue}const u=t[a],h=t[(a+2)%i],d=r(u,l);let f;if(d<1e-4)f=l;else{const m=Math.min(d/2,c);f=o(l,u,m/d)}const p=r(h,l);let g;if(p<1e-4)g=l;else{const m=Math.min(p/2,c);g=o(l,h,m/p)}a===0?e.moveTo(f.x,f.y):e.lineTo(f.x,f.y),e.quadraticCurveTo(l.x,l.y,g.x,g.y,n)}}const ZS=new Me;class qS{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new kn,this._graphicsPath2D=t}moveTo(t,s){return this.startPoly(t,s),this}lineTo(t,s){this._ensurePoly();const n=this._currentPoly.points,r=n[n.length-2],o=n[n.length-1];return(r!==t||o!==s)&&n.push(t,s),this}arc(t,s,n,r,o,i){this._ensurePoly(!1);const a=this._currentPoly.points;return Ug(a,t,s,n,r,o,i),this}arcTo(t,s,n,r,o){this._ensurePoly();const i=this._currentPoly.points;return GS(i,t,s,n,r,o),this}arcToSvg(t,s,n,r,o,i,a){const l=this._currentPoly.points;return WS(l,this._currentPoly.lastX,this._currentPoly.lastY,i,a,t,s,n,r,o),this}bezierCurveTo(t,s,n,r,o,i,a){this._ensurePoly();const l=this._currentPoly;return Gg(this._currentPoly.points,l.lastX,l.lastY,t,s,n,r,o,i,a),this}quadraticCurveTo(t,s,n,r,o){this._ensurePoly();const i=this._currentPoly;return VS(this._currentPoly.points,i.lastX,i.lastY,t,s,n,r,o),this}closePath(){return this.endPoly(!0),this}addPath(t,s){this.endPoly(),s&&!s.isIdentity()&&(t=t.clone(!0),t.transform(s));for(let n=0;n<t.instructions.length;n++){const r=t.instructions[n];this[r.action](...r.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,s,n,r,o){return this.drawShape(new Me(t,s,n,r),o),this}circle(t,s,n,r){return this.drawShape(new lu(t,s,n),r),this}poly(t,s,n){const r=new Ai(t);return r.closePath=s,this.drawShape(r,n),this}regularPoly(t,s,n,r,o=0,i){r=Math.max(r|0,3);const a=-1*Math.PI/2+o,l=Math.PI*2/r,c=[];for(let u=0;u<r;u++){const h=u*l+a;c.push(t+n*Math.cos(h),s+n*Math.sin(h))}return this.poly(c,!0,i),this}roundPoly(t,s,n,r,o,i=0,a){if(r=Math.max(r|0,3),o<=0)return this.regularPoly(t,s,n,r,i);const l=n*Math.sin(Math.PI/r)-.001;o=Math.min(o,l);const c=-1*Math.PI/2+i,u=Math.PI*2/r,h=(r-2)*Math.PI/r/2;for(let d=0;d<r;d++){const f=d*u+c,p=t+n*Math.cos(f),g=s+n*Math.sin(f),m=f+Math.PI+h,y=f-Math.PI-h,v=p+o*Math.cos(m),b=g+o*Math.sin(m),w=p+o*Math.cos(y),S=g+o*Math.sin(y);d===0?this.moveTo(v,b):this.lineTo(v,b),this.quadraticCurveTo(p,g,w,S,a)}return this.closePath()}roundShape(t,s,n=!1,r){return t.length<3?this:(n?YS(this,t,s,r):XS(this,t,s),this.closePath())}filletRect(t,s,n,r,o){if(o===0)return this.rect(t,s,n,r);const i=Math.min(n,r)/2,a=Math.min(i,Math.max(-i,o)),l=t+n,c=s+r,u=a<0?-a:0,h=Math.abs(a);return this.moveTo(t,s+h).arcTo(t+u,s+u,t+h,s,h).lineTo(l-h,s).arcTo(l-u,s+u,l,s+h,h).lineTo(l,c-h).arcTo(l-u,c-u,t+n-h,c,h).lineTo(t+h,c).arcTo(t+u,c-u,t,c-h,h).closePath()}chamferRect(t,s,n,r,o,i){if(o<=0)return this.rect(t,s,n,r);const a=Math.min(o,Math.min(n,r)/2),l=t+n,c=s+r,u=[t+a,s,l-a,s,l,s+a,l,c-a,l-a,c,t+a,c,t,c-a,t,s+a];for(let h=u.length-1;h>=2;h-=2)u[h]===u[h-2]&&u[h-1]===u[h-3]&&u.splice(h-1,2);return this.poly(u,!0,i)}ellipse(t,s,n,r,o){return this.drawShape(new hu(t,s,n,r),o),this}roundRect(t,s,n,r,o,i){return this.drawShape(new cu(t,s,n,r,o),i),this}drawShape(t,s){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:s}),this}startPoly(t,s){let n=this._currentPoly;return n&&this.endPoly(),n=new Ai,n.points.push(t,s),this._currentPoly=n,this}endPoly(t=!1){const s=this._currentPoly;return s&&s.points.length>2&&(s.closePath=t,this.shapePrimitives.push({shape:s})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new Ai,t)){const s=this.shapePrimitives[this.shapePrimitives.length-1];if(s){let n=s.shape.x,r=s.shape.y;if(!s.transform.isIdentity()){const o=s.transform,i=n;n=o.a*n+o.c*r+o.tx,r=o.b*i+o.d*r+o.ty}this._currentPoly.points.push(n,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let s=0;s<t.instructions.length;s++){const n=t.instructions[s];this[n.action](...n.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const s=this.shapePrimitives;for(let n=0;n<s.length;n++){const r=s[n],o=r.shape.getBounds(ZS);r.transform?t.addRect(o,r.transform):t.addRect(o)}return t}}class uo{constructor(t){this.instructions=[],this.uid=ke("graphicsPath"),this._dirty=!0,typeof t=="string"?uS(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new qS(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,s){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,s]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,s,n,r,o){const i=this.instructions[this.instructions.length-1],a=this.getLastPoint(ze.shared);let l=0,c=0;if(!i||i.action!=="bezierCurveTo")l=a.x,c=a.y;else{l=i.data[2],c=i.data[3];const u=a.x,h=a.y;l=u+(u-l),c=h+(h-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,t,s,n,r,o]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,s,n){const r=this.instructions[this.instructions.length-1],o=this.getLastPoint(ze.shared);let i=0,a=0;if(!r||r.action!=="quadraticCurveTo")i=o.x,a=o.y;else{i=r.data[0],a=r.data[1];const l=o.x,c=o.y;i=l+(l-i),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[i,a,t,s,n]}),this._dirty=!0,this}rect(t,s,n,r,o){return this.instructions.push({action:"rect",data:[t,s,n,r,o]}),this._dirty=!0,this}circle(t,s,n,r){return this.instructions.push({action:"circle",data:[t,s,n,r]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,s,n,r,o,i,a){o=o||r/2;const l=-1*Math.PI/2+i,c=n*2,u=Math.PI*2/c,h=[];for(let d=0;d<c;d++){const f=d%2?o:r,p=d*u+l;h.push(t+f*Math.cos(p),s+f*Math.sin(p))}return this.poly(h,!0,a),this}clone(t=!1){const s=new uo;if(!t)s.instructions=this.instructions.slice();else for(let n=0;n<this.instructions.length;n++){const r=this.instructions[n];s.instructions.push({action:r.action,data:r.data.slice()})}return s}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const s=t.a,n=t.b,r=t.c,o=t.d,i=t.tx,a=t.ty;let l=0,c=0,u=0,h=0,d=0,f=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const y=this.instructions[m],v=y.data;switch(y.action){case"moveTo":case"lineTo":l=v[0],c=v[1],v[0]=s*l+r*c+i,v[1]=n*l+o*c+a;break;case"bezierCurveTo":u=v[0],h=v[1],d=v[2],f=v[3],l=v[4],c=v[5],v[0]=s*u+r*h+i,v[1]=n*u+o*h+a,v[2]=s*d+r*f+i,v[3]=n*d+o*f+a,v[4]=s*l+r*c+i,v[5]=n*l+o*c+a;break;case"quadraticCurveTo":u=v[0],h=v[1],l=v[2],c=v[3],v[0]=s*u+r*h+i,v[1]=n*u+o*h+a,v[2]=s*l+r*c+i,v[3]=n*l+o*c+a;break;case"arcToSvg":l=v[5],c=v[6],p=v[0],g=v[1],v[0]=s*p+r*g,v[1]=n*p+o*g,v[5]=s*l+r*c+i,v[6]=n*l+o*c+a;break;case"circle":v[4]=Ci(v[3],t);break;case"rect":v[4]=Ci(v[4],t);break;case"ellipse":v[8]=Ci(v[8],t);break;case"roundRect":v[5]=Ci(v[5],t);break;case"addPath":v[0].transform(t);break;case"poly":v[2]=Ci(v[2],t);break;default:Se("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let s=this.instructions.length-1,n=this.instructions[s];if(!n)return t.x=0,t.y=0,t;for(;n.action==="closePath";){if(s--,s<0)return t.x=0,t.y=0,t;n=this.instructions[s]}switch(n.action){case"moveTo":case"lineTo":t.x=n.data[0],t.y=n.data[1];break;case"quadraticCurveTo":t.x=n.data[2],t.y=n.data[3];break;case"bezierCurveTo":t.x=n.data[4],t.y=n.data[5];break;case"arc":case"arcToSvg":t.x=n.data[5],t.y=n.data[6];break;case"addPath":n.data[0].getLastPoint(t);break}return t}}function Ci(e,t){return e?e.prepend(t):t.clone()}function QS(e,t){if(typeof e=="string"){const n=document.createElement("div");n.innerHTML=e.trim(),e=n.querySelector("svg")}const s={context:t,path:new uo};return Wg(e,s,null,null),t}function Wg(e,t,s,n){const r=e.children,{fillStyle:o,strokeStyle:i}=KS(e);o&&s?s={...s,...o}:o&&(s=o),i&&n?n={...n,...i}:i&&(n=i),t.context.fillStyle=s,t.context.strokeStyle=n;let a,l,c,u,h,d,f,p,g,m,y,v,b,w,S,_,A;switch(e.nodeName.toLowerCase()){case"path":w=e.getAttribute("d"),S=new uo(w),t.context.path(S),s&&t.context.fill(),n&&t.context.stroke();break;case"circle":f=Oe(e,"cx",0),p=Oe(e,"cy",0),g=Oe(e,"r",0),t.context.ellipse(f,p,g,g),s&&t.context.fill(),n&&t.context.stroke();break;case"rect":a=Oe(e,"x",0),l=Oe(e,"y",0),_=Oe(e,"width",0),A=Oe(e,"height",0),m=Oe(e,"rx",0),y=Oe(e,"ry",0),m||y?t.context.roundRect(a,l,_,A,m||y):t.context.rect(a,l,_,A),s&&t.context.fill(),n&&t.context.stroke();break;case"ellipse":f=Oe(e,"cx",0),p=Oe(e,"cy",0),m=Oe(e,"rx",0),y=Oe(e,"ry",0),t.context.beginPath(),t.context.ellipse(f,p,m,y),s&&t.context.fill(),n&&t.context.stroke();break;case"line":c=Oe(e,"x1",0),u=Oe(e,"y1",0),h=Oe(e,"x2",0),d=Oe(e,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(h,d),n&&t.context.stroke();break;case"polygon":b=e.getAttribute("points"),v=b.match(/\d+/g).map(O=>parseInt(O,10)),t.context.poly(v,!0),s&&t.context.fill(),n&&t.context.stroke();break;case"polyline":b=e.getAttribute("points"),v=b.match(/\d+/g).map(O=>parseInt(O,10)),t.context.poly(v,!1),n&&t.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${e.nodeName}> elements unsupported`);break}}for(let O=0;O<r.length;O++)Wg(r[O],t,s,n)}function Oe(e,t,s){const n=e.getAttribute(t);return n?Number(n):s}function KS(e){const t=e.getAttribute("style"),s={},n={};let r=!1,o=!1;if(t){const i=t.split(";");for(let a=0;a<i.length;a++){const l=i[a],[c,u]=l.split(":");switch(c){case"stroke":u!=="none"&&(s.color=is.shared.setValue(u).toNumber(),o=!0);break;case"stroke-width":s.width=Number(u);break;case"fill":u!=="none"&&(r=!0,n.color=is.shared.setValue(u).toNumber());break;case"fill-opacity":n.alpha=Number(u);break;case"stroke-opacity":s.alpha=Number(u);break;case"opacity":n.alpha=Number(u),s.alpha=Number(u);break}}}else{const i=e.getAttribute("stroke");i&&i!=="none"&&(o=!0,s.color=is.shared.setValue(i).toNumber(),s.width=Oe(e,"stroke-width",1));const a=e.getAttribute("fill");a&&a!=="none"&&(r=!0,n.color=is.shared.setValue(a).toNumber())}return{strokeStyle:o?s:null,fillStyle:r?n:null}}const Xg=class $m{constructor(t,s,n,r){this.uid=ke("fillGradient"),this.type="linear",this.gradientStops=[],this.x0=t,this.y0=s,this.x1=n,this.y1=r}addColorStop(t,s){return this.gradientStops.push({offset:t,color:is.shared.setValue(s).toHex()}),this}buildLinearGradient(){const t=$m.defaultTextureSize,{gradientStops:s}=this,n=Ke.get().createCanvas();n.width=t,n.height=t;const r=n.getContext("2d"),o=r.createLinearGradient(0,0,$m.defaultTextureSize,1);for(let g=0;g<s.length;g++){const m=s[g];o.addColorStop(m.offset,m.color)}r.fillStyle=o,r.fillRect(0,0,t,t),this.texture=new Vt({source:new so({resource:n,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:i,y0:a,x1:l,y1:c}=this,u=new Bt,h=l-i,d=c-a,f=Math.sqrt(h*h+d*d),p=Math.atan2(d,h);u.translate(-i,-a),u.scale(1/t,1/t),u.rotate(-p),u.scale(256/f,1),this.transform=u}};Xg.defaultTextureSize=256,bm=Xg;const Yg={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};wm=class{constructor(e,t){this.uid=ke("fillPattern"),this.transform=new Bt,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=Yg[t].addressModeU,e.source.style.addressModeV=Yg[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height)}},br=function(e,t){var i;if(e==null)return null;let s,n;if(e!=null&&e.fill?(n=e.fill,s={...t,...e}):(n=e,s=t),is.isColorLike(n)){const a=is.shared.setValue(n??0);return{...s,color:a.toNumber(),alpha:a.alpha===1?s.alpha:a.alpha,texture:Vt.WHITE}}else if(n instanceof wm){const a=n;return{...s,color:16777215,texture:a.texture,matrix:a.transform,fill:s.fill??null}}else if(n instanceof bm){const a=n;return a.buildLinearGradient(),{...s,color:16777215,texture:a.texture,matrix:a.transform}}const r={...t,...e};if(r.texture){if(r.texture!==Vt.WHITE){const l=((i=r.matrix)==null?void 0:i.invert())||new Bt;l.scale(1/r.texture.frame.width,1/r.texture.frame.height),r.matrix=l}const a=r.texture.source.style;a.addressMode==="clamp-to-edge"&&(a.addressMode="repeat")}const o=is.shared.setValue(r.color);return r.alpha*=o.alpha,r.color=o.toNumber(),r.matrix=r.matrix?r.matrix.clone():null,r};const JS=new ze,Zg=new Bt,wu=class Sn extends As{constructor(){super(...arguments),this.uid=ke("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new uo,this._transform=new Bt,this._fillStyle={...Sn.defaultFillStyle},this._strokeStyle={...Sn.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new kn,this._boundsDirty=!0}clone(){const t=new Sn;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=br(t,Sn.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=br(t,Sn.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=br(t,Sn.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=br(t,Sn.defaultStrokeStyle),this}texture(t,s,n,r,o,i){return this.instructions.push({action:"texture",data:{image:t,dx:n||0,dy:r||0,dw:o||t.frame.width,dh:i||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:s?is.shared.setValue(s).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new uo,this}fill(t,s){let n;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="stroke"?n=r.data.path:n=this._activePath.clone(),n?(t!=null&&(s!==void 0&&typeof t=="number"&&(le(he,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:s}),this._fillStyle=br(t,Sn.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:s}=this._activePath.getLastPoint(ze.shared);this._activePath.clear(),this._activePath.moveTo(t,s)}stroke(t){let s;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="fill"?s=n.data.path:s=this._activePath.clone(),s?(t!=null&&(this._strokeStyle=br(t,Sn.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const s=this.instructions[this.instructions.length-1-t],n=this._activePath.clone();if(s&&(s.action==="stroke"||s.action==="fill"))if(s.data.hole)s.data.hole.addPath(n);else{s.data.hole=n;break}}return this._initNextPathLocation(),this}arc(t,s,n,r,o,i){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*s+a.tx,a.b*t+a.d*s+a.ty,n,r,o,i),this}arcTo(t,s,n,r,o){this._tick++;const i=this._transform;return this._activePath.arcTo(i.a*t+i.c*s+i.tx,i.b*t+i.d*s+i.ty,i.a*n+i.c*r+i.tx,i.b*n+i.d*r+i.ty,o),this}arcToSvg(t,s,n,r,o,i,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(t,s,n,r,o,l.a*i+l.c*a+l.tx,l.b*i+l.d*a+l.ty),this}bezierCurveTo(t,s,n,r,o,i,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*t+l.c*s+l.tx,l.b*t+l.d*s+l.ty,l.a*n+l.c*r+l.tx,l.b*n+l.d*r+l.ty,l.a*o+l.c*i+l.tx,l.b*o+l.d*i+l.ty,a),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,s,n,r){return this._tick++,this._activePath.ellipse(t,s,n,r,this._transform.clone()),this}circle(t,s,n){return this._tick++,this._activePath.circle(t,s,n,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,s){this._tick++;const n=this._transform;return this._activePath.lineTo(n.a*t+n.c*s+n.tx,n.b*t+n.d*s+n.ty),this}moveTo(t,s){this._tick++;const n=this._transform,r=this._activePath.instructions,o=n.a*t+n.c*s+n.tx,i=n.b*t+n.d*s+n.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=o,r[0].data[1]=i,this):(this._activePath.moveTo(o,i),this)}quadraticCurveTo(t,s,n,r,o){this._tick++;const i=this._transform;return this._activePath.quadraticCurveTo(i.a*t+i.c*s+i.tx,i.b*t+i.d*s+i.ty,i.a*n+i.c*r+i.tx,i.b*n+i.d*r+i.ty,o),this}rect(t,s,n,r){return this._tick++,this._activePath.rect(t,s,n,r,this._transform.clone()),this}roundRect(t,s,n,r,o){return this._tick++,this._activePath.roundRect(t,s,n,r,o,this._transform.clone()),this}poly(t,s){return this._tick++,this._activePath.poly(t,s,this._transform.clone()),this}regularPoly(t,s,n,r,o=0,i){return this._tick++,this._activePath.regularPoly(t,s,n,r,o,i),this}roundPoly(t,s,n,r,o,i){return this._tick++,this._activePath.roundPoly(t,s,n,r,o,i),this}roundShape(t,s,n,r){return this._tick++,this._activePath.roundShape(t,s,n,r),this}filletRect(t,s,n,r,o){return this._tick++,this._activePath.filletRect(t,s,n,r,o),this}chamferRect(t,s,n,r,o,i){return this._tick++,this._activePath.chamferRect(t,s,n,r,o,i),this}star(t,s,n,r,o=0,i=0){return this._tick++,this._activePath.star(t,s,n,r,o,i,this._transform.clone()),this}svg(t){return this._tick++,QS(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,s=t){return this._transform.scale(t,s),this}setTransform(t,s,n,r,o,i){return t instanceof Bt?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,s,n,r,o,i),this)}transform(t,s,n,r,o,i){return t instanceof Bt?(this._transform.append(t),this):(Zg.set(t,s,n,r,o,i),this._transform.append(Zg),this)}translate(t,s=t){return this._transform.translate(t,s),this}clear(){return this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let s=0;s<this.instructions.length;s++){const n=this.instructions[s],r=n.action;if(r==="fill"){const o=n.data;t.addBounds(o.path.bounds)}else if(r==="texture"){const o=n.data;t.addFrame(o.dx,o.dy,o.dx+o.dw,o.dy+o.dh,o.transform)}if(r==="stroke"){const o=n.data,i=o.style.width/2,a=o.path.bounds;t.addFrame(a.minX-i,a.minY-i,a.maxX+i,a.maxY+i)}}return t}containsPoint(t){var r;if(!this.bounds.containsPoint(t.x,t.y))return!1;const s=this.instructions;let n=!1;for(let o=0;o<s.length;o++){const i=s[o],a=i.data,l=a.path;if(!i.action||!l)continue;const c=a.style,u=l.shapePath.shapePrimitives;for(let h=0;h<u.length;h++){const d=u[h].shape;if(!c||!d)continue;const f=u[h].transform,p=f?f.applyInverse(t,JS):t;i.action==="fill"?n=d.contains(p.x,p.y):n=d.strokeContains(p.x,p.y,c.width);const g=a.hole;if(g){const m=(r=g.shapePath)==null?void 0:r.shapePrimitives;if(m)for(let y=0;y<m.length;y++)m[y].shape.contains(p.x,p.y)&&(n=!1)}if(n)return!0}}return n}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};wu.defaultFillStyle={color:16777215,alpha:1,texture:Vt.WHITE,matrix:null,fill:null},wu.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Vt.WHITE,matrix:null,fill:null},wr=wu;function xu(e,t=1){var n;const s=(n=ao.RETINA_PREFIX)==null?void 0:n.exec(e);return s?parseFloat(s[1]):t}function _u(e,t,s){e.label=s,e._sourceOrigin=s;const n=new Vt({source:e,label:s}),r=()=>{delete t.promiseCache[s],Ge.has(s)&&Ge.remove(s)};return n.source.once("destroy",()=>{t.promiseCache[s]&&(Se("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),r())}),n.once("destroy",()=>{e.destroyed||(Se("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),n}const tC=".svg",eC="image/svg+xml",sC={extension:{type:mt.LoadParser,priority:Hn.Low},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(e){return ho(e,eC)||co(e,tC)},async load(e,t,s){return t.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?rC(e):nC(e,t,s,this.config.crossOrigin)},unload(e){e.destroy(!0)}};async function nC(e,t,s,n){var g,m,y;const r=await(await Ke.get().fetch(e)).blob(),o=URL.createObjectURL(r),i=new Image;i.src=o,i.crossOrigin=n,await i.decode(),URL.revokeObjectURL(o);const a=document.createElement("canvas"),l=a.getContext("2d"),c=((g=t.data)==null?void 0:g.resolution)||xu(e),u=((m=t.data)==null?void 0:m.width)??i.width,h=((y=t.data)==null?void 0:y.height)??i.height;a.width=u*c,a.height=h*c,l.drawImage(i,0,0,u*c,h*c);const{parseAsGraphicsContext:d,...f}=t.data,p=new so({resource:a,alphaMode:"premultiply-alpha-on-upload",resolution:c,...f});return _u(p,s,e)}async function rC(e){const t=await(await Ke.get().fetch(e)).text(),s=new wr;return s.svg(t),s}const oC=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let fo=null,Au=class{constructor(){fo||(fo=URL.createObjectURL(new Blob([oC],{type:"application/javascript"}))),this.worker=new Worker(fo)}};Au.revokeObjectURL=function(){fo&&(URL.revokeObjectURL(fo),fo=null)};const iC=`(function () {
    'use strict';

    async function loadImageBitmap(url) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      const imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap;
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let po=null;class qg{constructor(){po||(po=URL.createObjectURL(new Blob([iC],{type:"application/javascript"}))),this.worker=new Worker(po)}}qg.revokeObjectURL=function(){po&&(URL.revokeObjectURL(po),po=null)};let Qg=0,ku;class aC{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:s}=new Au;s.addEventListener("message",n=>{s.terminate(),Au.revokeObjectURL(),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){ku===void 0&&(ku=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<ku&&(this._createdWorkers++,t=new qg().worker,t.addEventListener("message",s=>{this._complete(s.data),this._returnWorker(s.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,s){await this._initWorkers();const n=new Promise((r,o)=>{this._queue.push({id:t,arguments:s,resolve:r,reject:o})});return this._next(),n}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const s=this._queue.pop(),n=s.id;this._resolveHash[Qg]={resolve:s.resolve,reject:s.reject},t.postMessage({data:s.arguments,uuid:Qg++,id:n})}}const Kg=new aC,lC=[".jpeg",".jpg",".png",".webp",".avif"],hC=["image/jpeg","image/png","image/webp","image/avif"];async function cC(e){const t=await Ke.get().fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const s=await t.blob();return await createImageBitmap(s)}const Jg={name:"loadTextures",extension:{type:mt.LoadParser,priority:Hn.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return ho(e,hC)||co(e,lC)},async load(e,t,s){var o;let n=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Kg.isImageBitmapSupported()?n=await Kg.loadImageBitmap(e):n=await cC(e):n=await new Promise(i=>{n=new Image,n.crossOrigin=this.config.crossOrigin,n.src=e,n.complete?i(n):n.onload=()=>{i(n)}});const r=new so({resource:n,alphaMode:"premultiply-alpha-on-upload",resolution:((o=t.data)==null?void 0:o.resolution)||xu(e),...t.data});return _u(r,s,e)},unload(e){e.destroy(!0)}},t0=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],uC=t0.map(e=>`video/${e.substring(1)}`);function dC(e,t,s){s===void 0&&!t.startsWith("data:")?e.crossOrigin=pC(t):s!==!1&&(e.crossOrigin=typeof s=="string"?s:"anonymous")}function fC(e){return new Promise((t,s)=>{e.addEventListener("canplaythrough",n),e.addEventListener("error",r),e.load();function n(){o(),t()}function r(i){o(),s(i)}function o(){e.removeEventListener("canplaythrough",n),e.removeEventListener("error",r)}})}function pC(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location;const s=new URL(e,document.baseURI);return s.hostname!==t.hostname||s.port!==t.port||s.protocol!==t.protocol?"anonymous":""}const mC={name:"loadVideo",extension:{type:mt.LoadParser},config:null,test(e){const t=ho(e,uC),s=co(e,t0);return t||s},async load(e,t,s){var l,c;const n={...ol.defaultOptions,resolution:((l=t.data)==null?void 0:l.resolution)||xu(e),alphaMode:((c=t.data)==null?void 0:c.alphaMode)||await vg(),...t.data},r=document.createElement("video"),o={preload:n.autoLoad!==!1?"auto":void 0,"webkit-playsinline":n.playsinline!==!1?"":void 0,playsinline:n.playsinline!==!1?"":void 0,muted:n.muted===!0?"":void 0,loop:n.loop===!0?"":void 0,autoplay:n.autoPlay!==!1?"":void 0};Object.keys(o).forEach(u=>{const h=o[u];h!==void 0&&r.setAttribute(u,h)}),n.muted===!0&&(r.muted=!0),dC(r,e,n.crossorigin);const i=document.createElement("source");let a;if(e.startsWith("data:"))a=e.slice(5,e.indexOf(";"));else if(!e.startsWith("blob:")){const u=e.split("?")[0].slice(e.lastIndexOf(".")+1).toLowerCase();a=ol.MIME_TYPES[u]||`video/${u}`}return i.src=e,a&&(i.type=a),new Promise(u=>{const h=async()=>{const d=new ol({...n,resource:r});r.removeEventListener("canplay",h),t.data.preload&&await fC(r),u(_u(d,s,e))};r.addEventListener("canplay",h),r.appendChild(i)})},unload(e){e.destroy(!0)}},e0={extension:mt.ResolveParser,test:Jg.test,parse:e=>{var t;return{resolution:parseFloat(((t=ao.RETINA_PREFIX.exec(e))==null?void 0:t[1])??"1"),format:e.split(".").pop(),src:e}}},gC={extension:mt.ResolveParser,test:e=>ao.RETINA_PREFIX.test(e)&&e.endsWith(".json"),parse:e0.parse};class yC{constructor(){this._detections=[],this._initialized=!1,this.resolver=new ao,this.loader=new Uk,this.cache=Ge,this._backgroundLoader=new Dk(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var o,i;if(this._initialized){Se("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let a=t.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const s=((o=t.texturePreference)==null?void 0:o.resolution)??1,n=typeof s=="number"?[s]:s,r=await this._detectFormats({preferredFormats:(i=t.texturePreference)==null?void 0:i.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:n}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,s){this._initialized||await this.init();const n=al(t),r=js(t).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),o=this.resolver.resolve(r),i=await this._mapLoadToResolve(o,s);return n?i[r[0]]:i}addBundle(t,s){this.resolver.addBundle(t,s)}async loadBundle(t,s){this._initialized||await this.init();let n=!1;typeof t=="string"&&(n=!0,t=[t]);const r=this.resolver.resolveBundle(t),o={},i=Object.keys(r);let a=0,l=0;const c=()=>{s==null||s(++a/l)},u=i.map(h=>{const d=r[h];return l+=Object.keys(d).length,this._mapLoadToResolve(d,c).then(f=>{o[h]=f})});return await Promise.all(u),n?o[t[0]]:o}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const s=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(s))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const s=this.resolver.resolveBundle(t);Object.values(s).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Ge.get(t);const s={};for(let n=0;n<t.length;n++)s[n]=Ge.get(t[n]);return s}async _mapLoadToResolve(t,s){const n=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const r=await this.loader.load(n,s);this._backgroundLoader.active=!0;const o={};return n.forEach(i=>{const a=r[i.src],l=[i.src];i.alias&&l.push(...i.alias),l.forEach(c=>{o[c]=a}),Ge.set(l,a)}),o}async unload(t){this._initialized||await this.init();const s=js(t).map(r=>typeof r!="string"?r.src:r),n=this.resolver.resolve(s);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=js(t);const s=this.resolver.resolveBundle(t),n=Object.keys(s).map(r=>this._unloadFromResolved(s[r]));await Promise.all(n)}async _unloadFromResolved(t){const s=Object.values(t);s.forEach(n=>{Ge.remove(n.src)}),await this.loader.unload(s)}async _detectFormats(t){let s=[];t.preferredFormats&&(s=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const n of t.detections)t.skipDetections||await n.test()?s=await n.add(s):t.skipDetections||(s=await n.remove(s));return s=s.filter((n,r)=>s.indexOf(n)===r),s}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(s=>{s.config&&Object.keys(s.config).filter(n=>n in t).forEach(n=>{s.config[n]=t[n]})})}}const me=new yC;ps.handleByList(mt.LoadParser,me.loader.parsers).handleByList(mt.ResolveParser,me.resolver.parsers).handleByList(mt.CacheParser,me.cache.parsers).handleByList(mt.DetectionParser,me.detections),ps.add(Nk,Bk,Lk,Gk,Fk,Vk,zk,Xk,qk,rS,sC,Jg,mC,e0,gC);const s0={loader:mt.LoadParser,resolver:mt.ResolveParser,cache:mt.CacheParser,detection:mt.DetectionParser};ps.handle(mt.Asset,e=>{const t=e.ref;Object.entries(s0).filter(([s])=>!!t[s]).forEach(([s,n])=>ps.add(Object.assign(t[s],{extension:t[s].extension??n})))},e=>{const t=e.ref;Object.keys(s0).filter(s=>!!t[s]).forEach(s=>ps.remove(t[s]))}),no=class extends te{constructor(e){e instanceof wr&&(e={context:e});const{context:t,roundPixels:s,...n}=e||{};super({label:"Graphics",...n}),this.canBundle=!0,this.renderPipeId="graphics",this._roundPixels=0,t?this._context=t:this._context=this._ownedContext=new wr,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=s??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(e){e.addBounds(this._context.bounds)}containsPoint(e){return this._context.containsPoint(e)}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}onViewUpdate(){this._didChangeId+=4096,this._didGraphicsUpdate=!0,!this.didViewUpdate&&(this.didViewUpdate=!0,this.renderGroup&&this.renderGroup.onChildViewUpdate(this))}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||(e==null?void 0:e.context)===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new no(this._context.clone()):(this._ownedContext=null,new no(this._context))}lineStyle(e,t,s){le(he,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return e&&(n.width=e),t&&(n.color=t),s&&(n.alpha=s),this.context.strokeStyle=n,this}beginFill(e,t){le(he,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return e&&(s.color=e),t&&(s.alpha=t),this.context.fillStyle=s,this}endFill(){le(he,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==wr.defaultStrokeStyle.width||e.color!==wr.defaultStrokeStyle.color||e.alpha!==wr.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return le(he,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return le(he,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return le(he,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return le(he,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return le(he,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return le(he,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}},ps.add(Dm,Nm);function jt(){}const n0=e=>e;function r0(e,t){for(const s in t)e[s]=t[s];return e}function o0(e){return e()}function i0(){return Object.create(null)}function Tn(e){e.forEach(o0)}function pl(e){return typeof e=="function"}function ce(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function vC(e){return Object.keys(e).length===0}function bC(e,...t){if(e==null){for(const n of t)n(void 0);return jt}const s=e.subscribe(...t);return s.unsubscribe?()=>s.unsubscribe():s}function en(e,t,s){e.$$.on_destroy.push(bC(t,s))}function wC(e,t,s,n){if(e){const r=a0(e,t,s,n);return e[0](r)}}function a0(e,t,s,n){return e[1]&&n?r0(s.ctx.slice(),e[1](n(t))):s.ctx}function xC(e,t,s,n){if(e[2]&&n){const r=e[2](n(s));if(t.dirty===void 0)return r;if(typeof r=="object"){const o=[],i=Math.max(t.dirty.length,r.length);for(let a=0;a<i;a+=1)o[a]=t.dirty[a]|r[a];return o}return t.dirty|r}return t.dirty}function _C(e,t,s,n,r,o){if(r){const i=a0(t,s,n,o);e.p(i,r)}}function AC(e){if(e.ctx.length>32){const t=[],s=e.ctx.length/32;for(let n=0;n<s;n++)t[n]=-1;return t}return-1}function kC(e){return e&&pl(e.destroy)?e.destroy:jt}const l0=typeof window<"u";let SC=l0?()=>window.performance.now():()=>Date.now(),Su=l0?e=>requestAnimationFrame(e):jt;const mo=new Set;function h0(e){mo.forEach(t=>{t.c(e)||(mo.delete(t),t.f())}),mo.size!==0&&Su(h0)}function CC(e){let t;return mo.size===0&&Su(h0),{promise:new Promise(s=>{mo.add(t={c:e,f:s})}),abort(){mo.delete(t)}}}function V(e,t){e.appendChild(t)}function c0(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function OC(e){const t=q("style");return t.textContent="/* empty */",TC(c0(e),t),t.sheet}function TC(e,t){return V(e.head||e,t),t.sheet}function Ct(e,t,s){e.insertBefore(t,s||null)}function xt(e){e.parentNode&&e.parentNode.removeChild(e)}function PC(e,t){for(let s=0;s<e.length;s+=1)e[s]&&e[s].d(t)}function q(e){return document.createElement(e)}function vt(e){return document.createTextNode(e)}function it(){return vt(" ")}function ml(){return vt("")}function Te(e,t,s,n){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s,n)}function Q(e,t,s){s==null?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function MC(e){return Array.from(e.childNodes)}function ne(e,t){t=""+t,e.data!==t&&(e.data=t)}function u0(e,t){e.value=t??""}function go(e,t,s,n){s==null?e.style.removeProperty(t):e.style.setProperty(t,s,n?"important":"")}function d0(e,t,s){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t){r.selected=!0;return}}(!s||t!==void 0)&&(e.selectedIndex=-1)}function IC(e){const t=e.querySelector(":checked");return t&&t.__value}function yo(e,t,s){e.classList.toggle(t,!!s)}function f0(e,t,{bubbles:s=!1,cancelable:n=!1}={}){return new CustomEvent(e,{detail:t,bubbles:s,cancelable:n})}function p0(e,t){return new e(t)}const gl=new Map;let yl=0;function EC(e){let t=5381,s=e.length;for(;s--;)t=(t<<5)-t^e.charCodeAt(s);return t>>>0}function $C(e,t){const s={stylesheet:OC(t),rules:{}};return gl.set(e,s),s}function m0(e,t,s,n,r,o,i,a=0){const l=16.666/n;let c=`{
`;for(let m=0;m<=1;m+=l){const y=t+(s-t)*o(m);c+=m*100+`%{${i(y,1-y)}}
`}const u=c+`100% {${i(s,1-s)}}
}`,h=`__svelte_${EC(u)}_${a}`,d=c0(e),{stylesheet:f,rules:p}=gl.get(d)||$C(d,e);p[h]||(p[h]=!0,f.insertRule(`@keyframes ${h} ${u}`,f.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${h} ${n}ms linear ${r}ms 1 both`,yl+=1,h}function RC(e,t){const s=(e.style.animation||"").split(", "),n=s.filter(t?o=>o.indexOf(t)<0:o=>o.indexOf("__svelte")===-1),r=s.length-n.length;r&&(e.style.animation=n.join(", "),yl-=r,yl||DC())}function DC(){Su(()=>{yl||(gl.forEach(e=>{const{ownerNode:t}=e.stylesheet;t&&xt(t)}),gl.clear())})}let Oi;function Ti(e){Oi=e}function Cu(){if(!Oi)throw new Error("Function called outside component initialization");return Oi}function Tr(e){Cu().$$.on_mount.push(e)}function g0(e){Cu().$$.on_destroy.push(e)}function Pi(){const e=Cu();return(t,s,{cancelable:n=!1}={})=>{const r=e.$$.callbacks[t];if(r){const o=f0(t,s,{cancelable:n});return r.slice().forEach(i=>{i.call(e,o)}),!o.defaultPrevented}return!0}}function Ou(e,t){const s=e.$$.callbacks[t.type];s&&s.slice().forEach(n=>n.call(this,t))}const vo=[],sn=[];let bo=[];const Tu=[],NC=Promise.resolve();let Pu=!1;function LC(){Pu||(Pu=!0,NC.then(ft))}function wo(e){bo.push(e)}function y0(e){Tu.push(e)}const Mu=new Set;let xo=0;function ft(){if(xo!==0)return;const e=Oi;do{try{for(;xo<vo.length;){const t=vo[xo];xo++,Ti(t),BC(t.$$)}}catch(t){throw vo.length=0,xo=0,t}for(Ti(null),vo.length=0,xo=0;sn.length;)sn.pop()();for(let t=0;t<bo.length;t+=1){const s=bo[t];Mu.has(s)||(Mu.add(s),s())}bo.length=0}while(vo.length);for(;Tu.length;)Tu.pop()();Pu=!1,Mu.clear(),Ti(e)}function BC(e){if(e.fragment!==null){e.update(),Tn(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(wo)}}function jC(e){const t=[],s=[];bo.forEach(n=>e.indexOf(n)===-1?t.push(n):s.push(n)),s.forEach(n=>n()),bo=t}let Mi;function FC(){return Mi||(Mi=Promise.resolve(),Mi.then(()=>{Mi=null})),Mi}function Iu(e,t,s){e.dispatchEvent(f0(`${t?"intro":"outro"}${s}`))}const vl=new Set;let Pn;function Ii(){Pn={r:0,c:[],p:Pn}}function Ei(){Pn.r||Tn(Pn.c),Pn=Pn.p}function dt(e,t){e&&e.i&&(vl.delete(e),e.i(t))}function gt(e,t,s,n){if(e&&e.o){if(vl.has(e))return;vl.add(e),Pn.c.push(()=>{vl.delete(e),n&&(s&&e.d(1),n())}),e.o(t)}else n&&n()}const VC={duration:0};function v0(e,t,s,n){let r=t(e,s,{direction:"both"}),o=n?0:1,i=null,a=null,l=null,c;function u(){l&&RC(e,l)}function h(f,p){const g=f.b-o;return p*=Math.abs(g),{a:o,b:f.b,d:g,duration:p,start:f.start,end:f.start+p,group:f.group}}function d(f){const{delay:p=0,duration:g=300,easing:m=n0,tick:y=jt,css:v}=r||VC,b={start:SC()+p,b:f};f||(b.group=Pn,Pn.r+=1),"inert"in e&&(f?c!==void 0&&(e.inert=c):(c=e.inert,e.inert=!0)),i||a?a=b:(v&&(u(),l=m0(e,o,f,g,p,m,v)),f&&y(0,1),i=h(b,g),wo(()=>Iu(e,f,"start")),CC(w=>{if(a&&w>a.start&&(i=h(a,g),a=null,Iu(e,i.b,"start"),v&&(u(),l=m0(e,o,i.b,i.duration,0,m,r.css))),i){if(w>=i.end)y(o=i.b,1-o),Iu(e,i.b,"end"),a||(i.b?u():--i.group.r||Tn(i.group.c)),i=null;else if(w>=i.start){const S=w-i.start;o=i.a+i.d*m(S/i.duration),y(o,1-o)}}return!!(i||a)}))}return{run(f){pl(r)?FC().then(()=>{r=r({direction:f?"in":"out"}),d(f)}):d(f)},end(){u(),i=a=null}}}function bl(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function zC(e,t){gt(e,1,1,()=>{t.delete(e.key)})}function GC(e,t,s,n,r,o,i,a,l,c,u,h){let d=e.length,f=o.length,p=d;const g={};for(;p--;)g[e[p].key]=p;const m=[],y=new Map,v=new Map,b=[];for(p=f;p--;){const A=h(r,o,p),O=s(A);let P=i.get(O);P?n&&b.push(()=>P.p(A,t)):(P=c(O,A),P.c()),y.set(O,m[p]=P),O in g&&v.set(O,Math.abs(p-g[O]))}const w=new Set,S=new Set;function _(A){dt(A,1),A.m(a,u),i.set(A.key,A),u=A.first,f--}for(;d&&f;){const A=m[f-1],O=e[d-1],P=A.key,R=O.key;A===O?(u=A.first,d--,f--):y.has(R)?!i.has(P)||w.has(P)?_(A):S.has(R)?d--:v.get(P)>v.get(R)?(S.add(P),_(A)):(w.add(R),d--):(l(O,i),d--)}for(;d--;){const A=e[d];y.has(A.key)||l(A,i)}for(;f;)_(m[f-1]);return Tn(b),m}function b0(e,t){const s={},n={},r={$$scope:1};let o=e.length;for(;o--;){const i=e[o],a=t[o];if(a){for(const l in i)l in a||(n[l]=1);for(const l in a)r[l]||(s[l]=a[l],r[l]=1);e[o]=a}else for(const l in i)r[l]=1}for(const i in n)i in s||(s[i]=void 0);return s}function w0(e){return typeof e=="object"&&e!==null?e:{}}function x0(e,t,s){const n=e.$$.props[t];n!==void 0&&(e.$$.bound[n]=s,s(e.$$.ctx[n]))}function Pt(e){e&&e.c()}function Ot(e,t,s){const{fragment:n,after_update:r}=e.$$;n&&n.m(t,s),wo(()=>{const o=e.$$.on_mount.map(o0).filter(pl);e.$$.on_destroy?e.$$.on_destroy.push(...o):Tn(o),e.$$.on_mount=[]}),r.forEach(wo)}function Tt(e,t){const s=e.$$;s.fragment!==null&&(jC(s.after_update),Tn(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function UC(e,t){e.$$.dirty[0]===-1&&(vo.push(e),LC(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ge(e,t,s,n,r,o,i=null,a=[-1]){const l=Oi;Ti(e);const c=e.$$={fragment:null,ctx:[],props:o,update:jt,not_equal:r,bound:i0(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:i0(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};i&&i(c.root);let u=!1;if(c.ctx=s?s(e,t.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return c.ctx&&r(c.ctx[h],c.ctx[h]=p)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](p),u&&UC(e,h)),d}):[],c.update(),u=!0,Tn(c.before_update),c.fragment=n?n(c.ctx):!1,t.target){if(t.hydrate){const h=MC(t.target);c.fragment&&c.fragment.l(h),h.forEach(xt)}else c.fragment&&c.fragment.c();t.intro&&dt(e.$$.fragment),Ot(e,t.target,t.anchor),ft()}Ti(l)}class ye{constructor(){Ua(this,"$$");Ua(this,"$$set")}$destroy(){Tt(this,1),this.$destroy=jt}$on(t,s){if(!pl(s))return jt;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(s),()=>{const r=n.indexOf(s);r!==-1&&n.splice(r,1)}}$set(t){this.$$set&&!vC(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const HC="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(HC);const _o=[];function WC(e,t){return{subscribe:Mn(e,t).subscribe}}function Mn(e,t=jt){let s;const n=new Set;function r(a){if(ce(e,a)&&(e=a,s)){const l=!_o.length;for(const c of n)c[1](),_o.push(c,e);if(l){for(let c=0;c<_o.length;c+=2)_o[c][0](_o[c+1]);_o.length=0}}}function o(a){r(a(e))}function i(a,l=jt){const c=[a,l];return n.add(c),n.size===1&&(s=t(r,o)||jt),a(e),()=>{n.delete(c),n.size===0&&s&&(s(),s=null)}}return{set:r,update:o,subscribe:i}}function XC(){const{subscribe:e,set:t}=Mn({component:null,props:{}});return{subscribe:e,set(s,n=null){t({component:s,props:n})}}}const nn=XC();function _0(e){let t,s,n;const r=[e[0].props];var o=e[0].component;function i(a,l){let c={};if(l!==void 0&&l&1)c=b0(r,[w0(a[0].props)]);else for(let u=0;u<r.length;u+=1)c=r0(c,r[u]);return{props:c}}return o&&(t=p0(o,i(e))),{c(){t&&Pt(t.$$.fragment),s=ml()},m(a,l){t&&Ot(t,a,l),Ct(a,s,l),n=!0},p(a,l){if(l&1&&o!==(o=a[0].component)){if(t){Ii();const c=t;gt(c.$$.fragment,1,0,()=>{Tt(c,1)}),Ei()}o?(t=p0(o,i(a,l)),Pt(t.$$.fragment),dt(t.$$.fragment,1),Ot(t,s.parentNode,s)):t=null}else if(o){const c=l&1?b0(r,[w0(a[0].props)]):{};t.$set(c)}},i(a){n||(t&&dt(t.$$.fragment,a),n=!0)},o(a){t&&gt(t.$$.fragment,a),n=!1},d(a){a&&xt(s),t&&Tt(t,a)}}}function YC(e){let t,s,n=e[0].component!==null&&_0(e);return{c(){n&&n.c(),t=ml()},m(r,o){n&&n.m(r,o),Ct(r,t,o),s=!0},p(r,[o]){r[0].component!==null?n?(n.p(r,o),o&1&&dt(n,1)):(n=_0(r),n.c(),dt(n,1),n.m(t.parentNode,t)):n&&(Ii(),gt(n,1,1,()=>{n=null}),Ei())},i(r){s||(dt(n),s=!0)},o(r){gt(n),s=!1},d(r){r&&xt(t),n&&n.d(r)}}}function ZC(e,t,s){let n;return en(e,nn,r=>s(0,n=r)),[n]}class qC extends ye{constructor(t){super(),ge(this,t,ZC,YC,ce,{})}}var Ao={};(function(e){(function(){var t=function(){this.init()};t.prototype={init:function(){var h=this||s;return h._counter=1e3,h._html5AudioPool=[],h.html5PoolSize=10,h._codecs={},h._howls=[],h._muted=!1,h._volume=1,h._canPlayEvent="canplaythrough",h._navigator=typeof window<"u"&&window.navigator?window.navigator:null,h.masterGain=null,h.noAudio=!1,h.usingWebAudio=!0,h.autoSuspend=!0,h.ctx=null,h.autoUnlock=!0,h._setup(),h},volume:function(h){var d=this||s;if(h=parseFloat(h),d.ctx||u(),typeof h<"u"&&h>=0&&h<=1){if(d._volume=h,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h,s.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),g=0;g<p.length;g++){var m=d._howls[f]._soundById(p[g]);m&&m._node&&(m._node.volume=m._volume*h)}return d}return d._volume},mute:function(h){var d=this||s;d.ctx||u(),d._muted=h,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h?0:d._volume,s.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),g=0;g<p.length;g++){var m=d._howls[f]._soundById(p[g]);m&&m._node&&(m._node.muted=h?!0:m._muted)}return d},stop:function(){for(var h=this||s,d=0;d<h._howls.length;d++)h._howls[d].stop();return h},unload:function(){for(var h=this||s,d=h._howls.length-1;d>=0;d--)h._howls[d].unload();return h.usingWebAudio&&h.ctx&&typeof h.ctx.close<"u"&&(h.ctx.close(),h.ctx=null,u()),h},codecs:function(h){return(this||s)._codecs[h.replace(/^x-/,"")]},_setup:function(){var h=this||s;if(h.state=h.ctx&&h.ctx.state||"suspended",h._autoSuspend(),!h.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(h._canPlayEvent="canplay")}catch{h.noAudio=!0}else h.noAudio=!0;try{var d=new Audio;d.muted&&(h.noAudio=!0)}catch{}return h.noAudio||h._setupCodecs(),h},_setupCodecs:function(){var h=this||s,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return h}if(!d||typeof d.canPlayType!="function")return h;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),p=h._navigator?h._navigator.userAgent:"",g=p.match(/OPR\/(\d+)/g),m=g&&parseInt(g[0].split("/")[1],10)<33,y=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,v=p.match(/Version\/(.*?) /),b=y&&v&&parseInt(v[1],10)<15;return h._codecs={mp3:!!(!m&&(f||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},h},_unlockAudio:function(){var h=this||s;if(!(h._audioUnlocked||!h.ctx)){h._audioUnlocked=!1,h.autoUnlock=!1,!h._mobileUnloaded&&h.ctx.sampleRate!==44100&&(h._mobileUnloaded=!0,h.unload()),h._scratchBuffer=h.ctx.createBuffer(1,1,22050);var d=function(f){for(;h._html5AudioPool.length<h.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,h._releaseHtml5Audio(p)}catch{h.noAudio=!0;break}for(var g=0;g<h._howls.length;g++)if(!h._howls[g]._webAudio)for(var m=h._howls[g]._getSoundIds(),y=0;y<m.length;y++){var v=h._howls[g]._soundById(m[y]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}h._autoResume();var b=h.ctx.createBufferSource();b.buffer=h._scratchBuffer,b.connect(h.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof h.ctx.resume=="function"&&h.ctx.resume(),b.onended=function(){b.disconnect(0),h._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var w=0;w<h._howls.length;w++)h._howls[w]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),h}},_obtainHtml5Audio:function(){var h=this||s;if(h._html5AudioPool.length)return h._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(h){var d=this||s;return h._unlocked&&d._html5AudioPool.push(h),d},_autoSuspend:function(){var h=this;if(!(!h.autoSuspend||!h.ctx||typeof h.ctx.suspend>"u"||!s.usingWebAudio)){for(var d=0;d<h._howls.length;d++)if(h._howls[d]._webAudio){for(var f=0;f<h._howls[d]._sounds.length;f++)if(!h._howls[d]._sounds[f]._paused)return h}return h._suspendTimer&&clearTimeout(h._suspendTimer),h._suspendTimer=setTimeout(function(){if(h.autoSuspend){h._suspendTimer=null,h.state="suspending";var p=function(){h.state="suspended",h._resumeAfterSuspend&&(delete h._resumeAfterSuspend,h._autoResume())};h.ctx.suspend().then(p,p)}},3e4),h}},_autoResume:function(){var h=this;if(!(!h.ctx||typeof h.ctx.resume>"u"||!s.usingWebAudio))return h.state==="running"&&h.ctx.state!=="interrupted"&&h._suspendTimer?(clearTimeout(h._suspendTimer),h._suspendTimer=null):h.state==="suspended"||h.state==="running"&&h.ctx.state==="interrupted"?(h.ctx.resume().then(function(){h.state="running";for(var d=0;d<h._howls.length;d++)h._howls[d]._emit("resume")}),h._suspendTimer&&(clearTimeout(h._suspendTimer),h._suspendTimer=null)):h.state==="suspending"&&(h._resumeAfterSuspend=!0),h}};var s=new t,n=function(h){var d=this;if(!h.src||h.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(h)};n.prototype={init:function(h){var d=this;return s.ctx||u(),d._autoplay=h.autoplay||!1,d._format=typeof h.format!="string"?h.format:[h.format],d._html5=h.html5||!1,d._muted=h.mute||!1,d._loop=h.loop||!1,d._pool=h.pool||5,d._preload=typeof h.preload=="boolean"||h.preload==="metadata"?h.preload:!0,d._rate=h.rate||1,d._sprite=h.sprite||{},d._src=typeof h.src!="string"?h.src:[h.src],d._volume=h.volume!==void 0?h.volume:1,d._xhr={method:h.xhr&&h.xhr.method?h.xhr.method:"GET",headers:h.xhr&&h.xhr.headers?h.xhr.headers:null,withCredentials:h.xhr&&h.xhr.withCredentials?h.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=h.onend?[{fn:h.onend}]:[],d._onfade=h.onfade?[{fn:h.onfade}]:[],d._onload=h.onload?[{fn:h.onload}]:[],d._onloaderror=h.onloaderror?[{fn:h.onloaderror}]:[],d._onplayerror=h.onplayerror?[{fn:h.onplayerror}]:[],d._onpause=h.onpause?[{fn:h.onpause}]:[],d._onplay=h.onplay?[{fn:h.onplay}]:[],d._onstop=h.onstop?[{fn:h.onstop}]:[],d._onmute=h.onmute?[{fn:h.onmute}]:[],d._onvolume=h.onvolume?[{fn:h.onvolume}]:[],d._onrate=h.onrate?[{fn:h.onrate}]:[],d._onseek=h.onseek?[{fn:h.onseek}]:[],d._onunlock=h.onunlock?[{fn:h.onunlock}]:[],d._onresume=[],d._webAudio=s.usingWebAudio&&!d._html5,typeof s.ctx<"u"&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var h=this,d=null;if(s.noAudio){h._emit("loaderror",null,"No audio support.");return}typeof h._src=="string"&&(h._src=[h._src]);for(var f=0;f<h._src.length;f++){var p,g;if(h._format&&h._format[f])p=h._format[f];else{if(g=h._src[f],typeof g!="string"){h._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(g),p||(p=/\.([^.]+)$/.exec(g.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&s.codecs(p)){d=h._src[f];break}}if(!d){h._emit("loaderror",null,"No codec support for selected audio sources.");return}return h._src=d,h._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(h._html5=!0,h._webAudio=!1),new r(h),h._webAudio&&i(h),h},play:function(h,d){var f=this,p=null;if(typeof h=="number")p=h,h=null;else{if(typeof h=="string"&&f._state==="loaded"&&!f._sprite[h])return null;if(typeof h>"u"&&(h="__default",!f._playLock)){for(var g=0,m=0;m<f._sounds.length;m++)f._sounds[m]._paused&&!f._sounds[m]._ended&&(g++,p=f._sounds[m]._id);g===1?h=null:p=null}}var y=p?f._soundById(p):f._inactiveSound();if(!y)return null;if(p&&!h&&(h=y._sprite||"__default"),f._state!=="loaded"){y._sprite=h,y._ended=!1;var v=y._id;return f._queue.push({event:"play",action:function(){f.play(v)}}),v}if(p&&!y._paused)return d||f._loadQueue("play"),y._id;f._webAudio&&s._autoResume();var b=Math.max(0,y._seek>0?y._seek:f._sprite[h][0]/1e3),w=Math.max(0,(f._sprite[h][0]+f._sprite[h][1])/1e3-b),S=w*1e3/Math.abs(y._rate),_=f._sprite[h][0]/1e3,A=(f._sprite[h][0]+f._sprite[h][1])/1e3;y._sprite=h,y._ended=!1;var O=function(){y._paused=!1,y._seek=b,y._start=_,y._stop=A,y._loop=!!(y._loop||f._sprite[h][2])};if(b>=A){f._ended(y);return}var P=y._node;if(f._webAudio){var R=function(){f._playLock=!1,O(),f._refreshBuffer(y);var j=y._muted||f._muted?0:y._volume;P.gain.setValueAtTime(j,s.ctx.currentTime),y._playStart=s.ctx.currentTime,typeof P.bufferSource.start>"u"?y._loop?P.bufferSource.noteGrainOn(0,b,86400):P.bufferSource.noteGrainOn(0,b,w):y._loop?P.bufferSource.start(0,b,86400):P.bufferSource.start(0,b,w),S!==1/0&&(f._endTimers[y._id]=setTimeout(f._ended.bind(f,y),S)),d||setTimeout(function(){f._emit("play",y._id),f._loadQueue()},0)};s.state==="running"&&s.ctx.state!=="interrupted"?R():(f._playLock=!0,f.once("resume",R),f._clearTimer(y._id))}else{var X=function(){P.currentTime=b,P.muted=y._muted||f._muted||s._muted||P.muted,P.volume=y._volume*s.volume(),P.playbackRate=y._rate;try{var j=P.play();if(j&&typeof Promise<"u"&&(j instanceof Promise||typeof j.then=="function")?(f._playLock=!0,O(),j.then(function(){f._playLock=!1,P._unlocked=!0,d?f._loadQueue():f._emit("play",y._id)}).catch(function(){f._playLock=!1,f._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),y._ended=!0,y._paused=!0})):d||(f._playLock=!1,O(),f._emit("play",y._id)),P.playbackRate=y._rate,P.paused){f._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}h!=="__default"||y._loop?f._endTimers[y._id]=setTimeout(f._ended.bind(f,y),S):(f._endTimers[y._id]=function(){f._ended(y),P.removeEventListener("ended",f._endTimers[y._id],!1)},P.addEventListener("ended",f._endTimers[y._id],!1))}catch(K){f._emit("playerror",y._id,K)}};P.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(P.src=f._src,P.load());var B=window&&window.ejecta||!P.readyState&&s._navigator.isCocoonJS;if(P.readyState>=3||B)X();else{f._playLock=!0,f._state="loading";var H=function(){f._state="loaded",X(),P.removeEventListener(s._canPlayEvent,H,!1)};P.addEventListener(s._canPlayEvent,H,!1),f._clearTimer(y._id)}}return y._id},pause:function(h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(h)}}),d;for(var f=d._getSoundIds(h),p=0;p<f.length;p++){d._clearTimer(f[p]);var g=d._soundById(f[p]);if(g&&!g._paused&&(g._seek=d.seek(f[p]),g._rateSeek=0,g._paused=!0,d._stopFade(f[p]),g._node))if(d._webAudio){if(!g._node.bufferSource)continue;typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),d._cleanBuffer(g._node)}else(!isNaN(g._node.duration)||g._node.duration===1/0)&&g._node.pause();arguments[1]||d._emit("pause",g?g._id:null)}return d},stop:function(h,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(h)}}),f;for(var p=f._getSoundIds(h),g=0;g<p.length;g++){f._clearTimer(p[g]);var m=f._soundById(p[g]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,f._stopFade(p[g]),m._node&&(f._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),f._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&f._clearSound(m._node))),d||f._emit("stop",m._id))}return f},mute:function(h,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(h,d)}}),f;if(typeof d>"u")if(typeof h=="boolean")f._muted=h;else return f._muted;for(var p=f._getSoundIds(d),g=0;g<p.length;g++){var m=f._soundById(p[g]);m&&(m._muted=h,m._interval&&f._stopFade(m._id),f._webAudio&&m._node?m._node.gain.setValueAtTime(h?0:m._volume,s.ctx.currentTime):m._node&&(m._node.muted=s._muted?!0:h),f._emit("mute",m._id))}return f},volume:function(){var h=this,d=arguments,f,p;if(d.length===0)return h._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var g=h._getSoundIds(),m=g.indexOf(d[0]);m>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length>=2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var y;if(typeof f<"u"&&f>=0&&f<=1){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"volume",action:function(){h.volume.apply(h,d)}}),h;typeof p>"u"&&(h._volume=f),p=h._getSoundIds(p);for(var v=0;v<p.length;v++)y=h._soundById(p[v]),y&&(y._volume=f,d[2]||h._stopFade(p[v]),h._webAudio&&y._node&&!y._muted?y._node.gain.setValueAtTime(f,s.ctx.currentTime):y._node&&!y._muted&&(y._node.volume=f*s.volume()),h._emit("volume",y._id))}else return y=p?h._soundById(p):h._sounds[0],y?y._volume:0;return h},fade:function(h,d,f,p){var g=this;if(g._state!=="loaded"||g._playLock)return g._queue.push({event:"fade",action:function(){g.fade(h,d,f,p)}}),g;h=Math.min(Math.max(0,parseFloat(h)),1),d=Math.min(Math.max(0,parseFloat(d)),1),f=parseFloat(f),g.volume(h,p);for(var m=g._getSoundIds(p),y=0;y<m.length;y++){var v=g._soundById(m[y]);if(v){if(p||g._stopFade(m[y]),g._webAudio&&!v._muted){var b=s.ctx.currentTime,w=b+f/1e3;v._volume=h,v._node.gain.setValueAtTime(h,b),v._node.gain.linearRampToValueAtTime(d,w)}g._startFadeInterval(v,h,d,f,m[y],typeof p>"u")}}return g},_startFadeInterval:function(h,d,f,p,g,m){var y=this,v=d,b=f-d,w=Math.abs(b/.01),S=Math.max(4,w>0?p/w:p),_=Date.now();h._fadeTo=f,h._interval=setInterval(function(){var A=(Date.now()-_)/p;_=Date.now(),v+=b*A,v=Math.round(v*100)/100,b<0?v=Math.max(f,v):v=Math.min(f,v),y._webAudio?h._volume=v:y.volume(v,h._id,!0),m&&(y._volume=v),(f<d&&v<=f||f>d&&v>=f)&&(clearInterval(h._interval),h._interval=null,h._fadeTo=null,y.volume(f,h._id),y._emit("fade",h._id))},S)},_stopFade:function(h){var d=this,f=d._soundById(h);return f&&f._interval&&(d._webAudio&&f._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(f._interval),f._interval=null,d.volume(f._fadeTo,h),f._fadeTo=null,d._emit("fade",h)),d},loop:function(){var h=this,d=arguments,f,p,g;if(d.length===0)return h._loop;if(d.length===1)if(typeof d[0]=="boolean")f=d[0],h._loop=f;else return g=h._soundById(parseInt(d[0],10)),g?g._loop:!1;else d.length===2&&(f=d[0],p=parseInt(d[1],10));for(var m=h._getSoundIds(p),y=0;y<m.length;y++)g=h._soundById(m[y]),g&&(g._loop=f,h._webAudio&&g._node&&g._node.bufferSource&&(g._node.bufferSource.loop=f,f&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop,h.playing(m[y])&&(h.pause(m[y],!0),h.play(m[y],!0)))));return h},rate:function(){var h=this,d=arguments,f,p;if(d.length===0)p=h._sounds[0]._id;else if(d.length===1){var g=h._getSoundIds(),m=g.indexOf(d[0]);m>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var y;if(typeof f=="number"){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"rate",action:function(){h.rate.apply(h,d)}}),h;typeof p>"u"&&(h._rate=f),p=h._getSoundIds(p);for(var v=0;v<p.length;v++)if(y=h._soundById(p[v]),y){h.playing(p[v])&&(y._rateSeek=h.seek(p[v]),y._playStart=h._webAudio?s.ctx.currentTime:y._playStart),y._rate=f,h._webAudio&&y._node&&y._node.bufferSource?y._node.bufferSource.playbackRate.setValueAtTime(f,s.ctx.currentTime):y._node&&(y._node.playbackRate=f);var b=h.seek(p[v]),w=(h._sprite[y._sprite][0]+h._sprite[y._sprite][1])/1e3-b,S=w*1e3/Math.abs(y._rate);(h._endTimers[p[v]]||!y._paused)&&(h._clearTimer(p[v]),h._endTimers[p[v]]=setTimeout(h._ended.bind(h,y),S)),h._emit("rate",y._id)}}else return y=h._soundById(p),y?y._rate:h._rate;return h},seek:function(){var h=this,d=arguments,f,p;if(d.length===0)h._sounds.length&&(p=h._sounds[0]._id);else if(d.length===1){var g=h._getSoundIds(),m=g.indexOf(d[0]);m>=0?p=parseInt(d[0],10):h._sounds.length&&(p=h._sounds[0]._id,f=parseFloat(d[0]))}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));if(typeof p>"u")return 0;if(typeof f=="number"&&(h._state!=="loaded"||h._playLock))return h._queue.push({event:"seek",action:function(){h.seek.apply(h,d)}}),h;var y=h._soundById(p);if(y)if(typeof f=="number"&&f>=0){var v=h.playing(p);v&&h.pause(p,!0),y._seek=f,y._ended=!1,h._clearTimer(p),!h._webAudio&&y._node&&!isNaN(y._node.duration)&&(y._node.currentTime=f);var b=function(){v&&h.play(p,!0),h._emit("seek",p)};if(v&&!h._webAudio){var w=function(){h._playLock?setTimeout(w,0):b()};setTimeout(w,0)}else b()}else if(h._webAudio){var S=h.playing(p)?s.ctx.currentTime-y._playStart:0,_=y._rateSeek?y._rateSeek-y._seek:0;return y._seek+(_+S*Math.abs(y._rate))}else return y._node.currentTime;return h},playing:function(h){var d=this;if(typeof h=="number"){var f=d._soundById(h);return f?!f._paused:!1}for(var p=0;p<d._sounds.length;p++)if(!d._sounds[p]._paused)return!0;return!1},duration:function(h){var d=this,f=d._duration,p=d._soundById(h);return p&&(f=d._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var h=this,d=h._sounds,f=0;f<d.length;f++)d[f]._paused||h.stop(d[f]._id),h._webAudio||(h._clearSound(d[f]._node),d[f]._node.removeEventListener("error",d[f]._errorFn,!1),d[f]._node.removeEventListener(s._canPlayEvent,d[f]._loadFn,!1),d[f]._node.removeEventListener("ended",d[f]._endFn,!1),s._releaseHtml5Audio(d[f]._node)),delete d[f]._node,h._clearTimer(d[f]._id);var p=s._howls.indexOf(h);p>=0&&s._howls.splice(p,1);var g=!0;for(f=0;f<s._howls.length;f++)if(s._howls[f]._src===h._src||h._src.indexOf(s._howls[f]._src)>=0){g=!1;break}return o&&g&&delete o[h._src],s.noAudio=!1,h._state="unloaded",h._sounds=[],h=null,null},on:function(h,d,f,p){var g=this,m=g["_on"+h];return typeof d=="function"&&m.push(p?{id:f,fn:d,once:p}:{id:f,fn:d}),g},off:function(h,d,f){var p=this,g=p["_on"+h],m=0;if(typeof d=="number"&&(f=d,d=null),d||f)for(m=0;m<g.length;m++){var y=f===g[m].id;if(d===g[m].fn&&y||!d&&y){g.splice(m,1);break}}else if(h)p["_on"+h]=[];else{var v=Object.keys(p);for(m=0;m<v.length;m++)v[m].indexOf("_on")===0&&Array.isArray(p[v[m]])&&(p[v[m]]=[])}return p},once:function(h,d,f){var p=this;return p.on(h,d,f,1),p},_emit:function(h,d,f){for(var p=this,g=p["_on"+h],m=g.length-1;m>=0;m--)(!g[m].id||g[m].id===d||h==="load")&&(setTimeout((function(y){y.call(this,d,f)}).bind(p,g[m].fn),0),g[m].once&&p.off(h,g[m].fn,g[m].id));return p._loadQueue(h),p},_loadQueue:function(h){var d=this;if(d._queue.length>0){var f=d._queue[0];f.event===h&&(d._queue.shift(),d._loadQueue()),h||f.action()}return d},_ended:function(h){var d=this,f=h._sprite;if(!d._webAudio&&h._node&&!h._node.paused&&!h._node.ended&&h._node.currentTime<h._stop)return setTimeout(d._ended.bind(d,h),100),d;var p=!!(h._loop||d._sprite[f][2]);if(d._emit("end",h._id),!d._webAudio&&p&&d.stop(h._id,!0).play(h._id),d._webAudio&&p){d._emit("play",h._id),h._seek=h._start||0,h._rateSeek=0,h._playStart=s.ctx.currentTime;var g=(h._stop-h._start)*1e3/Math.abs(h._rate);d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),g)}return d._webAudio&&!p&&(h._paused=!0,h._ended=!0,h._seek=h._start||0,h._rateSeek=0,d._clearTimer(h._id),d._cleanBuffer(h._node),s._autoSuspend()),!d._webAudio&&!p&&d.stop(h._id,!0),d},_clearTimer:function(h){var d=this;if(d._endTimers[h]){if(typeof d._endTimers[h]!="function")clearTimeout(d._endTimers[h]);else{var f=d._soundById(h);f&&f._node&&f._node.removeEventListener("ended",d._endTimers[h],!1)}delete d._endTimers[h]}return d},_soundById:function(h){for(var d=this,f=0;f<d._sounds.length;f++)if(h===d._sounds[f]._id)return d._sounds[f];return null},_inactiveSound:function(){var h=this;h._drain();for(var d=0;d<h._sounds.length;d++)if(h._sounds[d]._ended)return h._sounds[d].reset();return new r(h)},_drain:function(){var h=this,d=h._pool,f=0,p=0;if(!(h._sounds.length<d)){for(p=0;p<h._sounds.length;p++)h._sounds[p]._ended&&f++;for(p=h._sounds.length-1;p>=0;p--){if(f<=d)return;h._sounds[p]._ended&&(h._webAudio&&h._sounds[p]._node&&h._sounds[p]._node.disconnect(0),h._sounds.splice(p,1),f--)}}},_getSoundIds:function(h){var d=this;if(typeof h>"u"){for(var f=[],p=0;p<d._sounds.length;p++)f.push(d._sounds[p]._id);return f}else return[h]},_refreshBuffer:function(h){var d=this;return h._node.bufferSource=s.ctx.createBufferSource(),h._node.bufferSource.buffer=o[d._src],h._panner?h._node.bufferSource.connect(h._panner):h._node.bufferSource.connect(h._node),h._node.bufferSource.loop=h._loop,h._loop&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop||0),h._node.bufferSource.playbackRate.setValueAtTime(h._rate,s.ctx.currentTime),d},_cleanBuffer:function(h){var d=this,f=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(!h.bufferSource)return d;if(s._scratchBuffer&&h.bufferSource&&(h.bufferSource.onended=null,h.bufferSource.disconnect(0),f))try{h.bufferSource.buffer=s._scratchBuffer}catch{}return h.bufferSource=null,d},_clearSound:function(h){var d=/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent);d||(h.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(h){this._parent=h,this.init()};r.prototype={init:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++s._counter,d._sounds.push(h),h.create(),h},create:function(){var h=this,d=h._parent,f=s._muted||h._muted||h._parent._muted?0:h._volume;return d._webAudio?(h._node=typeof s.ctx.createGain>"u"?s.ctx.createGainNode():s.ctx.createGain(),h._node.gain.setValueAtTime(f,s.ctx.currentTime),h._node.paused=!0,h._node.connect(s.masterGain)):s.noAudio||(h._node=s._obtainHtml5Audio(),h._errorFn=h._errorListener.bind(h),h._node.addEventListener("error",h._errorFn,!1),h._loadFn=h._loadListener.bind(h),h._node.addEventListener(s._canPlayEvent,h._loadFn,!1),h._endFn=h._endListener.bind(h),h._node.addEventListener("ended",h._endFn,!1),h._node.src=d._src,h._node.preload=d._preload===!0?"auto":d._preload,h._node.volume=f*s.volume(),h._node.load()),h},reset:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._rateSeek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++s._counter,h},_errorListener:function(){var h=this;h._parent._emit("loaderror",h._id,h._node.error?h._node.error.code:0),h._node.removeEventListener("error",h._errorFn,!1)},_loadListener:function(){var h=this,d=h._parent;d._duration=Math.ceil(h._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),h._node.removeEventListener(s._canPlayEvent,h._loadFn,!1)},_endListener:function(){var h=this,d=h._parent;d._duration===1/0&&(d._duration=Math.ceil(h._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(h)),h._node.removeEventListener("ended",h._endFn,!1)}};var o={},i=function(h){var d=h._src;if(o[d]){h._duration=o[d].duration,c(h);return}if(/^data:[^;]+;base64,/.test(d)){for(var f=atob(d.split(",")[1]),p=new Uint8Array(f.length),g=0;g<f.length;++g)p[g]=f.charCodeAt(g);l(p.buffer,h)}else{var m=new XMLHttpRequest;m.open(h._xhr.method,d,!0),m.withCredentials=h._xhr.withCredentials,m.responseType="arraybuffer",h._xhr.headers&&Object.keys(h._xhr.headers).forEach(function(y){m.setRequestHeader(y,h._xhr.headers[y])}),m.onload=function(){var y=(m.status+"")[0];if(y!=="0"&&y!=="2"&&y!=="3"){h._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}l(m.response,h)},m.onerror=function(){h._webAudio&&(h._html5=!0,h._webAudio=!1,h._sounds=[],delete o[d],h.load())},a(m)}},a=function(h){try{h.send()}catch{h.onerror()}},l=function(h,d){var f=function(){d._emit("loaderror",null,"Decoding audio data failed.")},p=function(g){g&&d._sounds.length>0?(o[d._src]=g,c(d,g)):f()};typeof Promise<"u"&&s.ctx.decodeAudioData.length===1?s.ctx.decodeAudioData(h).then(p).catch(f):s.ctx.decodeAudioData(h,p,f)},c=function(h,d){d&&!h._duration&&(h._duration=d.duration),Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue())},u=function(){if(s.usingWebAudio){try{typeof AudioContext<"u"?s.ctx=new AudioContext:typeof webkitAudioContext<"u"?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch{s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var h=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),d=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=d?parseInt(d[1],10):null;if(h&&f&&f<9){var p=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!p&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=typeof s.ctx.createGain>"u"?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};e.Howler=s,e.Howl=n,typeof oo<"u"?(oo.HowlerGlobal=t,oo.Howler=s,oo.Howl=n,oo.Sound=r):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=s,window.Howl=n,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(s){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(s);return n},HowlerGlobal.prototype.pos=function(s,n,r){var o=this;if(!o.ctx||!o.ctx.listener)return o;if(n=typeof n!="number"?o._pos[1]:n,r=typeof r!="number"?o._pos[2]:r,typeof s=="number")o._pos=[s,n,r],typeof o.ctx.listener.positionX<"u"?(o.ctx.listener.positionX.setTargetAtTime(o._pos[0],Howler.ctx.currentTime,.1),o.ctx.listener.positionY.setTargetAtTime(o._pos[1],Howler.ctx.currentTime,.1),o.ctx.listener.positionZ.setTargetAtTime(o._pos[2],Howler.ctx.currentTime,.1)):o.ctx.listener.setPosition(o._pos[0],o._pos[1],o._pos[2]);else return o._pos;return o},HowlerGlobal.prototype.orientation=function(s,n,r,o,i,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(n=typeof n!="number"?c[1]:n,r=typeof r!="number"?c[2]:r,o=typeof o!="number"?c[3]:o,i=typeof i!="number"?c[4]:i,a=typeof a!="number"?c[5]:a,typeof s=="number")l._orientation=[s,n,r,o,i,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(s,n,r,o,i,a);else return c;return l},Howl.prototype.init=function(s){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],s.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(s,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(s,n)}}),r;var o=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof s=="number")r._stereo=s,r._pos=[s,0,0];else return r._stereo;for(var i=r._getSoundIds(n),a=0;a<i.length;a++){var l=r._soundById(i[a]);if(l)if(typeof s=="number")l._stereo=s,l._pos=[s,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&t(l,o),o==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(s,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(s,0,0):l._panner.pan.setValueAtTime(s,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(s,n,r,o){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"pos",action:function(){i.pos(s,n,r,o)}}),i;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof o>"u")if(typeof s=="number")i._pos=[s,n,r];else return i._pos;for(var a=i._getSoundIds(o),l=0;l<a.length;l++){var c=i._soundById(a[l]);if(c)if(typeof s=="number")c._pos=[s,n,r],c._node&&((!c._panner||c._panner.pan)&&t(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(s,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setPosition(s,n,r)),i._emit("pos",c._id);else return c._pos}return i},Howl.prototype.orientation=function(s,n,r,o){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"orientation",action:function(){i.orientation(s,n,r,o)}}),i;if(n=typeof n!="number"?i._orientation[1]:n,r=typeof r!="number"?i._orientation[2]:r,typeof o>"u")if(typeof s=="number")i._orientation=[s,n,r];else return i._orientation;for(var a=i._getSoundIds(o),l=0;l<a.length;l++){var c=i._soundById(a[l]);if(c)if(typeof s=="number")c._orientation=[s,n,r],c._node&&(c._panner||(c._pos||(c._pos=i._pos||[0,0,-.5]),t(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(s,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setOrientation(s,n,r)),i._emit("orientation",c._id);else return c._orientation}return i},Howl.prototype.pannerAttr=function(){var s=this,n=arguments,r,o,i;if(!s._webAudio)return s;if(n.length===0)return s._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof o>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),s._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:s._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:s._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:s._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:s._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:s._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:s._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:s._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:s._panningModel});else return i=s._soundById(parseInt(n[0],10)),i?i._pannerAttr:s._pannerAttr;else n.length===2&&(r=n[0],o=parseInt(n[1],10));for(var a=s._getSoundIds(o),l=0;l<a.length;l++)if(i=s._soundById(a[l]),i){var c=i._pannerAttr;c={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:c.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:c.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:c.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:c.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:c.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:c.panningModel};var u=i._panner;u||(i._pos||(i._pos=s._pos||[0,0,-.5]),t(i,"spatial"),u=i._panner),u.coneInnerAngle=c.coneInnerAngle,u.coneOuterAngle=c.coneOuterAngle,u.coneOuterGain=c.coneOuterGain,u.distanceModel=c.distanceModel,u.maxDistance=c.maxDistance,u.refDistance=c.refDistance,u.rolloffFactor=c.rolloffFactor,u.panningModel=c.panningModel}return s},Sound.prototype.init=function(s){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,s.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(s){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),s.call(this)}}(Sound.prototype.reset);var t=function(s,n){n=n||"spatial",n==="spatial"?(s._panner=Howler.ctx.createPanner(),s._panner.coneInnerAngle=s._pannerAttr.coneInnerAngle,s._panner.coneOuterAngle=s._pannerAttr.coneOuterAngle,s._panner.coneOuterGain=s._pannerAttr.coneOuterGain,s._panner.distanceModel=s._pannerAttr.distanceModel,s._panner.maxDistance=s._pannerAttr.maxDistance,s._panner.refDistance=s._pannerAttr.refDistance,s._panner.rolloffFactor=s._pannerAttr.rolloffFactor,s._panner.panningModel=s._pannerAttr.panningModel,typeof s._panner.positionX<"u"?(s._panner.positionX.setValueAtTime(s._pos[0],Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(s._pos[1],Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(s._pos[2],Howler.ctx.currentTime)):s._panner.setPosition(s._pos[0],s._pos[1],s._pos[2]),typeof s._panner.orientationX<"u"?(s._panner.orientationX.setValueAtTime(s._orientation[0],Howler.ctx.currentTime),s._panner.orientationY.setValueAtTime(s._orientation[1],Howler.ctx.currentTime),s._panner.orientationZ.setValueAtTime(s._orientation[2],Howler.ctx.currentTime)):s._panner.setOrientation(s._orientation[0],s._orientation[1],s._orientation[2])):(s._panner=Howler.ctx.createStereoPanner(),s._panner.pan.setValueAtTime(s._stereo,Howler.ctx.currentTime)),s._panner.connect(s._node),s._paused||s._parent.pause(s._id,!0).play(s._id,!0)}}()})(Ao);const Eu=350,QC=700;let ve=new Ao.Howl({src:[""]});const Lt=Object.freeze({get currentSong(){return ve},get playing(){return ve.playing()},crossfade(e){const t=new Ao.Howl({src:[e],loop:!0}),s=()=>{if(!ve.playing()){ve=t,ve.play(),ve.fade(0,1,Eu);return}t.play(),ve.fade(1,0,Eu),t.fade(0,1,Eu),ve=t};t.state()==="loaded"?s():t.once("load",s)},load(e){return new Promise(t=>{if(ve=new Ao.Howl({src:[e]}),ve.state()==="loaded")return t();ve.once("load",t)})},pause(){return new Promise(e=>{if(!this.playing)return e();ve.once("fade",()=>{ve.pause(),ve.volume(1),e()}),ve.fade(1,0,QC)})},pauseImmediately(){ve.pause()},play(){return new Promise(e=>{ve.once("play",e),ve.play()})},seek(e){ve.seek(e/1e3)}});function $u(e){return new Promise((t,s)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>s(e.error)})}function KC(e,t){const s=indexedDB.open(e);s.onupgradeneeded=()=>s.result.createObjectStore(t);const n=$u(s);return(r,o)=>n.then(i=>o(i.transaction(t,r).objectStore(t)))}let Ru;function A0(){return Ru||(Ru=KC("keyval-store","keyval")),Ru}function JC(e,t=A0()){return t("readonly",s=>$u(s.get(e)))}function ko(e,t,s=A0()){return s("readwrite",n=>(n.put(t,e),$u(n.transaction)))}function tO(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $i={exports:{}};const eO={},sO=Object.freeze(Object.defineProperty({__proto__:null,default:eO},Symbol.toStringTag,{value:"Module"})),nO=kA(sO);var k0=typeof process<"u"&&process.pid?process.pid.toString(36):"",S0="";if(typeof __webpack_require__!="function"&&typeof tO<"u"){var Du="",C0=nO;if(C0.networkInterfaces)var Nu=C0.networkInterfaces();if(Nu){t:for(let e in Nu){const t=Nu[e],s=t.length;for(var So=0;So<s;So++)if(t[So]!==void 0&&t[So].mac&&t[So].mac!="00:00:00:00:00:00"){Du=t[So].mac;break t}}S0=Du?parseInt(Du.replace(/\:|\D+/gi,"")).toString(36):""}}$i.exports=$i.exports.default=function(e,t){return(e||"")+S0+k0+Ri().toString(36)+(t||"")},$i.exports.process=function(e,t){return(e||"")+k0+Ri().toString(36)+(t||"")},$i.exports.time=function(e,t){return(e||"")+Ri().toString(36)+(t||"")};function Ri(){var e=Date.now(),t=Ri.last||e;return Ri.last=e>t?e:t+1}var rO=$i.exports;const oO=gi(rO),O0=`# Click the folder icon at the top-left to change audio and background.

meta:
  title: Title
  artist: Artist
  beats_per_minute: 180
  beats_per_measure: 4

  # approach_rate: [number]
  # start_offset: [number]

events:
  []

  # - at: [time]
  #   type: [bpmi|bpme|ar]
  #   value: [number]

notes:
  []

  # - at: [time]
  #   type: [hit|hold|trick]
  #   [until]: [time]
  #   track: [0-3]
  #   [to_track]: [number]
`,Pr="beatmaps_test";async function iO(){const e=await JC(Pr);e||await ko(Pr,[]);const t=e??[],{subscribe:s,set:n}=Mn(t);return{subscribe:s,delete(r){const o=t.findIndex(i=>i.id===r);if(o===-1)throw new Error("Cannot delete beatmap file from nonexistent ID.");t.splice(o,1),ko(Pr,t),n(t)},get(r){const o=t.find(i=>i.id===r);if(!o)throw new Error("Cannot get beatmap file from nonexistent ID.");return o},new(r,o){const i=oO();return t.push({id:i,assets:o??{audio:null,background:null},yaml:r??O0}),ko(Pr,t),n(t),i},setAudio(r,o){const i=t.find(a=>a.id===r);if(i===null)throw new Error("Cannot set beatmap background from nonexistent ID.");i.assets.audio=o,ko(Pr,t),n(t)},setBackground(r,o){const i=t.find(a=>a.id===r);if(i===null)throw new Error("Cannot set beatmap background from nonexistent ID.");i.assets.background=o,ko(Pr,t),n(t)},setBody(r,o){const i=t.find(a=>a.id===r);if(i===null)throw new Error("Cannot set beatmap body from nonexistent ID.");i.yaml=o,ko(Pr,t),n(t)}}}const ts=await iO();function T0(e){return typeof e>"u"||e===null}function aO(e){return typeof e=="object"&&e!==null}function lO(e){return Array.isArray(e)?e:T0(e)?[]:[e]}function hO(e,t){var s,n,r,o;if(t)for(o=Object.keys(t),s=0,n=o.length;s<n;s+=1)r=o[s],e[r]=t[r];return e}function cO(e,t){var s="",n;for(n=0;n<t;n+=1)s+=e;return s}function uO(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var dO=T0,fO=aO,pO=lO,mO=cO,gO=uO,yO=hO,be={isNothing:dO,isObject:fO,toArray:pO,repeat:mO,isNegativeZero:gO,extend:yO};function P0(e,t){var s="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(s+='in "'+e.mark.name+'" '),s+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(s+=`

`+e.mark.snippet),n+" "+s):n}function Di(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=P0(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}Di.prototype=Object.create(Error.prototype),Di.prototype.constructor=Di,Di.prototype.toString=function(e){return this.name+": "+P0(this,e)};var es=Di;function Lu(e,t,s,n,r){var o="",i="",a=Math.floor(r/2)-1;return n-t>a&&(o=" ... ",t=n-a+o.length),s-n>a&&(i=" ...",s=n+a-i.length),{str:o+e.slice(t,s).replace(/\t/g,"\u2192")+i,pos:n-t+o.length}}function Bu(e,t){return be.repeat(" ",t-e.length)+e}function vO(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var s=/\r?\n|\r|\0/g,n=[0],r=[],o,i=-1;o=s.exec(e.buffer);)r.push(o.index),n.push(o.index+o[0].length),e.position<=o.index&&i<0&&(i=n.length-2);i<0&&(i=n.length-1);var a="",l,c,u=Math.min(e.line+t.linesAfter,r.length).toString().length,h=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(i-l<0);l++)c=Lu(e.buffer,n[i-l],r[i-l],e.position-(n[i]-n[i-l]),h),a=be.repeat(" ",t.indent)+Bu((e.line-l+1).toString(),u)+" | "+c.str+`
`+a;for(c=Lu(e.buffer,n[i],r[i],e.position,h),a+=be.repeat(" ",t.indent)+Bu((e.line+1).toString(),u)+" | "+c.str+`
`,a+=be.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(i+l>=r.length);l++)c=Lu(e.buffer,n[i+l],r[i+l],e.position-(n[i]-n[i+l]),h),a+=be.repeat(" ",t.indent)+Bu((e.line+l+1).toString(),u)+" | "+c.str+`
`;return a.replace(/\n$/,"")}var bO=vO,wO=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],xO=["scalar","sequence","mapping"];function _O(e){var t={};return e!==null&&Object.keys(e).forEach(function(s){e[s].forEach(function(n){t[String(n)]=s})}),t}function AO(e,t){if(t=t||{},Object.keys(t).forEach(function(s){if(wO.indexOf(s)===-1)throw new es('Unknown option "'+s+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(s){return s},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=_O(t.styleAliases||null),xO.indexOf(this.kind)===-1)throw new es('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var Ie=AO;function M0(e,t){var s=[];return e[t].forEach(function(n){var r=s.length;s.forEach(function(o,i){o.tag===n.tag&&o.kind===n.kind&&o.multi===n.multi&&(r=i)}),s[r]=n}),s}function kO(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,s;function n(r){r.multi?(e.multi[r.kind].push(r),e.multi.fallback.push(r)):e[r.kind][r.tag]=e.fallback[r.tag]=r}for(t=0,s=arguments.length;t<s;t+=1)arguments[t].forEach(n);return e}function ju(e){return this.extend(e)}ju.prototype.extend=function(e){var t=[],s=[];if(e instanceof Ie)s.push(e);else if(Array.isArray(e))s=s.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(s=s.concat(e.explicit));else throw new es("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(r){if(!(r instanceof Ie))throw new es("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(r.loadKind&&r.loadKind!=="scalar")throw new es("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(r.multi)throw new es("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),s.forEach(function(r){if(!(r instanceof Ie))throw new es("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var n=Object.create(ju.prototype);return n.implicit=(this.implicit||[]).concat(t),n.explicit=(this.explicit||[]).concat(s),n.compiledImplicit=M0(n,"implicit"),n.compiledExplicit=M0(n,"explicit"),n.compiledTypeMap=kO(n.compiledImplicit,n.compiledExplicit),n};var I0=ju,E0=new Ie("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),$0=new Ie("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),R0=new Ie("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),D0=new I0({explicit:[E0,$0,R0]});function SO(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function CO(){return null}function OO(e){return e===null}var N0=new Ie("tag:yaml.org,2002:null",{kind:"scalar",resolve:SO,construct:CO,predicate:OO,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function TO(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function PO(e){return e==="true"||e==="True"||e==="TRUE"}function MO(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var L0=new Ie("tag:yaml.org,2002:bool",{kind:"scalar",resolve:TO,construct:PO,predicate:MO,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function IO(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function EO(e){return 48<=e&&e<=55}function $O(e){return 48<=e&&e<=57}function RO(e){if(e===null)return!1;var t=e.length,s=0,n=!1,r;if(!t)return!1;if(r=e[s],(r==="-"||r==="+")&&(r=e[++s]),r==="0"){if(s+1===t)return!0;if(r=e[++s],r==="b"){for(s++;s<t;s++)if(r=e[s],r!=="_"){if(r!=="0"&&r!=="1")return!1;n=!0}return n&&r!=="_"}if(r==="x"){for(s++;s<t;s++)if(r=e[s],r!=="_"){if(!IO(e.charCodeAt(s)))return!1;n=!0}return n&&r!=="_"}if(r==="o"){for(s++;s<t;s++)if(r=e[s],r!=="_"){if(!EO(e.charCodeAt(s)))return!1;n=!0}return n&&r!=="_"}}if(r==="_")return!1;for(;s<t;s++)if(r=e[s],r!=="_"){if(!$O(e.charCodeAt(s)))return!1;n=!0}return!(!n||r==="_")}function DO(e){var t=e,s=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(s=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return s*parseInt(t.slice(2),2);if(t[1]==="x")return s*parseInt(t.slice(2),16);if(t[1]==="o")return s*parseInt(t.slice(2),8)}return s*parseInt(t,10)}function NO(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!be.isNegativeZero(e)}var B0=new Ie("tag:yaml.org,2002:int",{kind:"scalar",resolve:RO,construct:DO,predicate:NO,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),LO=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function BO(e){return!(e===null||!LO.test(e)||e[e.length-1]==="_")}function jO(e){var t,s;return t=e.replace(/_/g,"").toLowerCase(),s=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?s===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:s*parseFloat(t,10)}var FO=/^[-+]?[0-9]+e/;function VO(e,t){var s;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(be.isNegativeZero(e))return"-0.0";return s=e.toString(10),FO.test(s)?s.replace("e",".e"):s}function zO(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||be.isNegativeZero(e))}var j0=new Ie("tag:yaml.org,2002:float",{kind:"scalar",resolve:BO,construct:jO,predicate:zO,represent:VO,defaultStyle:"lowercase"}),F0=D0.extend({implicit:[N0,L0,B0,j0]}),V0=F0,z0=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),G0=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function GO(e){return e===null?!1:z0.exec(e)!==null||G0.exec(e)!==null}function UO(e){var t,s,n,r,o,i,a,l=0,c=null,u,h,d;if(t=z0.exec(e),t===null&&(t=G0.exec(e)),t===null)throw new Error("Date resolve error");if(s=+t[1],n=+t[2]-1,r=+t[3],!t[4])return new Date(Date.UTC(s,n,r));if(o=+t[4],i=+t[5],a=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],h=+(t[11]||0),c=(u*60+h)*6e4,t[9]==="-"&&(c=-c)),d=new Date(Date.UTC(s,n,r,o,i,a,l)),c&&d.setTime(d.getTime()-c),d}function HO(e){return e.toISOString()}var U0=new Ie("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:GO,construct:UO,instanceOf:Date,represent:HO});function WO(e){return e==="<<"||e===null}var H0=new Ie("tag:yaml.org,2002:merge",{kind:"scalar",resolve:WO}),Fu=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function XO(e){if(e===null)return!1;var t,s,n=0,r=e.length,o=Fu;for(s=0;s<r;s++)if(t=o.indexOf(e.charAt(s)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function YO(e){var t,s,n=e.replace(/[\r\n=]/g,""),r=n.length,o=Fu,i=0,a=[];for(t=0;t<r;t++)t%4===0&&t&&(a.push(i>>16&255),a.push(i>>8&255),a.push(i&255)),i=i<<6|o.indexOf(n.charAt(t));return s=r%4*6,s===0?(a.push(i>>16&255),a.push(i>>8&255),a.push(i&255)):s===18?(a.push(i>>10&255),a.push(i>>2&255)):s===12&&a.push(i>>4&255),new Uint8Array(a)}function ZO(e){var t="",s=0,n,r,o=e.length,i=Fu;for(n=0;n<o;n++)n%3===0&&n&&(t+=i[s>>18&63],t+=i[s>>12&63],t+=i[s>>6&63],t+=i[s&63]),s=(s<<8)+e[n];return r=o%3,r===0?(t+=i[s>>18&63],t+=i[s>>12&63],t+=i[s>>6&63],t+=i[s&63]):r===2?(t+=i[s>>10&63],t+=i[s>>4&63],t+=i[s<<2&63],t+=i[64]):r===1&&(t+=i[s>>2&63],t+=i[s<<4&63],t+=i[64],t+=i[64]),t}function qO(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var W0=new Ie("tag:yaml.org,2002:binary",{kind:"scalar",resolve:XO,construct:YO,predicate:qO,represent:ZO}),QO=Object.prototype.hasOwnProperty,KO=Object.prototype.toString;function JO(e){if(e===null)return!0;var t=[],s,n,r,o,i,a=e;for(s=0,n=a.length;s<n;s+=1){if(r=a[s],i=!1,KO.call(r)!=="[object Object]")return!1;for(o in r)if(QO.call(r,o))if(!i)i=!0;else return!1;if(!i)return!1;if(t.indexOf(o)===-1)t.push(o);else return!1}return!0}function tT(e){return e!==null?e:[]}var X0=new Ie("tag:yaml.org,2002:omap",{kind:"sequence",resolve:JO,construct:tT}),eT=Object.prototype.toString;function sT(e){if(e===null)return!0;var t,s,n,r,o,i=e;for(o=new Array(i.length),t=0,s=i.length;t<s;t+=1){if(n=i[t],eT.call(n)!=="[object Object]"||(r=Object.keys(n),r.length!==1))return!1;o[t]=[r[0],n[r[0]]]}return!0}function nT(e){if(e===null)return[];var t,s,n,r,o,i=e;for(o=new Array(i.length),t=0,s=i.length;t<s;t+=1)n=i[t],r=Object.keys(n),o[t]=[r[0],n[r[0]]];return o}var Y0=new Ie("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:sT,construct:nT}),rT=Object.prototype.hasOwnProperty;function oT(e){if(e===null)return!0;var t,s=e;for(t in s)if(rT.call(s,t)&&s[t]!==null)return!1;return!0}function iT(e){return e!==null?e:{}}var Z0=new Ie("tag:yaml.org,2002:set",{kind:"mapping",resolve:oT,construct:iT}),Vu=V0.extend({implicit:[U0,H0],explicit:[W0,X0,Y0,Z0]}),Xn=Object.prototype.hasOwnProperty,wl=1,q0=2,Q0=3,xl=4,zu=1,aT=2,K0=3,lT=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,hT=/[\x85\u2028\u2029]/,cT=/[,\[\]\{\}]/,J0=/^(?:!|!!|![a-z\-]+!)$/i,ty=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function ey(e){return Object.prototype.toString.call(e)}function rn(e){return e===10||e===13}function Mr(e){return e===9||e===32}function as(e){return e===9||e===32||e===10||e===13}function Co(e){return e===44||e===91||e===93||e===123||e===125}function uT(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function dT(e){return e===120?2:e===117?4:e===85?8:0}function fT(e){return 48<=e&&e<=57?e-48:-1}function sy(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"\x85":e===95?"\xA0":e===76?"\u2028":e===80?"\u2029":""}function pT(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}for(var ny=new Array(256),ry=new Array(256),Oo=0;Oo<256;Oo++)ny[Oo]=sy(Oo)?1:0,ry[Oo]=sy(Oo);function mT(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Vu,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function oy(e,t){var s={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return s.snippet=bO(s),new es(t,s)}function ot(e,t){throw oy(e,t)}function _l(e,t){e.onWarning&&e.onWarning.call(null,oy(e,t))}var iy={YAML:function(e,t,s){var n,r,o;e.version!==null&&ot(e,"duplication of %YAML directive"),s.length!==1&&ot(e,"YAML directive accepts exactly one argument"),n=/^([0-9]+)\.([0-9]+)$/.exec(s[0]),n===null&&ot(e,"ill-formed argument of the YAML directive"),r=parseInt(n[1],10),o=parseInt(n[2],10),r!==1&&ot(e,"unacceptable YAML version of the document"),e.version=s[0],e.checkLineBreaks=o<2,o!==1&&o!==2&&_l(e,"unsupported YAML version of the document")},TAG:function(e,t,s){var n,r;s.length!==2&&ot(e,"TAG directive accepts exactly two arguments"),n=s[0],r=s[1],J0.test(n)||ot(e,"ill-formed tag handle (first argument) of the TAG directive"),Xn.call(e.tagMap,n)&&ot(e,'there is a previously declared suffix for "'+n+'" tag handle'),ty.test(r)||ot(e,"ill-formed tag prefix (second argument) of the TAG directive");try{r=decodeURIComponent(r)}catch{ot(e,"tag prefix is malformed: "+r)}e.tagMap[n]=r}};function Yn(e,t,s,n){var r,o,i,a;if(t<s){if(a=e.input.slice(t,s),n)for(r=0,o=a.length;r<o;r+=1)i=a.charCodeAt(r),i===9||32<=i&&i<=1114111||ot(e,"expected valid JSON character");else lT.test(a)&&ot(e,"the stream contains non-printable characters");e.result+=a}}function ay(e,t,s,n){var r,o,i,a;for(be.isObject(s)||ot(e,"cannot merge mappings; the provided source object is unacceptable"),r=Object.keys(s),i=0,a=r.length;i<a;i+=1)o=r[i],Xn.call(t,o)||(t[o]=s[o],n[o]=!0)}function To(e,t,s,n,r,o,i,a,l){var c,u;if(Array.isArray(r))for(r=Array.prototype.slice.call(r),c=0,u=r.length;c<u;c+=1)Array.isArray(r[c])&&ot(e,"nested arrays are not supported inside keys"),typeof r=="object"&&ey(r[c])==="[object Object]"&&(r[c]="[object Object]");if(typeof r=="object"&&ey(r)==="[object Object]"&&(r="[object Object]"),r=String(r),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)ay(e,t,o[c],s);else ay(e,t,o,s);else!e.json&&!Xn.call(s,r)&&Xn.call(t,r)&&(e.line=i||e.line,e.lineStart=a||e.lineStart,e.position=l||e.position,ot(e,"duplicated mapping key")),r==="__proto__"?Object.defineProperty(t,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[r]=o,delete s[r];return t}function Gu(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):ot(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ue(e,t,s){for(var n=0,r=e.input.charCodeAt(e.position);r!==0;){for(;Mr(r);)r===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),r=e.input.charCodeAt(++e.position);if(t&&r===35)do r=e.input.charCodeAt(++e.position);while(r!==10&&r!==13&&r!==0);if(rn(r))for(Gu(e),r=e.input.charCodeAt(e.position),n++,e.lineIndent=0;r===32;)e.lineIndent++,r=e.input.charCodeAt(++e.position);else break}return s!==-1&&n!==0&&e.lineIndent<s&&_l(e,"deficient indentation"),n}function Al(e){var t=e.position,s;return s=e.input.charCodeAt(t),!!((s===45||s===46)&&s===e.input.charCodeAt(t+1)&&s===e.input.charCodeAt(t+2)&&(t+=3,s=e.input.charCodeAt(t),s===0||as(s)))}function Uu(e,t){t===1?e.result+=" ":t>1&&(e.result+=be.repeat(`
`,t-1))}function gT(e,t,s){var n,r,o,i,a,l,c,u,h=e.kind,d=e.result,f;if(f=e.input.charCodeAt(e.position),as(f)||Co(f)||f===35||f===38||f===42||f===33||f===124||f===62||f===39||f===34||f===37||f===64||f===96||(f===63||f===45)&&(r=e.input.charCodeAt(e.position+1),as(r)||s&&Co(r)))return!1;for(e.kind="scalar",e.result="",o=i=e.position,a=!1;f!==0;){if(f===58){if(r=e.input.charCodeAt(e.position+1),as(r)||s&&Co(r))break}else if(f===35){if(n=e.input.charCodeAt(e.position-1),as(n))break}else{if(e.position===e.lineStart&&Al(e)||s&&Co(f))break;if(rn(f))if(l=e.line,c=e.lineStart,u=e.lineIndent,ue(e,!1,-1),e.lineIndent>=t){a=!0,f=e.input.charCodeAt(e.position);continue}else{e.position=i,e.line=l,e.lineStart=c,e.lineIndent=u;break}}a&&(Yn(e,o,i,!1),Uu(e,e.line-l),o=i=e.position,a=!1),Mr(f)||(i=e.position+1),f=e.input.charCodeAt(++e.position)}return Yn(e,o,i,!1),e.result?!0:(e.kind=h,e.result=d,!1)}function yT(e,t){var s,n,r;if(s=e.input.charCodeAt(e.position),s!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(s=e.input.charCodeAt(e.position))!==0;)if(s===39)if(Yn(e,n,e.position,!0),s=e.input.charCodeAt(++e.position),s===39)n=e.position,e.position++,r=e.position;else return!0;else rn(s)?(Yn(e,n,r,!0),Uu(e,ue(e,!1,t)),n=r=e.position):e.position===e.lineStart&&Al(e)?ot(e,"unexpected end of the document within a single quoted scalar"):(e.position++,r=e.position);ot(e,"unexpected end of the stream within a single quoted scalar")}function vT(e,t){var s,n,r,o,i,a;if(a=e.input.charCodeAt(e.position),a!==34)return!1;for(e.kind="scalar",e.result="",e.position++,s=n=e.position;(a=e.input.charCodeAt(e.position))!==0;){if(a===34)return Yn(e,s,e.position,!0),e.position++,!0;if(a===92){if(Yn(e,s,e.position,!0),a=e.input.charCodeAt(++e.position),rn(a))ue(e,!1,t);else if(a<256&&ny[a])e.result+=ry[a],e.position++;else if((i=dT(a))>0){for(r=i,o=0;r>0;r--)a=e.input.charCodeAt(++e.position),(i=uT(a))>=0?o=(o<<4)+i:ot(e,"expected hexadecimal character");e.result+=pT(o),e.position++}else ot(e,"unknown escape sequence");s=n=e.position}else rn(a)?(Yn(e,s,n,!0),Uu(e,ue(e,!1,t)),s=n=e.position):e.position===e.lineStart&&Al(e)?ot(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}ot(e,"unexpected end of the stream within a double quoted scalar")}function bT(e,t){var s=!0,n,r,o,i=e.tag,a,l=e.anchor,c,u,h,d,f,p=Object.create(null),g,m,y,v;if(v=e.input.charCodeAt(e.position),v===91)u=93,f=!1,a=[];else if(v===123)u=125,f=!0,a={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),v=e.input.charCodeAt(++e.position);v!==0;){if(ue(e,!0,t),v=e.input.charCodeAt(e.position),v===u)return e.position++,e.tag=i,e.anchor=l,e.kind=f?"mapping":"sequence",e.result=a,!0;s?v===44&&ot(e,"expected the node content, but found ','"):ot(e,"missed comma between flow collection entries"),m=g=y=null,h=d=!1,v===63&&(c=e.input.charCodeAt(e.position+1),as(c)&&(h=d=!0,e.position++,ue(e,!0,t))),n=e.line,r=e.lineStart,o=e.position,Po(e,t,wl,!1,!0),m=e.tag,g=e.result,ue(e,!0,t),v=e.input.charCodeAt(e.position),(d||e.line===n)&&v===58&&(h=!0,v=e.input.charCodeAt(++e.position),ue(e,!0,t),Po(e,t,wl,!1,!0),y=e.result),f?To(e,a,p,m,g,y,n,r,o):h?a.push(To(e,null,p,m,g,y,n,r,o)):a.push(g),ue(e,!0,t),v=e.input.charCodeAt(e.position),v===44?(s=!0,v=e.input.charCodeAt(++e.position)):s=!1}ot(e,"unexpected end of the stream within a flow collection")}function wT(e,t){var s,n,r=zu,o=!1,i=!1,a=t,l=0,c=!1,u,h;if(h=e.input.charCodeAt(e.position),h===124)n=!1;else if(h===62)n=!0;else return!1;for(e.kind="scalar",e.result="";h!==0;)if(h=e.input.charCodeAt(++e.position),h===43||h===45)zu===r?r=h===43?K0:aT:ot(e,"repeat of a chomping mode identifier");else if((u=fT(h))>=0)u===0?ot(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):i?ot(e,"repeat of an indentation width identifier"):(a=t+u-1,i=!0);else break;if(Mr(h)){do h=e.input.charCodeAt(++e.position);while(Mr(h));if(h===35)do h=e.input.charCodeAt(++e.position);while(!rn(h)&&h!==0)}for(;h!==0;){for(Gu(e),e.lineIndent=0,h=e.input.charCodeAt(e.position);(!i||e.lineIndent<a)&&h===32;)e.lineIndent++,h=e.input.charCodeAt(++e.position);if(!i&&e.lineIndent>a&&(a=e.lineIndent),rn(h)){l++;continue}if(e.lineIndent<a){r===K0?e.result+=be.repeat(`
`,o?1+l:l):r===zu&&o&&(e.result+=`
`);break}for(n?Mr(h)?(c=!0,e.result+=be.repeat(`
`,o?1+l:l)):c?(c=!1,e.result+=be.repeat(`
`,l+1)):l===0?o&&(e.result+=" "):e.result+=be.repeat(`
`,l):e.result+=be.repeat(`
`,o?1+l:l),o=!0,i=!0,l=0,s=e.position;!rn(h)&&h!==0;)h=e.input.charCodeAt(++e.position);Yn(e,s,e.position,!1)}return!0}function ly(e,t){var s,n=e.tag,r=e.anchor,o=[],i,a=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,ot(e,"tab characters must not be used in indentation")),!(l!==45||(i=e.input.charCodeAt(e.position+1),!as(i))));){if(a=!0,e.position++,ue(e,!0,-1)&&e.lineIndent<=t){o.push(null),l=e.input.charCodeAt(e.position);continue}if(s=e.line,Po(e,t,Q0,!1,!0),o.push(e.result),ue(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===s||e.lineIndent>t)&&l!==0)ot(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return a?(e.tag=n,e.anchor=r,e.kind="sequence",e.result=o,!0):!1}function xT(e,t,s){var n,r,o,i,a,l,c=e.tag,u=e.anchor,h={},d=Object.create(null),f=null,p=null,g=null,m=!1,y=!1,v;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=h),v=e.input.charCodeAt(e.position);v!==0;){if(!m&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,ot(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),o=e.line,(v===63||v===58)&&as(n))v===63?(m&&(To(e,h,d,f,p,null,i,a,l),f=p=g=null),y=!0,m=!0,r=!0):m?(m=!1,r=!0):ot(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,v=n;else{if(i=e.line,a=e.lineStart,l=e.position,!Po(e,s,q0,!1,!0))break;if(e.line===o){for(v=e.input.charCodeAt(e.position);Mr(v);)v=e.input.charCodeAt(++e.position);if(v===58)v=e.input.charCodeAt(++e.position),as(v)||ot(e,"a whitespace character is expected after the key-value separator within a block mapping"),m&&(To(e,h,d,f,p,null,i,a,l),f=p=g=null),y=!0,m=!1,r=!1,f=e.tag,p=e.result;else if(y)ot(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(y)ot(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===o||e.lineIndent>t)&&(m&&(i=e.line,a=e.lineStart,l=e.position),Po(e,t,xl,!0,r)&&(m?p=e.result:g=e.result),m||(To(e,h,d,f,p,g,i,a,l),f=p=g=null),ue(e,!0,-1),v=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&v!==0)ot(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return m&&To(e,h,d,f,p,null,i,a,l),y&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=h),y}function _T(e){var t,s=!1,n=!1,r,o,i;if(i=e.input.charCodeAt(e.position),i!==33)return!1;if(e.tag!==null&&ot(e,"duplication of a tag property"),i=e.input.charCodeAt(++e.position),i===60?(s=!0,i=e.input.charCodeAt(++e.position)):i===33?(n=!0,r="!!",i=e.input.charCodeAt(++e.position)):r="!",t=e.position,s){do i=e.input.charCodeAt(++e.position);while(i!==0&&i!==62);e.position<e.length?(o=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):ot(e,"unexpected end of the stream within a verbatim tag")}else{for(;i!==0&&!as(i);)i===33&&(n?ot(e,"tag suffix cannot contain exclamation marks"):(r=e.input.slice(t-1,e.position+1),J0.test(r)||ot(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);o=e.input.slice(t,e.position),cT.test(o)&&ot(e,"tag suffix cannot contain flow indicator characters")}o&&!ty.test(o)&&ot(e,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{ot(e,"tag name is malformed: "+o)}return s?e.tag=o:Xn.call(e.tagMap,r)?e.tag=e.tagMap[r]+o:r==="!"?e.tag="!"+o:r==="!!"?e.tag="tag:yaml.org,2002:"+o:ot(e,'undeclared tag handle "'+r+'"'),!0}function AT(e){var t,s;if(s=e.input.charCodeAt(e.position),s!==38)return!1;for(e.anchor!==null&&ot(e,"duplication of an anchor property"),s=e.input.charCodeAt(++e.position),t=e.position;s!==0&&!as(s)&&!Co(s);)s=e.input.charCodeAt(++e.position);return e.position===t&&ot(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function kT(e){var t,s,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!as(n)&&!Co(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&ot(e,"name of an alias node must contain at least one character"),s=e.input.slice(t,e.position),Xn.call(e.anchorMap,s)||ot(e,'unidentified alias "'+s+'"'),e.result=e.anchorMap[s],ue(e,!0,-1),!0}function Po(e,t,s,n,r){var o,i,a,l=1,c=!1,u=!1,h,d,f,p,g,m;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=i=a=xl===s||Q0===s,n&&ue(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;_T(e)||AT(e);)ue(e,!0,-1)?(c=!0,a=o,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):a=!1;if(a&&(a=c||r),(l===1||xl===s)&&(wl===s||q0===s?g=t:g=t+1,m=e.position-e.lineStart,l===1?a&&(ly(e,m)||xT(e,m,g))||bT(e,g)?u=!0:(i&&wT(e,g)||yT(e,g)||vT(e,g)?u=!0:kT(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&ot(e,"alias node should not have any properties")):gT(e,g,wl===s)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=a&&ly(e,m))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&ot(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),h=0,d=e.implicitTypes.length;h<d;h+=1)if(p=e.implicitTypes[h],p.resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Xn.call(e.typeMap[e.kind||"fallback"],e.tag))p=e.typeMap[e.kind||"fallback"][e.tag];else for(p=null,f=e.typeMap.multi[e.kind||"fallback"],h=0,d=f.length;h<d;h+=1)if(e.tag.slice(0,f[h].tag.length)===f[h].tag){p=f[h];break}p||ot(e,"unknown tag !<"+e.tag+">"),e.result!==null&&p.kind!==e.kind&&ot(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result,e.tag)?(e.result=p.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):ot(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function ST(e){var t=e.position,s,n,r,o=!1,i;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(i=e.input.charCodeAt(e.position))!==0&&(ue(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||i!==37));){for(o=!0,i=e.input.charCodeAt(++e.position),s=e.position;i!==0&&!as(i);)i=e.input.charCodeAt(++e.position);for(n=e.input.slice(s,e.position),r=[],n.length<1&&ot(e,"directive name must not be less than one character in length");i!==0;){for(;Mr(i);)i=e.input.charCodeAt(++e.position);if(i===35){do i=e.input.charCodeAt(++e.position);while(i!==0&&!rn(i));break}if(rn(i))break;for(s=e.position;i!==0&&!as(i);)i=e.input.charCodeAt(++e.position);r.push(e.input.slice(s,e.position))}i!==0&&Gu(e),Xn.call(iy,n)?iy[n](e,n,r):_l(e,'unknown document directive "'+n+'"')}if(ue(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,ue(e,!0,-1)):o&&ot(e,"directives end mark is expected"),Po(e,e.lineIndent-1,xl,!1,!0),ue(e,!0,-1),e.checkLineBreaks&&hT.test(e.input.slice(t,e.position))&&_l(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Al(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,ue(e,!0,-1));return}if(e.position<e.length-1)ot(e,"end of the stream or a document separator is expected");else return}function hy(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var s=new mT(e,t),n=e.indexOf("\0");for(n!==-1&&(s.position=n,ot(s,"null byte is not allowed in input")),s.input+="\0";s.input.charCodeAt(s.position)===32;)s.lineIndent+=1,s.position+=1;for(;s.position<s.length-1;)ST(s);return s.documents}function CT(e,t,s){t!==null&&typeof t=="object"&&typeof s>"u"&&(s=t,t=null);var n=hy(e,s);if(typeof t!="function")return n;for(var r=0,o=n.length;r<o;r+=1)t(n[r])}function OT(e,t){var s=hy(e,t);if(s.length!==0){if(s.length===1)return s[0];throw new es("expected a single document in the stream, but found more")}}var TT=CT,PT=OT,cy={loadAll:TT,load:PT},uy=Object.prototype.toString,dy=Object.prototype.hasOwnProperty,Hu=65279,MT=9,Ni=10,IT=13,ET=32,$T=33,RT=34,Wu=35,DT=37,NT=38,LT=39,BT=42,fy=44,jT=45,kl=58,FT=61,VT=62,zT=63,GT=64,py=91,my=93,UT=96,gy=123,HT=124,yy=125,Ue={};Ue[0]="\\0",Ue[7]="\\a",Ue[8]="\\b",Ue[9]="\\t",Ue[10]="\\n",Ue[11]="\\v",Ue[12]="\\f",Ue[13]="\\r",Ue[27]="\\e",Ue[34]='\\"',Ue[92]="\\\\",Ue[133]="\\N",Ue[160]="\\_",Ue[8232]="\\L",Ue[8233]="\\P";var WT=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],XT=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function YT(e,t){var s,n,r,o,i,a,l;if(t===null)return{};for(s={},n=Object.keys(t),r=0,o=n.length;r<o;r+=1)i=n[r],a=String(t[i]),i.slice(0,2)==="!!"&&(i="tag:yaml.org,2002:"+i.slice(2)),l=e.compiledTypeMap.fallback[i],l&&dy.call(l.styleAliases,a)&&(a=l.styleAliases[a]),s[i]=a;return s}function ZT(e){var t,s,n;if(t=e.toString(16).toUpperCase(),e<=255)s="x",n=2;else if(e<=65535)s="u",n=4;else if(e<=4294967295)s="U",n=8;else throw new es("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+s+be.repeat("0",n-t.length)+t}var qT=1,Li=2;function QT(e){this.schema=e.schema||Vu,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=be.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=YT(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?Li:qT,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function vy(e,t){for(var s=be.repeat(" ",t),n=0,r=-1,o="",i,a=e.length;n<a;)r=e.indexOf(`
`,n),r===-1?(i=e.slice(n),n=a):(i=e.slice(n,r+1),n=r+1),i.length&&i!==`
`&&(o+=s),o+=i;return o}function Xu(e,t){return`
`+be.repeat(" ",e.indent*t)}function KT(e,t){var s,n,r;for(s=0,n=e.implicitTypes.length;s<n;s+=1)if(r=e.implicitTypes[s],r.resolve(t))return!0;return!1}function Sl(e){return e===ET||e===MT}function Bi(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Hu||65536<=e&&e<=1114111}function by(e){return Bi(e)&&e!==Hu&&e!==IT&&e!==Ni}function wy(e,t,s){var n=by(e),r=n&&!Sl(e);return(s?n:n&&e!==fy&&e!==py&&e!==my&&e!==gy&&e!==yy)&&e!==Wu&&!(t===kl&&!r)||by(t)&&!Sl(t)&&e===Wu||t===kl&&r}function JT(e){return Bi(e)&&e!==Hu&&!Sl(e)&&e!==jT&&e!==zT&&e!==kl&&e!==fy&&e!==py&&e!==my&&e!==gy&&e!==yy&&e!==Wu&&e!==NT&&e!==BT&&e!==$T&&e!==HT&&e!==FT&&e!==VT&&e!==LT&&e!==RT&&e!==DT&&e!==GT&&e!==UT}function t2(e){return!Sl(e)&&e!==kl}function ji(e,t){var s=e.charCodeAt(t),n;return s>=55296&&s<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(s-55296)*1024+n-56320+65536:s}function xy(e){var t=/^\n* /;return t.test(e)}var _y=1,Yu=2,Ay=3,ky=4,Mo=5;function e2(e,t,s,n,r,o,i,a){var l,c=0,u=null,h=!1,d=!1,f=n!==-1,p=-1,g=JT(ji(e,0))&&t2(ji(e,e.length-1));if(t||i)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=ji(e,l),!Bi(c))return Mo;g=g&&wy(c,u,a),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=ji(e,l),c===Ni)h=!0,f&&(d=d||l-p-1>n&&e[p+1]!==" ",p=l);else if(!Bi(c))return Mo;g=g&&wy(c,u,a),u=c}d=d||f&&l-p-1>n&&e[p+1]!==" "}return!h&&!d?g&&!i&&!r(e)?_y:o===Li?Mo:Yu:s>9&&xy(e)?Mo:i?o===Li?Mo:Yu:d?ky:Ay}function s2(e,t,s,n,r){e.dump=function(){if(t.length===0)return e.quotingType===Li?'""':"''";if(!e.noCompatMode&&(WT.indexOf(t)!==-1||XT.test(t)))return e.quotingType===Li?'"'+t+'"':"'"+t+"'";var o=e.indent*Math.max(1,s),i=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),a=n||e.flowLevel>-1&&s>=e.flowLevel;function l(c){return KT(e,c)}switch(e2(t,a,e.indent,i,l,e.quotingType,e.forceQuotes&&!n,r)){case _y:return t;case Yu:return"'"+t.replace(/'/g,"''")+"'";case Ay:return"|"+Sy(t,e.indent)+Cy(vy(t,o));case ky:return">"+Sy(t,e.indent)+Cy(vy(n2(t,i),o));case Mo:return'"'+r2(t)+'"';default:throw new es("impossible error: invalid scalar style")}}()}function Sy(e,t){var s=xy(e)?String(t):"",n=e[e.length-1]===`
`,r=n&&(e[e.length-2]===`
`||e===`
`),o=r?"+":n?"":"-";return s+o+`
`}function Cy(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function n2(e,t){for(var s=/(\n+)([^\n]*)/g,n=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,s.lastIndex=c,Oy(e.slice(0,c),t)}(),r=e[0]===`
`||e[0]===" ",o,i;i=s.exec(e);){var a=i[1],l=i[2];o=l[0]===" ",n+=a+(!r&&!o&&l!==""?`
`:"")+Oy(l,t),r=o}return n}function Oy(e,t){if(e===""||e[0]===" ")return e;for(var s=/ [^ ]/g,n,r=0,o,i=0,a=0,l="";n=s.exec(e);)a=n.index,a-r>t&&(o=i>r?i:a,l+=`
`+e.slice(r,o),r=o+1),i=a;return l+=`
`,e.length-r>t&&i>r?l+=e.slice(r,i)+`
`+e.slice(i+1):l+=e.slice(r),l.slice(1)}function r2(e){for(var t="",s=0,n,r=0;r<e.length;s>=65536?r+=2:r++)s=ji(e,r),n=Ue[s],!n&&Bi(s)?(t+=e[r],s>=65536&&(t+=e[r+1])):t+=n||ZT(s);return t}function o2(e,t,s){var n="",r=e.tag,o,i,a;for(o=0,i=s.length;o<i;o+=1)a=s[o],e.replacer&&(a=e.replacer.call(s,String(o),a)),(In(e,t,a,!1,!1)||typeof a>"u"&&In(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=r,e.dump="["+n+"]"}function Ty(e,t,s,n){var r="",o=e.tag,i,a,l;for(i=0,a=s.length;i<a;i+=1)l=s[i],e.replacer&&(l=e.replacer.call(s,String(i),l)),(In(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&In(e,t+1,null,!0,!0,!1,!0))&&((!n||r!=="")&&(r+=Xu(e,t)),e.dump&&Ni===e.dump.charCodeAt(0)?r+="-":r+="- ",r+=e.dump);e.tag=o,e.dump=r||"[]"}function i2(e,t,s){var n="",r=e.tag,o=Object.keys(s),i,a,l,c,u;for(i=0,a=o.length;i<a;i+=1)u="",n!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=o[i],c=s[l],e.replacer&&(c=e.replacer.call(s,l,c)),In(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),In(e,t,c,!1,!1)&&(u+=e.dump,n+=u));e.tag=r,e.dump="{"+n+"}"}function a2(e,t,s,n){var r="",o=e.tag,i=Object.keys(s),a,l,c,u,h,d;if(e.sortKeys===!0)i.sort();else if(typeof e.sortKeys=="function")i.sort(e.sortKeys);else if(e.sortKeys)throw new es("sortKeys must be a boolean or a function");for(a=0,l=i.length;a<l;a+=1)d="",(!n||r!=="")&&(d+=Xu(e,t)),c=i[a],u=s[c],e.replacer&&(u=e.replacer.call(s,c,u)),In(e,t+1,c,!0,!0,!0)&&(h=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,h&&(e.dump&&Ni===e.dump.charCodeAt(0)?d+="?":d+="? "),d+=e.dump,h&&(d+=Xu(e,t)),In(e,t+1,u,!0,h)&&(e.dump&&Ni===e.dump.charCodeAt(0)?d+=":":d+=": ",d+=e.dump,r+=d));e.tag=o,e.dump=r||"{}"}function Py(e,t,s){var n,r,o,i,a,l;for(r=s?e.explicitTypes:e.implicitTypes,o=0,i=r.length;o<i;o+=1)if(a=r[o],(a.instanceOf||a.predicate)&&(!a.instanceOf||typeof t=="object"&&t instanceof a.instanceOf)&&(!a.predicate||a.predicate(t))){if(s?a.multi&&a.representName?e.tag=a.representName(t):e.tag=a.tag:e.tag="?",a.represent){if(l=e.styleMap[a.tag]||a.defaultStyle,uy.call(a.represent)==="[object Function]")n=a.represent(t,l);else if(dy.call(a.represent,l))n=a.represent[l](t,l);else throw new es("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');e.dump=n}return!0}return!1}function In(e,t,s,n,r,o,i){e.tag=null,e.dump=s,Py(e,s,!1)||Py(e,s,!0);var a=uy.call(e.dump),l=n,c;n&&(n=e.flowLevel<0||e.flowLevel>t);var u=a==="[object Object]"||a==="[object Array]",h,d;if(u&&(h=e.duplicates.indexOf(s),d=h!==-1),(e.tag!==null&&e.tag!=="?"||d||e.indent!==2&&t>0)&&(r=!1),d&&e.usedDuplicates[h])e.dump="*ref_"+h;else{if(u&&d&&!e.usedDuplicates[h]&&(e.usedDuplicates[h]=!0),a==="[object Object]")n&&Object.keys(e.dump).length!==0?(a2(e,t,e.dump,r),d&&(e.dump="&ref_"+h+e.dump)):(i2(e,t,e.dump),d&&(e.dump="&ref_"+h+" "+e.dump));else if(a==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!i&&t>0?Ty(e,t-1,e.dump,r):Ty(e,t,e.dump,r),d&&(e.dump="&ref_"+h+e.dump)):(o2(e,t,e.dump),d&&(e.dump="&ref_"+h+" "+e.dump));else if(a==="[object String]")e.tag!=="?"&&s2(e,e.dump,t,o,l);else{if(a==="[object Undefined]"||e.skipInvalid)return!1;throw new es("unacceptable kind of an object to dump "+a)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}function l2(e,t){var s=[],n=[],r,o;for(Zu(e,s,n),r=0,o=n.length;r<o;r+=1)t.duplicates.push(s[n[r]]);t.usedDuplicates=new Array(o)}function Zu(e,t,s){var n,r,o;if(e!==null&&typeof e=="object")if(r=t.indexOf(e),r!==-1)s.indexOf(r)===-1&&s.push(r);else if(t.push(e),Array.isArray(e))for(r=0,o=e.length;r<o;r+=1)Zu(e[r],t,s);else for(n=Object.keys(e),r=0,o=n.length;r<o;r+=1)Zu(e[n[r]],t,s)}function h2(e,t){t=t||{};var s=new QT(t);s.noRefs||l2(e,s);var n=e;return s.replacer&&(n=s.replacer.call({"":n},"",n)),In(s,0,n,!0,!0)?s.dump+`
`:""}var c2=h2,u2={dump:c2};function qu(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var d2=Ie,f2=I0,p2=D0,m2=F0,g2=V0,y2=Vu,v2=cy.load,b2=cy.loadAll,w2=u2.dump,Qu=es,x2={binary:W0,float:j0,map:R0,null:N0,pairs:Y0,set:Z0,timestamp:U0,bool:L0,int:B0,merge:H0,omap:X0,seq:$0,str:E0},_2=qu("safeLoad","load"),A2=qu("safeLoadAll","loadAll"),k2=qu("safeDump","dump"),Ku={Type:d2,Schema:f2,FAILSAFE_SCHEMA:p2,JSON_SCHEMA:m2,CORE_SCHEMA:g2,DEFAULT_SCHEMA:y2,load:v2,loadAll:b2,dump:w2,YAMLException:Qu,types:x2,safeLoad:_2,safeLoadAll:A2,safeDump:k2};function Vs(e,t,s,n,r){return e+(r-s)/(n-s)*(t-e)}const My=30,Ju=.8;class Zn extends Je{static get RADIUS(){return me.get("hit_button").width/2}constructor(t){super({texture:me.get("hit_button"),anchor:.5,tint:t}),this._activateTime=null,this._isHeld=!1}hold(t){this._activateTime=t,this._isHeld=!0}release(t){this._activateTime=t,this._isHeld=!1}update(t){if(this._activateTime===null){this.scale.set(1);return}const s=this._isHeld?Math.max(Vs(1,Ju,this._activateTime,this._activateTime+My,t),Ju):Math.min(Vs(Ju,1,this._activateTime,this._activateTime+My,t),1);this.scale.set(s)}}function S2(e){let t,s,n;return{c(){t=q("canvas"),t.textContent="Sorry, canvas isn't supported."},m(r,o){Ct(r,t,o),e[3](t),s||(n=Te(window,"resize",e[1]),s=!0)},p:jt,i:jt,o:jt,d(r){r&&xt(t),e[3](null),s=!1,n()}}}const Io=600,td=900,Fi=20,ed=650;function C2(e,t,s){let n;const r=new Pg;Tr(async()=>{await r.init({canvas:n,backgroundAlpha:0}),i()});function o(){return r}function i(){const l=n.parentElement,c=Math.min(l.clientWidth/Io,l.clientHeight/td,1),u=l.clientHeight/c;r.renderer.resize(Io,u),r.canvas.style.width=`${Io*c}px`,r.canvas.style.height="100%";const h=-(Zn.RADIUS+Fi);r.stage.pivot.y=-(r.renderer.height+h)}function a(l){sn[l?"unshift":"push"](()=>{n=l,s(0,n)})}return[n,i,o,a]}class Iy extends ye{constructor(t){super(),ge(this,t,C2,S2,ce,{getPixiApp:2})}get getPixiApp(){return this.$$.ctx[2]}}class O2{constructor(t,s,n,r){this._metadata=t,this._notes=s,this._timingEvents=n,this._spacingEvents=r}get meta(){return this._metadata}get notes(){return this._notes}get timingEvents(){return this._timingEvents}get startTimestamp(){return-this._timingEvents[0].timePerMeasure}get endTimestamp(){return this._notes.length===0?this._timingEvents.at(-1).timePerMeasure:this._notes.at(-1).atTime+this._timingEvents.at(-1).timePerMeasure}getApproachRate(t){const s=Ey(this._spacingEvents,t);return this._spacingEvents[s].approachRate}getInitialTimestamp(t){const s=this.getVelocity(this._notes[0].atTime);return Math.min(0,this._notes[0].atTime-t/s)}getTimingEvent(t){return this._timingEvents[this.getTimingEventIndex(t)]}getTimingEventIndex(t){return Ey(this._timingEvents,t)}getVelocity(t){const s=this._timingEvents[this.getTimingEventIndex(t)],n=this.getApproachRate(t);return ed*n/s.timePerMeasure}}function Ey(e,t){if(t<0||e.length===1)return 0;for(let s=1;s<e.length;s++){const n=e[s],r=e[s-1];if(t>=r.atTime&&t<n.atTime)return s-1}return e.length-1}class $y{constructor({title:t,artist:s,audioURI:n,backgroundURI:r}){this._title=t,this._artist=s,this._audioURI=n,this._backgroundURI=r}get title(){return this._title}get artist(){return this._artist}get audioURI(){return this._audioURI}get backgroundURI(){return this._backgroundURI}}var sd={exports:{}},Ry={},zs={},Eo={},Vi={},_t={},zi={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class s extends t{constructor(v){if(super(),!e.IDENTIFIER.test(v))throw new Error("CodeGen: name must be a valid identifier");this.str=v}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=s;class n extends t{constructor(v){super(),this._items=typeof v=="string"?[v]:v}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const v=this._items[0];return v===""||v==='""'}get str(){var v;return(v=this._str)!==null&&v!==void 0?v:this._str=this._items.reduce((b,w)=>`${b}${w}`,"")}get names(){var v;return(v=this._names)!==null&&v!==void 0?v:this._names=this._items.reduce((b,w)=>(w instanceof s&&(b[w.str]=(b[w.str]||0)+1),b),{})}}e._Code=n,e.nil=new n("");function r(y,...v){const b=[y[0]];let w=0;for(;w<v.length;)a(b,v[w]),b.push(y[++w]);return new n(b)}e._=r;const o=new n("+");function i(y,...v){const b=[f(y[0])];let w=0;for(;w<v.length;)b.push(o),a(b,v[w]),b.push(o,f(y[++w]));return l(b),new n(b)}e.str=i;function a(y,v){v instanceof n?y.push(...v._items):v instanceof s?y.push(v):y.push(h(v))}e.addCodeArg=a;function l(y){let v=1;for(;v<y.length-1;){if(y[v]===o){const b=c(y[v-1],y[v+1]);if(b!==void 0){y.splice(v-1,3,b);continue}y[v++]="+"}v++}}function c(y,v){if(v==='""')return y;if(y==='""')return v;if(typeof y=="string")return v instanceof s||y[y.length-1]!=='"'?void 0:typeof v!="string"?`${y.slice(0,-1)}${v}"`:v[0]==='"'?y.slice(0,-1)+v.slice(1):void 0;if(typeof v=="string"&&v[0]==='"'&&!(y instanceof s))return`"${y}${v.slice(1)}`}function u(y,v){return v.emptyStr()?y:y.emptyStr()?v:i`${y}${v}`}e.strConcat=u;function h(y){return typeof y=="number"||typeof y=="boolean"||y===null?y:f(Array.isArray(y)?y.join(","):y)}function d(y){return new n(f(y))}e.stringify=d;function f(y){return JSON.stringify(y).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=f;function p(y){return typeof y=="string"&&e.IDENTIFIER.test(y)?new n(`.${y}`):r`[${y}]`}e.getProperty=p;function g(y){if(typeof y=="string"&&e.IDENTIFIER.test(y))return new n(`${y}`);throw new Error(`CodeGen: invalid export name: ${y}, use explicit $id name mapping`)}e.getEsmExportName=g;function m(y){return new n(y.toString())}e.regexpCode=m})(zi);var nd={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=zi;class s extends Error{constructor(c){super(`CodeGen: "code" for ${c} not defined`),this.value=c.value}}var n;(function(l){l[l.Started=0]="Started",l[l.Completed=1]="Completed"})(n=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class r{constructor({prefixes:c,parent:u}={}){this._names={},this._prefixes=c,this._parent=u}toName(c){return c instanceof t.Name?c:this.name(c)}name(c){return new t.Name(this._newName(c))}_newName(c){const u=this._names[c]||this._nameGroup(c);return`${c}${u.index++}`}_nameGroup(c){var u,h;if(!((h=(u=this._parent)===null||u===void 0?void 0:u._prefixes)===null||h===void 0)&&h.has(c)||this._prefixes&&!this._prefixes.has(c))throw new Error(`CodeGen: prefix "${c}" is not allowed in this scope`);return this._names[c]={prefix:c,index:0}}}e.Scope=r;class o extends t.Name{constructor(c,u){super(u),this.prefix=c}setValue(c,{property:u,itemIndex:h}){this.value=c,this.scopePath=(0,t._)`.${new t.Name(u)}[${h}]`}}e.ValueScopeName=o;const i=(0,t._)`\n`;class a extends r{constructor(c){super(c),this._values={},this._scope=c.scope,this.opts={...c,_n:c.lines?i:t.nil}}get(){return this._scope}name(c){return new o(c,this._newName(c))}value(c,u){var h;if(u.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const d=this.toName(c),{prefix:f}=d,p=(h=u.key)!==null&&h!==void 0?h:u.ref;let g=this._values[f];if(g){const v=g.get(p);if(v)return v}else g=this._values[f]=new Map;g.set(p,d);const m=this._scope[f]||(this._scope[f]=[]),y=m.length;return m[y]=u.ref,d.setValue(u,{property:f,itemIndex:y}),d}getValue(c,u){const h=this._values[c];if(h)return h.get(u)}scopeRefs(c,u=this._values){return this._reduceValues(u,h=>{if(h.scopePath===void 0)throw new Error(`CodeGen: name "${h}" has no value`);return(0,t._)`${c}${h.scopePath}`})}scopeCode(c=this._values,u,h){return this._reduceValues(c,d=>{if(d.value===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return d.value.code},u,h)}_reduceValues(c,u,h={},d){let f=t.nil;for(const p in c){const g=c[p];if(!g)continue;const m=h[p]=h[p]||new Map;g.forEach(y=>{if(m.has(y))return;m.set(y,n.Started);let v=u(y);if(v){const b=this.opts.es5?e.varKinds.var:e.varKinds.const;f=(0,t._)`${f}${b} ${y} = ${v};${this.opts._n}`}else if(v=d==null?void 0:d(y))f=(0,t._)`${f}${v}${this.opts._n}`;else throw new s(y);m.set(y,n.Completed)})}return f}}e.ValueScope=a})(nd),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=zi,s=nd;var n=zi;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var r=nd;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return r.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return r.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return r.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return r.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(x,C){return this}}class i extends o{constructor(x,C,$){super(),this.varKind=x,this.name=C,this.rhs=$}render({es5:x,_n:C}){const $=x?s.varKinds.var:this.varKind,F=this.rhs===void 0?"":` = ${this.rhs}`;return`${$} ${this.name}${F};`+C}optimizeNames(x,C){if(x[this.name.str])return this.rhs&&(this.rhs=j(this.rhs,x,C)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class a extends o{constructor(x,C,$){super(),this.lhs=x,this.rhs=C,this.sideEffects=$}render({_n:x}){return`${this.lhs} = ${this.rhs};`+x}optimizeNames(x,C){if(!(this.lhs instanceof t.Name&&!x[this.lhs.str]&&!this.sideEffects))return this.rhs=j(this.rhs,x,C),this}get names(){const x=this.lhs instanceof t.Name?{}:{...this.lhs.names};return H(x,this.rhs)}}class l extends a{constructor(x,C,$,F){super(x,$,F),this.op=C}render({_n:x}){return`${this.lhs} ${this.op}= ${this.rhs};`+x}}class c extends o{constructor(x){super(),this.label=x,this.names={}}render({_n:x}){return`${this.label}:`+x}}class u extends o{constructor(x){super(),this.label=x,this.names={}}render({_n:x}){return`break${this.label?` ${this.label}`:""};`+x}}class h extends o{constructor(x){super(),this.error=x}render({_n:x}){return`throw ${this.error};`+x}get names(){return this.error.names}}class d extends o{constructor(x){super(),this.code=x}render({_n:x}){return`${this.code};`+x}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(x,C){return this.code=j(this.code,x,C),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class f extends o{constructor(x=[]){super(),this.nodes=x}render(x){return this.nodes.reduce((C,$)=>C+$.render(x),"")}optimizeNodes(){const{nodes:x}=this;let C=x.length;for(;C--;){const $=x[C].optimizeNodes();Array.isArray($)?x.splice(C,1,...$):$?x[C]=$:x.splice(C,1)}return x.length>0?this:void 0}optimizeNames(x,C){const{nodes:$}=this;let F=$.length;for(;F--;){const Y=$[F];Y.optimizeNames(x,C)||(K(x,Y.names),$.splice(F,1))}return $.length>0?this:void 0}get names(){return this.nodes.reduce((x,C)=>B(x,C.names),{})}}class p extends f{render(x){return"{"+x._n+super.render(x)+"}"+x._n}}class g extends f{}class m extends p{}m.kind="else";class y extends p{constructor(x,C){super(C),this.condition=x}render(x){let C=`if(${this.condition})`+super.render(x);return this.else&&(C+="else "+this.else.render(x)),C}optimizeNodes(){super.optimizeNodes();const x=this.condition;if(x===!0)return this.nodes;let C=this.else;if(C){const $=C.optimizeNodes();C=this.else=Array.isArray($)?new m($):$}if(C)return x===!1?C instanceof y?C:C.nodes:this.nodes.length?this:new y(nt(x),C instanceof y?[C]:C.nodes);if(!(x===!1||!this.nodes.length))return this}optimizeNames(x,C){var $;if(this.else=($=this.else)===null||$===void 0?void 0:$.optimizeNames(x,C),!!(super.optimizeNames(x,C)||this.else))return this.condition=j(this.condition,x,C),this}get names(){const x=super.names;return H(x,this.condition),this.else&&B(x,this.else.names),x}}y.kind="if";class v extends p{}v.kind="for";class b extends v{constructor(x){super(),this.iteration=x}render(x){return`for(${this.iteration})`+super.render(x)}optimizeNames(x,C){if(super.optimizeNames(x,C))return this.iteration=j(this.iteration,x,C),this}get names(){return B(super.names,this.iteration.names)}}class w extends v{constructor(x,C,$,F){super(),this.varKind=x,this.name=C,this.from=$,this.to=F}render(x){const C=x.es5?s.varKinds.var:this.varKind,{name:$,from:F,to:Y}=this;return`for(${C} ${$}=${F}; ${$}<${Y}; ${$}++)`+super.render(x)}get names(){const x=H(super.names,this.from);return H(x,this.to)}}class S extends v{constructor(x,C,$,F){super(),this.loop=x,this.varKind=C,this.name=$,this.iterable=F}render(x){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(x)}optimizeNames(x,C){if(super.optimizeNames(x,C))return this.iterable=j(this.iterable,x,C),this}get names(){return B(super.names,this.iterable.names)}}class _ extends p{constructor(x,C,$){super(),this.name=x,this.args=C,this.async=$}render(x){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(x)}}_.kind="func";class A extends f{render(x){return"return "+super.render(x)}}A.kind="return";class O extends p{render(x){let C="try"+super.render(x);return this.catch&&(C+=this.catch.render(x)),this.finally&&(C+=this.finally.render(x)),C}optimizeNodes(){var x,C;return super.optimizeNodes(),(x=this.catch)===null||x===void 0||x.optimizeNodes(),(C=this.finally)===null||C===void 0||C.optimizeNodes(),this}optimizeNames(x,C){var $,F;return super.optimizeNames(x,C),($=this.catch)===null||$===void 0||$.optimizeNames(x,C),(F=this.finally)===null||F===void 0||F.optimizeNames(x,C),this}get names(){const x=super.names;return this.catch&&B(x,this.catch.names),this.finally&&B(x,this.finally.names),x}}class P extends p{constructor(x){super(),this.error=x}render(x){return`catch(${this.error})`+super.render(x)}}P.kind="catch";class R extends p{render(x){return"finally"+super.render(x)}}R.kind="finally";class X{constructor(x,C={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...C,_n:C.lines?`
`:""},this._extScope=x,this._scope=new s.Scope({parent:x}),this._nodes=[new g]}toString(){return this._root.render(this.opts)}name(x){return this._scope.name(x)}scopeName(x){return this._extScope.name(x)}scopeValue(x,C){const $=this._extScope.value(x,C);return(this._values[$.prefix]||(this._values[$.prefix]=new Set)).add($),$}getScopeValue(x,C){return this._extScope.getValue(x,C)}scopeRefs(x){return this._extScope.scopeRefs(x,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(x,C,$,F){const Y=this._scope.toName(C);return $!==void 0&&F&&(this._constants[Y.str]=$),this._leafNode(new i(x,Y,$)),Y}const(x,C,$){return this._def(s.varKinds.const,x,C,$)}let(x,C,$){return this._def(s.varKinds.let,x,C,$)}var(x,C,$){return this._def(s.varKinds.var,x,C,$)}assign(x,C,$){return this._leafNode(new a(x,C,$))}add(x,C){return this._leafNode(new l(x,e.operators.ADD,C))}code(x){return typeof x=="function"?x():x!==t.nil&&this._leafNode(new d(x)),this}object(...x){const C=["{"];for(const[$,F]of x)C.length>1&&C.push(","),C.push($),($!==F||this.opts.es5)&&(C.push(":"),(0,t.addCodeArg)(C,F));return C.push("}"),new t._Code(C)}if(x,C,$){if(this._blockNode(new y(x)),C&&$)this.code(C).else().code($).endIf();else if(C)this.code(C).endIf();else if($)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(x){return this._elseNode(new y(x))}else(){return this._elseNode(new m)}endIf(){return this._endBlockNode(y,m)}_for(x,C){return this._blockNode(x),C&&this.code(C).endFor(),this}for(x,C){return this._for(new b(x),C)}forRange(x,C,$,F,Y=this.opts.es5?s.varKinds.var:s.varKinds.let){const ct=this._scope.toName(x);return this._for(new w(Y,ct,C,$),()=>F(ct))}forOf(x,C,$,F=s.varKinds.const){const Y=this._scope.toName(x);if(this.opts.es5){const ct=C instanceof t.Name?C:this.var("_arr",C);return this.forRange("_i",0,(0,t._)`${ct}.length`,wt=>{this.var(Y,(0,t._)`${ct}[${wt}]`),$(Y)})}return this._for(new S("of",F,Y,C),()=>$(Y))}forIn(x,C,$,F=this.opts.es5?s.varKinds.var:s.varKinds.const){if(this.opts.ownProperties)return this.forOf(x,(0,t._)`Object.keys(${C})`,$);const Y=this._scope.toName(x);return this._for(new S("in",F,Y,C),()=>$(Y))}endFor(){return this._endBlockNode(v)}label(x){return this._leafNode(new c(x))}break(x){return this._leafNode(new u(x))}return(x){const C=new A;if(this._blockNode(C),this.code(x),C.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(A)}try(x,C,$){if(!C&&!$)throw new Error('CodeGen: "try" without "catch" and "finally"');const F=new O;if(this._blockNode(F),this.code(x),C){const Y=this.name("e");this._currNode=F.catch=new P(Y),C(Y)}return $&&(this._currNode=F.finally=new R,this.code($)),this._endBlockNode(P,R)}throw(x){return this._leafNode(new h(x))}block(x,C){return this._blockStarts.push(this._nodes.length),x&&this.code(x).endBlock(C),this}endBlock(x){const C=this._blockStarts.pop();if(C===void 0)throw new Error("CodeGen: not in self-balancing block");const $=this._nodes.length-C;if($<0||x!==void 0&&$!==x)throw new Error(`CodeGen: wrong number of nodes: ${$} vs ${x} expected`);return this._nodes.length=C,this}func(x,C=t.nil,$,F){return this._blockNode(new _(x,C,$)),F&&this.code(F).endFunc(),this}endFunc(){return this._endBlockNode(_)}optimize(x=1){for(;x-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(x){return this._currNode.nodes.push(x),this}_blockNode(x){this._currNode.nodes.push(x),this._nodes.push(x)}_endBlockNode(x,C){const $=this._currNode;if($ instanceof x||C&&$ instanceof C)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${C?`${x.kind}/${C.kind}`:x.kind}"`)}_elseNode(x){const C=this._currNode;if(!(C instanceof y))throw new Error('CodeGen: "else" without "if"');return this._currNode=C.else=x,this}get _root(){return this._nodes[0]}get _currNode(){const x=this._nodes;return x[x.length-1]}set _currNode(x){const C=this._nodes;C[C.length-1]=x}}e.CodeGen=X;function B(D,x){for(const C in x)D[C]=(D[C]||0)+(x[C]||0);return D}function H(D,x){return x instanceof t._CodeOrName?B(D,x.names):D}function j(D,x,C){if(D instanceof t.Name)return $(D);if(!F(D))return D;return new t._Code(D._items.reduce((Y,ct)=>(ct instanceof t.Name&&(ct=$(ct)),ct instanceof t._Code?Y.push(...ct._items):Y.push(ct),Y),[]));function $(Y){const ct=C[Y.str];return ct===void 0||x[Y.str]!==1?Y:(delete x[Y.str],ct)}function F(Y){return Y instanceof t._Code&&Y._items.some(ct=>ct instanceof t.Name&&x[ct.str]===1&&C[ct.str]!==void 0)}}function K(D,x){for(const C in x)D[C]=(D[C]||0)-(x[C]||0)}function nt(D){return typeof D=="boolean"||typeof D=="number"||D===null?!D:(0,t._)`!${L(D)}`}e.not=nt;const ht=E(e.operators.AND);function St(...D){return D.reduce(ht)}e.and=St;const U=E(e.operators.OR);function N(...D){return D.reduce(U)}e.or=N;function E(D){return(x,C)=>x===t.nil?C:C===t.nil?x:(0,t._)`${L(x)} ${D} ${L(C)}`}function L(D){return D instanceof t.Name?D:(0,t._)`(${D})`}}(_t);var Et={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=_t,s=zi;function n(_){const A={};for(const O of _)A[O]=!0;return A}e.toHash=n;function r(_,A){return typeof A=="boolean"?A:Object.keys(A).length===0?!0:(o(_,A),!i(A,_.self.RULES.all))}e.alwaysValidSchema=r;function o(_,A=_.schema){const{opts:O,self:P}=_;if(!O.strictSchema||typeof A=="boolean")return;const R=P.RULES.keywords;for(const X in A)R[X]||S(_,`unknown keyword: "${X}"`)}e.checkUnknownRules=o;function i(_,A){if(typeof _=="boolean")return!_;for(const O in _)if(A[O])return!0;return!1}e.schemaHasRules=i;function a(_,A){if(typeof _=="boolean")return!_;for(const O in _)if(O!=="$ref"&&A.all[O])return!0;return!1}e.schemaHasRulesButRef=a;function l({topSchemaRef:_,schemaPath:A},O,P,R){if(!R){if(typeof O=="number"||typeof O=="boolean")return O;if(typeof O=="string")return(0,t._)`${O}`}return(0,t._)`${_}${A}${(0,t.getProperty)(P)}`}e.schemaRefOrVal=l;function c(_){return d(decodeURIComponent(_))}e.unescapeFragment=c;function u(_){return encodeURIComponent(h(_))}e.escapeFragment=u;function h(_){return typeof _=="number"?`${_}`:_.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=h;function d(_){return _.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=d;function f(_,A){if(Array.isArray(_))for(const O of _)A(O);else A(_)}e.eachItem=f;function p({mergeNames:_,mergeToName:A,mergeValues:O,resultToName:P}){return(R,X,B,H)=>{const j=B===void 0?X:B instanceof t.Name?(X instanceof t.Name?_(R,X,B):A(R,X,B),B):X instanceof t.Name?(A(R,B,X),X):O(X,B);return H===t.Name&&!(j instanceof t.Name)?P(R,j):j}}e.mergeEvaluated={props:p({mergeNames:(_,A,O)=>_.if((0,t._)`${O} !== true && ${A} !== undefined`,()=>{_.if((0,t._)`${A} === true`,()=>_.assign(O,!0),()=>_.assign(O,(0,t._)`${O} || {}`).code((0,t._)`Object.assign(${O}, ${A})`))}),mergeToName:(_,A,O)=>_.if((0,t._)`${O} !== true`,()=>{A===!0?_.assign(O,!0):(_.assign(O,(0,t._)`${O} || {}`),m(_,O,A))}),mergeValues:(_,A)=>_===!0?!0:{..._,...A},resultToName:g}),items:p({mergeNames:(_,A,O)=>_.if((0,t._)`${O} !== true && ${A} !== undefined`,()=>_.assign(O,(0,t._)`${A} === true ? true : ${O} > ${A} ? ${O} : ${A}`)),mergeToName:(_,A,O)=>_.if((0,t._)`${O} !== true`,()=>_.assign(O,A===!0?!0:(0,t._)`${O} > ${A} ? ${O} : ${A}`)),mergeValues:(_,A)=>_===!0?!0:Math.max(_,A),resultToName:(_,A)=>_.var("items",A)})};function g(_,A){if(A===!0)return _.var("props",!0);const O=_.var("props",(0,t._)`{}`);return A!==void 0&&m(_,O,A),O}e.evaluatedPropsToName=g;function m(_,A,O){Object.keys(O).forEach(P=>_.assign((0,t._)`${A}${(0,t.getProperty)(P)}`,!0))}e.setEvaluated=m;const y={};function v(_,A){return _.scopeValue("func",{ref:A,code:y[A.code]||(y[A.code]=new s._Code(A.code))})}e.useFunc=v;var b;(function(_){_[_.Num=0]="Num",_[_.Str=1]="Str"})(b=e.Type||(e.Type={}));function w(_,A,O){if(_ instanceof t.Name){const P=A===b.Num;return O?P?(0,t._)`"[" + ${_} + "]"`:(0,t._)`"['" + ${_} + "']"`:P?(0,t._)`"/" + ${_}`:(0,t._)`"/" + ${_}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return O?(0,t.getProperty)(_).toString():"/"+h(_)}e.getErrorPath=w;function S(_,A,O=_.opts.strictSchema){if(O){if(A=`strict mode: ${A}`,O===!0)throw new Error(A);_.self.logger.warn(A)}}e.checkStrictMode=S})(Et);var on={};Object.defineProperty(on,"__esModule",{value:!0});const He=_t,T2={data:new He.Name("data"),valCxt:new He.Name("valCxt"),instancePath:new He.Name("instancePath"),parentData:new He.Name("parentData"),parentDataProperty:new He.Name("parentDataProperty"),rootData:new He.Name("rootData"),dynamicAnchors:new He.Name("dynamicAnchors"),vErrors:new He.Name("vErrors"),errors:new He.Name("errors"),this:new He.Name("this"),self:new He.Name("self"),scope:new He.Name("scope"),json:new He.Name("json"),jsonPos:new He.Name("jsonPos"),jsonLen:new He.Name("jsonLen"),jsonPart:new He.Name("jsonPart")};on.default=T2,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=_t,s=Et,n=on;e.keywordError={message:({keyword:m})=>(0,t.str)`must pass "${m}" keyword validation`},e.keyword$DataError={message:({keyword:m,schemaType:y})=>y?(0,t.str)`"${m}" keyword must be ${y} ($data)`:(0,t.str)`"${m}" keyword is invalid ($data)`};function r(m,y=e.keywordError,v,b){const{it:w}=m,{gen:S,compositeRule:_,allErrors:A}=w,O=h(m,y,v);b??(_||A)?l(S,O):c(w,(0,t._)`[${O}]`)}e.reportError=r;function o(m,y=e.keywordError,v){const{it:b}=m,{gen:w,compositeRule:S,allErrors:_}=b,A=h(m,y,v);l(w,A),S||_||c(b,n.default.vErrors)}e.reportExtraError=o;function i(m,y){m.assign(n.default.errors,y),m.if((0,t._)`${n.default.vErrors} !== null`,()=>m.if(y,()=>m.assign((0,t._)`${n.default.vErrors}.length`,y),()=>m.assign(n.default.vErrors,null)))}e.resetErrorsCount=i;function a({gen:m,keyword:y,schemaValue:v,data:b,errsCount:w,it:S}){if(w===void 0)throw new Error("ajv implementation error");const _=m.name("err");m.forRange("i",w,n.default.errors,A=>{m.const(_,(0,t._)`${n.default.vErrors}[${A}]`),m.if((0,t._)`${_}.instancePath === undefined`,()=>m.assign((0,t._)`${_}.instancePath`,(0,t.strConcat)(n.default.instancePath,S.errorPath))),m.assign((0,t._)`${_}.schemaPath`,(0,t.str)`${S.errSchemaPath}/${y}`),S.opts.verbose&&(m.assign((0,t._)`${_}.schema`,v),m.assign((0,t._)`${_}.data`,b))})}e.extendErrors=a;function l(m,y){const v=m.const("err",y);m.if((0,t._)`${n.default.vErrors} === null`,()=>m.assign(n.default.vErrors,(0,t._)`[${v}]`),(0,t._)`${n.default.vErrors}.push(${v})`),m.code((0,t._)`${n.default.errors}++`)}function c(m,y){const{gen:v,validateName:b,schemaEnv:w}=m;w.$async?v.throw((0,t._)`new ${m.ValidationError}(${y})`):(v.assign((0,t._)`${b}.errors`,y),v.return(!1))}const u={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function h(m,y,v){const{createErrors:b}=m.it;return b===!1?(0,t._)`{}`:d(m,y,v)}function d(m,y,v={}){const{gen:b,it:w}=m,S=[f(w,v),p(m,v)];return g(m,y,S),b.object(...S)}function f({errorPath:m},{instancePath:y}){const v=y?(0,t.str)`${m}${(0,s.getErrorPath)(y,s.Type.Str)}`:m;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,v)]}function p({keyword:m,it:{errSchemaPath:y}},{schemaPath:v,parentSchema:b}){let w=b?y:(0,t.str)`${y}/${m}`;return v&&(w=(0,t.str)`${w}${(0,s.getErrorPath)(v,s.Type.Str)}`),[u.schemaPath,w]}function g(m,{params:y,message:v},b){const{keyword:w,data:S,schemaValue:_,it:A}=m,{opts:O,propertyName:P,topSchemaRef:R,schemaPath:X}=A;b.push([u.keyword,w],[u.params,typeof y=="function"?y(m):y||(0,t._)`{}`]),O.messages&&b.push([u.message,typeof v=="function"?v(m):v]),O.verbose&&b.push([u.schema,_],[u.parentSchema,(0,t._)`${R}${X}`],[n.default.data,S]),P&&b.push([u.propertyName,P])}}(Vi),Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.boolOrEmptySchema=Eo.topBoolOrEmptySchema=void 0;const P2=Vi,M2=_t,I2=on,E2={message:"boolean schema is false"};function $2(e){const{gen:t,schema:s,validateName:n}=e;s===!1?Dy(e,!1):typeof s=="object"&&s.$async===!0?t.return(I2.default.data):(t.assign((0,M2._)`${n}.errors`,null),t.return(!0))}Eo.topBoolOrEmptySchema=$2;function R2(e,t){const{gen:s,schema:n}=e;n===!1?(s.var(t,!1),Dy(e)):s.var(t,!0)}Eo.boolOrEmptySchema=R2;function Dy(e,t){const{gen:s,data:n}=e,r={gen:s,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,P2.reportError)(r,E2,void 0,t)}var Gi={},Ir={};Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.getRules=Ir.isJSONType=void 0;const D2=["string","number","integer","boolean","null","object","array"],N2=new Set(D2);function L2(e){return typeof e=="string"&&N2.has(e)}Ir.isJSONType=L2;function B2(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}Ir.getRules=B2;var En={};Object.defineProperty(En,"__esModule",{value:!0}),En.shouldUseRule=En.shouldUseGroup=En.schemaHasRulesForType=void 0;function j2({schema:e,self:t},s){const n=t.RULES.types[s];return n&&n!==!0&&Ny(e,n)}En.schemaHasRulesForType=j2;function Ny(e,t){return t.rules.some(s=>Ly(e,s))}En.shouldUseGroup=Ny;function Ly(e,t){var s;return e[t.keyword]!==void 0||((s=t.definition.implements)===null||s===void 0?void 0:s.some(n=>e[n]!==void 0))}En.shouldUseRule=Ly,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=Ir,s=En,n=Vi,r=_t,o=Et;var i;(function(b){b[b.Correct=0]="Correct",b[b.Wrong=1]="Wrong"})(i=e.DataType||(e.DataType={}));function a(b){const w=l(b.type);if(w.includes("null")){if(b.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!w.length&&b.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');b.nullable===!0&&w.push("null")}return w}e.getSchemaTypes=a;function l(b){const w=Array.isArray(b)?b:b?[b]:[];if(w.every(t.isJSONType))return w;throw new Error("type must be JSONType or JSONType[]: "+w.join(","))}e.getJSONTypes=l;function c(b,w){const{gen:S,data:_,opts:A}=b,O=h(w,A.coerceTypes),P=w.length>0&&!(O.length===0&&w.length===1&&(0,s.schemaHasRulesForType)(b,w[0]));if(P){const R=g(w,_,A.strictNumbers,i.Wrong);S.if(R,()=>{O.length?d(b,w,O):y(b)})}return P}e.coerceAndCheckDataType=c;const u=new Set(["string","number","integer","boolean","null"]);function h(b,w){return w?b.filter(S=>u.has(S)||w==="array"&&S==="array"):[]}function d(b,w,S){const{gen:_,data:A,opts:O}=b,P=_.let("dataType",(0,r._)`typeof ${A}`),R=_.let("coerced",(0,r._)`undefined`);O.coerceTypes==="array"&&_.if((0,r._)`${P} == 'object' && Array.isArray(${A}) && ${A}.length == 1`,()=>_.assign(A,(0,r._)`${A}[0]`).assign(P,(0,r._)`typeof ${A}`).if(g(w,A,O.strictNumbers),()=>_.assign(R,A))),_.if((0,r._)`${R} !== undefined`);for(const B of S)(u.has(B)||B==="array"&&O.coerceTypes==="array")&&X(B);_.else(),y(b),_.endIf(),_.if((0,r._)`${R} !== undefined`,()=>{_.assign(A,R),f(b,R)});function X(B){switch(B){case"string":_.elseIf((0,r._)`${P} == "number" || ${P} == "boolean"`).assign(R,(0,r._)`"" + ${A}`).elseIf((0,r._)`${A} === null`).assign(R,(0,r._)`""`);return;case"number":_.elseIf((0,r._)`${P} == "boolean" || ${A} === null
              || (${P} == "string" && ${A} && ${A} == +${A})`).assign(R,(0,r._)`+${A}`);return;case"integer":_.elseIf((0,r._)`${P} === "boolean" || ${A} === null
              || (${P} === "string" && ${A} && ${A} == +${A} && !(${A} % 1))`).assign(R,(0,r._)`+${A}`);return;case"boolean":_.elseIf((0,r._)`${A} === "false" || ${A} === 0 || ${A} === null`).assign(R,!1).elseIf((0,r._)`${A} === "true" || ${A} === 1`).assign(R,!0);return;case"null":_.elseIf((0,r._)`${A} === "" || ${A} === 0 || ${A} === false`),_.assign(R,null);return;case"array":_.elseIf((0,r._)`${P} === "string" || ${P} === "number"
              || ${P} === "boolean" || ${A} === null`).assign(R,(0,r._)`[${A}]`)}}}function f({gen:b,parentData:w,parentDataProperty:S},_){b.if((0,r._)`${w} !== undefined`,()=>b.assign((0,r._)`${w}[${S}]`,_))}function p(b,w,S,_=i.Correct){const A=_===i.Correct?r.operators.EQ:r.operators.NEQ;let O;switch(b){case"null":return(0,r._)`${w} ${A} null`;case"array":O=(0,r._)`Array.isArray(${w})`;break;case"object":O=(0,r._)`${w} && typeof ${w} == "object" && !Array.isArray(${w})`;break;case"integer":O=P((0,r._)`!(${w} % 1) && !isNaN(${w})`);break;case"number":O=P();break;default:return(0,r._)`typeof ${w} ${A} ${b}`}return _===i.Correct?O:(0,r.not)(O);function P(R=r.nil){return(0,r.and)((0,r._)`typeof ${w} == "number"`,R,S?(0,r._)`isFinite(${w})`:r.nil)}}e.checkDataType=p;function g(b,w,S,_){if(b.length===1)return p(b[0],w,S,_);let A;const O=(0,o.toHash)(b);if(O.array&&O.object){const P=(0,r._)`typeof ${w} != "object"`;A=O.null?P:(0,r._)`!${w} || ${P}`,delete O.null,delete O.array,delete O.object}else A=r.nil;O.number&&delete O.integer;for(const P in O)A=(0,r.and)(A,p(P,w,S,_));return A}e.checkDataTypes=g;const m={message:({schema:b})=>`must be ${b}`,params:({schema:b,schemaValue:w})=>typeof b=="string"?(0,r._)`{type: ${b}}`:(0,r._)`{type: ${w}}`};function y(b){const w=v(b);(0,n.reportError)(w,m)}e.reportTypeError=y;function v(b){const{gen:w,data:S,schema:_}=b,A=(0,o.schemaRefOrVal)(b,_,"type");return{gen:w,keyword:"type",data:S,schema:_.type,schemaCode:A,schemaValue:A,parentSchema:_,params:{},it:b}}}(Gi);var Cl={};Object.defineProperty(Cl,"__esModule",{value:!0}),Cl.assignDefaults=void 0;const $o=_t,F2=Et;function V2(e,t){const{properties:s,items:n}=e.schema;if(t==="object"&&s)for(const r in s)By(e,r,s[r].default);else t==="array"&&Array.isArray(n)&&n.forEach((r,o)=>By(e,o,r.default))}Cl.assignDefaults=V2;function By(e,t,s){const{gen:n,compositeRule:r,data:o,opts:i}=e;if(s===void 0)return;const a=(0,$o._)`${o}${(0,$o.getProperty)(t)}`;if(r){(0,F2.checkStrictMode)(e,`default is ignored for: ${a}`);return}let l=(0,$o._)`${a} === undefined`;i.useDefaults==="empty"&&(l=(0,$o._)`${l} || ${a} === null || ${a} === ""`),n.if(l,(0,$o._)`${a} = ${(0,$o.stringify)(s)}`)}var an={},At={};Object.defineProperty(At,"__esModule",{value:!0}),At.validateUnion=At.validateArray=At.usePattern=At.callValidateCode=At.schemaProperties=At.allSchemaProperties=At.noPropertyInData=At.propertyInData=At.isOwnProperty=At.hasPropFunc=At.reportMissingProp=At.checkMissingProp=At.checkReportMissingProp=void 0;const Xt=_t,rd=Et,qn=on,z2=Et;function G2(e,t){const{gen:s,data:n,it:r}=e;s.if(id(s,n,t,r.opts.ownProperties),()=>{e.setParams({missingProperty:(0,Xt._)`${t}`},!0),e.error()})}At.checkReportMissingProp=G2;function U2({gen:e,data:t,it:{opts:s}},n,r){return(0,Xt.or)(...n.map(o=>(0,Xt.and)(id(e,t,o,s.ownProperties),(0,Xt._)`${r} = ${o}`)))}At.checkMissingProp=U2;function H2(e,t){e.setParams({missingProperty:t},!0),e.error()}At.reportMissingProp=H2;function jy(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Xt._)`Object.prototype.hasOwnProperty`})}At.hasPropFunc=jy;function od(e,t,s){return(0,Xt._)`${jy(e)}.call(${t}, ${s})`}At.isOwnProperty=od;function W2(e,t,s,n){const r=(0,Xt._)`${t}${(0,Xt.getProperty)(s)} !== undefined`;return n?(0,Xt._)`${r} && ${od(e,t,s)}`:r}At.propertyInData=W2;function id(e,t,s,n){const r=(0,Xt._)`${t}${(0,Xt.getProperty)(s)} === undefined`;return n?(0,Xt.or)(r,(0,Xt.not)(od(e,t,s))):r}At.noPropertyInData=id;function Fy(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}At.allSchemaProperties=Fy;function X2(e,t){return Fy(t).filter(s=>!(0,rd.alwaysValidSchema)(e,t[s]))}At.schemaProperties=X2;function Y2({schemaCode:e,data:t,it:{gen:s,topSchemaRef:n,schemaPath:r,errorPath:o},it:i},a,l,c){const u=c?(0,Xt._)`${e}, ${t}, ${n}${r}`:t,h=[[qn.default.instancePath,(0,Xt.strConcat)(qn.default.instancePath,o)],[qn.default.parentData,i.parentData],[qn.default.parentDataProperty,i.parentDataProperty],[qn.default.rootData,qn.default.rootData]];i.opts.dynamicRef&&h.push([qn.default.dynamicAnchors,qn.default.dynamicAnchors]);const d=(0,Xt._)`${u}, ${s.object(...h)}`;return l!==Xt.nil?(0,Xt._)`${a}.call(${l}, ${d})`:(0,Xt._)`${a}(${d})`}At.callValidateCode=Y2;const Z2=(0,Xt._)`new RegExp`;function q2({gen:e,it:{opts:t}},s){const n=t.unicodeRegExp?"u":"",{regExp:r}=t.code,o=r(s,n);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,Xt._)`${r.code==="new RegExp"?Z2:(0,z2.useFunc)(e,r)}(${s}, ${n})`})}At.usePattern=q2;function Q2(e){const{gen:t,data:s,keyword:n,it:r}=e,o=t.name("valid");if(r.allErrors){const a=t.let("valid",!0);return i(()=>t.assign(a,!1)),a}return t.var(o,!0),i(()=>t.break()),o;function i(a){const l=t.const("len",(0,Xt._)`${s}.length`);t.forRange("i",0,l,c=>{e.subschema({keyword:n,dataProp:c,dataPropType:rd.Type.Num},o),t.if((0,Xt.not)(o),a)})}}At.validateArray=Q2;function K2(e){const{gen:t,schema:s,keyword:n,it:r}=e;if(!Array.isArray(s))throw new Error("ajv implementation error");if(s.some(a=>(0,rd.alwaysValidSchema)(r,a))&&!r.opts.unevaluated)return;const o=t.let("valid",!1),i=t.name("_valid");t.block(()=>s.forEach((a,l)=>{const c=e.subschema({keyword:n,schemaProp:l,compositeRule:!0},i);t.assign(o,(0,Xt._)`${o} || ${i}`),e.mergeValidEvaluated(c,i)||t.if((0,Xt.not)(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))}At.validateUnion=K2,Object.defineProperty(an,"__esModule",{value:!0}),an.validateKeywordUsage=an.validSchemaType=an.funcKeywordCode=an.macroKeywordCode=void 0;const ss=_t,Er=on,J2=At,tP=Vi;function eP(e,t){const{gen:s,keyword:n,schema:r,parentSchema:o,it:i}=e,a=t.macro.call(i.self,r,o,i),l=zy(s,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);const c=s.name("valid");e.subschema({schema:a,schemaPath:ss.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:l,compositeRule:!0},c),e.pass(c,()=>e.error(!0))}an.macroKeywordCode=eP;function sP(e,t){var s;const{gen:n,keyword:r,schema:o,parentSchema:i,$data:a,it:l}=e;rP(l,t);const c=!a&&t.compile?t.compile.call(l.self,o,i,l):t.validate,u=zy(n,r,c),h=n.let("valid");e.block$data(h,d),e.ok((s=t.valid)!==null&&s!==void 0?s:h);function d(){if(t.errors===!1)g(),t.modifying&&Vy(e),m(()=>e.error());else{const y=t.async?f():p();t.modifying&&Vy(e),m(()=>nP(e,y))}}function f(){const y=n.let("ruleErrs",null);return n.try(()=>g((0,ss._)`await `),v=>n.assign(h,!1).if((0,ss._)`${v} instanceof ${l.ValidationError}`,()=>n.assign(y,(0,ss._)`${v}.errors`),()=>n.throw(v))),y}function p(){const y=(0,ss._)`${u}.errors`;return n.assign(y,null),g(ss.nil),y}function g(y=t.async?(0,ss._)`await `:ss.nil){const v=l.opts.passContext?Er.default.this:Er.default.self,b=!("compile"in t&&!a||t.schema===!1);n.assign(h,(0,ss._)`${y}${(0,J2.callValidateCode)(e,u,v,b)}`,t.modifying)}function m(y){var v;n.if((0,ss.not)((v=t.valid)!==null&&v!==void 0?v:h),y)}}an.funcKeywordCode=sP;function Vy(e){const{gen:t,data:s,it:n}=e;t.if(n.parentData,()=>t.assign(s,(0,ss._)`${n.parentData}[${n.parentDataProperty}]`))}function nP(e,t){const{gen:s}=e;s.if((0,ss._)`Array.isArray(${t})`,()=>{s.assign(Er.default.vErrors,(0,ss._)`${Er.default.vErrors} === null ? ${t} : ${Er.default.vErrors}.concat(${t})`).assign(Er.default.errors,(0,ss._)`${Er.default.vErrors}.length`),(0,tP.extendErrors)(e)},()=>e.error())}function rP({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function zy(e,t,s){if(s===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof s=="function"?{ref:s}:{ref:s,code:(0,ss.stringify)(s)})}function oP(e,t,s=!1){return!t.length||t.some(n=>n==="array"?Array.isArray(e):n==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==n||s&&typeof e>"u")}an.validSchemaType=oP;function iP({schema:e,opts:t,self:s,errSchemaPath:n},r,o){if(Array.isArray(r.keyword)?!r.keyword.includes(o):r.keyword!==o)throw new Error("ajv implementation error");const i=r.dependencies;if(i!=null&&i.some(a=>!Object.prototype.hasOwnProperty.call(e,a)))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(r.validateSchema&&!r.validateSchema(e[o])){const a=`keyword "${o}" value is invalid at path "${n}": `+s.errorsText(r.validateSchema.errors);if(t.validateSchema==="log")s.logger.error(a);else throw new Error(a)}}an.validateKeywordUsage=iP;var Qn={};Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.extendSubschemaMode=Qn.extendSubschemaData=Qn.getSubschema=void 0;const ln=_t,Gy=Et;function aP(e,{keyword:t,schemaProp:s,schema:n,schemaPath:r,errSchemaPath:o,topSchemaRef:i}){if(t!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const a=e.schema[t];return s===void 0?{schema:a,schemaPath:(0,ln._)`${e.schemaPath}${(0,ln.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:a[s],schemaPath:(0,ln._)`${e.schemaPath}${(0,ln.getProperty)(t)}${(0,ln.getProperty)(s)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,Gy.escapeFragment)(s)}`}}if(n!==void 0){if(r===void 0||o===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:r,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Qn.getSubschema=aP;function lP(e,t,{dataProp:s,dataPropType:n,data:r,dataTypes:o,propertyName:i}){if(r!==void 0&&s!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=t;if(s!==void 0){const{errorPath:c,dataPathArr:u,opts:h}=t,d=a.let("data",(0,ln._)`${t.data}${(0,ln.getProperty)(s)}`,!0);l(d),e.errorPath=(0,ln.str)`${c}${(0,Gy.getErrorPath)(s,n,h.jsPropertySyntax)}`,e.parentDataProperty=(0,ln._)`${s}`,e.dataPathArr=[...u,e.parentDataProperty]}if(r!==void 0){const c=r instanceof ln.Name?r:a.let("data",r,!0);l(c),i!==void 0&&(e.propertyName=i)}o&&(e.dataTypes=o);function l(c){e.data=c,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,c]}}Qn.extendSubschemaData=lP;function hP(e,{jtdDiscriminator:t,jtdMetadata:s,compositeRule:n,createErrors:r,allErrors:o}){n!==void 0&&(e.compositeRule=n),r!==void 0&&(e.createErrors=r),o!==void 0&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=s}Qn.extendSubschemaMode=hP;var Ee={},Uy=function e(t,s){if(t===s)return!0;if(t&&s&&typeof t=="object"&&typeof s=="object"){if(t.constructor!==s.constructor)return!1;var n,r,o;if(Array.isArray(t)){if(n=t.length,n!=s.length)return!1;for(r=n;r--!==0;)if(!e(t[r],s[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===s.toString();if(o=Object.keys(t),n=o.length,n!==Object.keys(s).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(s,o[r]))return!1;for(r=n;r--!==0;){var i=o[r];if(!e(t[i],s[i]))return!1}return!0}return t!==t&&s!==s},Hy={exports:{}},Kn=Hy.exports=function(e,t,s){typeof t=="function"&&(s=t,t={}),s=t.cb||s;var n=typeof s=="function"?s:s.pre||function(){},r=s.post||function(){};Ol(t,n,r,e,"",e)};Kn.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},Kn.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},Kn.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},Kn.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Ol(e,t,s,n,r,o,i,a,l,c){if(n&&typeof n=="object"&&!Array.isArray(n)){t(n,r,o,i,a,l,c);for(var u in n){var h=n[u];if(Array.isArray(h)){if(u in Kn.arrayKeywords)for(var d=0;d<h.length;d++)Ol(e,t,s,h[d],r+"/"+u+"/"+d,o,r,u,n,d)}else if(u in Kn.propsKeywords){if(h&&typeof h=="object")for(var f in h)Ol(e,t,s,h[f],r+"/"+u+"/"+cP(f),o,r,u,n,f)}else(u in Kn.keywords||e.allKeys&&!(u in Kn.skipKeywords))&&Ol(e,t,s,h,r+"/"+u,o,r,u,n)}s(n,r,o,i,a,l,c)}}function cP(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}var uP=Hy.exports;Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.getSchemaRefs=Ee.resolveUrl=Ee.normalizeId=Ee._getFullPath=Ee.getFullPath=Ee.inlineRef=void 0;const dP=Et,fP=Uy,pP=uP,mP=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function gP(e,t=!0){return typeof e=="boolean"?!0:t===!0?!ad(e):t?Wy(e)<=t:!1}Ee.inlineRef=gP;const yP=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function ad(e){for(const t in e){if(yP.has(t))return!0;const s=e[t];if(Array.isArray(s)&&s.some(ad)||typeof s=="object"&&ad(s))return!0}return!1}function Wy(e){let t=0;for(const s in e)if(s==="$ref"||(t++,!mP.has(s)&&(typeof e[s]=="object"&&(0,dP.eachItem)(e[s],n=>t+=Wy(n)),t===1/0)))return 1/0;return t}function Xy(e,t="",s){s!==!1&&(t=Ro(t));const n=e.parse(t);return Yy(e,n)}Ee.getFullPath=Xy;function Yy(e,t){return e.serialize(t).split("#")[0]+"#"}Ee._getFullPath=Yy;const vP=/#\/?$/;function Ro(e){return e?e.replace(vP,""):""}Ee.normalizeId=Ro;function bP(e,t,s){return s=Ro(s),e.resolve(t,s)}Ee.resolveUrl=bP;const wP=/^[a-z_][-a-z0-9._]*$/i;function xP(e,t){if(typeof e=="boolean")return{};const{schemaId:s,uriResolver:n}=this.opts,r=Ro(e[s]||t),o={"":r},i=Xy(n,r,!1),a={},l=new Set;return pP(e,{allKeys:!0},(h,d,f,p)=>{if(p===void 0)return;const g=i+d;let m=o[p];typeof h[s]=="string"&&(m=y.call(this,h[s])),v.call(this,h.$anchor),v.call(this,h.$dynamicAnchor),o[d]=m;function y(b){const w=this.opts.uriResolver.resolve;if(b=Ro(m?w(m,b):b),l.has(b))throw u(b);l.add(b);let S=this.refs[b];return typeof S=="string"&&(S=this.refs[S]),typeof S=="object"?c(h,S.schema,b):b!==Ro(g)&&(b[0]==="#"?(c(h,a[b],b),a[b]=h):this.refs[b]=g),b}function v(b){if(typeof b=="string"){if(!wP.test(b))throw new Error(`invalid anchor "${b}"`);y.call(this,`#${b}`)}}}),a;function c(h,d,f){if(d!==void 0&&!fP(h,d))throw u(f)}function u(h){return new Error(`reference "${h}" resolves to more than one schema`)}}Ee.getSchemaRefs=xP,Object.defineProperty(zs,"__esModule",{value:!0}),zs.getData=zs.KeywordCxt=zs.validateFunctionCode=void 0;const Zy=Eo,qy=Gi,ld=En,Tl=Gi,_P=Cl,Ui=an,hd=Qn,rt=_t,pt=on,AP=Ee,$n=Et,Hi=Vi;function kP(e){if(tv(e)&&(ev(e),Jy(e))){OP(e);return}Qy(e,()=>(0,Zy.topBoolOrEmptySchema)(e))}zs.validateFunctionCode=kP;function Qy({gen:e,validateName:t,schema:s,schemaEnv:n,opts:r},o){r.code.es5?e.func(t,(0,rt._)`${pt.default.data}, ${pt.default.valCxt}`,n.$async,()=>{e.code((0,rt._)`"use strict"; ${Ky(s,r)}`),CP(e,r),e.code(o)}):e.func(t,(0,rt._)`${pt.default.data}, ${SP(r)}`,n.$async,()=>e.code(Ky(s,r)).code(o))}function SP(e){return(0,rt._)`{${pt.default.instancePath}="", ${pt.default.parentData}, ${pt.default.parentDataProperty}, ${pt.default.rootData}=${pt.default.data}${e.dynamicRef?(0,rt._)`, ${pt.default.dynamicAnchors}={}`:rt.nil}}={}`}function CP(e,t){e.if(pt.default.valCxt,()=>{e.var(pt.default.instancePath,(0,rt._)`${pt.default.valCxt}.${pt.default.instancePath}`),e.var(pt.default.parentData,(0,rt._)`${pt.default.valCxt}.${pt.default.parentData}`),e.var(pt.default.parentDataProperty,(0,rt._)`${pt.default.valCxt}.${pt.default.parentDataProperty}`),e.var(pt.default.rootData,(0,rt._)`${pt.default.valCxt}.${pt.default.rootData}`),t.dynamicRef&&e.var(pt.default.dynamicAnchors,(0,rt._)`${pt.default.valCxt}.${pt.default.dynamicAnchors}`)},()=>{e.var(pt.default.instancePath,(0,rt._)`""`),e.var(pt.default.parentData,(0,rt._)`undefined`),e.var(pt.default.parentDataProperty,(0,rt._)`undefined`),e.var(pt.default.rootData,pt.default.data),t.dynamicRef&&e.var(pt.default.dynamicAnchors,(0,rt._)`{}`)})}function OP(e){const{schema:t,opts:s,gen:n}=e;Qy(e,()=>{s.$comment&&t.$comment&&nv(e),EP(e),n.let(pt.default.vErrors,null),n.let(pt.default.errors,0),s.unevaluated&&TP(e),sv(e),DP(e)})}function TP(e){const{gen:t,validateName:s}=e;e.evaluated=t.const("evaluated",(0,rt._)`${s}.evaluated`),t.if((0,rt._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,rt._)`${e.evaluated}.props`,(0,rt._)`undefined`)),t.if((0,rt._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,rt._)`${e.evaluated}.items`,(0,rt._)`undefined`))}function Ky(e,t){const s=typeof e=="object"&&e[t.schemaId];return s&&(t.code.source||t.code.process)?(0,rt._)`/*# sourceURL=${s} */`:rt.nil}function PP(e,t){if(tv(e)&&(ev(e),Jy(e))){MP(e,t);return}(0,Zy.boolOrEmptySchema)(e,t)}function Jy({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const s in e)if(t.RULES.all[s])return!0;return!1}function tv(e){return typeof e.schema!="boolean"}function MP(e,t){const{schema:s,gen:n,opts:r}=e;r.$comment&&s.$comment&&nv(e),$P(e),RP(e);const o=n.const("_errs",pt.default.errors);sv(e,o),n.var(t,(0,rt._)`${o} === ${pt.default.errors}`)}function ev(e){(0,$n.checkUnknownRules)(e),IP(e)}function sv(e,t){if(e.opts.jtd)return rv(e,[],!1,t);const s=(0,qy.getSchemaTypes)(e.schema),n=(0,qy.coerceAndCheckDataType)(e,s);rv(e,s,!n,t)}function IP(e){const{schema:t,errSchemaPath:s,opts:n,self:r}=e;t.$ref&&n.ignoreKeywordsWithRef&&(0,$n.schemaHasRulesButRef)(t,r.RULES)&&r.logger.warn(`$ref: keywords ignored in schema at path "${s}"`)}function EP(e){const{schema:t,opts:s}=e;t.default!==void 0&&s.useDefaults&&s.strictSchema&&(0,$n.checkStrictMode)(e,"default is ignored in the schema root")}function $P(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,AP.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function RP(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function nv({gen:e,schemaEnv:t,schema:s,errSchemaPath:n,opts:r}){const o=s.$comment;if(r.$comment===!0)e.code((0,rt._)`${pt.default.self}.logger.log(${o})`);else if(typeof r.$comment=="function"){const i=(0,rt.str)`${n}/$comment`,a=e.scopeValue("root",{ref:t.root});e.code((0,rt._)`${pt.default.self}.opts.$comment(${o}, ${i}, ${a}.schema)`)}}function DP(e){const{gen:t,schemaEnv:s,validateName:n,ValidationError:r,opts:o}=e;s.$async?t.if((0,rt._)`${pt.default.errors} === 0`,()=>t.return(pt.default.data),()=>t.throw((0,rt._)`new ${r}(${pt.default.vErrors})`)):(t.assign((0,rt._)`${n}.errors`,pt.default.vErrors),o.unevaluated&&NP(e),t.return((0,rt._)`${pt.default.errors} === 0`))}function NP({gen:e,evaluated:t,props:s,items:n}){s instanceof rt.Name&&e.assign((0,rt._)`${t}.props`,s),n instanceof rt.Name&&e.assign((0,rt._)`${t}.items`,n)}function rv(e,t,s,n){const{gen:r,schema:o,data:i,allErrors:a,opts:l,self:c}=e,{RULES:u}=c;if(o.$ref&&(l.ignoreKeywordsWithRef||!(0,$n.schemaHasRulesButRef)(o,u))){r.block(()=>lv(e,"$ref",u.all.$ref.definition));return}l.jtd||LP(e,t),r.block(()=>{for(const d of u.rules)h(d);h(u.post)});function h(d){(0,ld.shouldUseGroup)(o,d)&&(d.type?(r.if((0,Tl.checkDataType)(d.type,i,l.strictNumbers)),ov(e,d),t.length===1&&t[0]===d.type&&s&&(r.else(),(0,Tl.reportTypeError)(e)),r.endIf()):ov(e,d),a||r.if((0,rt._)`${pt.default.errors} === ${n||0}`))}}function ov(e,t){const{gen:s,schema:n,opts:{useDefaults:r}}=e;r&&(0,_P.assignDefaults)(e,t.type),s.block(()=>{for(const o of t.rules)(0,ld.shouldUseRule)(n,o)&&lv(e,o.keyword,o.definition,t.type)})}function LP(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(BP(e,t),e.opts.allowUnionTypes||jP(e,t),FP(e,e.dataTypes))}function BP(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(s=>{iv(e.dataTypes,s)||cd(e,`type "${s}" not allowed by context "${e.dataTypes.join(",")}"`)}),zP(e,t)}}function jP(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&cd(e,"use allowUnionTypes to allow union type keyword")}function FP(e,t){const s=e.self.RULES.all;for(const n in s){const r=s[n];if(typeof r=="object"&&(0,ld.shouldUseRule)(e.schema,r)){const{type:o}=r.definition;o.length&&!o.some(i=>VP(t,i))&&cd(e,`missing type "${o.join(",")}" for keyword "${n}"`)}}}function VP(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function iv(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function zP(e,t){const s=[];for(const n of e.dataTypes)iv(t,n)?s.push(n):t.includes("integer")&&n==="number"&&s.push("integer");e.dataTypes=s}function cd(e,t){const s=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${s}" (strictTypes)`,(0,$n.checkStrictMode)(e,t,e.opts.strictTypes)}class av{constructor(t,s,n){if((0,Ui.validateKeywordUsage)(t,s,n),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=n,this.data=t.data,this.schema=t.schema[n],this.$data=s.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,$n.schemaRefOrVal)(t,this.schema,n,this.$data),this.schemaType=s.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=s,this.$data)this.schemaCode=t.gen.const("vSchema",hv(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,Ui.validSchemaType)(this.schema,s.schemaType,s.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(s.schemaType)}`);("code"in s?s.trackErrors:s.errors!==!1)&&(this.errsCount=t.gen.const("_errs",pt.default.errors))}result(t,s,n){this.failResult((0,rt.not)(t),s,n)}failResult(t,s,n){this.gen.if(t),n?n():this.error(),s?(this.gen.else(),s(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,s){this.failResult((0,rt.not)(t),void 0,s)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:s}=this;this.fail((0,rt._)`${s} !== undefined && (${(0,rt.or)(this.invalid$data(),t)})`)}error(t,s,n){if(s){this.setParams(s),this._error(t,n),this.setParams({});return}this._error(t,n)}_error(t,s){(t?Hi.reportExtraError:Hi.reportError)(this,this.def.error,s)}$dataError(){(0,Hi.reportError)(this,this.def.$dataError||Hi.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Hi.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,s){s?Object.assign(this.params,t):this.params=t}block$data(t,s,n=rt.nil){this.gen.block(()=>{this.check$data(t,n),s()})}check$data(t=rt.nil,s=rt.nil){if(!this.$data)return;const{gen:n,schemaCode:r,schemaType:o,def:i}=this;n.if((0,rt.or)((0,rt._)`${r} === undefined`,s)),t!==rt.nil&&n.assign(t,!0),(o.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),t!==rt.nil&&n.assign(t,!1)),n.else()}invalid$data(){const{gen:t,schemaCode:s,schemaType:n,def:r,it:o}=this;return(0,rt.or)(i(),a());function i(){if(n.length){if(!(s instanceof rt.Name))throw new Error("ajv implementation error");const l=Array.isArray(n)?n:[n];return(0,rt._)`${(0,Tl.checkDataTypes)(l,s,o.opts.strictNumbers,Tl.DataType.Wrong)}`}return rt.nil}function a(){if(r.validateSchema){const l=t.scopeValue("validate$data",{ref:r.validateSchema});return(0,rt._)`!${l}(${s})`}return rt.nil}}subschema(t,s){const n=(0,hd.getSubschema)(this.it,t);(0,hd.extendSubschemaData)(n,this.it,t),(0,hd.extendSubschemaMode)(n,t);const r={...this.it,...n,items:void 0,props:void 0};return PP(r,s),r}mergeEvaluated(t,s){const{it:n,gen:r}=this;n.opts.unevaluated&&(n.props!==!0&&t.props!==void 0&&(n.props=$n.mergeEvaluated.props(r,t.props,n.props,s)),n.items!==!0&&t.items!==void 0&&(n.items=$n.mergeEvaluated.items(r,t.items,n.items,s)))}mergeValidEvaluated(t,s){const{it:n,gen:r}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return r.if(s,()=>this.mergeEvaluated(t,rt.Name)),!0}}zs.KeywordCxt=av;function lv(e,t,s,n){const r=new av(e,s,t);"code"in s?s.code(r,n):r.$data&&s.validate?(0,Ui.funcKeywordCode)(r,s):"macro"in s?(0,Ui.macroKeywordCode)(r,s):(s.compile||s.validate)&&(0,Ui.funcKeywordCode)(r,s)}const GP=/^\/(?:[^~]|~0|~1)*$/,UP=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function hv(e,{dataLevel:t,dataNames:s,dataPathArr:n}){let r,o;if(e==="")return pt.default.rootData;if(e[0]==="/"){if(!GP.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);r=e,o=pt.default.rootData}else{const c=UP.exec(e);if(!c)throw new Error(`Invalid JSON-pointer: ${e}`);const u=+c[1];if(r=c[2],r==="#"){if(u>=t)throw new Error(l("property/index",u));return n[t-u]}if(u>t)throw new Error(l("data",u));if(o=s[t-u],!r)return o}let i=o;const a=r.split("/");for(const c of a)c&&(o=(0,rt._)`${o}${(0,rt.getProperty)((0,$n.unescapeJsonPointer)(c))}`,i=(0,rt._)`${i} && ${o}`);return i;function l(c,u){return`Cannot access ${c} ${u} levels up, current level is ${t}`}}zs.getData=hv;var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});class HP extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}Wi.default=HP;var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0});const ud=Ee;class WP extends Error{constructor(t,s,n,r){super(r||`can't resolve reference ${n} from id ${s}`),this.missingRef=(0,ud.resolveUrl)(t,s,n),this.missingSchema=(0,ud.normalizeId)((0,ud.getFullPath)(t,this.missingRef))}}Xi.default=WP;var ls={};Object.defineProperty(ls,"__esModule",{value:!0}),ls.resolveSchema=ls.getCompilingSchema=ls.resolveRef=ls.compileSchema=ls.SchemaEnv=void 0;const Gs=_t,XP=Wi,$r=on,Us=Ee,cv=Et,YP=zs;class Pl{constructor(t){var s;this.refs={},this.dynamicAnchors={};let n;typeof t.schema=="object"&&(n=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(s=t.baseId)!==null&&s!==void 0?s:(0,Us.normalizeId)(n==null?void 0:n[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=n==null?void 0:n.$async,this.refs={}}}ls.SchemaEnv=Pl;function dd(e){const t=uv.call(this,e);if(t)return t;const s=(0,Us.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:n,lines:r}=this.opts.code,{ownProperties:o}=this.opts,i=new Gs.CodeGen(this.scope,{es5:n,lines:r,ownProperties:o});let a;e.$async&&(a=i.scopeValue("Error",{ref:XP.default,code:(0,Gs._)`require("ajv/dist/runtime/validation_error").default`}));const l=i.scopeName("validate");e.validateName=l;const c={gen:i,allErrors:this.opts.allErrors,data:$r.default.data,parentData:$r.default.parentData,parentDataProperty:$r.default.parentDataProperty,dataNames:[$r.default.data],dataPathArr:[Gs.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,Gs.stringify)(e.schema)}:{ref:e.schema}),validateName:l,ValidationError:a,schema:e.schema,schemaEnv:e,rootId:s,baseId:e.baseId||s,schemaPath:Gs.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Gs._)`""`,opts:this.opts,self:this};let u;try{this._compilations.add(e),(0,YP.validateFunctionCode)(c),i.optimize(this.opts.code.optimize);const h=i.toString();u=`${i.scopeRefs($r.default.scope)}return ${h}`,this.opts.code.process&&(u=this.opts.code.process(u,e));const d=new Function(`${$r.default.self}`,`${$r.default.scope}`,u)(this,this.scope.get());if(this.scope.value(l,{ref:d}),d.errors=null,d.schema=e.schema,d.schemaEnv=e,e.$async&&(d.$async=!0),this.opts.code.source===!0&&(d.source={validateName:l,validateCode:h,scopeValues:i._values}),this.opts.unevaluated){const{props:f,items:p}=c;d.evaluated={props:f instanceof Gs.Name?void 0:f,items:p instanceof Gs.Name?void 0:p,dynamicProps:f instanceof Gs.Name,dynamicItems:p instanceof Gs.Name},d.source&&(d.source.evaluated=(0,Gs.stringify)(d.evaluated))}return e.validate=d,e}catch(h){throw delete e.validate,delete e.validateName,u&&this.logger.error("Error compiling schema, function code:",u),h}finally{this._compilations.delete(e)}}ls.compileSchema=dd;function ZP(e,t,s){var n;s=(0,Us.resolveUrl)(this.opts.uriResolver,t,s);const r=e.refs[s];if(r)return r;let o=KP.call(this,e,s);if(o===void 0){const i=(n=e.localRefs)===null||n===void 0?void 0:n[s],{schemaId:a}=this.opts;i&&(o=new Pl({schema:i,schemaId:a,root:e,baseId:t}))}if(o!==void 0)return e.refs[s]=qP.call(this,o)}ls.resolveRef=ZP;function qP(e){return(0,Us.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:dd.call(this,e)}function uv(e){for(const t of this._compilations)if(QP(t,e))return t}ls.getCompilingSchema=uv;function QP(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function KP(e,t){let s;for(;typeof(s=this.refs[t])=="string";)t=s;return s||this.schemas[t]||Ml.call(this,e,t)}function Ml(e,t){const s=this.opts.uriResolver.parse(t),n=(0,Us._getFullPath)(this.opts.uriResolver,s);let r=(0,Us.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===r)return fd.call(this,s,e);const o=(0,Us.normalizeId)(n),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){const a=Ml.call(this,e,i);return typeof(a==null?void 0:a.schema)!="object"?void 0:fd.call(this,s,a)}if(typeof(i==null?void 0:i.schema)=="object"){if(i.validate||dd.call(this,i),o===(0,Us.normalizeId)(t)){const{schema:a}=i,{schemaId:l}=this.opts,c=a[l];return c&&(r=(0,Us.resolveUrl)(this.opts.uriResolver,r,c)),new Pl({schema:a,schemaId:l,root:e,baseId:r})}return fd.call(this,s,i)}}ls.resolveSchema=Ml;const JP=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function fd(e,{baseId:t,schema:s,root:n}){var r;if(((r=e.fragment)===null||r===void 0?void 0:r[0])!=="/")return;for(const a of e.fragment.slice(1).split("/")){if(typeof s=="boolean")return;const l=s[(0,cv.unescapeFragment)(a)];if(l===void 0)return;s=l;const c=typeof s=="object"&&s[this.opts.schemaId];!JP.has(a)&&c&&(t=(0,Us.resolveUrl)(this.opts.uriResolver,t,c))}let o;if(typeof s!="boolean"&&s.$ref&&!(0,cv.schemaHasRulesButRef)(s,this.RULES)){const a=(0,Us.resolveUrl)(this.opts.uriResolver,t,s.$ref);o=Ml.call(this,n,a)}const{schemaId:i}=this.opts;if(o=o||new Pl({schema:s,schemaId:i,root:n,baseId:t}),o.schema!==o.root.schema)return o}const tM="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",eM="Meta-schema for $data reference (JSON AnySchema extension proposal)",sM="object",nM=["$data"],rM={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},oM=!1,iM={$id:tM,description:eM,type:sM,required:nM,properties:rM,additionalProperties:oM};var pd={},md={exports:{}};(function(e,t){(function(s,n){n(t)})(oo,function(s){function n(){for(var k=arguments.length,T=Array(k),M=0;M<k;M++)T[M]=arguments[M];if(T.length>1){T[0]=T[0].slice(0,-1);for(var z=T.length-1,G=1;G<z;++G)T[G]=T[G].slice(1,-1);return T[z]=T[z].slice(1),T.join("")}else return T[0]}function r(k){return"(?:"+k+")"}function o(k){return k===void 0?"undefined":k===null?"null":Object.prototype.toString.call(k).split(" ").pop().split("]").shift().toLowerCase()}function i(k){return k.toUpperCase()}function a(k){return k!=null?k instanceof Array?k:typeof k.length!="number"||k.split||k.setInterval||k.call?[k]:Array.prototype.slice.call(k):[]}function l(k,T){var M=k;if(T)for(var z in T)M[z]=T[z];return M}function c(k){var T="[A-Za-z]",M="[0-9]",z=n(M,"[A-Fa-f]"),G=r(r("%[EFef]"+z+"%"+z+z+"%"+z+z)+"|"+r("%[89A-Fa-f]"+z+"%"+z+z)+"|"+r("%"+z+z)),lt="[\\:\\/\\?\\#\\[\\]\\@]",at="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Dt=n(lt,at),fe=k?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Ht=k?"[\\uE000-\\uF8FF]":"[]",It=n(T,M,"[\\-\\.\\_\\~]",fe);r(T+n(T,M,"[\\+\\-\\.]")+"*"),r(r(G+"|"+n(It,at,"[\\:]"))+"*");var Qt=r(r("25[0-5]")+"|"+r("2[0-4]"+M)+"|"+r("1"+M+M)+"|"+r("0?[1-9]"+M)+"|0?0?"+M),ae=r(Qt+"\\."+Qt+"\\."+Qt+"\\."+Qt),yt=r(z+"{1,4}"),pe=r(r(yt+"\\:"+yt)+"|"+ae),Wt=r(r(yt+"\\:")+"{6}"+pe),Ns=r("\\:\\:"+r(yt+"\\:")+"{5}"+pe),pi=r(r(yt)+"?\\:\\:"+r(yt+"\\:")+"{4}"+pe),Ks=r(r(r(yt+"\\:")+"{0,1}"+yt)+"?\\:\\:"+r(yt+"\\:")+"{3}"+pe),Gn=r(r(r(yt+"\\:")+"{0,2}"+yt)+"?\\:\\:"+r(yt+"\\:")+"{2}"+pe),Kr=r(r(r(yt+"\\:")+"{0,3}"+yt)+"?\\:\\:"+yt+"\\:"+pe),Jr=r(r(r(yt+"\\:")+"{0,4}"+yt)+"?\\:\\:"+pe),Ls=r(r(r(yt+"\\:")+"{0,5}"+yt)+"?\\:\\:"+yt),Un=r(r(r(yt+"\\:")+"{0,6}"+yt)+"?\\:\\:"),to=r([Wt,Ns,pi,Ks,Gn,Kr,Jr,Ls,Un].join("|")),_n=r(r(It+"|"+G)+"+");r("[vV]"+z+"+\\."+n(It,at,"[\\:]")+"+"),r(r(G+"|"+n(It,at))+"*");var _c=r(G+"|"+n(It,at,"[\\:\\@]"));return r(r(G+"|"+n(It,at,"[\\@]"))+"+"),r(r(_c+"|"+n("[\\/\\?]",Ht))+"*"),{NOT_SCHEME:new RegExp(n("[^]",T,M,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(n("[^\\%\\:]",It,at),"g"),NOT_HOST:new RegExp(n("[^\\%\\[\\]\\:]",It,at),"g"),NOT_PATH:new RegExp(n("[^\\%\\/\\:\\@]",It,at),"g"),NOT_PATH_NOSCHEME:new RegExp(n("[^\\%\\/\\@]",It,at),"g"),NOT_QUERY:new RegExp(n("[^\\%]",It,at,"[\\:\\@\\/\\?]",Ht),"g"),NOT_FRAGMENT:new RegExp(n("[^\\%]",It,at,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(n("[^]",It,at),"g"),UNRESERVED:new RegExp(It,"g"),OTHER_CHARS:new RegExp(n("[^\\%]",It,Dt),"g"),PCT_ENCODED:new RegExp(G,"g"),IPV4ADDRESS:new RegExp("^("+ae+")$"),IPV6ADDRESS:new RegExp("^\\[?("+to+")"+r(r("\\%25|\\%(?!"+z+"{2})")+"("+_n+")")+"?\\]?$")}}var u=c(!1),h=c(!0),d=function(){function k(T,M){var z=[],G=!0,lt=!1,at=void 0;try{for(var Dt=T[Symbol.iterator](),fe;!(G=(fe=Dt.next()).done)&&(z.push(fe.value),!(M&&z.length===M));G=!0);}catch(Ht){lt=!0,at=Ht}finally{try{!G&&Dt.return&&Dt.return()}finally{if(lt)throw at}}return z}return function(T,M){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return k(T,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(k){if(Array.isArray(k)){for(var T=0,M=Array(k.length);T<k.length;T++)M[T]=k[T];return M}else return Array.from(k)},p=2147483647,g=36,m=1,y=26,v=38,b=700,w=72,S=128,_="-",A=/^xn--/,O=/[^\0-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,R={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},X=g-m,B=Math.floor,H=String.fromCharCode;function j(k){throw new RangeError(R[k])}function K(k,T){for(var M=[],z=k.length;z--;)M[z]=T(k[z]);return M}function nt(k,T){var M=k.split("@"),z="";M.length>1&&(z=M[0]+"@",k=M[1]),k=k.replace(P,".");var G=k.split("."),lt=K(G,T).join(".");return z+lt}function ht(k){for(var T=[],M=0,z=k.length;M<z;){var G=k.charCodeAt(M++);if(G>=55296&&G<=56319&&M<z){var lt=k.charCodeAt(M++);(lt&64512)==56320?T.push(((G&1023)<<10)+(lt&1023)+65536):(T.push(G),M--)}else T.push(G)}return T}var St=function(k){return String.fromCodePoint.apply(String,f(k))},U=function(k){return k-48<10?k-22:k-65<26?k-65:k-97<26?k-97:g},N=function(k,T){return k+22+75*(k<26)-((T!=0)<<5)},E=function(k,T,M){var z=0;for(k=M?B(k/b):k>>1,k+=B(k/T);k>X*y>>1;z+=g)k=B(k/X);return B(z+(X+1)*k/(k+v))},L=function(k){var T=[],M=k.length,z=0,G=S,lt=w,at=k.lastIndexOf(_);at<0&&(at=0);for(var Dt=0;Dt<at;++Dt)k.charCodeAt(Dt)>=128&&j("not-basic"),T.push(k.charCodeAt(Dt));for(var fe=at>0?at+1:0;fe<M;){for(var Ht=z,It=1,Qt=g;;Qt+=g){fe>=M&&j("invalid-input");var ae=U(k.charCodeAt(fe++));(ae>=g||ae>B((p-z)/It))&&j("overflow"),z+=ae*It;var yt=Qt<=lt?m:Qt>=lt+y?y:Qt-lt;if(ae<yt)break;var pe=g-yt;It>B(p/pe)&&j("overflow"),It*=pe}var Wt=T.length+1;lt=E(z-Ht,Wt,Ht==0),B(z/Wt)>p-G&&j("overflow"),G+=B(z/Wt),z%=Wt,T.splice(z++,0,G)}return String.fromCodePoint.apply(String,T)},D=function(k){var T=[];k=ht(k);var M=k.length,z=S,G=0,lt=w,at=!0,Dt=!1,fe=void 0;try{for(var Ht=k[Symbol.iterator](),It;!(at=(It=Ht.next()).done);at=!0){var Qt=It.value;Qt<128&&T.push(H(Qt))}}catch(Ga){Dt=!0,fe=Ga}finally{try{!at&&Ht.return&&Ht.return()}finally{if(Dt)throw fe}}var ae=T.length,yt=ae;for(ae&&T.push(_);yt<M;){var pe=p,Wt=!0,Ns=!1,pi=void 0;try{for(var Ks=k[Symbol.iterator](),Gn;!(Wt=(Gn=Ks.next()).done);Wt=!0){var Kr=Gn.value;Kr>=z&&Kr<pe&&(pe=Kr)}}catch(Ga){Ns=!0,pi=Ga}finally{try{!Wt&&Ks.return&&Ks.return()}finally{if(Ns)throw pi}}var Jr=yt+1;pe-z>B((p-G)/Jr)&&j("overflow"),G+=(pe-z)*Jr,z=pe;var Ls=!0,Un=!1,to=void 0;try{for(var _n=k[Symbol.iterator](),_c;!(Ls=(_c=_n.next()).done);Ls=!0){var pA=_c.value;if(pA<z&&++G>p&&j("overflow"),pA==z){for(var Ac=G,kc=g;;kc+=g){var Sc=kc<=lt?m:kc>=lt+y?y:kc-lt;if(Ac<Sc)break;var mA=Ac-Sc,gA=g-Sc;T.push(H(N(Sc+mA%gA,0))),Ac=B(mA/gA)}T.push(H(N(Ac,0))),lt=E(G,Jr,yt==ae),G=0,++yt}}}catch(Ga){Un=!0,to=Ga}finally{try{!Ls&&_n.return&&_n.return()}finally{if(Un)throw to}}++G,++z}return T.join("")},x=function(k){return nt(k,function(T){return A.test(T)?L(T.slice(4).toLowerCase()):T})},C=function(k){return nt(k,function(T){return O.test(T)?"xn--"+D(T):T})},$={version:"2.1.0",ucs2:{decode:ht,encode:St},decode:L,encode:D,toASCII:C,toUnicode:x},F={};function Y(k){var T=k.charCodeAt(0),M=void 0;return T<16?M="%0"+T.toString(16).toUpperCase():T<128?M="%"+T.toString(16).toUpperCase():T<2048?M="%"+(T>>6|192).toString(16).toUpperCase()+"%"+(T&63|128).toString(16).toUpperCase():M="%"+(T>>12|224).toString(16).toUpperCase()+"%"+(T>>6&63|128).toString(16).toUpperCase()+"%"+(T&63|128).toString(16).toUpperCase(),M}function ct(k){for(var T="",M=0,z=k.length;M<z;){var G=parseInt(k.substr(M+1,2),16);if(G<128)T+=String.fromCharCode(G),M+=3;else if(G>=194&&G<224){if(z-M>=6){var lt=parseInt(k.substr(M+4,2),16);T+=String.fromCharCode((G&31)<<6|lt&63)}else T+=k.substr(M,6);M+=6}else if(G>=224){if(z-M>=9){var at=parseInt(k.substr(M+4,2),16),Dt=parseInt(k.substr(M+7,2),16);T+=String.fromCharCode((G&15)<<12|(at&63)<<6|Dt&63)}else T+=k.substr(M,9);M+=9}else T+=k.substr(M,3),M+=3}return T}function wt(k,T){function M(z){var G=ct(z);return G.match(T.UNRESERVED)?G:z}return k.scheme&&(k.scheme=String(k.scheme).replace(T.PCT_ENCODED,M).toLowerCase().replace(T.NOT_SCHEME,"")),k.userinfo!==void 0&&(k.userinfo=String(k.userinfo).replace(T.PCT_ENCODED,M).replace(T.NOT_USERINFO,Y).replace(T.PCT_ENCODED,i)),k.host!==void 0&&(k.host=String(k.host).replace(T.PCT_ENCODED,M).toLowerCase().replace(T.NOT_HOST,Y).replace(T.PCT_ENCODED,i)),k.path!==void 0&&(k.path=String(k.path).replace(T.PCT_ENCODED,M).replace(k.scheme?T.NOT_PATH:T.NOT_PATH_NOSCHEME,Y).replace(T.PCT_ENCODED,i)),k.query!==void 0&&(k.query=String(k.query).replace(T.PCT_ENCODED,M).replace(T.NOT_QUERY,Y).replace(T.PCT_ENCODED,i)),k.fragment!==void 0&&(k.fragment=String(k.fragment).replace(T.PCT_ENCODED,M).replace(T.NOT_FRAGMENT,Y).replace(T.PCT_ENCODED,i)),k}function Ft(k){return k.replace(/^0*(.*)/,"$1")||"0"}function Nt(k,T){var M=k.match(T.IPV4ADDRESS)||[],z=d(M,2),G=z[1];return G?G.split(".").map(Ft).join("."):k}function J(k,T){var M=k.match(T.IPV6ADDRESS)||[],z=d(M,3),G=z[1],lt=z[2];if(G){for(var at=G.toLowerCase().split("::").reverse(),Dt=d(at,2),fe=Dt[0],Ht=Dt[1],It=Ht?Ht.split(":").map(Ft):[],Qt=fe.split(":").map(Ft),ae=T.IPV4ADDRESS.test(Qt[Qt.length-1]),yt=ae?7:8,pe=Qt.length-yt,Wt=Array(yt),Ns=0;Ns<yt;++Ns)Wt[Ns]=It[Ns]||Qt[pe+Ns]||"";ae&&(Wt[yt-1]=Nt(Wt[yt-1],T));var pi=Wt.reduce(function(Ls,Un,to){if(!Un||Un==="0"){var _n=Ls[Ls.length-1];_n&&_n.index+_n.length===to?_n.length++:Ls.push({index:to,length:1})}return Ls},[]),Ks=pi.sort(function(Ls,Un){return Un.length-Ls.length})[0],Gn=void 0;if(Ks&&Ks.length>1){var Kr=Wt.slice(0,Ks.index),Jr=Wt.slice(Ks.index+Ks.length);Gn=Kr.join(":")+"::"+Jr.join(":")}else Gn=Wt.join(":");return lt&&(Gn+="%"+lt),Gn}else return k}var Gt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Ve="".match(/(){0}/)[1]===void 0;function Jt(k){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M={},z=T.iri!==!1?h:u;T.reference==="suffix"&&(k=(T.scheme?T.scheme+":":"")+"//"+k);var G=k.match(Gt);if(G){Ve?(M.scheme=G[1],M.userinfo=G[3],M.host=G[4],M.port=parseInt(G[5],10),M.path=G[6]||"",M.query=G[7],M.fragment=G[8],isNaN(M.port)&&(M.port=G[5])):(M.scheme=G[1]||void 0,M.userinfo=k.indexOf("@")!==-1?G[3]:void 0,M.host=k.indexOf("//")!==-1?G[4]:void 0,M.port=parseInt(G[5],10),M.path=G[6]||"",M.query=k.indexOf("?")!==-1?G[7]:void 0,M.fragment=k.indexOf("#")!==-1?G[8]:void 0,isNaN(M.port)&&(M.port=k.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?G[4]:void 0)),M.host&&(M.host=J(Nt(M.host,z),z)),M.scheme===void 0&&M.userinfo===void 0&&M.host===void 0&&M.port===void 0&&!M.path&&M.query===void 0?M.reference="same-document":M.scheme===void 0?M.reference="relative":M.fragment===void 0?M.reference="absolute":M.reference="uri",T.reference&&T.reference!=="suffix"&&T.reference!==M.reference&&(M.error=M.error||"URI is not a "+T.reference+" reference.");var lt=F[(T.scheme||M.scheme||"").toLowerCase()];if(!T.unicodeSupport&&(!lt||!lt.unicodeSupport)){if(M.host&&(T.domainHost||lt&&lt.domainHost))try{M.host=$.toASCII(M.host.replace(z.PCT_ENCODED,ct).toLowerCase())}catch(at){M.error=M.error||"Host's domain name can not be converted to ASCII via punycode: "+at}wt(M,u)}else wt(M,z);lt&&lt.parse&&lt.parse(M,T)}else M.error=M.error||"URI can not be parsed.";return M}function qe(k,T){var M=T.iri!==!1?h:u,z=[];return k.userinfo!==void 0&&(z.push(k.userinfo),z.push("@")),k.host!==void 0&&z.push(J(Nt(String(k.host),M),M).replace(M.IPV6ADDRESS,function(G,lt,at){return"["+lt+(at?"%25"+at:"")+"]"})),(typeof k.port=="number"||typeof k.port=="string")&&(z.push(":"),z.push(String(k.port))),z.length?z.join(""):void 0}var Ae=/^\.\.?\//,Qs=/^\/\.(\/|$)/,zn=/^\/\.\.(\/|$)/,Zr=/^\/?(?:.|\n)*?(?=\/|$)/;function wn(k){for(var T=[];k.length;)if(k.match(Ae))k=k.replace(Ae,"");else if(k.match(Qs))k=k.replace(Qs,"/");else if(k.match(zn))k=k.replace(zn,"/"),T.pop();else if(k==="."||k==="..")k="";else{var M=k.match(Zr);if(M){var z=M[0];k=k.slice(z.length),T.push(z)}else throw new Error("Unexpected dot segment condition")}return T.join("")}function fs(k){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M=T.iri?h:u,z=[],G=F[(T.scheme||k.scheme||"").toLowerCase()];if(G&&G.serialize&&G.serialize(k,T),k.host&&!M.IPV6ADDRESS.test(k.host)&&(T.domainHost||G&&G.domainHost))try{k.host=T.iri?$.toUnicode(k.host):$.toASCII(k.host.replace(M.PCT_ENCODED,ct).toLowerCase())}catch(Dt){k.error=k.error||"Host's domain name can not be converted to "+(T.iri?"Unicode":"ASCII")+" via punycode: "+Dt}wt(k,M),T.reference!=="suffix"&&k.scheme&&(z.push(k.scheme),z.push(":"));var lt=qe(k,T);if(lt!==void 0&&(T.reference!=="suffix"&&z.push("//"),z.push(lt),k.path&&k.path.charAt(0)!=="/"&&z.push("/")),k.path!==void 0){var at=k.path;!T.absolutePath&&(!G||!G.absolutePath)&&(at=wn(at)),lt===void 0&&(at=at.replace(/^\/\//,"/%2F")),z.push(at)}return k.query!==void 0&&(z.push("?"),z.push(k.query)),k.fragment!==void 0&&(z.push("#"),z.push(k.fragment)),z.join("")}function di(k,T){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},z=arguments[3],G={};return z||(k=Jt(fs(k,M),M),T=Jt(fs(T,M),M)),M=M||{},!M.tolerant&&T.scheme?(G.scheme=T.scheme,G.userinfo=T.userinfo,G.host=T.host,G.port=T.port,G.path=wn(T.path||""),G.query=T.query):(T.userinfo!==void 0||T.host!==void 0||T.port!==void 0?(G.userinfo=T.userinfo,G.host=T.host,G.port=T.port,G.path=wn(T.path||""),G.query=T.query):(T.path?(T.path.charAt(0)==="/"?G.path=wn(T.path):((k.userinfo!==void 0||k.host!==void 0||k.port!==void 0)&&!k.path?G.path="/"+T.path:k.path?G.path=k.path.slice(0,k.path.lastIndexOf("/")+1)+T.path:G.path=T.path,G.path=wn(G.path)),G.query=T.query):(G.path=k.path,T.query!==void 0?G.query=T.query:G.query=k.query),G.userinfo=k.userinfo,G.host=k.host,G.port=k.port),G.scheme=k.scheme),G.fragment=T.fragment,G}function Fa(k,T,M){var z=l({scheme:"null"},M);return fs(di(Jt(k,z),Jt(T,z),z,!0),z)}function qr(k,T){return typeof k=="string"?k=fs(Jt(k,T),T):o(k)==="object"&&(k=Jt(fs(k,T),T)),k}function Va(k,T,M){return typeof k=="string"?k=fs(Jt(k,M),M):o(k)==="object"&&(k=fs(k,M)),typeof T=="string"?T=fs(Jt(T,M),M):o(T)==="object"&&(T=fs(T,M)),k===T}function xc(k,T){return k&&k.toString().replace(!T||!T.iri?u.ESCAPE:h.ESCAPE,Y)}function Ds(k,T){return k&&k.toString().replace(!T||!T.iri?u.PCT_ENCODED:h.PCT_ENCODED,ct)}var Qr={scheme:"http",domainHost:!0,parse:function(k,T){return k.host||(k.error=k.error||"HTTP URIs must have a host."),k},serialize:function(k,T){var M=String(k.scheme).toLowerCase()==="https";return(k.port===(M?443:80)||k.port==="")&&(k.port=void 0),k.path||(k.path="/"),k}},iA={scheme:"https",domainHost:Qr.domainHost,parse:Qr.parse,serialize:Qr.serialize};function aA(k){return typeof k.secure=="boolean"?k.secure:String(k.scheme).toLowerCase()==="wss"}var za={scheme:"ws",domainHost:!0,parse:function(k,T){var M=k;return M.secure=aA(M),M.resourceName=(M.path||"/")+(M.query?"?"+M.query:""),M.path=void 0,M.query=void 0,M},serialize:function(k,T){if((k.port===(aA(k)?443:80)||k.port==="")&&(k.port=void 0),typeof k.secure=="boolean"&&(k.scheme=k.secure?"wss":"ws",k.secure=void 0),k.resourceName){var M=k.resourceName.split("?"),z=d(M,2),G=z[0],lt=z[1];k.path=G&&G!=="/"?G:void 0,k.query=lt,k.resourceName=void 0}return k.fragment=void 0,k}},lA={scheme:"wss",domainHost:za.domainHost,parse:za.parse,serialize:za.serialize},Jj={},hA="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",xn="[0-9A-Fa-f]",tF=r(r("%[EFef]"+xn+"%"+xn+xn+"%"+xn+xn)+"|"+r("%[89A-Fa-f]"+xn+"%"+xn+xn)+"|"+r("%"+xn+xn)),eF="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",sF="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",nF=n(sF,'[\\"\\\\]'),rF="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",oF=new RegExp(hA,"g"),fi=new RegExp(tF,"g"),iF=new RegExp(n("[^]",eF,"[\\.]",'[\\"]',nF),"g"),cA=new RegExp(n("[^]",hA,rF),"g"),aF=cA;function pm(k){var T=ct(k);return T.match(oF)?T:k}var uA={scheme:"mailto",parse:function(k,T){var M=k,z=M.to=M.path?M.path.split(","):[];if(M.path=void 0,M.query){for(var G=!1,lt={},at=M.query.split("&"),Dt=0,fe=at.length;Dt<fe;++Dt){var Ht=at[Dt].split("=");switch(Ht[0]){case"to":for(var It=Ht[1].split(","),Qt=0,ae=It.length;Qt<ae;++Qt)z.push(It[Qt]);break;case"subject":M.subject=Ds(Ht[1],T);break;case"body":M.body=Ds(Ht[1],T);break;default:G=!0,lt[Ds(Ht[0],T)]=Ds(Ht[1],T);break}}G&&(M.headers=lt)}M.query=void 0;for(var yt=0,pe=z.length;yt<pe;++yt){var Wt=z[yt].split("@");if(Wt[0]=Ds(Wt[0]),T.unicodeSupport)Wt[1]=Ds(Wt[1],T).toLowerCase();else try{Wt[1]=$.toASCII(Ds(Wt[1],T).toLowerCase())}catch(Ns){M.error=M.error||"Email address's domain name can not be converted to ASCII via punycode: "+Ns}z[yt]=Wt.join("@")}return M},serialize:function(k,T){var M=k,z=a(k.to);if(z){for(var G=0,lt=z.length;G<lt;++G){var at=String(z[G]),Dt=at.lastIndexOf("@"),fe=at.slice(0,Dt).replace(fi,pm).replace(fi,i).replace(iF,Y),Ht=at.slice(Dt+1);try{Ht=T.iri?$.toUnicode(Ht):$.toASCII(Ds(Ht,T).toLowerCase())}catch(yt){M.error=M.error||"Email address's domain name can not be converted to "+(T.iri?"Unicode":"ASCII")+" via punycode: "+yt}z[G]=fe+"@"+Ht}M.path=z.join(",")}var It=k.headers=k.headers||{};k.subject&&(It.subject=k.subject),k.body&&(It.body=k.body);var Qt=[];for(var ae in It)It[ae]!==Jj[ae]&&Qt.push(ae.replace(fi,pm).replace(fi,i).replace(cA,Y)+"="+It[ae].replace(fi,pm).replace(fi,i).replace(aF,Y));return Qt.length&&(M.query=Qt.join("&")),M}},lF=/^([^\:]+)\:(.*)/,dA={scheme:"urn",parse:function(k,T){var M=k.path&&k.path.match(lF),z=k;if(M){var G=T.scheme||z.scheme||"urn",lt=M[1].toLowerCase(),at=M[2],Dt=G+":"+(T.nid||lt),fe=F[Dt];z.nid=lt,z.nss=at,z.path=void 0,fe&&(z=fe.parse(z,T))}else z.error=z.error||"URN can not be parsed.";return z},serialize:function(k,T){var M=T.scheme||k.scheme||"urn",z=k.nid,G=M+":"+(T.nid||z),lt=F[G];lt&&(k=lt.serialize(k,T));var at=k,Dt=k.nss;return at.path=(z||T.nid)+":"+Dt,at}},hF=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,fA={scheme:"urn:uuid",parse:function(k,T){var M=k;return M.uuid=M.nss,M.nss=void 0,!T.tolerant&&(!M.uuid||!M.uuid.match(hF))&&(M.error=M.error||"UUID is not valid."),M},serialize:function(k,T){var M=k;return M.nss=(k.uuid||"").toLowerCase(),M}};F[Qr.scheme]=Qr,F[iA.scheme]=iA,F[za.scheme]=za,F[lA.scheme]=lA,F[uA.scheme]=uA,F[dA.scheme]=dA,F[fA.scheme]=fA,s.SCHEMES=F,s.pctEncChar=Y,s.pctDecChars=ct,s.parse=Jt,s.removeDotSegments=wn,s.serialize=fs,s.resolveComponents=di,s.resolve=Fa,s.normalize=qr,s.equal=Va,s.escapeComponent=xc,s.unescapeComponent=Ds,Object.defineProperty(s,"__esModule",{value:!0})})})(md,md.exports);var aM=md.exports;Object.defineProperty(pd,"__esModule",{value:!0});const dv=aM;dv.code='require("ajv/dist/runtime/uri").default',pd.default=dv,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=zs;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var s=_t;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return s._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return s.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return s.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return s.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return s.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return s.CodeGen}});const n=Wi,r=Xi,o=Ir,i=ls,a=_t,l=Ee,c=Gi,u=Et,h=iM,d=pd,f=(N,E)=>new RegExp(N,E);f.code="new RegExp";const p=["removeAdditional","useDefaults","coerceTypes"],g=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),m={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},y={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},v=200;function b(N){var E,L,D,x,C,$,F,Y,ct,wt,Ft,Nt,J,Gt,Ve,Jt,qe,Ae,Qs,zn,Zr,wn,fs,di,Fa;const qr=N.strict,Va=(E=N.code)===null||E===void 0?void 0:E.optimize,xc=Va===!0||Va===void 0?1:Va||0,Ds=(D=(L=N.code)===null||L===void 0?void 0:L.regExp)!==null&&D!==void 0?D:f,Qr=(x=N.uriResolver)!==null&&x!==void 0?x:d.default;return{strictSchema:($=(C=N.strictSchema)!==null&&C!==void 0?C:qr)!==null&&$!==void 0?$:!0,strictNumbers:(Y=(F=N.strictNumbers)!==null&&F!==void 0?F:qr)!==null&&Y!==void 0?Y:!0,strictTypes:(wt=(ct=N.strictTypes)!==null&&ct!==void 0?ct:qr)!==null&&wt!==void 0?wt:"log",strictTuples:(Nt=(Ft=N.strictTuples)!==null&&Ft!==void 0?Ft:qr)!==null&&Nt!==void 0?Nt:"log",strictRequired:(Gt=(J=N.strictRequired)!==null&&J!==void 0?J:qr)!==null&&Gt!==void 0?Gt:!1,code:N.code?{...N.code,optimize:xc,regExp:Ds}:{optimize:xc,regExp:Ds},loopRequired:(Ve=N.loopRequired)!==null&&Ve!==void 0?Ve:v,loopEnum:(Jt=N.loopEnum)!==null&&Jt!==void 0?Jt:v,meta:(qe=N.meta)!==null&&qe!==void 0?qe:!0,messages:(Ae=N.messages)!==null&&Ae!==void 0?Ae:!0,inlineRefs:(Qs=N.inlineRefs)!==null&&Qs!==void 0?Qs:!0,schemaId:(zn=N.schemaId)!==null&&zn!==void 0?zn:"$id",addUsedSchema:(Zr=N.addUsedSchema)!==null&&Zr!==void 0?Zr:!0,validateSchema:(wn=N.validateSchema)!==null&&wn!==void 0?wn:!0,validateFormats:(fs=N.validateFormats)!==null&&fs!==void 0?fs:!0,unicodeRegExp:(di=N.unicodeRegExp)!==null&&di!==void 0?di:!0,int32range:(Fa=N.int32range)!==null&&Fa!==void 0?Fa:!0,uriResolver:Qr}}class w{constructor(E={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,E=this.opts={...E,...b(E)};const{es5:L,lines:D}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:g,es5:L,lines:D}),this.logger=B(E.logger);const x=E.validateFormats;E.validateFormats=!1,this.RULES=(0,o.getRules)(),S.call(this,m,E,"NOT SUPPORTED"),S.call(this,y,E,"DEPRECATED","warn"),this._metaOpts=R.call(this),E.formats&&O.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),E.keywords&&P.call(this,E.keywords),typeof E.meta=="object"&&this.addMetaSchema(E.meta),A.call(this),E.validateFormats=x}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:E,meta:L,schemaId:D}=this.opts;let x=h;D==="id"&&(x={...h},x.id=x.$id,delete x.$id),L&&E&&this.addMetaSchema(x,x[D],!1)}defaultMeta(){const{meta:E,schemaId:L}=this.opts;return this.opts.defaultMeta=typeof E=="object"?E[L]||E:void 0}validate(E,L){let D;if(typeof E=="string"){if(D=this.getSchema(E),!D)throw new Error(`no schema with key or ref "${E}"`)}else D=this.compile(E);const x=D(L);return"$async"in D||(this.errors=D.errors),x}compile(E,L){const D=this._addSchema(E,L);return D.validate||this._compileSchemaEnv(D)}compileAsync(E,L){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:D}=this.opts;return x.call(this,E,L);async function x(wt,Ft){await C.call(this,wt.$schema);const Nt=this._addSchema(wt,Ft);return Nt.validate||$.call(this,Nt)}async function C(wt){wt&&!this.getSchema(wt)&&await x.call(this,{$ref:wt},!0)}async function $(wt){try{return this._compileSchemaEnv(wt)}catch(Ft){if(!(Ft instanceof r.default))throw Ft;return F.call(this,Ft),await Y.call(this,Ft.missingSchema),$.call(this,wt)}}function F({missingSchema:wt,missingRef:Ft}){if(this.refs[wt])throw new Error(`AnySchema ${wt} is loaded but ${Ft} cannot be resolved`)}async function Y(wt){const Ft=await ct.call(this,wt);this.refs[wt]||await C.call(this,Ft.$schema),this.refs[wt]||this.addSchema(Ft,wt,L)}async function ct(wt){const Ft=this._loading[wt];if(Ft)return Ft;try{return await(this._loading[wt]=D(wt))}finally{delete this._loading[wt]}}}addSchema(E,L,D,x=this.opts.validateSchema){if(Array.isArray(E)){for(const $ of E)this.addSchema($,void 0,D,x);return this}let C;if(typeof E=="object"){const{schemaId:$}=this.opts;if(C=E[$],C!==void 0&&typeof C!="string")throw new Error(`schema ${$} must be string`)}return L=(0,l.normalizeId)(L||C),this._checkUnique(L),this.schemas[L]=this._addSchema(E,D,L,x,!0),this}addMetaSchema(E,L,D=this.opts.validateSchema){return this.addSchema(E,L,!0,D),this}validateSchema(E,L){if(typeof E=="boolean")return!0;let D;if(D=E.$schema,D!==void 0&&typeof D!="string")throw new Error("$schema must be a string");if(D=D||this.opts.defaultMeta||this.defaultMeta(),!D)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const x=this.validate(D,E);if(!x&&L){const C="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(C);else throw new Error(C)}return x}getSchema(E){let L;for(;typeof(L=_.call(this,E))=="string";)E=L;if(L===void 0){const{schemaId:D}=this.opts,x=new i.SchemaEnv({schema:{},schemaId:D});if(L=i.resolveSchema.call(this,x,E),!L)return;this.refs[E]=L}return L.validate||this._compileSchemaEnv(L)}removeSchema(E){if(E instanceof RegExp)return this._removeAllSchemas(this.schemas,E),this._removeAllSchemas(this.refs,E),this;switch(typeof E){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const L=_.call(this,E);return typeof L=="object"&&this._cache.delete(L.schema),delete this.schemas[E],delete this.refs[E],this}case"object":{const L=E;this._cache.delete(L);let D=E[this.opts.schemaId];return D&&(D=(0,l.normalizeId)(D),delete this.schemas[D],delete this.refs[D]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(E){for(const L of E)this.addKeyword(L);return this}addKeyword(E,L){let D;if(typeof E=="string")D=E,typeof L=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),L.keyword=D);else if(typeof E=="object"&&L===void 0){if(L=E,D=L.keyword,Array.isArray(D)&&!D.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(j.call(this,D,L),!L)return(0,u.eachItem)(D,C=>K.call(this,C)),this;ht.call(this,L);const x={...L,type:(0,c.getJSONTypes)(L.type),schemaType:(0,c.getJSONTypes)(L.schemaType)};return(0,u.eachItem)(D,x.type.length===0?C=>K.call(this,C,x):C=>x.type.forEach($=>K.call(this,C,x,$))),this}getKeyword(E){const L=this.RULES.all[E];return typeof L=="object"?L.definition:!!L}removeKeyword(E){const{RULES:L}=this;delete L.keywords[E],delete L.all[E];for(const D of L.rules){const x=D.rules.findIndex(C=>C.keyword===E);x>=0&&D.rules.splice(x,1)}return this}addFormat(E,L){return typeof L=="string"&&(L=new RegExp(L)),this.formats[E]=L,this}errorsText(E=this.errors,{separator:L=", ",dataVar:D="data"}={}){return!E||E.length===0?"No errors":E.map(x=>`${D}${x.instancePath} ${x.message}`).reduce((x,C)=>x+L+C)}$dataMetaSchema(E,L){const D=this.RULES.all;E=JSON.parse(JSON.stringify(E));for(const x of L){const C=x.split("/").slice(1);let $=E;for(const F of C)$=$[F];for(const F in D){const Y=D[F];if(typeof Y!="object")continue;const{$data:ct}=Y.definition,wt=$[F];ct&&wt&&($[F]=U(wt))}}return E}_removeAllSchemas(E,L){for(const D in E){const x=E[D];(!L||L.test(D))&&(typeof x=="string"?delete E[D]:x&&!x.meta&&(this._cache.delete(x.schema),delete E[D]))}}_addSchema(E,L,D,x=this.opts.validateSchema,C=this.opts.addUsedSchema){let $;const{schemaId:F}=this.opts;if(typeof E=="object")$=E[F];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof E!="boolean")throw new Error("schema must be object or boolean")}let Y=this._cache.get(E);if(Y!==void 0)return Y;D=(0,l.normalizeId)($||D);const ct=l.getSchemaRefs.call(this,E,D);return Y=new i.SchemaEnv({schema:E,schemaId:F,meta:L,baseId:D,localRefs:ct}),this._cache.set(Y.schema,Y),C&&!D.startsWith("#")&&(D&&this._checkUnique(D),this.refs[D]=Y),x&&this.validateSchema(E,!0),Y}_checkUnique(E){if(this.schemas[E]||this.refs[E])throw new Error(`schema with key or id "${E}" already exists`)}_compileSchemaEnv(E){if(E.meta?this._compileMetaSchema(E):i.compileSchema.call(this,E),!E.validate)throw new Error("ajv implementation error");return E.validate}_compileMetaSchema(E){const L=this.opts;this.opts=this._metaOpts;try{i.compileSchema.call(this,E)}finally{this.opts=L}}}e.default=w,w.ValidationError=n.default,w.MissingRefError=r.default;function S(N,E,L,D="error"){for(const x in N){const C=x;C in E&&this.logger[D](`${L}: option ${x}. ${N[C]}`)}}function _(N){return N=(0,l.normalizeId)(N),this.schemas[N]||this.refs[N]}function A(){const N=this.opts.schemas;if(N)if(Array.isArray(N))this.addSchema(N);else for(const E in N)this.addSchema(N[E],E)}function O(){for(const N in this.opts.formats){const E=this.opts.formats[N];E&&this.addFormat(N,E)}}function P(N){if(Array.isArray(N)){this.addVocabulary(N);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const E in N){const L=N[E];L.keyword||(L.keyword=E),this.addKeyword(L)}}function R(){const N={...this.opts};for(const E of p)delete N[E];return N}const X={log(){},warn(){},error(){}};function B(N){if(N===!1)return X;if(N===void 0)return console;if(N.log&&N.warn&&N.error)return N;throw new Error("logger must implement log, warn and error methods")}const H=/^[a-z_$][a-z0-9_$:-]*$/i;function j(N,E){const{RULES:L}=this;if((0,u.eachItem)(N,D=>{if(L.keywords[D])throw new Error(`Keyword ${D} is already defined`);if(!H.test(D))throw new Error(`Keyword ${D} has invalid name`)}),!!E&&E.$data&&!("code"in E||"validate"in E))throw new Error('$data keyword must have "code" or "validate" function')}function K(N,E,L){var D;const x=E==null?void 0:E.post;if(L&&x)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:C}=this;let $=x?C.post:C.rules.find(({type:Y})=>Y===L);if($||($={type:L,rules:[]},C.rules.push($)),C.keywords[N]=!0,!E)return;const F={keyword:N,definition:{...E,type:(0,c.getJSONTypes)(E.type),schemaType:(0,c.getJSONTypes)(E.schemaType)}};E.before?nt.call(this,$,F,E.before):$.rules.push(F),C.all[N]=F,(D=E.implements)===null||D===void 0||D.forEach(Y=>this.addKeyword(Y))}function nt(N,E,L){const D=N.rules.findIndex(x=>x.keyword===L);D>=0?N.rules.splice(D,0,E):(N.rules.push(E),this.logger.warn(`rule ${L} is not defined`))}function ht(N){let{metaSchema:E}=N;E!==void 0&&(N.$data&&this.opts.$data&&(E=U(E)),N.validateSchema=this.compile(E,!0))}const St={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function U(N){return{anyOf:[N,St]}}}(Ry);var gd={},yd={},vd={};Object.defineProperty(vd,"__esModule",{value:!0});const lM={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};vd.default=lM;var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.callRef=Rr.getValidate=void 0;const hM=Xi,fv=At,hs=_t,Do=on,pv=ls,Il=Et,cM={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:s,it:n}=e,{baseId:r,schemaEnv:o,validateName:i,opts:a,self:l}=n,{root:c}=o;if((s==="#"||s==="#/")&&r===c.baseId)return h();const u=pv.resolveRef.call(l,c,r,s);if(u===void 0)throw new hM.default(n.opts.uriResolver,r,s);if(u instanceof pv.SchemaEnv)return d(u);return f(u);function h(){if(o===c)return El(e,i,o,o.$async);const p=t.scopeValue("root",{ref:c});return El(e,(0,hs._)`${p}.validate`,c,c.$async)}function d(p){const g=mv(e,p);El(e,g,p,p.$async)}function f(p){const g=t.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,hs.stringify)(p)}:{ref:p}),m=t.name("valid"),y=e.subschema({schema:p,dataTypes:[],schemaPath:hs.nil,topSchemaRef:g,errSchemaPath:s},m);e.mergeEvaluated(y),e.ok(m)}}};function mv(e,t){const{gen:s}=e;return t.validate?s.scopeValue("validate",{ref:t.validate}):(0,hs._)`${s.scopeValue("wrapper",{ref:t})}.validate`}Rr.getValidate=mv;function El(e,t,s,n){const{gen:r,it:o}=e,{allErrors:i,schemaEnv:a,opts:l}=o,c=l.passContext?Do.default.this:hs.nil;n?u():h();function u(){if(!a.$async)throw new Error("async schema referenced by sync schema");const p=r.let("valid");r.try(()=>{r.code((0,hs._)`await ${(0,fv.callValidateCode)(e,t,c)}`),f(t),i||r.assign(p,!0)},g=>{r.if((0,hs._)`!(${g} instanceof ${o.ValidationError})`,()=>r.throw(g)),d(g),i||r.assign(p,!1)}),e.ok(p)}function h(){e.result((0,fv.callValidateCode)(e,t,c),()=>f(t),()=>d(t))}function d(p){const g=(0,hs._)`${p}.errors`;r.assign(Do.default.vErrors,(0,hs._)`${Do.default.vErrors} === null ? ${g} : ${Do.default.vErrors}.concat(${g})`),r.assign(Do.default.errors,(0,hs._)`${Do.default.vErrors}.length`)}function f(p){var g;if(!o.opts.unevaluated)return;const m=(g=s==null?void 0:s.validate)===null||g===void 0?void 0:g.evaluated;if(o.props!==!0)if(m&&!m.dynamicProps)m.props!==void 0&&(o.props=Il.mergeEvaluated.props(r,m.props,o.props));else{const y=r.var("props",(0,hs._)`${p}.evaluated.props`);o.props=Il.mergeEvaluated.props(r,y,o.props,hs.Name)}if(o.items!==!0)if(m&&!m.dynamicItems)m.items!==void 0&&(o.items=Il.mergeEvaluated.items(r,m.items,o.items));else{const y=r.var("items",(0,hs._)`${p}.evaluated.items`);o.items=Il.mergeEvaluated.items(r,y,o.items,hs.Name)}}}Rr.callRef=El,Rr.default=cM,Object.defineProperty(yd,"__esModule",{value:!0});const uM=vd,dM=Rr,fM=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",uM.default,dM.default];yd.default=fM;var bd={},wd={};Object.defineProperty(wd,"__esModule",{value:!0});const $l=_t,Jn=$l.operators,Rl={maximum:{okStr:"<=",ok:Jn.LTE,fail:Jn.GT},minimum:{okStr:">=",ok:Jn.GTE,fail:Jn.LT},exclusiveMaximum:{okStr:"<",ok:Jn.LT,fail:Jn.GTE},exclusiveMinimum:{okStr:">",ok:Jn.GT,fail:Jn.LTE}},pM={message:({keyword:e,schemaCode:t})=>(0,$l.str)`must be ${Rl[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,$l._)`{comparison: ${Rl[e].okStr}, limit: ${t}}`},mM={keyword:Object.keys(Rl),type:"number",schemaType:"number",$data:!0,error:pM,code(e){const{keyword:t,data:s,schemaCode:n}=e;e.fail$data((0,$l._)`${s} ${Rl[t].fail} ${n} || isNaN(${s})`)}};wd.default=mM;var xd={};Object.defineProperty(xd,"__esModule",{value:!0});const Yi=_t,gM={message:({schemaCode:e})=>(0,Yi.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,Yi._)`{multipleOf: ${e}}`},yM={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:gM,code(e){const{gen:t,data:s,schemaCode:n,it:r}=e,o=r.opts.multipleOfPrecision,i=t.let("res"),a=o?(0,Yi._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,Yi._)`${i} !== parseInt(${i})`;e.fail$data((0,Yi._)`(${n} === 0 || (${i} = ${s}/${n}, ${a}))`)}};xd.default=yM;var _d={},Ad={};Object.defineProperty(Ad,"__esModule",{value:!0});function gv(e){const t=e.length;let s=0,n=0,r;for(;n<t;)s++,r=e.charCodeAt(n++),r>=55296&&r<=56319&&n<t&&(r=e.charCodeAt(n),(r&64512)===56320&&n++);return s}Ad.default=gv,gv.code='require("ajv/dist/runtime/ucs2length").default',Object.defineProperty(_d,"__esModule",{value:!0});const Dr=_t,vM=Et,bM=Ad,wM={message({keyword:e,schemaCode:t}){const s=e==="maxLength"?"more":"fewer";return(0,Dr.str)`must NOT have ${s} than ${t} characters`},params:({schemaCode:e})=>(0,Dr._)`{limit: ${e}}`},xM={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:wM,code(e){const{keyword:t,data:s,schemaCode:n,it:r}=e,o=t==="maxLength"?Dr.operators.GT:Dr.operators.LT,i=r.opts.unicode===!1?(0,Dr._)`${s}.length`:(0,Dr._)`${(0,vM.useFunc)(e.gen,bM.default)}(${s})`;e.fail$data((0,Dr._)`${i} ${o} ${n}`)}};_d.default=xM;var kd={};Object.defineProperty(kd,"__esModule",{value:!0});const _M=At,Dl=_t,AM={message:({schemaCode:e})=>(0,Dl.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,Dl._)`{pattern: ${e}}`},kM={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:AM,code(e){const{data:t,$data:s,schema:n,schemaCode:r,it:o}=e,i=o.opts.unicodeRegExp?"u":"",a=s?(0,Dl._)`(new RegExp(${r}, ${i}))`:(0,_M.usePattern)(e,n);e.fail$data((0,Dl._)`!${a}.test(${t})`)}};kd.default=kM;var Sd={};Object.defineProperty(Sd,"__esModule",{value:!0});const Zi=_t,SM={message({keyword:e,schemaCode:t}){const s=e==="maxProperties"?"more":"fewer";return(0,Zi.str)`must NOT have ${s} than ${t} properties`},params:({schemaCode:e})=>(0,Zi._)`{limit: ${e}}`},CM={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:SM,code(e){const{keyword:t,data:s,schemaCode:n}=e,r=t==="maxProperties"?Zi.operators.GT:Zi.operators.LT;e.fail$data((0,Zi._)`Object.keys(${s}).length ${r} ${n}`)}};Sd.default=CM;var Cd={};Object.defineProperty(Cd,"__esModule",{value:!0});const qi=At,Qi=_t,OM=Et,TM={message:({params:{missingProperty:e}})=>(0,Qi.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,Qi._)`{missingProperty: ${e}}`},PM={keyword:"required",type:"object",schemaType:"array",$data:!0,error:TM,code(e){const{gen:t,schema:s,schemaCode:n,data:r,$data:o,it:i}=e,{opts:a}=i;if(!o&&s.length===0)return;const l=s.length>=a.loopRequired;if(i.allErrors?c():u(),a.strictRequired){const f=e.parentSchema.properties,{definedProperties:p}=e.it;for(const g of s)if((f==null?void 0:f[g])===void 0&&!p.has(g)){const m=i.schemaEnv.baseId+i.errSchemaPath,y=`required property "${g}" is not defined at "${m}" (strictRequired)`;(0,OM.checkStrictMode)(i,y,i.opts.strictRequired)}}function c(){if(l||o)e.block$data(Qi.nil,h);else for(const f of s)(0,qi.checkReportMissingProp)(e,f)}function u(){const f=t.let("missing");if(l||o){const p=t.let("valid",!0);e.block$data(p,()=>d(f,p)),e.ok(p)}else t.if((0,qi.checkMissingProp)(e,s,f)),(0,qi.reportMissingProp)(e,f),t.else()}function h(){t.forOf("prop",n,f=>{e.setParams({missingProperty:f}),t.if((0,qi.noPropertyInData)(t,r,f,a.ownProperties),()=>e.error())})}function d(f,p){e.setParams({missingProperty:f}),t.forOf(f,n,()=>{t.assign(p,(0,qi.propertyInData)(t,r,f,a.ownProperties)),t.if((0,Qi.not)(p),()=>{e.error(),t.break()})},Qi.nil)}}};Cd.default=PM;var Od={};Object.defineProperty(Od,"__esModule",{value:!0});const Ki=_t,MM={message({keyword:e,schemaCode:t}){const s=e==="maxItems"?"more":"fewer";return(0,Ki.str)`must NOT have ${s} than ${t} items`},params:({schemaCode:e})=>(0,Ki._)`{limit: ${e}}`},IM={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:MM,code(e){const{keyword:t,data:s,schemaCode:n}=e,r=t==="maxItems"?Ki.operators.GT:Ki.operators.LT;e.fail$data((0,Ki._)`${s}.length ${r} ${n}`)}};Od.default=IM;var Td={},Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});const yv=Uy;yv.code='require("ajv/dist/runtime/equal").default',Ji.default=yv,Object.defineProperty(Td,"__esModule",{value:!0});const Pd=Gi,$e=_t,EM=Et,$M=Ji,RM={message:({params:{i:e,j:t}})=>(0,$e.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,$e._)`{i: ${e}, j: ${t}}`},DM={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:RM,code(e){const{gen:t,data:s,$data:n,schema:r,parentSchema:o,schemaCode:i,it:a}=e;if(!n&&!r)return;const l=t.let("valid"),c=o.items?(0,Pd.getSchemaTypes)(o.items):[];e.block$data(l,u,(0,$e._)`${i} === false`),e.ok(l);function u(){const p=t.let("i",(0,$e._)`${s}.length`),g=t.let("j");e.setParams({i:p,j:g}),t.assign(l,!0),t.if((0,$e._)`${p} > 1`,()=>(h()?d:f)(p,g))}function h(){return c.length>0&&!c.some(p=>p==="object"||p==="array")}function d(p,g){const m=t.name("item"),y=(0,Pd.checkDataTypes)(c,m,a.opts.strictNumbers,Pd.DataType.Wrong),v=t.const("indices",(0,$e._)`{}`);t.for((0,$e._)`;${p}--;`,()=>{t.let(m,(0,$e._)`${s}[${p}]`),t.if(y,(0,$e._)`continue`),c.length>1&&t.if((0,$e._)`typeof ${m} == "string"`,(0,$e._)`${m} += "_"`),t.if((0,$e._)`typeof ${v}[${m}] == "number"`,()=>{t.assign(g,(0,$e._)`${v}[${m}]`),e.error(),t.assign(l,!1).break()}).code((0,$e._)`${v}[${m}] = ${p}`)})}function f(p,g){const m=(0,EM.useFunc)(t,$M.default),y=t.name("outer");t.label(y).for((0,$e._)`;${p}--;`,()=>t.for((0,$e._)`${g} = ${p}; ${g}--;`,()=>t.if((0,$e._)`${m}(${s}[${p}], ${s}[${g}])`,()=>{e.error(),t.assign(l,!1).break(y)})))}}};Td.default=DM;var Md={};Object.defineProperty(Md,"__esModule",{value:!0});const Id=_t,NM=Et,LM=Ji,BM={message:"must be equal to constant",params:({schemaCode:e})=>(0,Id._)`{allowedValue: ${e}}`},jM={keyword:"const",$data:!0,error:BM,code(e){const{gen:t,data:s,$data:n,schemaCode:r,schema:o}=e;n||o&&typeof o=="object"?e.fail$data((0,Id._)`!${(0,NM.useFunc)(t,LM.default)}(${s}, ${r})`):e.fail((0,Id._)`${o} !== ${s}`)}};Md.default=jM;var Ed={};Object.defineProperty(Ed,"__esModule",{value:!0});const ta=_t,FM=Et,VM=Ji,zM={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,ta._)`{allowedValues: ${e}}`},GM={keyword:"enum",schemaType:"array",$data:!0,error:zM,code(e){const{gen:t,data:s,$data:n,schema:r,schemaCode:o,it:i}=e;if(!n&&r.length===0)throw new Error("enum must have non-empty array");const a=r.length>=i.opts.loopEnum;let l;const c=()=>l??(l=(0,FM.useFunc)(t,VM.default));let u;if(a||n)u=t.let("valid"),e.block$data(u,h);else{if(!Array.isArray(r))throw new Error("ajv implementation error");const f=t.const("vSchema",o);u=(0,ta.or)(...r.map((p,g)=>d(f,g)))}e.pass(u);function h(){t.assign(u,!1),t.forOf("v",o,f=>t.if((0,ta._)`${c()}(${s}, ${f})`,()=>t.assign(u,!0).break()))}function d(f,p){const g=r[p];return typeof g=="object"&&g!==null?(0,ta._)`${c()}(${s}, ${f}[${p}])`:(0,ta._)`${s} === ${g}`}}};Ed.default=GM,Object.defineProperty(bd,"__esModule",{value:!0});const UM=wd,HM=xd,WM=_d,XM=kd,YM=Sd,ZM=Cd,qM=Od,QM=Td,KM=Md,JM=Ed,tI=[UM.default,HM.default,WM.default,XM.default,YM.default,ZM.default,qM.default,QM.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},KM.default,JM.default];bd.default=tI;var $d={},No={};Object.defineProperty(No,"__esModule",{value:!0}),No.validateAdditionalItems=void 0;const Nr=_t,Rd=Et,eI={message:({params:{len:e}})=>(0,Nr.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Nr._)`{limit: ${e}}`},sI={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:eI,code(e){const{parentSchema:t,it:s}=e,{items:n}=t;if(!Array.isArray(n)){(0,Rd.checkStrictMode)(s,'"additionalItems" is ignored when "items" is not an array of schemas');return}vv(e,n)}};function vv(e,t){const{gen:s,schema:n,data:r,keyword:o,it:i}=e;i.items=!0;const a=s.const("len",(0,Nr._)`${r}.length`);if(n===!1)e.setParams({len:t.length}),e.pass((0,Nr._)`${a} <= ${t.length}`);else if(typeof n=="object"&&!(0,Rd.alwaysValidSchema)(i,n)){const c=s.var("valid",(0,Nr._)`${a} <= ${t.length}`);s.if((0,Nr.not)(c),()=>l(c)),e.ok(c)}function l(c){s.forRange("i",t.length,a,u=>{e.subschema({keyword:o,dataProp:u,dataPropType:Rd.Type.Num},c),i.allErrors||s.if((0,Nr.not)(c),()=>s.break())})}}No.validateAdditionalItems=vv,No.default=sI;var Dd={},Lo={};Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.validateTuple=void 0;const bv=_t,Nl=Et,nI=At,rI={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:s}=e;if(Array.isArray(t))return wv(e,"additionalItems",t);s.items=!0,!(0,Nl.alwaysValidSchema)(s,t)&&e.ok((0,nI.validateArray)(e))}};function wv(e,t,s=e.schema){const{gen:n,parentSchema:r,data:o,keyword:i,it:a}=e;u(r),a.opts.unevaluated&&s.length&&a.items!==!0&&(a.items=Nl.mergeEvaluated.items(n,s.length,a.items));const l=n.name("valid"),c=n.const("len",(0,bv._)`${o}.length`);s.forEach((h,d)=>{(0,Nl.alwaysValidSchema)(a,h)||(n.if((0,bv._)`${c} > ${d}`,()=>e.subschema({keyword:i,schemaProp:d,dataProp:d},l)),e.ok(l))});function u(h){const{opts:d,errSchemaPath:f}=a,p=s.length,g=p===h.minItems&&(p===h.maxItems||h[t]===!1);if(d.strictTuples&&!g){const m=`"${i}" is ${p}-tuple, but minItems or maxItems/${t} are not specified or different at path "${f}"`;(0,Nl.checkStrictMode)(a,m,d.strictTuples)}}}Lo.validateTuple=wv,Lo.default=rI,Object.defineProperty(Dd,"__esModule",{value:!0});const oI=Lo,iI={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,oI.validateTuple)(e,"items")};Dd.default=iI;var Nd={};Object.defineProperty(Nd,"__esModule",{value:!0});const xv=_t,aI=Et,lI=At,hI=No,cI={message:({params:{len:e}})=>(0,xv.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,xv._)`{limit: ${e}}`},uI={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:cI,code(e){const{schema:t,parentSchema:s,it:n}=e,{prefixItems:r}=s;n.items=!0,!(0,aI.alwaysValidSchema)(n,t)&&(r?(0,hI.validateAdditionalItems)(e,r):e.ok((0,lI.validateArray)(e)))}};Nd.default=uI;var Ld={};Object.defineProperty(Ld,"__esModule",{value:!0});const Os=_t,Ll=Et,dI={message:({params:{min:e,max:t}})=>t===void 0?(0,Os.str)`must contain at least ${e} valid item(s)`:(0,Os.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,Os._)`{minContains: ${e}}`:(0,Os._)`{minContains: ${e}, maxContains: ${t}}`},fI={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:dI,code(e){const{gen:t,schema:s,parentSchema:n,data:r,it:o}=e;let i,a;const{minContains:l,maxContains:c}=n;o.opts.next?(i=l===void 0?1:l,a=c):i=1;const u=t.const("len",(0,Os._)`${r}.length`);if(e.setParams({min:i,max:a}),a===void 0&&i===0){(0,Ll.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,Ll.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,Ll.alwaysValidSchema)(o,s)){let g=(0,Os._)`${u} >= ${i}`;a!==void 0&&(g=(0,Os._)`${g} && ${u} <= ${a}`),e.pass(g);return}o.items=!0;const h=t.name("valid");a===void 0&&i===1?f(h,()=>t.if(h,()=>t.break())):i===0?(t.let(h,!0),a!==void 0&&t.if((0,Os._)`${r}.length > 0`,d)):(t.let(h,!1),d()),e.result(h,()=>e.reset());function d(){const g=t.name("_valid"),m=t.let("count",0);f(g,()=>t.if(g,()=>p(m)))}function f(g,m){t.forRange("i",0,u,y=>{e.subschema({keyword:"contains",dataProp:y,dataPropType:Ll.Type.Num,compositeRule:!0},g),m()})}function p(g){t.code((0,Os._)`${g}++`),a===void 0?t.if((0,Os._)`${g} >= ${i}`,()=>t.assign(h,!0).break()):(t.if((0,Os._)`${g} > ${a}`,()=>t.assign(h,!1).break()),i===1?t.assign(h,!0):t.if((0,Os._)`${g} >= ${i}`,()=>t.assign(h,!0)))}}};Ld.default=fI;var _v={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=_t,s=Et,n=At;e.error={message:({params:{property:l,depsCount:c,deps:u}})=>{const h=c===1?"property":"properties";return(0,t.str)`must have ${h} ${u} when property ${l} is present`},params:({params:{property:l,depsCount:c,deps:u,missingProperty:h}})=>(0,t._)`{property: ${l},
    missingProperty: ${h},
    depsCount: ${c},
    deps: ${u}}`};const r={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(l){const[c,u]=o(l);i(l,c),a(l,u)}};function o({schema:l}){const c={},u={};for(const h in l){if(h==="__proto__")continue;const d=Array.isArray(l[h])?c:u;d[h]=l[h]}return[c,u]}function i(l,c=l.schema){const{gen:u,data:h,it:d}=l;if(Object.keys(c).length===0)return;const f=u.let("missing");for(const p in c){const g=c[p];if(g.length===0)continue;const m=(0,n.propertyInData)(u,h,p,d.opts.ownProperties);l.setParams({property:p,depsCount:g.length,deps:g.join(", ")}),d.allErrors?u.if(m,()=>{for(const y of g)(0,n.checkReportMissingProp)(l,y)}):(u.if((0,t._)`${m} && (${(0,n.checkMissingProp)(l,g,f)})`),(0,n.reportMissingProp)(l,f),u.else())}}e.validatePropertyDeps=i;function a(l,c=l.schema){const{gen:u,data:h,keyword:d,it:f}=l,p=u.name("valid");for(const g in c)(0,s.alwaysValidSchema)(f,c[g])||(u.if((0,n.propertyInData)(u,h,g,f.opts.ownProperties),()=>{const m=l.subschema({keyword:d,schemaProp:g},p);l.mergeValidEvaluated(m,p)},()=>u.var(p,!0)),l.ok(p))}e.validateSchemaDeps=a,e.default=r})(_v);var Bd={};Object.defineProperty(Bd,"__esModule",{value:!0});const Av=_t,pI=Et,mI={message:"property name must be valid",params:({params:e})=>(0,Av._)`{propertyName: ${e.propertyName}}`},gI={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:mI,code(e){const{gen:t,schema:s,data:n,it:r}=e;if((0,pI.alwaysValidSchema)(r,s))return;const o=t.name("valid");t.forIn("key",n,i=>{e.setParams({propertyName:i}),e.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),t.if((0,Av.not)(o),()=>{e.error(!0),r.allErrors||t.break()})}),e.ok(o)}};Bd.default=gI;var Bl={};Object.defineProperty(Bl,"__esModule",{value:!0});const jl=At,Hs=_t,yI=on,Fl=Et,vI={message:"must NOT have additional properties",params:({params:e})=>(0,Hs._)`{additionalProperty: ${e.additionalProperty}}`},bI={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:vI,code(e){const{gen:t,schema:s,parentSchema:n,data:r,errsCount:o,it:i}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:a,opts:l}=i;if(i.props=!0,l.removeAdditional!=="all"&&(0,Fl.alwaysValidSchema)(i,s))return;const c=(0,jl.allSchemaProperties)(n.properties),u=(0,jl.allSchemaProperties)(n.patternProperties);h(),e.ok((0,Hs._)`${o} === ${yI.default.errors}`);function h(){t.forIn("key",r,m=>{!c.length&&!u.length?p(m):t.if(d(m),()=>p(m))})}function d(m){let y;if(c.length>8){const v=(0,Fl.schemaRefOrVal)(i,n.properties,"properties");y=(0,jl.isOwnProperty)(t,v,m)}else c.length?y=(0,Hs.or)(...c.map(v=>(0,Hs._)`${m} === ${v}`)):y=Hs.nil;return u.length&&(y=(0,Hs.or)(y,...u.map(v=>(0,Hs._)`${(0,jl.usePattern)(e,v)}.test(${m})`))),(0,Hs.not)(y)}function f(m){t.code((0,Hs._)`delete ${r}[${m}]`)}function p(m){if(l.removeAdditional==="all"||l.removeAdditional&&s===!1){f(m);return}if(s===!1){e.setParams({additionalProperty:m}),e.error(),a||t.break();return}if(typeof s=="object"&&!(0,Fl.alwaysValidSchema)(i,s)){const y=t.name("valid");l.removeAdditional==="failing"?(g(m,y,!1),t.if((0,Hs.not)(y),()=>{e.reset(),f(m)})):(g(m,y),a||t.if((0,Hs.not)(y),()=>t.break()))}}function g(m,y,v){const b={keyword:"additionalProperties",dataProp:m,dataPropType:Fl.Type.Str};v===!1&&Object.assign(b,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(b,y)}}};Bl.default=bI;var jd={};Object.defineProperty(jd,"__esModule",{value:!0});const wI=zs,kv=At,Fd=Et,Sv=Bl,xI={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:s,parentSchema:n,data:r,it:o}=e;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Sv.default.code(new wI.KeywordCxt(o,Sv.default,"additionalProperties"));const i=(0,kv.allSchemaProperties)(s);for(const h of i)o.definedProperties.add(h);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=Fd.mergeEvaluated.props(t,(0,Fd.toHash)(i),o.props));const a=i.filter(h=>!(0,Fd.alwaysValidSchema)(o,s[h]));if(a.length===0)return;const l=t.name("valid");for(const h of a)c(h)?u(h):(t.if((0,kv.propertyInData)(t,r,h,o.opts.ownProperties)),u(h),o.allErrors||t.else().var(l,!0),t.endIf()),e.it.definedProperties.add(h),e.ok(l);function c(h){return o.opts.useDefaults&&!o.compositeRule&&s[h].default!==void 0}function u(h){e.subschema({keyword:"properties",schemaProp:h,dataProp:h},l)}}};jd.default=xI;var Vd={};Object.defineProperty(Vd,"__esModule",{value:!0});const Cv=At,Vl=_t,Ov=Et,Tv=Et,_I={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:s,data:n,parentSchema:r,it:o}=e,{opts:i}=o,a=(0,Cv.allSchemaProperties)(s),l=a.filter(g=>(0,Ov.alwaysValidSchema)(o,s[g]));if(a.length===0||l.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;const c=i.strictSchema&&!i.allowMatchingProperties&&r.properties,u=t.name("valid");o.props!==!0&&!(o.props instanceof Vl.Name)&&(o.props=(0,Tv.evaluatedPropsToName)(t,o.props));const{props:h}=o;d();function d(){for(const g of a)c&&f(g),o.allErrors?p(g):(t.var(u,!0),p(g),t.if(u))}function f(g){for(const m in c)new RegExp(g).test(m)&&(0,Ov.checkStrictMode)(o,`property ${m} matches pattern ${g} (use allowMatchingProperties)`)}function p(g){t.forIn("key",n,m=>{t.if((0,Vl._)`${(0,Cv.usePattern)(e,g)}.test(${m})`,()=>{const y=l.includes(g);y||e.subschema({keyword:"patternProperties",schemaProp:g,dataProp:m,dataPropType:Tv.Type.Str},u),o.opts.unevaluated&&h!==!0?t.assign((0,Vl._)`${h}[${m}]`,!0):!y&&!o.allErrors&&t.if((0,Vl.not)(u),()=>t.break())})})}}};Vd.default=_I;var zd={};Object.defineProperty(zd,"__esModule",{value:!0});const AI=Et,kI={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:s,it:n}=e;if((0,AI.alwaysValidSchema)(n,s)){e.fail();return}const r=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},r),e.failResult(r,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};zd.default=kI;var Gd={};Object.defineProperty(Gd,"__esModule",{value:!0});const SI=At,CI={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:SI.validateUnion,error:{message:"must match a schema in anyOf"}};Gd.default=CI;var Ud={};Object.defineProperty(Ud,"__esModule",{value:!0});const zl=_t,OI=Et,TI={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,zl._)`{passingSchemas: ${e.passing}}`},PI={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:TI,code(e){const{gen:t,schema:s,parentSchema:n,it:r}=e;if(!Array.isArray(s))throw new Error("ajv implementation error");if(r.opts.discriminator&&n.discriminator)return;const o=s,i=t.let("valid",!1),a=t.let("passing",null),l=t.name("_valid");e.setParams({passing:a}),t.block(c),e.result(i,()=>e.reset(),()=>e.error(!0));function c(){o.forEach((u,h)=>{let d;(0,OI.alwaysValidSchema)(r,u)?t.var(l,!0):d=e.subschema({keyword:"oneOf",schemaProp:h,compositeRule:!0},l),h>0&&t.if((0,zl._)`${l} && ${i}`).assign(i,!1).assign(a,(0,zl._)`[${a}, ${h}]`).else(),t.if(l,()=>{t.assign(i,!0),t.assign(a,h),d&&e.mergeEvaluated(d,zl.Name)})})}}};Ud.default=PI;var Hd={};Object.defineProperty(Hd,"__esModule",{value:!0});const MI=Et,II={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:s,it:n}=e;if(!Array.isArray(s))throw new Error("ajv implementation error");const r=t.name("valid");s.forEach((o,i)=>{if((0,MI.alwaysValidSchema)(n,o))return;const a=e.subschema({keyword:"allOf",schemaProp:i},r);e.ok(r),e.mergeEvaluated(a)})}};Hd.default=II;var Wd={};Object.defineProperty(Wd,"__esModule",{value:!0});const Gl=_t,Pv=Et,EI={message:({params:e})=>(0,Gl.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,Gl._)`{failingKeyword: ${e.ifClause}}`},$I={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:EI,code(e){const{gen:t,parentSchema:s,it:n}=e;s.then===void 0&&s.else===void 0&&(0,Pv.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const r=Mv(n,"then"),o=Mv(n,"else");if(!r&&!o)return;const i=t.let("valid",!0),a=t.name("_valid");if(l(),e.reset(),r&&o){const u=t.let("ifClause");e.setParams({ifClause:u}),t.if(a,c("then",u),c("else",u))}else r?t.if(a,c("then")):t.if((0,Gl.not)(a),c("else"));e.pass(i,()=>e.error(!0));function l(){const u=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);e.mergeEvaluated(u)}function c(u,h){return()=>{const d=e.subschema({keyword:u},a);t.assign(i,a),e.mergeValidEvaluated(d,i),h?t.assign(h,(0,Gl._)`${u}`):e.setParams({ifClause:u})}}}};function Mv(e,t){const s=e.schema[t];return s!==void 0&&!(0,Pv.alwaysValidSchema)(e,s)}Wd.default=$I;var Xd={};Object.defineProperty(Xd,"__esModule",{value:!0});const RI=Et,DI={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:s}){t.if===void 0&&(0,RI.checkStrictMode)(s,`"${e}" without "if" is ignored`)}};Xd.default=DI,Object.defineProperty($d,"__esModule",{value:!0});const NI=No,LI=Dd,BI=Lo,jI=Nd,FI=Ld,VI=_v,zI=Bd,GI=Bl,UI=jd,HI=Vd,WI=zd,XI=Gd,YI=Ud,ZI=Hd,qI=Wd,QI=Xd;function KI(e=!1){const t=[WI.default,XI.default,YI.default,ZI.default,qI.default,QI.default,zI.default,GI.default,VI.default,UI.default,HI.default];return e?t.push(LI.default,jI.default):t.push(NI.default,BI.default),t.push(FI.default),t}$d.default=KI;var Yd={},Zd={};Object.defineProperty(Zd,"__esModule",{value:!0});const re=_t,JI={message:({schemaCode:e})=>(0,re.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,re._)`{format: ${e}}`},tE={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:JI,code(e,t){const{gen:s,data:n,$data:r,schema:o,schemaCode:i,it:a}=e,{opts:l,errSchemaPath:c,schemaEnv:u,self:h}=a;if(!l.validateFormats)return;r?d():f();function d(){const p=s.scopeValue("formats",{ref:h.formats,code:l.code.formats}),g=s.const("fDef",(0,re._)`${p}[${i}]`),m=s.let("fType"),y=s.let("format");s.if((0,re._)`typeof ${g} == "object" && !(${g} instanceof RegExp)`,()=>s.assign(m,(0,re._)`${g}.type || "string"`).assign(y,(0,re._)`${g}.validate`),()=>s.assign(m,(0,re._)`"string"`).assign(y,g)),e.fail$data((0,re.or)(v(),b()));function v(){return l.strictSchema===!1?re.nil:(0,re._)`${i} && !${y}`}function b(){const w=u.$async?(0,re._)`(${g}.async ? await ${y}(${n}) : ${y}(${n}))`:(0,re._)`${y}(${n})`,S=(0,re._)`(typeof ${y} == "function" ? ${w} : ${y}.test(${n}))`;return(0,re._)`${y} && ${y} !== true && ${m} === ${t} && !${S}`}}function f(){const p=h.formats[o];if(!p){v();return}if(p===!0)return;const[g,m,y]=b(p);g===t&&e.pass(w());function v(){if(l.strictSchema===!1){h.logger.warn(S());return}throw new Error(S());function S(){return`unknown format "${o}" ignored in schema at path "${c}"`}}function b(S){const _=S instanceof RegExp?(0,re.regexpCode)(S):l.code.formats?(0,re._)`${l.code.formats}${(0,re.getProperty)(o)}`:void 0,A=s.scopeValue("formats",{key:o,ref:S,code:_});return typeof S=="object"&&!(S instanceof RegExp)?[S.type||"string",S.validate,(0,re._)`${A}.validate`]:["string",S,A]}function w(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!u.$async)throw new Error("async format in sync schema");return(0,re._)`await ${y}(${n})`}return typeof m=="function"?(0,re._)`${y}(${n})`:(0,re._)`${y}.test(${n})`}}}};Zd.default=tE,Object.defineProperty(Yd,"__esModule",{value:!0});const eE=Zd,sE=[eE.default];Yd.default=sE;var Bo={};Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.contentVocabulary=Bo.metadataVocabulary=void 0,Bo.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],Bo.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"],Object.defineProperty(gd,"__esModule",{value:!0});const nE=yd,rE=bd,oE=$d,iE=Yd,Iv=Bo,aE=[nE.default,rE.default,(0,oE.default)(),iE.default,Iv.metadataVocabulary,Iv.contentVocabulary];gd.default=aE;var qd={},Ev={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(Ev),Object.defineProperty(qd,"__esModule",{value:!0});const jo=_t,Qd=Ev,$v=ls,lE=Et,hE={message:({params:{discrError:e,tagName:t}})=>e===Qd.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:s}})=>(0,jo._)`{error: ${e}, tag: ${s}, tagValue: ${t}}`},cE={keyword:"discriminator",type:"object",schemaType:"object",error:hE,code(e){const{gen:t,data:s,schema:n,parentSchema:r,it:o}=e,{oneOf:i}=r;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");const l=t.let("valid",!1),c=t.const("tag",(0,jo._)`${s}${(0,jo.getProperty)(a)}`);t.if((0,jo._)`typeof ${c} == "string"`,()=>u(),()=>e.error(!1,{discrError:Qd.DiscrError.Tag,tag:c,tagName:a})),e.ok(l);function u(){const f=d();t.if(!1);for(const p in f)t.elseIf((0,jo._)`${c} === ${p}`),t.assign(l,h(f[p]));t.else(),e.error(!1,{discrError:Qd.DiscrError.Mapping,tag:c,tagName:a}),t.endIf()}function h(f){const p=t.name("valid"),g=e.subschema({keyword:"oneOf",schemaProp:f},p);return e.mergeEvaluated(g,jo.Name),p}function d(){var f;const p={},g=y(r);let m=!0;for(let w=0;w<i.length;w++){let S=i[w];S!=null&&S.$ref&&!(0,lE.schemaHasRulesButRef)(S,o.self.RULES)&&(S=$v.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,S==null?void 0:S.$ref),S instanceof $v.SchemaEnv&&(S=S.schema));const _=(f=S==null?void 0:S.properties)===null||f===void 0?void 0:f[a];if(typeof _!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);m=m&&(g||y(S)),v(_,w)}if(!m)throw new Error(`discriminator: "${a}" must be required`);return p;function y({required:w}){return Array.isArray(w)&&w.includes(a)}function v(w,S){if(w.const)b(w.const,S);else if(w.enum)for(const _ of w.enum)b(_,S);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function b(w,S){if(typeof w!="string"||w in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[w]=S}}}};qd.default=cE;const uE="http://json-schema.org/draft-07/schema#",dE="http://json-schema.org/draft-07/schema#",fE="Core schema meta-schema",pE={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},mE=["object","boolean"],gE={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},yE={$schema:uE,$id:dE,title:fE,definitions:pE,type:mE,properties:gE,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const s=Ry,n=gd,r=qd,o=yE,i=["/properties"],a="http://json-schema.org/draft-07/schema";class l extends s.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(p=>this.addVocabulary(p)),this.opts.discriminator&&this.addKeyword(r.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const p=this.opts.$data?this.$dataMetaSchema(o,i):o;this.addMetaSchema(p,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}e.exports=t=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var c=zs;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=_t;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var h=Wi;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return h.default}});var d=Xi;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return d.default}})})(sd,sd.exports);var vE=sd.exports;const bE=gi(vE),wE={type:"object",properties:{meta:{type:"object",properties:{title:{type:"string"},artist:{type:"string"},beats_per_minute:{type:"number",minimum:1},beats_per_measure:{type:"integer",minimum:1},approach_rate:{type:"number",exclusiveMinimum:0},start_offset:{type:"number",minimum:0}},required:["title","artist","beats_per_minute","beats_per_measure"]},events:{type:"array",items:{type:"object",properties:{at:{type:"number",minimum:0},type:{type:"string",enum:["bpmi","bpme","ar"]},value:{type:"number",minimum:0}},required:["at","type","value"]}},notes:{type:"array",items:{type:"object",properties:{at:{type:"number",minimum:0},type:{type:"string",enum:["hit","hold","trick"]},track:{type:"number",enum:[0,1,2,3]},until:{type:"number",minimum:{$data:"1/at"}},to_track:{type:"integer",enum:[0,1,2,3]}},required:["at","type","track"],allOf:[{if:{properties:{type:{const:"hold"}}},then:{required:["until"]}},{if:{properties:{type:{const:"trick"}}},then:{required:["to_track"]}}]}}},required:["meta","events","notes"]},xE=new bE({$data:!0}),Rv=xE.compile(wE);function _E(e){if(!Rv(e)){const t=Rv.errors[0];return`Validation Error: ${t.message} (${t.keyword}; ${t.instancePath})`}return""}class Kd{constructor(t){this.atTime=t}}class AE extends Kd{constructor(t,s){super(t),this.velocity=s}}class Jd extends AE{constructor(t,s,n,r){super(s,n),this.index=t,this.track=r}}class Dv extends Jd{}class tf extends Jd{constructor(t,s,n,r,o){super(t,s,r,o),this.untilTime=n}get duration(){return this.untilTime-this.atTime}}class ef extends Jd{constructor(t,s,n,r,o){super(t,s,n,r),this.toTrack=o}get switchStartTime(){return this.atTime-ed*.65/this.velocity}get switchEndTime(){return this.atTime-ed*.25/this.velocity}}class sf extends Kd{constructor(t,s,n){super(t),this.beatsPerMinute=s,this.beatsPerMeasure=n}get timePerBeat(){return 6e4/this.beatsPerMinute}get timePerMeasure(){return this.timePerBeat*this.beatsPerMeasure}}class Nv extends Kd{constructor(t,s){super(t),this.approachRate=s}}const Ws={checkStructure(e){try{const t=Ku.load(e.yaml);return _E(t)||""}catch(t){return t instanceof Qu?`YAML Error: ${t.message}`:`Other Error: ${t.message}`}},parseMetadata(e){var t,s,n,r,o,i;try{const a=Ku.load(e.yaml);return new $y({title:((t=a==null?void 0:a.meta)==null?void 0:t.title)||"[error]",artist:((s=a==null?void 0:a.meta)==null?void 0:s.artist)||"[error]",audioURI:((r=(n=e.assets)==null?void 0:n.audio)==null?void 0:r.uri)||"",backgroundURI:((i=(o=e.assets)==null?void 0:o.background)==null?void 0:i.uri)||""})}catch(a){if(a instanceof Qu)return new $y({title:"[error]",artist:"[error]",audioURI:"",backgroundURI:""})}},parseWhole(e){const t=Ku.load(e.yaml),s=this.parseMetadata(e),n=new O2(s,[],...kE(t));for(const[r,o]of t.notes.entries())o.type==="hit"?n._notes.push(new Dv(r,o.at,n.getVelocity(o.at),o.track)):o.type==="hold"?n._notes.push(new tf(r,o.at,o.until,n.getVelocity(o.at),o.track)):o.type==="trick"&&n._notes.push(new ef(r,o.at,n.getVelocity(o.at),o.track,o.to_track));return n}};function kE(e){const t=[new sf(e.meta.start_offset||0,e.meta.beats_per_minute,e.meta.beats_per_measure)],s=[new Nv(e.meta.start_offset||0,e.meta.approach_rate||1)];for(const n of e.events){const r=t.at(-1),o=t.length-(r.atTime===n.at?1:0);n.type==="bpmi"?t[o]=new sf(n.at,n.value,r.beatsPerMeasure):n.type==="bpme"?t[o]=new sf(n.at,r.beatsPerMinute,n.value??r.beatsPerMeasure):n.type==="ar"&&s.push(new Nv(n.at,n.value))}return[t,s]}function Lv(e,{delay:t=0,duration:s=400,easing:n=n0}={}){const r=+getComputedStyle(e).opacity;return{delay:t,duration:s,easing:n,css:o=>`opacity: ${o*r}`}}function Bv(e){let t,s,n,r,o;return{c(){t=q("div"),Q(t,"class","background-image svelte-tigh0d"),go(t,"--background",e[2])},m(i,a){Ct(i,t,a),n=!0,r||(o=Te(t,"introend",TE),r=!0)},p(i,a){e=i,(!n||a&4)&&go(t,"--background",e[2])},i(i){n||(i&&wo(()=>{n&&(s||(s=v0(t,Lv,{duration:Fv},!0)),s.run(1))}),n=!0)},o(i){i&&(s||(s=v0(t,Lv,{duration:Fv},!1)),s.run(0)),n=!1},d(i){i&&xt(t),i&&s&&s.end(),r=!1,o()}}}function SE(e){let t,s,n,r=e[2]&&Bv(e);return{c(){t=q("div"),s=q("div"),n=it(),r&&r.c(),Q(s,"class","background-image svelte-tigh0d"),go(s,"--background",e[1]),Q(t,"class","background svelte-tigh0d"),go(t,"--dim-amount",e[0])},m(o,i){Ct(o,t,i),V(t,s),V(t,n),r&&r.m(t,null)},p(o,[i]){i&2&&go(s,"--background",o[1]),o[2]?r?(r.p(o,i),i&4&&dt(r,1)):(r=Bv(o),r.c(),dt(r,1),r.m(t,null)):r&&(Ii(),gt(r,1,1,()=>{r=null}),Ei()),i&1&&go(t,"--dim-amount",o[0])},i(o){dt(r)},o(o){gt(r)},d(o){o&&xt(t),r&&r.d()}}}const jv="black",CE=.45,Fv=225;let Vv=Mn(jv),Ul=Mn(""),OE=Mn(CE);function nf(e){Ul.set(`url('${e}')`)}function rf(){Ul.set(jv)}function TE(){Ul.update(e=>(Vv.set(e),""))}function PE(e,t,s){let n,r,o;return en(e,OE,i=>s(0,n=i)),en(e,Vv,i=>s(1,r=i)),en(e,Ul,i=>s(2,o=i)),[n,r,o]}class Hl extends ye{constructor(t){super(),ge(this,t,PE,SE,ce,{})}}function ME(e){let t,s,n,r,o;return{c(){t=q("button"),s=q("span"),n=vt(e[1]),Q(s,"class","material-symbols-outlined"),t.disabled=e[0],Q(t,"class","svelte-1x2g5wr"),yo(t,"disabled",e[0])},m(i,a){Ct(i,t,a),V(t,s),V(s,n),r||(o=Te(t,"click",e[2]),r=!0)},p(i,[a]){a&2&&ne(n,i[1]),a&1&&(t.disabled=i[0]),a&1&&yo(t,"disabled",i[0])},i:jt,o:jt,d(i){i&&xt(t),r=!1,o()}}}function IE(e,t,s){let{disabled:n=!1}=t,{icon:r}=t;function o(i){Ou.call(this,e,i)}return e.$$set=i=>{"disabled"in i&&s(0,n=i.disabled),"icon"in i&&s(1,r=i.icon)},[n,r,o]}class gs extends ye{constructor(t){super(),ge(this,t,IE,ME,ce,{disabled:0,icon:1})}get disabled(){return this.$$.ctx[0]}set disabled(t){this.$$set({disabled:t}),ft()}get icon(){return this.$$.ctx[1]}set icon(t){this.$$set({icon:t}),ft()}}function zv(e){let t;return{c(){t=q("p"),t.textContent="(Has errors; needs editing!)",Q(t,"class","invalid-line svelte-602zge")},m(s,n){Ct(s,t,n)},d(s){s&&xt(t)}}}function EE(e){let t,s,n,r=e[0].title+"",o,i,a,l=e[0].artist+"",c,u,h,d,f,p,g,m,y,v,b=!e[2]&&zv();return f=new gs({props:{icon:"Edit",disabled:!e[1]}}),f.$on("click",e[5]),g=new gs({props:{icon:"Delete",disabled:!e[1]}}),g.$on("click",e[6]),{c(){t=q("div"),s=q("div"),n=q("h2"),o=vt(r),i=it(),a=q("p"),c=vt(l),u=it(),b&&b.c(),h=it(),d=q("div"),Pt(f.$$.fragment),p=it(),Pt(g.$$.fragment),Q(n,"class","major-line svelte-602zge"),Q(a,"class","minor-line svelte-602zge"),Q(d,"class","action-list svelte-602zge"),Q(t,"class","beatmap-item svelte-602zge"),Q(t,"role","button"),yo(t,"invalid",!e[2]),yo(t,"selected",e[1])},m(w,S){Ct(w,t,S),V(t,s),V(s,n),V(n,o),V(s,i),V(s,a),V(a,c),V(s,u),b&&b.m(s,null),V(t,h),V(t,d),Ot(f,d,null),V(d,p),Ot(g,d,null),m=!0,y||(v=Te(t,"click",e[4]),y=!0)},p(w,[S]){(!m||S&1)&&r!==(r=w[0].title+"")&&ne(o,r),(!m||S&1)&&l!==(l=w[0].artist+"")&&ne(c,l),w[2]?b&&(b.d(1),b=null):b||(b=zv(),b.c(),b.m(s,null));const _={};S&2&&(_.disabled=!w[1]),f.$set(_);const A={};S&2&&(A.disabled=!w[1]),g.$set(A),(!m||S&4)&&yo(t,"invalid",!w[2]),(!m||S&2)&&yo(t,"selected",w[1])},i(w){m||(dt(f.$$.fragment,w),dt(g.$$.fragment,w),m=!0)},o(w){gt(f.$$.fragment,w),gt(g.$$.fragment,w),m=!1},d(w){w&&xt(t),b&&b.d(),Tt(f),Tt(g),y=!1,v()}}}function $E(e,t,s){const n=Pi();let{metadata:r}=t,{selected:o}=t,{valid:i}=t;function a(u){Ou.call(this,e,u)}const l=()=>n("edit"),c=()=>n("delete");return e.$$set=u=>{"metadata"in u&&s(0,r=u.metadata),"selected"in u&&s(1,o=u.selected),"valid"in u&&s(2,i=u.valid)},[r,o,i,n,a,l,c]}class RE extends ye{constructor(t){super(),ge(this,t,$E,EE,ce,{metadata:0,selected:1,valid:2})}get metadata(){return this.$$.ctx[0]}set metadata(t){this.$$set({metadata:t}),ft()}get selected(){return this.$$.ctx[1]}set selected(t){this.$$set({selected:t}),ft()}get valid(){return this.$$.ctx[2]}set valid(t){this.$$set({valid:t}),ft()}}function DE(e){let t,s,n,r,o,i,a;const l=e[2].default,c=wC(l,e,e[1],null);return{c(){t=q("button"),s=q("span"),n=vt(e[0]),r=it(),c&&c.c(),Q(s,"class","material-symbols-outlined svelte-1rvmu89"),Q(t,"class","svelte-1rvmu89")},m(u,h){Ct(u,t,h),V(t,s),V(s,n),V(t,r),c&&c.m(t,null),o=!0,i||(a=Te(t,"click",e[3]),i=!0)},p(u,[h]){(!o||h&1)&&ne(n,u[0]),c&&c.p&&(!o||h&2)&&_C(c,l,u,u[1],o?xC(l,u[1],h,null):AC(u[1]),null)},i(u){o||(dt(c,u),o=!0)},o(u){gt(c,u),o=!1},d(u){u&&xt(t),c&&c.d(u),i=!1,a()}}}function NE(e,t,s){let{$$slots:n={},$$scope:r}=t,{icon:o}=t;function i(a){Ou.call(this,e,a)}return e.$$set=a=>{"icon"in a&&s(0,o=a.icon),"$$scope"in a&&s(1,r=a.$$scope)},[o,r,n,i]}class Wl extends ye{constructor(t){super(),ge(this,t,NE,DE,ce,{icon:0})}get icon(){return this.$$.ctx[0]}set icon(t){this.$$set({icon:t}),ft()}}const Gv=1024;let LE=0,of=class{constructor(e,t){this.from=e,this.to=t}};class kt{constructor(t={}){this.id=LE++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=cs.match(t)),s=>{let n=t(s);return n===void 0?null:[this,n]}}}kt.closedBy=new kt({deserialize:e=>e.split(" ")}),kt.openedBy=new kt({deserialize:e=>e.split(" ")}),kt.group=new kt({deserialize:e=>e.split(" ")}),kt.isolate=new kt({deserialize:e=>{if(e&&e!="rtl"&&e!="ltr"&&e!="auto")throw new RangeError("Invalid value for isolate: "+e);return e||"auto"}}),kt.contextHash=new kt({perNode:!0}),kt.lookAhead=new kt({perNode:!0}),kt.mounted=new kt({perNode:!0});class Xl{constructor(t,s,n){this.tree=t,this.overlay=s,this.parser=n}static get(t){return t&&t.props&&t.props[kt.mounted.id]}}const BE=Object.create(null);class cs{constructor(t,s,n,r=0){this.name=t,this.props=s,this.id=n,this.flags=r}static define(t){let s=t.props&&t.props.length?Object.create(null):BE,n=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),r=new cs(t.name||"",s,t.id,n);if(t.props){for(let o of t.props)if(Array.isArray(o)||(o=o(r)),o){if(o[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");s[o[0].id]=o[1]}}return r}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let s=this.prop(kt.group);return s?s.indexOf(t)>-1:!1}return this.id==t}static match(t){let s=Object.create(null);for(let n in t)for(let r of n.split(" "))s[r]=t[n];return n=>{for(let r=n.prop(kt.group),o=-1;o<(r?r.length:0);o++){let i=s[o<0?n.name:r[o]];if(i)return i}}}}cs.none=new cs("",Object.create(null),0,8);class af{constructor(t){this.types=t;for(let s=0;s<t.length;s++)if(t[s].id!=s)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let s=[];for(let n of this.types){let r=null;for(let o of t){let i=o(n);i&&(r||(r=Object.assign({},n.props)),r[i[0].id]=i[1])}s.push(r?new cs(n.name,r,n.id,n.flags):n)}return new af(s)}}const Yl=new WeakMap,Uv=new WeakMap;var Pe;(function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"})(Pe||(Pe={}));class de{constructor(t,s,n,r,o){if(this.type=t,this.children=s,this.positions=n,this.length=r,this.props=null,o&&o.length){this.props=Object.create(null);for(let[i,a]of o)this.props[typeof i=="number"?i:i.id]=a}}toString(){let t=Xl.get(this);if(t&&!t.overlay)return t.tree.toString();let s="";for(let n of this.children){let r=n.toString();r&&(s&&(s+=","),s+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(s.length?"("+s+")":""):s}cursor(t=0){return new cf(this.topNode,t)}cursorAt(t,s=0,n=0){let r=Yl.get(this)||this.topNode,o=new cf(r);return o.moveTo(t,s),Yl.set(this,o._tree),o}get topNode(){return new Ts(this,0,0,null)}resolve(t,s=0){let n=ea(Yl.get(this)||this.topNode,t,s,!1);return Yl.set(this,n),n}resolveInner(t,s=0){let n=ea(Uv.get(this)||this.topNode,t,s,!0);return Uv.set(this,n),n}resolveStack(t,s=0){return VE(this,t,s)}iterate(t){let{enter:s,leave:n,from:r=0,to:o=this.length}=t,i=t.mode||0,a=(i&Pe.IncludeAnonymous)>0;for(let l=this.cursor(i|Pe.IncludeAnonymous);;){let c=!1;if(l.from<=o&&l.to>=r&&(!a&&l.type.isAnonymous||s(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&n&&(a||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let s in this.props)t.push([+s,this.props[s]]);return t}balance(t={}){return this.children.length<=8?this:df(cs.none,this.children,this.positions,0,this.children.length,0,this.length,(s,n,r)=>new de(this.type,s,n,r,this.propValues),t.makeTree||((s,n,r)=>new de(cs.none,s,n,r)))}static build(t){return zE(t)}}de.empty=new de(cs.none,[],[],0);class lf{constructor(t,s){this.buffer=t,this.index=s}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new lf(this.buffer,this.index)}}class tr{constructor(t,s,n){this.buffer=t,this.length=s,this.set=n}get type(){return cs.none}toString(){let t=[];for(let s=0;s<this.buffer.length;)t.push(this.childString(s)),s=this.buffer[s+3];return t.join(",")}childString(t){let s=this.buffer[t],n=this.buffer[t+3],r=this.set.types[s],o=r.name;if(/\W/.test(o)&&!r.isError&&(o=JSON.stringify(o)),t+=4,n==t)return o;let i=[];for(;t<n;)i.push(this.childString(t)),t=this.buffer[t+3];return o+"("+i.join(",")+")"}findChild(t,s,n,r,o){let{buffer:i}=this,a=-1;for(let l=t;l!=s&&!(Hv(o,r,i[l+1],i[l+2])&&(a=l,n>0));l=i[l+3]);return a}slice(t,s,n){let r=this.buffer,o=new Uint16Array(s-t),i=0;for(let a=t,l=0;a<s;){o[l++]=r[a++],o[l++]=r[a++]-n;let c=o[l++]=r[a++]-n;o[l++]=r[a++]-t,i=Math.max(i,c)}return new tr(o,i,this.set)}}function Hv(e,t,s,n){switch(e){case-2:return s<t;case-1:return n>=t&&s<t;case 0:return s<t&&n>t;case 1:return s<=t&&n>t;case 2:return n>t;case 4:return!0}}function ea(e,t,s,n){for(var r;e.from==e.to||(s<1?e.from>=t:e.from>t)||(s>-1?e.to<=t:e.to<t);){let i=!n&&e instanceof Ts&&e.index<0?null:e.parent;if(!i)return e;e=i}let o=n?0:Pe.IgnoreOverlays;if(n)for(let i=e,a=i.parent;a;i=a,a=i.parent)i instanceof Ts&&i.index<0&&((r=a.enter(t,s,o))===null||r===void 0?void 0:r.from)!=i.from&&(e=a);for(;;){let i=e.enter(t,s,o);if(!i)return e;e=i}}class Wv{cursor(t=0){return new cf(this,t)}getChild(t,s=null,n=null){let r=Xv(this,t,s,n);return r.length?r[0]:null}getChildren(t,s=null,n=null){return Xv(this,t,s,n)}resolve(t,s=0){return ea(this,t,s,!1)}resolveInner(t,s=0){return ea(this,t,s,!0)}matchContext(t){return hf(this,t)}enterUnfinishedNodesBefore(t){let s=this.childBefore(t),n=this;for(;s;){let r=s.lastChild;if(!r||r.to!=s.to)break;r.type.isError&&r.from==r.to?(n=s,s=r.prevSibling):s=r}return n}get node(){return this}get next(){return this.parent}}class Ts extends Wv{constructor(t,s,n,r){super(),this._tree=t,this.from=s,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,s,n,r,o=0){for(let i=this;;){for(let{children:a,positions:l}=i._tree,c=s>0?a.length:-1;t!=c;t+=s){let u=a[t],h=l[t]+i.from;if(Hv(r,n,h,h+u.length)){if(u instanceof tr){if(o&Pe.ExcludeBuffers)continue;let d=u.findChild(0,u.buffer.length,s,n-h,r);if(d>-1)return new er(new jE(i,u,t,h),null,d)}else if(o&Pe.IncludeAnonymous||!u.type.isAnonymous||uf(u)){let d;if(!(o&Pe.IgnoreMounts)&&(d=Xl.get(u))&&!d.overlay)return new Ts(d.tree,h,t,i);let f=new Ts(u,h,t,i);return o&Pe.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(s<0?u.children.length-1:0,s,n,r)}}}if(o&Pe.IncludeAnonymous||!i.type.isAnonymous||(i.index>=0?t=i.index+s:t=s<0?-1:i._parent._tree.children.length,i=i._parent,!i))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,s,n=0){let r;if(!(n&Pe.IgnoreOverlays)&&(r=Xl.get(this._tree))&&r.overlay){let o=t-this.from;for(let{from:i,to:a}of r.overlay)if((s>0?i<=o:i<o)&&(s<0?a>=o:a>o))return new Ts(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,s,n)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Xv(e,t,s,n){let r=e.cursor(),o=[];if(!r.firstChild())return o;if(s!=null){for(let i=!1;!i;)if(i=r.type.is(s),!r.nextSibling())return o}for(;;){if(n!=null&&r.type.is(n))return o;if(r.type.is(t)&&o.push(r.node),!r.nextSibling())return n==null?o:[]}}function hf(e,t,s=t.length-1){for(let n=e.parent;s>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[s]&&t[s]!=n.name)return!1;s--}}return!0}class jE{constructor(t,s,n,r){this.parent=t,this.buffer=s,this.index=n,this.start=r}}class er extends Wv{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,s,n){super(),this.context=t,this._parent=s,this.index=n,this.type=t.buffer.set.types[t.buffer.buffer[n]]}child(t,s,n){let{buffer:r}=this.context,o=r.findChild(this.index+4,r.buffer[this.index+3],t,s-this.context.start,n);return o<0?null:new er(this.context,this,o)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,s,n=0){if(n&Pe.ExcludeBuffers)return null;let{buffer:r}=this.context,o=r.findChild(this.index+4,r.buffer[this.index+3],s>0?1:-1,t-this.context.start,s);return o<0?null:new er(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,s=t.buffer[this.index+3];return s<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new er(this.context,this._parent,s):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,s=this._parent?this._parent.index+4:0;return this.index==s?this.externalSibling(-1):new er(this.context,this._parent,t.findChild(s,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],s=[],{buffer:n}=this.context,r=this.index+4,o=n.buffer[this.index+3];if(o>r){let i=n.buffer[this.index+1];t.push(n.slice(r,o,i)),s.push(0)}return new de(this.type,t,s,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Yv(e){if(!e.length)return null;let t=0,s=e[0];for(let o=1;o<e.length;o++){let i=e[o];(i.from>s.from||i.to<s.to)&&(s=i,t=o)}let n=s instanceof Ts&&s.index<0?null:s.parent,r=e.slice();return n?r[t]=n:r.splice(t,1),new FE(r,s)}class FE{constructor(t,s){this.heads=t,this.node=s}get next(){return Yv(this.heads)}}function VE(e,t,s){let n=e.resolveInner(t,s),r=null;for(let o=n instanceof Ts?n:n.context.parent;o;o=o.parent)if(o.index<0){let i=o.parent;(r||(r=[n])).push(i.resolve(t,s)),o=i}else{let i=Xl.get(o.tree);if(i&&i.overlay&&i.overlay[0].from<=t&&i.overlay[i.overlay.length-1].to>=t){let a=new Ts(i.tree,i.overlay[0].from+o.from,-1,o);(r||(r=[n])).push(ea(a,t,s,!1))}}return r?Yv(r):n}class cf{get name(){return this.type.name}constructor(t,s=0){if(this.mode=s,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Ts)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let n=t._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,s){this.index=t;let{start:n,buffer:r}=this.buffer;return this.type=s||r.set.types[r.buffer[t]],this.from=n+r.buffer[t+1],this.to=n+r.buffer[t+2],!0}yield(t){return t?t instanceof Ts?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,s,n){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,s,n,this.mode));let{buffer:r}=this.buffer,o=r.findChild(this.index+4,r.buffer[this.index+3],t,s-this.buffer.start,n);return o<0?!1:(this.stack.push(this.index),this.yieldBuf(o))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,s,n=this.mode){return this.buffer?n&Pe.ExcludeBuffers?!1:this.enterChild(1,t,s):this.yield(this._tree.enter(t,s,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Pe.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Pe.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:s}=this.buffer,n=this.stack.length-1;if(t<0){let r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(s.findChild(r,this.index,-1,0,4))}else{let r=s.buffer[this.index+3];if(r<(n<0?s.buffer.length:s.buffer[this.stack[n]+3]))return this.yieldBuf(r)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let s,n,{buffer:r}=this;if(r){if(t>0){if(this.index<r.buffer.buffer.length)return!1}else for(let o=0;o<this.index;o++)if(r.buffer.buffer[o+3]<this.index)return!1;({index:s,parent:n}=r)}else({index:s,_parent:n}=this._tree);for(;n;{index:s,_parent:n}=n)if(s>-1)for(let o=s+t,i=t<0?-1:n._tree.children.length;o!=i;o+=t){let a=n._tree.children[o];if(this.mode&Pe.IncludeAnonymous||a instanceof tr||!a.type.isAnonymous||uf(a))return!1}return!0}move(t,s){if(s&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,s=0){for(;(this.from==this.to||(s<1?this.from>=t:this.from>t)||(s>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,s););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,s=null,n=0;if(t&&t.context==this.buffer)t:for(let r=this.index,o=this.stack.length;o>=0;){for(let i=t;i;i=i._parent)if(i.index==r){if(r==this.index)return i;s=i,n=o+1;break t}r=this.stack[--o]}for(let r=n;r<this.stack.length;r++)s=new er(this.buffer,s,this.stack[r]);return this.bufferNode=new er(this.buffer,s,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,s){for(let n=0;;){let r=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;r&&s&&s(this),r=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,r=!0}}}matchContext(t){if(!this.buffer)return hf(this.node,t);let{buffer:s}=this.buffer,{types:n}=s.set;for(let r=t.length-1,o=this.stack.length-1;r>=0;o--){if(o<0)return hf(this.node,t,r);let i=n[s.buffer[this.stack[o]]];if(!i.isAnonymous){if(t[r]&&t[r]!=i.name)return!1;r--}}return!0}}function uf(e){return e.children.some(t=>t instanceof tr||!t.type.isAnonymous||uf(t))}function zE(e){var t;let{buffer:s,nodeSet:n,maxBufferLength:r=Gv,reused:o=[],minRepeatType:i=n.types.length}=e,a=Array.isArray(s)?new lf(s,s.length):s,l=n.types,c=0,u=0;function h(S,_,A,O,P,R){let{id:X,start:B,end:H,size:j}=a,K=u;for(;j<0;)if(a.next(),j==-1){let N=o[X];A.push(N),O.push(B-S);return}else if(j==-3){c=X;return}else if(j==-4){u=X;return}else throw new RangeError(`Unrecognized record size: ${j}`);let nt=l[X],ht,St,U=B-S;if(H-B<=r&&(St=m(a.pos-_,P))){let N=new Uint16Array(St.size-St.skip),E=a.pos-St.size,L=N.length;for(;a.pos>E;)L=y(St.start,N,L);ht=new tr(N,H-St.start,n),U=St.start-S}else{let N=a.pos-j;a.next();let E=[],L=[],D=X>=i?X:-1,x=0,C=H;for(;a.pos>N;)D>=0&&a.id==D&&a.size>=0?(a.end<=C-r&&(p(E,L,B,x,a.end,C,D,K),x=E.length,C=a.end),a.next()):R>2500?d(B,N,E,L):h(B,N,E,L,D,R+1);if(D>=0&&x>0&&x<E.length&&p(E,L,B,x,B,C,D,K),E.reverse(),L.reverse(),D>-1&&x>0){let $=f(nt);ht=df(nt,E,L,0,E.length,0,H-B,$,$)}else ht=g(nt,E,L,H-B,K-H)}A.push(ht),O.push(U)}function d(S,_,A,O){let P=[],R=0,X=-1;for(;a.pos>_;){let{id:B,start:H,end:j,size:K}=a;if(K>4)a.next();else{if(X>-1&&H<X)break;X<0&&(X=j-r),P.push(B,H,j),R++,a.next()}}if(R){let B=new Uint16Array(R*4),H=P[P.length-2];for(let j=P.length-3,K=0;j>=0;j-=3)B[K++]=P[j],B[K++]=P[j+1]-H,B[K++]=P[j+2]-H,B[K++]=K;A.push(new tr(B,P[2]-H,n)),O.push(H-S)}}function f(S){return(_,A,O)=>{let P=0,R=_.length-1,X,B;if(R>=0&&(X=_[R])instanceof de){if(!R&&X.type==S&&X.length==O)return X;(B=X.prop(kt.lookAhead))&&(P=A[R]+X.length+B)}return g(S,_,A,O,P)}}function p(S,_,A,O,P,R,X,B){let H=[],j=[];for(;S.length>O;)H.push(S.pop()),j.push(_.pop()+A-P);S.push(g(n.types[X],H,j,R-P,B-R)),_.push(P-A)}function g(S,_,A,O,P=0,R){if(c){let X=[kt.contextHash,c];R=R?[X].concat(R):[X]}if(P>25){let X=[kt.lookAhead,P];R=R?[X].concat(R):[X]}return new de(S,_,A,O,R)}function m(S,_){let A=a.fork(),O=0,P=0,R=0,X=A.end-r,B={size:0,start:0,skip:0};t:for(let H=A.pos-S;A.pos>H;){let j=A.size;if(A.id==_&&j>=0){B.size=O,B.start=P,B.skip=R,R+=4,O+=4,A.next();continue}let K=A.pos-j;if(j<0||K<H||A.start<X)break;let nt=A.id>=i?4:0,ht=A.start;for(A.next();A.pos>K;){if(A.size<0)if(A.size==-3)nt+=4;else break t;else A.id>=i&&(nt+=4);A.next()}P=ht,O+=j,R+=nt}return(_<0||O==S)&&(B.size=O,B.start=P,B.skip=R),B.size>4?B:void 0}function y(S,_,A){let{id:O,start:P,end:R,size:X}=a;if(a.next(),X>=0&&O<i){let B=A;if(X>4){let H=a.pos-(X-4);for(;a.pos>H;)A=y(S,_,A)}_[--A]=B,_[--A]=R-S,_[--A]=P-S,_[--A]=O}else X==-3?c=O:X==-4&&(u=O);return A}let v=[],b=[];for(;a.pos>0;)h(e.start||0,e.bufferStart||0,v,b,-1,0);let w=(t=e.length)!==null&&t!==void 0?t:v.length?b[0]+v[0].length:0;return new de(l[e.topID],v.reverse(),b.reverse(),w)}const Zv=new WeakMap;function Zl(e,t){if(!e.isAnonymous||t instanceof tr||t.type!=e)return 1;let s=Zv.get(t);if(s==null){s=1;for(let n of t.children){if(n.type!=e||!(n instanceof de)){s=1;break}s+=Zl(e,n)}Zv.set(t,s)}return s}function df(e,t,s,n,r,o,i,a,l){let c=0;for(let p=n;p<r;p++)c+=Zl(e,t[p]);let u=Math.ceil(c*1.5/8),h=[],d=[];function f(p,g,m,y,v){for(let b=m;b<y;){let w=b,S=g[b],_=Zl(e,p[b]);for(b++;b<y;b++){let A=Zl(e,p[b]);if(_+A>=u)break;_+=A}if(b==w+1){if(_>u){let A=p[w];f(A.children,A.positions,0,A.children.length,g[w]+v);continue}h.push(p[w])}else{let A=g[b-1]+p[b-1].length-S;h.push(df(e,p,g,w,b,S,A,null,l))}d.push(S+v-o)}}return f(t,s,n,r,0),(a||l)(h,d,i)}class Lr{constructor(t,s,n,r,o=!1,i=!1){this.from=t,this.to=s,this.tree=n,this.offset=r,this.open=(o?1:0)|(i?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,s=[],n=!1){let r=[new Lr(0,t.length,t,0,!1,n)];for(let o of s)o.to>t.length&&r.push(o);return r}static applyChanges(t,s,n=128){if(!s.length)return t;let r=[],o=1,i=t.length?t[0]:null;for(let a=0,l=0,c=0;;a++){let u=a<s.length?s[a]:null,h=u?u.fromA:1e9;if(h-l>=n)for(;i&&i.from<h;){let d=i;if(l>=d.from||h<=d.to||c){let f=Math.max(d.from,l)-c,p=Math.min(d.to,h)-c;d=f>=p?null:new Lr(f,p,d.tree,d.offset+c,a>0,!!u)}if(d&&r.push(d),i.to>h)break;i=o<t.length?t[o++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return r}}class qv{startParse(t,s,n){return typeof t=="string"&&(t=new GE(t)),n=n?n.length?n.map(r=>new of(r.from,r.to)):[new of(0,0)]:[new of(0,t.length)],this.createParse(t,s||[],n)}parse(t,s,n){let r=this.startParse(t,s,n);for(;;){let o=r.advance();if(o)return o}}}class GE{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,s){return this.string.slice(t,s)}}new kt({perNode:!0});class ql{constructor(t,s,n,r,o,i,a,l,c,u=0,h){this.p=t,this.stack=s,this.state=n,this.reducePos=r,this.pos=o,this.score=i,this.buffer=a,this.bufferBase=l,this.curContext=c,this.lookAhead=u,this.parent=h}toString(){return`[${this.stack.filter((t,s)=>s%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,s,n=0){let r=t.parser.context;return new ql(t,[],s,n,n,0,[],0,r?new Qv(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,s){this.stack.push(this.state,s,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var s;let n=t>>19,r=t&65535,{parser:o}=this.p,i=o.dynamicPrecedence(r);if(i&&(this.score+=i),n==0){this.pushState(o.getGoto(this.state,r,!0),this.reducePos),r<o.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,4,!0),this.reduceContext(r,this.reducePos);return}let a=this.stack.length-(n-1)*3-(t&262144?6:0),l=a?this.stack[a-2]:this.p.ranges[0].from,c=this.reducePos-l;c>=2e3&&!(!((s=this.p.parser.nodeSet.types[r])===null||s===void 0)&&s.isAnonymous)&&(l==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=l,this.p.lastBigReductionSize=c));let u=a?this.stack[a-1]:0,h=this.bufferBase+this.buffer.length-u;if(r<o.minRepeatTerm||t&131072){let d=o.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,l,d,h+4,!0)}if(t&262144)this.state=this.stack[a];else{let d=this.stack[a-3];this.state=o.getGoto(d,r,!0)}for(;this.stack.length>a;)this.stack.pop();this.reduceContext(r,l)}storeNode(t,s,n,r=4,o=!1){if(t==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let i=this,a=this.buffer.length;if(a==0&&i.parent&&(a=i.bufferBase-i.parent.bufferBase,i=i.parent),a>0&&i.buffer[a-4]==0&&i.buffer[a-1]>-1){if(s==n)return;if(i.buffer[a-2]>=s){i.buffer[a-2]=n;return}}}if(!o||this.pos==n)this.buffer.push(t,s,n,r);else{let i=this.buffer.length;if(i>0&&this.buffer[i-4]!=0)for(;i>0&&this.buffer[i-2]>n;)this.buffer[i]=this.buffer[i-4],this.buffer[i+1]=this.buffer[i-3],this.buffer[i+2]=this.buffer[i-2],this.buffer[i+3]=this.buffer[i-1],i-=4,r>4&&(r-=4);this.buffer[i]=t,this.buffer[i+1]=s,this.buffer[i+2]=n,this.buffer[i+3]=r}}shift(t,s,n,r){if(t&131072)this.pushState(t&65535,this.pos);else if(t&262144)this.pos=r,this.shiftContext(s,n),s<=this.p.parser.maxNode&&this.buffer.push(s,n,r,4);else{let o=t,{parser:i}=this.p;(r>this.pos||s<=i.maxNode)&&(this.pos=r,i.stateFlag(o,1)||(this.reducePos=r)),this.pushState(o,n),this.shiftContext(s,n),s<=i.maxNode&&this.buffer.push(s,n,r,4)}}apply(t,s,n,r){t&65536?this.reduce(t):this.shift(t,s,n,r)}useNode(t,s){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=t)&&(this.p.reused.push(t),n++);let r=this.pos;this.reducePos=this.pos=r+t.length,this.pushState(s,r),this.buffer.push(n,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,s=t.buffer.length;for(;s>0&&t.buffer[s-2]>t.reducePos;)s-=4;let n=t.buffer.slice(s),r=t.bufferBase+s;for(;t&&r==t.bufferBase;)t=t.parent;return new ql(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,r,this.curContext,this.lookAhead,t)}recoverByDelete(t,s){let n=t<=this.p.parser.maxNode;n&&this.storeNode(t,this.pos,s,4),this.storeNode(0,this.pos,s,n?8:4),this.pos=this.reducePos=s,this.score-=190}canShift(t){for(let s=new UE(this);;){let n=this.p.parser.stateSlot(s.state,4)||this.p.parser.hasAction(s.state,t);if(n==0)return!1;if(!(n&65536))return!0;s.reduce(n)}}recoverByInsert(t){if(this.stack.length>=300)return[];let s=this.p.parser.nextStates(this.state);if(s.length>8||this.stack.length>=120){let r=[];for(let o=0,i;o<s.length;o+=2)(i=s[o+1])!=this.state&&this.p.parser.hasAction(i,t)&&r.push(s[o],i);if(this.stack.length<120)for(let o=0;r.length<8&&o<s.length;o+=2){let i=s[o+1];r.some((a,l)=>l&1&&a==i)||r.push(s[o],i)}s=r}let n=[];for(let r=0;r<s.length&&n.length<4;r+=2){let o=s[r+1];if(o==this.state)continue;let i=this.split();i.pushState(o,this.pos),i.storeNode(0,i.pos,i.pos,4,!0),i.shiftContext(s[r],this.pos),i.reducePos=this.pos,i.score-=200,n.push(i)}return n}forceReduce(){let{parser:t}=this.p,s=t.stateSlot(this.state,5);if(!(s&65536))return!1;if(!t.validAction(this.state,s)){let n=s>>19,r=s&65535,o=this.stack.length-n*3;if(o<0||t.getGoto(this.stack[o],r,!1)<0){let i=this.findForcedReduction();if(i==null)return!1;s=i}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(s),!0}findForcedReduction(){let{parser:t}=this.p,s=[],n=(r,o)=>{if(!s.includes(r))return s.push(r),t.allActions(r,i=>{if(!(i&393216))if(i&65536){let a=(i>>19)-o;if(a>1){let l=i&65535,c=this.stack.length-a*3;if(c>=0&&t.getGoto(this.stack[c],l,!1)>=0)return a<<19|65536|l}}else{let a=n(i,o+1);if(a!=null)return a}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:t}=this.p;return t.data[t.stateSlot(this.state,1)]==65535&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let s=0;s<this.stack.length;s+=3)if(this.stack[s]!=t.stack[s])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,s){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(s)))}reduceContext(t,s){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(s)))}emitContext(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let s=new Qv(this.curContext.tracker,t);s.hash!=this.curContext.hash&&this.emitContext(),this.curContext=s}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Qv{constructor(t,s){this.tracker=t,this.context=s,this.hash=t.strict?t.hash(s):0}}class UE{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let s=t&65535,n=t>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],s,!0);this.state=r}}class Ql{constructor(t,s,n){this.stack=t,this.pos=s,this.index=n,this.buffer=t.buffer,this.index==0&&this.maybeNext()}static create(t,s=t.bufferBase+t.buffer.length){return new Ql(t,s,s-t.bufferBase)}maybeNext(){let t=this.stack.parent;t!=null&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Ql(this.stack,this.pos,this.index)}}function Kl(e,t=Uint16Array){if(typeof e!="string")return e;let s=null;for(let n=0,r=0;n<e.length;){let o=0;for(;;){let i=e.charCodeAt(n++),a=!1;if(i==126){o=65535;break}i>=92&&i--,i>=34&&i--;let l=i-32;if(l>=46&&(l-=46,a=!0),o+=l,a)break;o*=46}s?s[r++]=o:s=new t(o)}return s}class Jl{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Kv=new Jl;class HE{constructor(t,s){this.input=t,this.ranges=s,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Kv,this.rangeIndex=0,this.pos=this.chunkPos=s[0].from,this.range=s[0],this.end=s[s.length-1].to,this.readNext()}resolveOffset(t,s){let n=this.range,r=this.rangeIndex,o=this.pos+t;for(;o<n.from;){if(!r)return null;let i=this.ranges[--r];o-=n.from-i.to,n=i}for(;s<0?o>n.to:o>=n.to;){if(r==this.ranges.length-1)return null;let i=this.ranges[++r];o+=i.from-n.to,n=i}return o}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let s of this.ranges)if(s.to>t)return Math.max(t,s.from);return this.end}peek(t){let s=this.chunkOff+t,n,r;if(s>=0&&s<this.chunk.length)n=this.pos+t,r=this.chunk.charCodeAt(s);else{let o=this.resolveOffset(t,1);if(o==null)return-1;if(n=o,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let i=this.rangeIndex,a=this.range;for(;a.to<=n;)a=this.ranges[++i];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-n)),r=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),r}acceptToken(t,s=0){let n=s?this.resolveOffset(s,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=n}acceptTokenTo(t,s){this.token.value=t,this.token.end=s}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:s}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=s,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),s=this.pos+t.length;this.chunk=s>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,s){if(s?(this.token=s,s.start=t,s.lookAhead=t+1,s.value=s.extended=-1):this.token=Kv,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,s){if(t>=this.chunkPos&&s<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,s-this.chunkPos);if(t>=this.chunk2Pos&&s<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,s-this.chunk2Pos);if(t>=this.range.from&&s<=this.range.to)return this.input.read(t,s);let n="";for(let r of this.ranges){if(r.from>=s)break;r.to>t&&(n+=this.input.read(Math.max(r.from,t),Math.min(r.to,s)))}return n}}class Fo{constructor(t,s){this.data=t,this.id=s}token(t,s){let{parser:n}=s.p;WE(this.data,t,s,this.id,n.data,n.tokenPrecTable)}}Fo.prototype.contextual=Fo.prototype.fallback=Fo.prototype.extend=!1,Fo.prototype.fallback=Fo.prototype.extend=!1;class th{constructor(t,s={}){this.token=t,this.contextual=!!s.contextual,this.fallback=!!s.fallback,this.extend=!!s.extend}}function WE(e,t,s,n,r,o){let i=0,a=1<<n,{dialect:l}=s.p.parser;t:for(;a&e[i];){let c=e[i+1];for(let f=i+3;f<c;f+=2)if((e[f+1]&a)>0){let p=e[f];if(l.allows(p)&&(t.token.value==-1||t.token.value==p||XE(p,t.token.value,r,o))){t.acceptToken(p);break}}let u=t.next,h=0,d=e[i+2];if(t.next<0&&d>h&&e[c+d*3-3]==65535){i=e[c+d*3-1];continue t}for(;h<d;){let f=h+d>>1,p=c+f+(f<<1),g=e[p],m=e[p+1]||65536;if(u<g)d=f;else if(u>=m)h=f+1;else{i=e[p+2],t.advance();continue t}}break}}function Jv(e,t,s){for(let n=t,r;(r=e[n])!=65535;n++)if(r==s)return n-t;return-1}function XE(e,t,s,n){let r=Jv(s,n,t);return r<0||Jv(s,n,e)<r}const ys=typeof process<"u"&&process.env&&/\bparse\b/.test({}.LOG);let ff=null;function tb(e,t,s){let n=e.cursor(Pe.IncludeAnonymous);for(n.moveTo(t);;)if(!(s<0?n.childBefore(t):n.childAfter(t)))for(;;){if((s<0?n.to<t:n.from>t)&&!n.type.isError)return s<0?Math.max(0,Math.min(n.to-1,t-25)):Math.min(e.length,Math.max(n.from+1,t+25));if(s<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return s<0?0:e.length}}class YE{constructor(t,s){this.fragments=t,this.nodeSet=s,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?tb(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?tb(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let s=this.trees.length-1;if(s<0)return this.nextFragment(),null;let n=this.trees[s],r=this.index[s];if(r==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let o=n.children[r],i=this.start[s]+n.positions[r];if(i>t)return this.nextStart=i,null;if(o instanceof de){if(i==t){if(i<this.safeFrom)return null;let a=i+o.length;if(a<=this.safeTo){let l=o.prop(kt.lookAhead);if(!l||a+l<this.fragment.to)return o}}this.index[s]++,i+o.length>=Math.max(this.safeFrom,t)&&(this.trees.push(o),this.start.push(i),this.index.push(0))}else this.index[s]++,this.nextStart=i+o.length}}}class ZE{constructor(t,s){this.stream=s,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(n=>new Jl)}getActions(t){let s=0,n=null,{parser:r}=t.p,{tokenizers:o}=r,i=r.stateSlot(t.state,3),a=t.curContext?t.curContext.hash:0,l=0;for(let c=0;c<o.length;c++){if(!(1<<c&i))continue;let u=o[c],h=this.tokens[c];if(!(n&&!u.fallback)&&((u.contextual||h.start!=t.pos||h.mask!=i||h.context!=a)&&(this.updateCachedToken(h,u,t),h.mask=i,h.context=a),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let d=s;if(h.extended>-1&&(s=this.addActions(t,h.extended,h.end,s)),s=this.addActions(t,h.value,h.end,s),!u.extend&&(n=h,s>d))break}}for(;this.actions.length>s;)this.actions.pop();return l&&t.setLookAhead(l),!n&&t.pos==this.stream.end&&(n=new Jl,n.value=t.p.parser.eofTerm,n.start=n.end=t.pos,s=this.addActions(t,n.value,n.end,s)),this.mainToken=n,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let s=new Jl,{pos:n,p:r}=t;return s.start=n,s.end=Math.min(n+1,r.stream.end),s.value=n==r.stream.end?r.parser.eofTerm:0,s}updateCachedToken(t,s,n){let r=this.stream.clipPos(n.pos);if(s.token(this.stream.reset(r,t),n),t.value>-1){let{parser:o}=n.p;for(let i=0;i<o.specialized.length;i++)if(o.specialized[i]==t.value){let a=o.specializers[i](this.stream.read(t.start,t.end),n);if(a>=0&&n.p.parser.dialect.allows(a>>1)){a&1?t.extended=a>>1:t.value=a>>1;break}}}else t.value=0,t.end=this.stream.clipPos(r+1)}putAction(t,s,n,r){for(let o=0;o<r;o+=3)if(this.actions[o]==t)return r;return this.actions[r++]=t,this.actions[r++]=s,this.actions[r++]=n,r}addActions(t,s,n,r){let{state:o}=t,{parser:i}=t.p,{data:a}=i;for(let l=0;l<2;l++)for(let c=i.stateSlot(o,l?2:1);;c+=3){if(a[c]==65535)if(a[c+1]==1)c=Rn(a,c+2);else{r==0&&a[c+1]==2&&(r=this.putAction(Rn(a,c+2),s,n,r));break}a[c]==s&&(r=this.putAction(Rn(a,c+1),s,n,r))}return r}}class qE{constructor(t,s,n,r){this.parser=t,this.input=s,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new HE(s,r),this.tokens=new ZE(t,this.stream),this.topTerm=t.top[1];let{from:o}=r[0];this.stacks=[ql.start(this,t.top[0],o)],this.fragments=n.length&&this.stream.end-o>t.bufferLength*4?new YE(n,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t=this.stacks,s=this.minStackPos,n=this.stacks=[],r,o;if(this.bigReductionCount>300&&t.length==1){let[i]=t;for(;i.forceReduce()&&i.stack.length&&i.stack[i.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let i=0;i<t.length;i++){let a=t[i];for(;;){if(this.tokens.mainToken=null,a.pos>s)n.push(a);else{if(this.advanceStack(a,n,t))continue;{r||(r=[],o=[]),r.push(a);let l=this.tokens.getMainToken(a);o.push(l.value,l.end)}}break}}if(!n.length){let i=r&&JE(r);if(i)return ys&&console.log("Finish with "+this.stackID(i)),this.stackToTree(i);if(this.parser.strict)throw ys&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+s);this.recovering||(this.recovering=5)}if(this.recovering&&r){let i=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,o,n);if(i)return ys&&console.log("Force-finish "+this.stackID(i)),this.stackToTree(i.forceAll())}if(this.recovering){let i=this.recovering==1?1:this.recovering*3;if(n.length>i)for(n.sort((a,l)=>l.score-a.score);n.length>i;)n.pop();n.some(a=>a.reducePos>s)&&this.recovering--}else if(n.length>1){t:for(let i=0;i<n.length-1;i++){let a=n[i];for(let l=i+1;l<n.length;l++){let c=n[l];if(a.sameState(c)||a.buffer.length>500&&c.buffer.length>500)if((a.score-c.score||a.buffer.length-c.buffer.length)>0)n.splice(l--,1);else{n.splice(i--,1);continue t}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let i=1;i<n.length;i++)n[i].pos<this.minStackPos&&(this.minStackPos=n[i].pos);return null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,s,n){let r=t.pos,{parser:o}=this,i=ys?this.stackID(t)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let c=t.curContext&&t.curContext.tracker.strict,u=c?t.curContext.hash:0;for(let h=this.fragments.nodeAt(r);h;){let d=this.parser.nodeSet.types[h.type.id]==h.type?o.getGoto(t.state,h.type.id):-1;if(d>-1&&h.length&&(!c||(h.prop(kt.contextHash)||0)==u))return t.useNode(h,d),ys&&console.log(i+this.stackID(t)+` (via reuse of ${o.getName(h.type.id)})`),!0;if(!(h instanceof de)||h.children.length==0||h.positions[0]>0)break;let f=h.children[0];if(f instanceof de&&h.positions[0]==0)h=f;else break}}let a=o.stateSlot(t.state,4);if(a>0)return t.reduce(a),ys&&console.log(i+this.stackID(t)+` (via always-reduce ${o.getName(a&65535)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let l=this.tokens.getActions(t);for(let c=0;c<l.length;){let u=l[c++],h=l[c++],d=l[c++],f=c==l.length||!n,p=f?t:t.split(),g=this.tokens.mainToken;if(p.apply(u,h,g?g.start:p.pos,d),ys&&console.log(i+this.stackID(p)+` (via ${u&65536?`reduce of ${o.getName(u&65535)}`:"shift"} for ${o.getName(h)} @ ${r}${p==t?"":", split"})`),f)return!0;p.pos>r?s.push(p):n.push(p)}return!1}advanceFully(t,s){let n=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>n)return eb(t,s),!0}}runRecovery(t,s,n){let r=null,o=!1;for(let i=0;i<t.length;i++){let a=t[i],l=s[i<<1],c=s[(i<<1)+1],u=ys?this.stackID(a)+" -> ":"";if(a.deadEnd&&(o||(o=!0,a.restart(),ys&&console.log(u+this.stackID(a)+" (restarted)"),this.advanceFully(a,n))))continue;let h=a.split(),d=u;for(let f=0;h.forceReduce()&&f<10&&(ys&&console.log(d+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,n));f++)ys&&(d=this.stackID(h)+" -> ");for(let f of a.recoverByInsert(l))ys&&console.log(u+this.stackID(f)+" (via recover-insert)"),this.advanceFully(f,n);this.stream.end>a.pos?(c==a.pos&&(c++,l=0),a.recoverByDelete(l,c),ys&&console.log(u+this.stackID(a)+` (via recover-delete ${this.parser.getName(l)})`),eb(a,n)):(!r||r.score<a.score)&&(r=a)}return r}stackToTree(t){return t.close(),de.build({buffer:Ql.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let s=(ff||(ff=new WeakMap)).get(t);return s||ff.set(t,s=String.fromCodePoint(this.nextStackID++)),s+t}}function eb(e,t){for(let s=0;s<t.length;s++){let n=t[s];if(n.pos==e.pos&&n.sameState(e)){t[s].score<e.score&&(t[s]=e);return}}t.push(e)}class QE{constructor(t,s,n){this.source=t,this.flags=s,this.disabled=n}allows(t){return!this.disabled||this.disabled[t]==0}}const pf=e=>e;class KE{constructor(t){this.start=t.start,this.shift=t.shift||pf,this.reduce=t.reduce||pf,this.reuse=t.reuse||pf,this.hash=t.hash||(()=>0),this.strict=t.strict!==!1}}class eh extends qv{constructor(t){if(super(),this.wrappers=[],t.version!=14)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let s=t.nodeNames.split(" ");this.minRepeatTerm=s.length;for(let a=0;a<t.repeatNodeCount;a++)s.push("");let n=Object.keys(t.topRules).map(a=>t.topRules[a][1]),r=[];for(let a=0;a<s.length;a++)r.push([]);function o(a,l,c){r[a].push([l,l.deserialize(String(c))])}if(t.nodeProps)for(let a of t.nodeProps){let l=a[0];typeof l=="string"&&(l=kt[l]);for(let c=1;c<a.length;){let u=a[c++];if(u>=0)o(u,l,a[c++]);else{let h=a[c+-u];for(let d=-u;d>0;d--)o(a[c++],l,h);c++}}}this.nodeSet=new af(s.map((a,l)=>cs.define({name:l>=this.minRepeatTerm?void 0:a,id:l,props:r[l],top:n.indexOf(l)>-1,error:l==0,skipped:t.skippedNodes&&t.skippedNodes.indexOf(l)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=Gv;let i=Kl(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(sb),this.states=Kl(t.states,Uint32Array),this.data=Kl(t.stateData),this.goto=Kl(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(a=>typeof a=="number"?new Fo(i,a):a),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,s,n){let r=new qE(this,t,s,n);for(let o of this.wrappers)r=o(r,t,s,n);return r}getGoto(t,s,n=!1){let r=this.goto;if(s>=r[0])return-1;for(let o=r[s+1];;){let i=r[o++],a=i&1,l=r[o++];if(a&&n)return l;for(let c=o+(i>>1);o<c;o++)if(r[o]==t)return l;if(a)return-1}}hasAction(t,s){let n=this.data;for(let r=0;r<2;r++)for(let o=this.stateSlot(t,r?2:1),i;;o+=3){if((i=n[o])==65535)if(n[o+1]==1)i=n[o=Rn(n,o+2)];else{if(n[o+1]==2)return Rn(n,o+2);break}if(i==s||i==0)return Rn(n,o+1)}return 0}stateSlot(t,s){return this.states[t*6+s]}stateFlag(t,s){return(this.stateSlot(t,0)&s)>0}validAction(t,s){return!!this.allActions(t,n=>n==s?!0:null)}allActions(t,s){let n=this.stateSlot(t,4),r=n?s(n):void 0;for(let o=this.stateSlot(t,1);r==null;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=Rn(this.data,o+2);else break;r=s(Rn(this.data,o+1))}return r}nextStates(t){let s=[];for(let n=this.stateSlot(t,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Rn(this.data,n+2);else break;if(!(this.data[n+2]&1)){let r=this.data[n+1];s.some((o,i)=>i&1&&o==r)||s.push(this.data[n],r)}}return s}configure(t){let s=Object.assign(Object.create(eh.prototype),this);if(t.props&&(s.nodeSet=this.nodeSet.extend(...t.props)),t.top){let n=this.topRules[t.top];if(!n)throw new RangeError(`Invalid top rule name ${t.top}`);s.top=n}return t.tokenizers&&(s.tokenizers=this.tokenizers.map(n=>{let r=t.tokenizers.find(o=>o.from==n);return r?r.to:n})),t.specializers&&(s.specializers=this.specializers.slice(),s.specializerSpecs=this.specializerSpecs.map((n,r)=>{let o=t.specializers.find(a=>a.from==n.external);if(!o)return n;let i=Object.assign(Object.assign({},n),{external:o.to});return s.specializers[r]=sb(i),i})),t.contextTracker&&(s.context=t.contextTracker),t.dialect&&(s.dialect=this.parseDialect(t.dialect)),t.strict!=null&&(s.strict=t.strict),t.wrap&&(s.wrappers=s.wrappers.concat(t.wrap)),t.bufferLength!=null&&(s.bufferLength=t.bufferLength),s}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let s=this.dynamicPrecedences;return s==null?0:s[t]||0}parseDialect(t){let s=Object.keys(this.dialects),n=s.map(()=>!1);if(t)for(let o of t.split(" ")){let i=s.indexOf(o);i>=0&&(n[i]=!0)}let r=null;for(let o=0;o<s.length;o++)if(!n[o])for(let i=this.dialects[s[o]],a;(a=this.data[i++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[a]=1;return new QE(t,n,r)}static deserialize(t){return new eh(t)}}function Rn(e,t){return e[t]|e[t+1]<<16}function JE(e){let t=null;for(let s of e){let n=s.p.stoppedAt;(s.pos==s.p.stream.end||n!=null&&s.pos>n)&&s.p.parser.stateFlag(s.state,2)&&(!t||t.score<s.score)&&(t=s)}return t}function sb(e){if(e.external){let t=e.extend?1:0;return(s,n)=>e.external(s,n)<<1|t}return e.get}let t$=0,sr=class AA{constructor(t,s,n){this.set=t,this.base=s,this.modified=n,this.id=t$++}static define(t){if(t!=null&&t.base)throw new Error("Can not derive from a modified tag");let s=new AA([],null,[]);if(s.set.push(s),t)for(let n of t.set)s.set.push(n);return s}static defineModifier(){let t=new sh;return s=>s.modified.indexOf(t)>-1?s:sh.get(s.base||s,s.modified.concat(t).sort((n,r)=>n.id-r.id))}},e$=0;class sh{constructor(){this.instances=[],this.id=e$++}static get(t,s){if(!s.length)return t;let n=s[0].instances.find(a=>a.base==t&&s$(s,a.modified));if(n)return n;let r=[],o=new sr(r,t,s);for(let a of s)a.instances.push(o);let i=n$(s);for(let a of t.set)if(!a.modified.length)for(let l of i)r.push(sh.get(a,l));return o}}function s$(e,t){return e.length==t.length&&e.every((s,n)=>s==t[n])}function n$(e){let t=[[]];for(let s=0;s<e.length;s++)for(let n=0,r=t.length;n<r;n++)t.push(t[n].concat(e[s]));return t.sort((s,n)=>n.length-s.length)}function nb(e){let t=Object.create(null);for(let s in e){let n=e[s];Array.isArray(n)||(n=[n]);for(let r of s.split(" "))if(r){let o=[],i=2,a=r;for(let h=0;;){if(a=="..."&&h>0&&h+3==r.length){i=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!d)throw new RangeError("Invalid path: "+r);if(o.push(d[0]=="*"?"":d[0][0]=='"'?JSON.parse(d[0]):d[0]),h+=d[0].length,h==r.length)break;let f=r[h++];if(h==r.length&&f=="!"){i=0;break}if(f!="/")throw new RangeError("Invalid path: "+r);a=r.slice(h)}let l=o.length-1,c=o[l];if(!c)throw new RangeError("Invalid path: "+r);let u=new nh(n,i,l>0?o.slice(0,l):null);t[c]=u.sort(t[c])}}return rb.add(t)}const rb=new kt;class nh{constructor(t,s,n,r){this.tags=t,this.mode=s,this.context=n,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}nh.empty=new nh([],2,null);function ob(e,t){let s=Object.create(null);for(let o of e)if(!Array.isArray(o.tag))s[o.tag.id]=o.class;else for(let i of o.tag)s[i.id]=o.class;let{scope:n,all:r=null}=t||{};return{style:o=>{let i=r;for(let a of o)for(let l of a.set){let c=s[l.id];if(c){i=i?i+" "+c:c;break}}return i},scope:n}}function r$(e,t){let s=null;for(let n of e){let r=n.style(t);r&&(s=s?s+" "+r:r)}return s}function o$(e,t,s,n=0,r=e.length){let o=new i$(n,Array.isArray(t)?t:[t],s);o.highlightRange(e.cursor(),n,r,"",o.highlighters),o.flush(r)}class i${constructor(t,s,n){this.at=t,this.highlighters=s,this.span=n,this.class=""}startSpan(t,s){s!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=s)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,s,n,r,o){let{type:i,from:a,to:l}=t;if(a>=n||l<=s)return;i.isTop&&(o=this.highlighters.filter(f=>!f.scope||f.scope(i)));let c=r,u=a$(t)||nh.empty,h=r$(o,u.tags);if(h&&(c&&(c+=" "),c+=h,u.mode==1&&(r+=(r?" ":"")+h)),this.startSpan(Math.max(s,a),c),u.opaque)return;let d=t.tree&&t.tree.prop(kt.mounted);if(d&&d.overlay){let f=t.node.enter(d.overlay[0].from+a,1),p=this.highlighters.filter(m=>!m.scope||m.scope(d.tree.type)),g=t.firstChild();for(let m=0,y=a;;m++){let v=m<d.overlay.length?d.overlay[m]:null,b=v?v.from+a:l,w=Math.max(s,y),S=Math.min(n,b);if(w<S&&g)for(;t.from<S&&(this.highlightRange(t,w,S,r,o),this.startSpan(Math.min(S,t.to),c),!(t.to>=b||!t.nextSibling())););if(!v||b>n)break;y=v.to+a,y>s&&(this.highlightRange(f.cursor(),Math.max(s,v.from+a),Math.min(n,y),"",p),this.startSpan(Math.min(n,y),c))}g&&t.parent()}else if(t.firstChild()){d&&(r="");do if(!(t.to<=s)){if(t.from>=n)break;this.highlightRange(t,s,n,r,o),this.startSpan(Math.min(n,t.to),c)}while(t.nextSibling());t.parent()}}}function a$(e){let t=e.type.prop(rb);for(;t&&t.context&&!e.matchContext(t.context);)t=t.next;return t||null}const Z=sr.define,rh=Z(),nr=Z(),ib=Z(nr),ab=Z(nr),rr=Z(),oh=Z(rr),mf=Z(rr),hn=Z(),Br=Z(hn),cn=Z(),un=Z(),gf=Z(),sa=Z(gf),ih=Z(),I={comment:rh,lineComment:Z(rh),blockComment:Z(rh),docComment:Z(rh),name:nr,variableName:Z(nr),typeName:ib,tagName:Z(ib),propertyName:ab,attributeName:Z(ab),className:Z(nr),labelName:Z(nr),namespace:Z(nr),macroName:Z(nr),literal:rr,string:oh,docString:Z(oh),character:Z(oh),attributeValue:Z(oh),number:mf,integer:Z(mf),float:Z(mf),bool:Z(rr),regexp:Z(rr),escape:Z(rr),color:Z(rr),url:Z(rr),keyword:cn,self:Z(cn),null:Z(cn),atom:Z(cn),unit:Z(cn),modifier:Z(cn),operatorKeyword:Z(cn),controlKeyword:Z(cn),definitionKeyword:Z(cn),moduleKeyword:Z(cn),operator:un,derefOperator:Z(un),arithmeticOperator:Z(un),logicOperator:Z(un),bitwiseOperator:Z(un),compareOperator:Z(un),updateOperator:Z(un),definitionOperator:Z(un),typeOperator:Z(un),controlOperator:Z(un),punctuation:gf,separator:Z(gf),bracket:sa,angleBracket:Z(sa),squareBracket:Z(sa),paren:Z(sa),brace:Z(sa),content:hn,heading:Br,heading1:Z(Br),heading2:Z(Br),heading3:Z(Br),heading4:Z(Br),heading5:Z(Br),heading6:Z(Br),contentSeparator:Z(hn),list:Z(hn),quote:Z(hn),emphasis:Z(hn),strong:Z(hn),link:Z(hn),monospace:Z(hn),strikethrough:Z(hn),inserted:Z(),deleted:Z(),changed:Z(),invalid:Z(),meta:ih,documentMeta:Z(ih),annotation:Z(ih),processingInstruction:Z(ih),definition:sr.defineModifier(),constant:sr.defineModifier(),function:sr.defineModifier(),standard:sr.defineModifier(),local:sr.defineModifier(),special:sr.defineModifier()};ob([{tag:I.link,class:"tok-link"},{tag:I.heading,class:"tok-heading"},{tag:I.emphasis,class:"tok-emphasis"},{tag:I.strong,class:"tok-strong"},{tag:I.keyword,class:"tok-keyword"},{tag:I.atom,class:"tok-atom"},{tag:I.bool,class:"tok-bool"},{tag:I.url,class:"tok-url"},{tag:I.labelName,class:"tok-labelName"},{tag:I.inserted,class:"tok-inserted"},{tag:I.deleted,class:"tok-deleted"},{tag:I.literal,class:"tok-literal"},{tag:I.string,class:"tok-string"},{tag:I.number,class:"tok-number"},{tag:[I.regexp,I.escape,I.special(I.string)],class:"tok-string2"},{tag:I.variableName,class:"tok-variableName"},{tag:I.local(I.variableName),class:"tok-variableName tok-local"},{tag:I.definition(I.variableName),class:"tok-variableName tok-definition"},{tag:I.special(I.variableName),class:"tok-variableName2"},{tag:I.definition(I.propertyName),class:"tok-propertyName tok-definition"},{tag:I.typeName,class:"tok-typeName"},{tag:I.namespace,class:"tok-namespace"},{tag:I.className,class:"tok-className"},{tag:I.macroName,class:"tok-macroName"},{tag:I.propertyName,class:"tok-propertyName"},{tag:I.operator,class:"tok-operator"},{tag:I.comment,class:"tok-comment"},{tag:I.meta,class:"tok-meta"},{tag:I.invalid,class:"tok-invalid"},{tag:I.punctuation,class:"tok-punctuation"}]);const Vo=63,lb=64,l$=1,h$=2,hb=3,c$=4,cb=5,u$=6,d$=7,ub=65,f$=66,p$=8,m$=9,g$=10,y$=11,v$=12,db=13,b$=19,w$=20,x$=29,_$=33,A$=34,k$=47,S$=0,yf=1,vf=2,na=3,bf=4,wc=class wc{constructor(t,s,n){this.parent=t,this.depth=s,this.type=n,this.hash=(t?t.hash+t.hash<<8:0)+s+(s<<4)+n}};Ua(wc,"top",new wc(null,-1,S$));let jr=wc;function ra(e,t){for(let s=0,n=t-e.pos-1;;n--,s++){let r=e.peek(n);if(Dn(r)||r==-1)return s}}function wf(e){return e==32||e==9}function Dn(e){return e==10||e==13}function fb(e){return wf(e)||Dn(e)}function Fr(e){return e<0||fb(e)}const C$=new KE({start:jr.top,reduce(e,t){return e.type==na&&(t==w$||t==A$)?e.parent:e},shift(e,t,s,n){if(t==hb)return new jr(e,ra(n,n.pos),yf);if(t==ub||t==cb)return new jr(e,ra(n,n.pos),vf);if(t==Vo)return e.parent;if(t==b$||t==_$)return new jr(e,0,na);if(t==db&&e.type==bf)return e.parent;if(t==k$){let r=/[1-9]/.exec(n.read(n.pos,s.pos));if(r)return new jr(e,e.depth+ +r[0],bf)}return e},hash(e){return e.hash}});function zo(e,t,s=0){return e.peek(s)==t&&e.peek(s+1)==t&&e.peek(s+2)==t&&Fr(e.peek(s+3))}const O$=new th((e,t)=>{if(e.next==-1&&t.canShift(lb))return e.acceptToken(lb);let s=e.peek(-1);if((Dn(s)||s<0)&&t.context.type!=na){if(zo(e,45))if(t.canShift(Vo))e.acceptToken(Vo);else return e.acceptToken(l$,3);if(zo(e,46))if(t.canShift(Vo))e.acceptToken(Vo);else return e.acceptToken(h$,3);let n=0;for(;e.next==32;)n++,e.advance();(n<t.context.depth||n==t.context.depth&&t.context.type==yf&&(e.next!=45||!Fr(e.peek(1))))&&e.next!=-1&&!Dn(e.next)&&e.next!=35&&e.acceptToken(Vo,-n)}},{contextual:!0}),T$=new th((e,t)=>{if(t.context.type==na){e.next==63&&(e.advance(),Fr(e.next)&&e.acceptToken(d$));return}if(e.next==45)e.advance(),Fr(e.next)&&e.acceptToken(t.context.type==yf&&t.context.depth==ra(e,e.pos-1)?c$:hb);else if(e.next==63)e.advance(),Fr(e.next)&&e.acceptToken(t.context.type==vf&&t.context.depth==ra(e,e.pos-1)?u$:cb);else{let s=e.pos;for(;;)if(wf(e.next)){if(e.pos==s)return;e.advance()}else if(e.next==33)gb(e);else if(e.next==38)xf(e);else if(e.next==42){xf(e);break}else if(e.next==39||e.next==34){if(_f(e,!0))break;return}else if(e.next==91||e.next==123){if(!M$(e))return;break}else{yb(e,!0,!1,0);break}for(;wf(e.next);)e.advance();if(e.next==58){if(e.pos==s&&t.canShift(x$))return;let n=e.peek(1);Fr(n)&&e.acceptTokenTo(t.context.type==vf&&t.context.depth==ra(e,s)?f$:ub,s)}}},{contextual:!0});function P$(e){return e>32&&e<127&&e!=34&&e!=37&&e!=44&&e!=60&&e!=62&&e!=92&&e!=94&&e!=96&&e!=123&&e!=124&&e!=125}function pb(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function mb(e,t){return e.next==37?(e.advance(),pb(e.next)&&e.advance(),pb(e.next)&&e.advance(),!0):P$(e.next)||t&&e.next==44?(e.advance(),!0):!1}function gb(e){if(e.advance(),e.next==60){for(e.advance();;)if(!mb(e,!0)){e.next==62&&e.advance();break}}else for(;mb(e,!1););}function xf(e){for(e.advance();!Fr(e.next)&&ah(e.tag)!="f";)e.advance()}function _f(e,t){let s=e.next,n=!1,r=e.pos;for(e.advance();;){let o=e.next;if(o<0)break;if(e.advance(),o==s)if(o==39)if(e.next==39)e.advance();else break;else break;else if(o==92&&s==34)e.next>=0&&e.advance();else if(Dn(o)){if(t)return!1;n=!0}else if(t&&e.pos>=r+1024)return!1}return!n}function M$(e){for(let t=[],s=e.pos+1024;;)if(e.next==91||e.next==123)t.push(e.next),e.advance();else if(e.next==39||e.next==34){if(!_f(e,!0))return!1}else if(e.next==93||e.next==125){if(t[t.length-1]!=e.next-2)return!1;if(t.pop(),e.advance(),!t.length)return!0}else{if(e.next<0||e.pos>s||Dn(e.next))return!1;e.advance()}}const I$="iiisiiissisfissssssssssssisssiiissssssssssssssssssssssssssfsfssissssssssssssssssssssssssssfif";function ah(e){return e<33?"u":e>125?"s":I$[e-33]}function Af(e,t){let s=ah(e);return s!="u"&&!(t&&s=="f")}function yb(e,t,s,n){if(ah(e.next)=="s"||(e.next==63||e.next==58||e.next==45)&&Af(e.peek(1),s))e.advance();else return!1;let r=e.pos;for(;;){let o=e.next,i=0,a=n+1;for(;fb(o);){if(Dn(o)){if(t)return!1;a=0}else a++;o=e.peek(++i)}if(!(o>=0&&(o==58?Af(e.peek(i+1),s):o==35?e.peek(i-1)!=32:Af(o,s)))||!s&&a<=n||a==0&&!s&&(zo(e,45,i)||zo(e,46,i)))break;if(t&&ah(o)=="f")return!1;for(let l=i;l>=0;l--)e.advance();if(t&&e.pos>r+1024)return!1}return!0}const E$=new th((e,t)=>{if(e.next==33)gb(e),e.acceptToken(v$);else if(e.next==38||e.next==42){let s=e.next==38?g$:y$;xf(e),e.acceptToken(s)}else e.next==39||e.next==34?(_f(e,!1),e.acceptToken(m$)):yb(e,!1,t.context.type==na,t.context.depth)&&e.acceptToken(p$)}),$$=new th((e,t)=>{let s=t.context.type==bf?t.context.depth:-1,n=e.pos;t:for(;;){let r=0,o=e.next;for(;o==32;)o=e.peek(++r);if(!r&&(zo(e,45,r)||zo(e,46,r))||!Dn(o)&&(s<0&&(s=Math.max(t.context.depth+1,r)),r<s))break;for(;;){if(e.next<0)break t;let i=Dn(e.next);if(e.advance(),i)continue t;n=e.pos}}e.acceptTokenTo(db,n)}),R$=nb({DirectiveName:I.keyword,DirectiveContent:I.attributeValue,"DirectiveEnd DocEnd":I.meta,QuotedLiteral:I.string,BlockLiteralHeader:I.special(I.string),BlockLiteralContent:I.content,Literal:I.content,"Key/Literal Key/QuotedLiteral":I.definition(I.propertyName),"Anchor Alias":I.labelName,Tag:I.typeName,Comment:I.lineComment,": , -":I.separator,"?":I.punctuation,"[ ]":I.squareBracket,"{ }":I.brace}),D$=eh.deserialize({version:14,states:"5lQ!ZQgOOO#PQfO'#CpO#uQfO'#DOOOQR'#Dv'#DvO$qQgO'#DRO%gQdO'#DUO%nQgO'#DUO&ROaO'#D[OOQR'#Du'#DuO&{QgO'#D^O'rQgO'#D`OOQR'#Dt'#DtO(iOqO'#DbOOQP'#Dj'#DjO(zQaO'#CmO)YQgO'#CmOOQP'#Cm'#CmQ)jQaOOQ)uQgOOQ]QgOOO*PQdO'#CrO*nQdO'#CtOOQO'#Dw'#DwO+]Q`O'#CxO+hQdO'#CwO+rQ`O'#CwOOQO'#Cv'#CvO+wQdO'#CvOOQO'#Cq'#CqO,UQ`O,59[O,^QfO,59[OOQR,59[,59[OOQO'#Cx'#CxO,eQ`O'#DPO,pQdO'#DPOOQO'#Dx'#DxO,zQdO'#DxO-XQ`O,59jO-aQfO,59jOOQR,59j,59jOOQR'#DS'#DSO-hQcO,59mO-sQgO'#DVO.TQ`O'#DVO.YQcO,59pOOQR'#DX'#DXO#|QfO'#DWO.hQcO'#DWOOQR,59v,59vO.yOWO,59vO/OOaO,59vO/WOaO,59vO/cQgO'#D_OOQR,59x,59xO0VQgO'#DaOOQR,59z,59zOOQP,59|,59|O0yOaO,59|O1ROaO,59|O1aOqO,59|OOQP-E7h-E7hO1oQgO,59XOOQP,59X,59XO2PQaO'#DeO2_QgO'#DeO2oQgO'#DkOOQP'#Dk'#DkQ)jQaOOO3PQdO'#CsOOQO,59^,59^O3kQdO'#CuOOQO,59`,59`OOQO,59c,59cO4VQdO,59cO4aQdO'#CzO4kQ`O'#CzOOQO,59b,59bOOQU,5:Q,5:QOOQR1G.v1G.vO4pQ`O1G.vOOQU-E7d-E7dO4xQdO,59kOOQO,59k,59kO5SQdO'#DQO5^Q`O'#DQOOQO,5:d,5:dOOQU,5:R,5:ROOQR1G/U1G/UO5cQ`O1G/UOOQU-E7e-E7eO5kQgO'#DhO5xQcO1G/XOOQR1G/X1G/XOOQR,59q,59qO6TQgO,59qO6eQdO'#DiO6lQgO'#DiO7PQcO1G/[OOQR1G/[1G/[OOQR,59r,59rO#|QfO,59rOOQR1G/b1G/bO7_OWO1G/bO7dOaO1G/bOOQR,59y,59yOOQR,59{,59{OOQP1G/h1G/hO7lOaO1G/hO7tOaO1G/hO8POaO1G/hOOQP1G.s1G.sO8_QgO,5:POOQP,5:P,5:POOQP,5:V,5:VOOQP-E7i-E7iOOQO,59_,59_OOQO,59a,59aOOQO1G.}1G.}OOQO,59f,59fO8oQdO,59fOOQR7+$b7+$bP,XQ`O'#DfOOQO1G/V1G/VOOQO,59l,59lO8yQdO,59lOOQR7+$p7+$pP9TQ`O'#DgOOQR'#DT'#DTOOQR,5:S,5:SOOQR-E7f-E7fOOQR7+$s7+$sOOQR1G/]1G/]O9YQgO'#DYO9jQ`O'#DYOOQR,5:T,5:TO#|QfO'#DZO9oQcO'#DZOOQR-E7g-E7gOOQR7+$v7+$vOOQR1G/^1G/^OOQR7+$|7+$|O:QOWO7+$|OOQP7+%S7+%SO:VOaO7+%SO:_OaO7+%SOOQP1G/k1G/kOOQO1G/Q1G/QOOQO1G/W1G/WOOQR,59t,59tO:jQgO,59tOOQR,59u,59uO#|QfO,59uOOQR<<Hh<<HhOOQP<<Hn<<HnO:zOaO<<HnOOQR1G/`1G/`OOQR1G/a1G/aOOQPAN>YAN>Y",stateData:";S~O!fOS!gOS^OS~OP_OQbORSOTUOWROXROYYOZZO[XOcPOqQO!PVO!V[O!cTO~O`cO~P]OVkOWROXROYeOZfO[dOcPOmhOqQO~OboO~P!bOVtOWROXROYeOZfO[dOcPOmrOqQO~OpwO~P#WORSOTUOWROXROYYOZZO[XOcPOqQO!PVO!cTO~OSvP!avP!bvP~P#|OWROXROYeOZfO[dOcPOqQO~OmzO~P%OOm!OOUzP!azP!bzP!dzP~P#|O^!SO!b!QO!f!TO!g!RO~ORSOTUOWROXROcPOqQO!PVO!cTO~OY!UOP!QXQ!QX!V!QX!`!QXS!QX!a!QX!b!QXU!QXm!QX!d!QX~P&aO[!WOP!SXQ!SX!V!SX!`!SXS!SX!a!SX!b!SXU!SXm!SX!d!SX~P&aO^!ZO!W![O!b!YO!f!]O!g!YO~OP!_O!V[OQaX!`aX~OPaXQaX!VaX!`aX~P#|OP!bOQ!cO!V[O~OP_O!V[O~P#|OWROXROY!fOcPOqQObfXmfXofXpfX~OWROXRO[!hOcPOqQObhXmhXohXphX~ObeXmlXoeX~ObkXokX~P%OOm!kO~Om!lObnPonP~P%OOb!pOo!oO~Ob!pO~P!bOm!sOosXpsX~OosXpsX~P%OOm!uOotPptP~P%OOo!xOp!yO~Op!yO~P#WOS!|O!a#OO!b#OO~OUyX!ayX!byX!dyX~P#|Om#QO~OU#SO!a#UO!b#UO!d#RO~Om#WOUzX!azX!bzX!dzX~O]#XO~O!b#XO!g#YO~O^#ZO!b#XO!g#YO~OP!RXQ!RX!V!RX!`!RXS!RX!a!RX!b!RXU!RXm!RX!d!RX~P&aOP!TXQ!TX!V!TX!`!TXS!TX!a!TX!b!TXU!TXm!TX!d!TX~P&aO!b#^O!g#^O~O^#_O!b#^O!f#`O!g#^O~O^#_O!W#aO!b#^O!g#^O~OPaaQaa!Vaa!`aa~P#|OP#cO!V[OQ!XX!`!XX~OP!XXQ!XX!V!XX!`!XX~P#|OP_O!V[OQ!_X!`!_X~P#|OWROXROcPOqQObgXmgXogXpgX~OWROXROcPOqQObiXmiXoiXpiX~Obkaoka~P%OObnXonX~P%OOm#kO~Ob#lOo!oO~Oosapsa~P%OOotXptX~P%OOm#pO~Oo!xOp#qO~OSwP!awP!bwP~P#|OS!|O!a#vO!b#vO~OUya!aya!bya!dya~P#|Om#xO~P%OOm#{OU}P!a}P!b}P!d}P~P#|OU#SO!a$OO!b$OO!d#RO~O]$QO~O!b$QO!g$RO~O!b$SO!g$SO~O^$TO!b$SO!g$SO~O^$TO!b$SO!f$UO!g$SO~OP!XaQ!Xa!V!Xa!`!Xa~P#|Obnaona~P%OOotapta~P%OOo!xO~OU|X!a|X!b|X!d|X~P#|Om$ZO~Om$]OU}X!a}X!b}X!d}X~O]$^O~O!b$_O!g$_O~O^$`O!b$_O!g$_O~OU|a!a|a!b|a!d|a~P#|O!b$cO!g$cO~O",goto:",]!mPPPPPPPPPPPPPPPPP!nPP!v#v#|$`#|$c$f$j$nP%VPPP!v%Y%^%a%{&O%a&R&U&X&_&b%aP&e&{&e'O'RPP']'a'g'm's'y(XPPPPPPPP(_)e*X+c,VUaObcR#e!c!{ROPQSTUXY_bcdehknrtvz!O!U!W!_!b!c!f!h!k!l!s!u!|#Q#R#S#W#c#k#p#x#{$Z$]QmPR!qnqfPQThknrtv!k!l!s!u#R#k#pR!gdR!ieTlPnTjPnSiPnSqQvQ{TQ!mkQ!trQ!vtR#y#RR!nkTsQvR!wt!RWOSUXY_bcz!O!U!W!_!b!c!|#Q#S#W#c#x#{$Z$]RySR#t!|R|TR|UQ!PUR#|#SR#z#RR#z#SyZOSU_bcz!O!_!b!c!|#Q#S#W#c#x#{$Z$]R!VXR!XYa]O^abc!a!c!eT!da!eQnPR!rnQvQR!{vQ!}yR#u!}Q#T|R#}#TW^Obc!cS!^^!aT!aa!eQ!eaR#f!eW`Obc!cQxSS}U#SQ!`_Q#PzQ#V!OQ#b!_Q#d!bQ#s!|Q#w#QQ$P#WQ$V#cQ$Y#xQ$[#{Q$a$ZR$b$]xZOSU_bcz!O!_!b!c!|#Q#S#W#c#x#{$Z$]Q!VXQ!XYQ#[!UR#]!W!QWOSUXY_bcz!O!U!W!_!b!c!|#Q#S#W#c#x#{$Z$]pfPQThknrtv!k!l!s!u#R#k#pQ!gdQ!ieQ#g!fR#h!hSgPn^pQTkrtv#RQ!jhQ#i!kQ#j!lQ#n!sQ#o!uQ$W#kR$X#pQuQR!zv",nodeNames:"\u26A0 DirectiveEnd DocEnd - - ? ? ? Literal QuotedLiteral Anchor Alias Tag BlockLiteralContent Comment Stream BOM Document ] [ FlowSequence Item Tagged Anchored Anchored Tagged FlowMapping Pair Key : Pair , } { FlowMapping Pair Pair BlockSequence Item Item BlockMapping Pair Pair Key Pair Pair BlockLiteral BlockLiteralHeader Tagged Anchored Anchored Tagged Directive DirectiveName DirectiveContent Document",maxTerm:74,context:C$,nodeProps:[["isolate",-3,8,9,14,""],["openedBy",18,"[",32,"{"],["closedBy",19,"]",33,"}"]],propSources:[R$],skippedNodes:[0],repeatNodeCount:6,tokenData:"-Y~RnOX#PXY$QYZ$]Z]#P]^$]^p#Ppq$Qqs#Pst$btu#Puv$yv|#P|}&e}![#P![!]'O!]!`#P!`!a'i!a!}#P!}#O*g#O#P#P#P#Q+Q#Q#o#P#o#p+k#p#q'i#q#r,U#r;'S#P;'S;=`#z<%l?HT#P?HT?HU,o?HUO#PQ#UU!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#PQ#kTOY#PZs#Pt;'S#P;'S;=`#z<%lO#PQ#}P;=`<%l#P~$VQ!f~XY$Qpq$Q~$bO!g~~$gS^~OY$bZ;'S$b;'S;=`$s<%lO$b~$vP;=`<%l$bR%OX!WQOX%kXY#PZ]%k]^#P^p%kpq#hq;'S%k;'S;=`&_<%lO%kR%rX!WQ!VPOX%kXY#PZ]%k]^#P^p%kpq#hq;'S%k;'S;=`&_<%lO%kR&bP;=`<%l%kR&lUoP!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#PR'VUmP!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#PR'p[!PP!WQOY#PZp#Ppq#hq{#P{|(f|}#P}!O(f!O!R#P!R![)p![;'S#P;'S;=`#z<%lO#PR(mW!PP!WQOY#PZp#Ppq#hq!R#P!R![)V![;'S#P;'S;=`#z<%lO#PR)^U!PP!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#PR)wY!PP!WQOY#PZp#Ppq#hq{#P{|)V|}#P}!O)V!O;'S#P;'S;=`#z<%lO#PR*nUcP!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#PR+XUbP!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#PR+rUqP!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#PR,]UpP!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#PR,vU`P!WQOY#PZp#Ppq#hq;'S#P;'S;=`#z<%lO#P",tokenizers:[O$,T$,E$,$$,0,1],topRules:{Stream:[0,15]},tokenPrec:0});class Rt{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,s,n){[t,s]=Go(this,t,s);let r=[];return this.decompose(0,t,r,2),n.length&&n.decompose(0,n.length,r,3),this.decompose(s,this.length,r,1),dn.from(r,this.length-(s-t)+n.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,s=this.length){[t,s]=Go(this,t,s);let n=[];return this.decompose(t,s,n,0),dn.from(n,s-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let s=this.scanIdentical(t,1),n=this.length-this.scanIdentical(t,-1),r=new oa(this),o=new oa(t);for(let i=s,a=s;;){if(r.next(i),o.next(i),i=0,r.lineBreak!=o.lineBreak||r.done!=o.done||r.value!=o.value)return!1;if(a+=r.value.length,r.done||a>=n)return!0}}iter(t=1){return new oa(this,t)}iterRange(t,s=this.length){return new bb(this,t,s)}iterLines(t,s){let n;if(t==null)n=this.iter();else{s==null&&(s=this.lines+1);let r=this.line(t).from;n=this.iterRange(r,Math.max(r,s==this.lines+1?this.length:s<=1?0:this.line(s-1).to))}return new wb(n)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?Rt.empty:t.length<=32?new oe(t):dn.from(oe.split(t,[]))}}class oe extends Rt{constructor(t,s=N$(t)){super(),this.text=t,this.length=s}get lines(){return this.text.length}get children(){return null}lineInner(t,s,n,r){for(let o=0;;o++){let i=this.text[o],a=r+i.length;if((s?n:a)>=t)return new L$(r,a,n,i);r=a+1,n++}}decompose(t,s,n,r){let o=t<=0&&s>=this.length?this:new oe(vb(this.text,t,s),Math.min(s,this.length)-Math.max(0,t));if(r&1){let i=n.pop(),a=lh(o.text,i.text.slice(),0,o.length);if(a.length<=32)n.push(new oe(a,i.length+o.length));else{let l=a.length>>1;n.push(new oe(a.slice(0,l)),new oe(a.slice(l)))}}else n.push(o)}replace(t,s,n){if(!(n instanceof oe))return super.replace(t,s,n);[t,s]=Go(this,t,s);let r=lh(this.text,lh(n.text,vb(this.text,0,t)),s),o=this.length+n.length-(s-t);return r.length<=32?new oe(r,o):dn.from(oe.split(r,[]),o)}sliceString(t,s=this.length,n=`
`){[t,s]=Go(this,t,s);let r="";for(let o=0,i=0;o<=s&&i<this.text.length;i++){let a=this.text[i],l=o+a.length;o>t&&i&&(r+=n),t<l&&s>o&&(r+=a.slice(Math.max(0,t-o),s-o)),o=l+1}return r}flatten(t){for(let s of this.text)t.push(s)}scanIdentical(){return 0}static split(t,s){let n=[],r=-1;for(let o of t)n.push(o),r+=o.length+1,n.length==32&&(s.push(new oe(n,r)),n=[],r=-1);return r>-1&&s.push(new oe(n,r)),s}}class dn extends Rt{constructor(t,s){super(),this.children=t,this.length=s,this.lines=0;for(let n of t)this.lines+=n.lines}lineInner(t,s,n,r){for(let o=0;;o++){let i=this.children[o],a=r+i.length,l=n+i.lines-1;if((s?l:a)>=t)return i.lineInner(t,s,n,r);r=a+1,n=l+1}}decompose(t,s,n,r){for(let o=0,i=0;i<=s&&o<this.children.length;o++){let a=this.children[o],l=i+a.length;if(t<=l&&s>=i){let c=r&((i<=t?1:0)|(l>=s?2:0));i>=t&&l<=s&&!c?n.push(a):a.decompose(t-i,s-i,n,c)}i=l+1}}replace(t,s,n){if([t,s]=Go(this,t,s),n.lines<this.lines)for(let r=0,o=0;r<this.children.length;r++){let i=this.children[r],a=o+i.length;if(t>=o&&s<=a){let l=i.replace(t-o,s-o,n),c=this.lines-i.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[r]=l,new dn(u,this.length-(s-t)+n.length)}return super.replace(o,a,l)}o=a+1}return super.replace(t,s,n)}sliceString(t,s=this.length,n=`
`){[t,s]=Go(this,t,s);let r="";for(let o=0,i=0;o<this.children.length&&i<=s;o++){let a=this.children[o],l=i+a.length;i>t&&o&&(r+=n),t<l&&s>i&&(r+=a.sliceString(t-i,s-i,n)),i=l+1}return r}flatten(t){for(let s of this.children)s.flatten(t)}scanIdentical(t,s){if(!(t instanceof dn))return 0;let n=0,[r,o,i,a]=s>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;r+=s,o+=s){if(r==i||o==a)return n;let l=this.children[r],c=t.children[o];if(l!=c)return n+l.scanIdentical(c,s);n+=l.length+1}}static from(t,s=t.reduce((n,r)=>n+r.length+1,-1)){let n=0;for(let f of t)n+=f.lines;if(n<32){let f=[];for(let p of t)p.flatten(f);return new oe(f,s)}let r=Math.max(32,n>>5),o=r<<1,i=r>>1,a=[],l=0,c=-1,u=[];function h(f){let p;if(f.lines>o&&f instanceof dn)for(let g of f.children)h(g);else f.lines>i&&(l>i||!l)?(d(),a.push(f)):f instanceof oe&&l&&(p=u[u.length-1])instanceof oe&&f.lines+p.lines<=32?(l+=f.lines,c+=f.length+1,u[u.length-1]=new oe(p.text.concat(f.text),p.length+1+f.length)):(l+f.lines>r&&d(),l+=f.lines,c+=f.length+1,u.push(f))}function d(){l!=0&&(a.push(u.length==1?u[0]:dn.from(u,c)),c=-1,l=u.length=0)}for(let f of t)h(f);return d(),a.length==1?a[0]:new dn(a,s)}}Rt.empty=new oe([""],0);function N$(e){let t=-1;for(let s of e)t+=s.length+1;return t}function lh(e,t,s=0,n=1e9){for(let r=0,o=0,i=!0;o<e.length&&r<=n;o++){let a=e[o],l=r+a.length;l>=s&&(l>n&&(a=a.slice(0,n-r)),r<s&&(a=a.slice(s-r)),i?(t[t.length-1]+=a,i=!1):t.push(a)),r=l+1}return t}function vb(e,t,s){return lh(e,[""],t,s)}class oa{constructor(t,s=1){this.dir=s,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[s>0?1:(t instanceof oe?t.text.length:t.children.length)<<1]}nextInner(t,s){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,r=this.nodes[n],o=this.offsets[n],i=o>>1,a=r instanceof oe?r.text.length:r.children.length;if(i==(s>0?a:0)){if(n==0)return this.done=!0,this.value="",this;s>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((o&1)==(s>0?0:1)){if(this.offsets[n]+=s,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(r instanceof oe){let l=r.text[i+(s<0?-1:0)];if(this.offsets[n]+=s,l.length>Math.max(0,t))return this.value=t==0?l:s>0?l.slice(t):l.slice(0,l.length-t),this;t-=l.length}else{let l=r.children[i+(s<0?-1:0)];t>l.length?(t-=l.length,this.offsets[n]+=s):(s<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(s>0?1:(l instanceof oe?l.text.length:l.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class bb{constructor(t,s,n){this.value="",this.done=!1,this.cursor=new oa(t,s>n?-1:1),this.pos=s>n?t.length:0,this.from=Math.min(s,n),this.to=Math.max(s,n)}nextInner(t,s){if(s<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,s<0?this.pos-this.to:this.from-this.pos);let n=s<0?this.pos-this.from:this.to-this.pos;t>n&&(t=n),n-=t;let{value:r}=this.cursor.next(t);return this.pos+=(r.length+t)*s,this.value=r.length<=n?r:s<0?r.slice(r.length-n):r.slice(0,n),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class wb{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:s,lineBreak:n,value:r}=this.inner.next(t);return s&&this.afterBreak?(this.value="",this.afterBreak=!1):s?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Rt.prototype[Symbol.iterator]=function(){return this.iter()},oa.prototype[Symbol.iterator]=bb.prototype[Symbol.iterator]=wb.prototype[Symbol.iterator]=function(){return this});class L${constructor(t,s,n,r){this.from=t,this.to=s,this.number=n,this.text=r}get length(){return this.to-this.from}}function Go(e,t,s){return t=Math.max(0,Math.min(e.length,t)),[t,Math.max(t,Math.min(e.length,s))]}let Uo="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=1;e<Uo.length;e++)Uo[e]+=Uo[e-1];function B$(e){for(let t=1;t<Uo.length;t+=2)if(Uo[t]>e)return Uo[t-1]<=e;return!1}function xb(e){return e>=127462&&e<=127487}const _b=8205;function Re(e,t,s=!0,n=!0){return(s?Ab:j$)(e,t,n)}function Ab(e,t,s){if(t==e.length)return t;t&&kb(e.charCodeAt(t))&&Sb(e.charCodeAt(t-1))&&t--;let n=De(e,t);for(t+=Ps(n);t<e.length;){let r=De(e,t);if(n==_b||r==_b||s&&B$(r))t+=Ps(r),n=r;else if(xb(r)){let o=0,i=t-2;for(;i>=0&&xb(De(e,i));)o++,i-=2;if(o%2==0)break;t+=2}else break}return t}function j$(e,t,s){for(;t>0;){let n=Ab(e,t-2,s);if(n<t)return n;t--}return 0}function kb(e){return e>=56320&&e<57344}function Sb(e){return e>=55296&&e<56320}function De(e,t){let s=e.charCodeAt(t);if(!Sb(s)||t+1==e.length)return s;let n=e.charCodeAt(t+1);return kb(n)?(s-55296<<10)+(n-56320)+65536:s}function kf(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}function Ps(e){return e<65536?1:2}const Sf=/\r\n?|\n/;var ns=function(e){return e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter",e}(ns||(ns={}));class fn{constructor(t){this.sections=t}get length(){let t=0;for(let s=0;s<this.sections.length;s+=2)t+=this.sections[s];return t}get newLength(){let t=0;for(let s=0;s<this.sections.length;s+=2){let n=this.sections[s+1];t+=n<0?this.sections[s]:n}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let s=0,n=0,r=0;s<this.sections.length;){let o=this.sections[s++],i=this.sections[s++];i<0?(t(n,r,o),r+=o):r+=i,n+=o}}iterChangedRanges(t,s=!1){Cf(this,t,s)}get invertedDesc(){let t=[];for(let s=0;s<this.sections.length;){let n=this.sections[s++],r=this.sections[s++];r<0?t.push(n,r):t.push(r,n)}return new fn(t)}composeDesc(t){return this.empty?t:t.empty?this:Cb(this,t)}mapDesc(t,s=!1){return t.empty?this:Of(this,t,s)}mapPos(t,s=-1,n=ns.Simple){let r=0,o=0;for(let i=0;i<this.sections.length;){let a=this.sections[i++],l=this.sections[i++],c=r+a;if(l<0){if(c>t)return o+(t-r);o+=a}else{if(n!=ns.Simple&&c>=t&&(n==ns.TrackDel&&r<t&&c>t||n==ns.TrackBefore&&r<t||n==ns.TrackAfter&&c>t))return null;if(c>t||c==t&&s<0&&!a)return t==r||s<0?o:o+l;o+=l}r=c}if(t>r)throw new RangeError(`Position ${t} is out of range for changeset of length ${r}`);return o}touchesRange(t,s=t){for(let n=0,r=0;n<this.sections.length&&r<=s;){let o=this.sections[n++],i=this.sections[n++],a=r+o;if(i>=0&&r<=s&&a>=t)return r<t&&a>s?"cover":!0;r=a}return!1}toString(){let t="";for(let s=0;s<this.sections.length;){let n=this.sections[s++],r=this.sections[s++];t+=(t?" ":"")+n+(r>=0?":"+r:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(s=>typeof s!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new fn(t)}static create(t){return new fn(t)}}class we extends fn{constructor(t,s){super(t),this.inserted=s}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Cf(this,(s,n,r,o,i)=>t=t.replace(r,r+(n-s),i),!1),t}mapDesc(t,s=!1){return Of(this,t,s,!0)}invert(t){let s=this.sections.slice(),n=[];for(let r=0,o=0;r<s.length;r+=2){let i=s[r],a=s[r+1];if(a>=0){s[r]=a,s[r+1]=i;let l=r>>1;for(;n.length<l;)n.push(Rt.empty);n.push(i?t.slice(o,o+i):Rt.empty)}o+=i}return new we(s,n)}compose(t){return this.empty?t:t.empty?this:Cb(this,t,!0)}map(t,s=!1){return t.empty?this:Of(this,t,s,!0)}iterChanges(t,s=!1){Cf(this,t,s)}get desc(){return fn.create(this.sections)}filter(t){let s=[],n=[],r=[],o=new ia(this);t:for(let i=0,a=0;;){let l=i==t.length?1e9:t[i++];for(;a<l||a==l&&o.len==0;){if(o.done)break t;let u=Math.min(o.len,l-a);We(r,u,-1);let h=o.ins==-1?-1:o.off==0?o.ins:0;We(s,u,h),h>0&&or(n,s,o.text),o.forward(u),a+=u}let c=t[i++];for(;a<c;){if(o.done)break t;let u=Math.min(o.len,c-a);We(s,u,-1),We(r,u,o.ins==-1?-1:o.off==0?o.ins:0),o.forward(u),a+=u}}return{changes:new we(s,n),filtered:fn.create(r)}}toJSON(){let t=[];for(let s=0;s<this.sections.length;s+=2){let n=this.sections[s],r=this.sections[s+1];r<0?t.push(n):r==0?t.push([n]):t.push([n].concat(this.inserted[s>>1].toJSON()))}return t}static of(t,s,n){let r=[],o=[],i=0,a=null;function l(u=!1){if(!u&&!r.length)return;i<s&&We(r,s-i,-1);let h=new we(r,o);a=a?a.compose(h.map(a)):h,r=[],o=[],i=0}function c(u){if(Array.isArray(u))for(let h of u)c(h);else if(u instanceof we){if(u.length!=s)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${s})`);l(),a=a?a.compose(u.map(a)):u}else{let{from:h,to:d=h,insert:f}=u;if(h>d||h<0||d>s)throw new RangeError(`Invalid change range ${h} to ${d} (in doc of length ${s})`);let p=f?typeof f=="string"?Rt.of(f.split(n||Sf)):f:Rt.empty,g=p.length;if(h==d&&g==0)return;h<i&&l(),h>i&&We(r,h-i,-1),We(r,d-h,g),or(o,r,p),i=d}}return c(t),l(!a),a}static empty(t){return new we(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let s=[],n=[];for(let r=0;r<t.length;r++){let o=t[r];if(typeof o=="number")s.push(o,-1);else{if(!Array.isArray(o)||typeof o[0]!="number"||o.some((i,a)=>a&&typeof i!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(o.length==1)s.push(o[0],0);else{for(;n.length<r;)n.push(Rt.empty);n[r]=Rt.of(o.slice(1)),s.push(o[0],n[r].length)}}}return new we(s,n)}static createSet(t,s){return new we(t,s)}}function We(e,t,s,n=!1){if(t==0&&s<=0)return;let r=e.length-2;r>=0&&s<=0&&s==e[r+1]?e[r]+=t:t==0&&e[r]==0?e[r+1]+=s:n?(e[r]+=t,e[r+1]+=s):e.push(t,s)}function or(e,t,s){if(s.length==0)return;let n=t.length-2>>1;if(n<e.length)e[e.length-1]=e[e.length-1].append(s);else{for(;e.length<n;)e.push(Rt.empty);e.push(s)}}function Cf(e,t,s){let n=e.inserted;for(let r=0,o=0,i=0;i<e.sections.length;){let a=e.sections[i++],l=e.sections[i++];if(l<0)r+=a,o+=a;else{let c=r,u=o,h=Rt.empty;for(;c+=a,u+=l,l&&n&&(h=h.append(n[i-2>>1])),!(s||i==e.sections.length||e.sections[i+1]<0);)a=e.sections[i++],l=e.sections[i++];t(r,c,o,u,h),r=c,o=u}}}function Of(e,t,s,n=!1){let r=[],o=n?[]:null,i=new ia(e),a=new ia(t);for(let l=-1;;)if(i.ins==-1&&a.ins==-1){let c=Math.min(i.len,a.len);We(r,c,-1),i.forward(c),a.forward(c)}else if(a.ins>=0&&(i.ins<0||l==i.i||i.off==0&&(a.len<i.len||a.len==i.len&&!s))){let c=a.len;for(We(r,a.ins,-1);c;){let u=Math.min(i.len,c);i.ins>=0&&l<i.i&&i.len<=u&&(We(r,0,i.ins),o&&or(o,r,i.text),l=i.i),i.forward(u),c-=u}a.next()}else if(i.ins>=0){let c=0,u=i.len;for(;u;)if(a.ins==-1){let h=Math.min(u,a.len);c+=h,u-=h,a.forward(h)}else if(a.ins==0&&a.len<u)u-=a.len,a.next();else break;We(r,c,l<i.i?i.ins:0),o&&l<i.i&&or(o,r,i.text),l=i.i,i.forward(i.len-u)}else{if(i.done&&a.done)return o?we.createSet(r,o):fn.create(r);throw new Error("Mismatched change set lengths")}}function Cb(e,t,s=!1){let n=[],r=s?[]:null,o=new ia(e),i=new ia(t);for(let a=!1;;){if(o.done&&i.done)return r?we.createSet(n,r):fn.create(n);if(o.ins==0)We(n,o.len,0,a),o.next();else if(i.len==0&&!i.done)We(n,0,i.ins,a),r&&or(r,n,i.text),i.next();else{if(o.done||i.done)throw new Error("Mismatched change set lengths");{let l=Math.min(o.len2,i.len),c=n.length;if(o.ins==-1){let u=i.ins==-1?-1:i.off?0:i.ins;We(n,l,u,a),r&&u&&or(r,n,i.text)}else i.ins==-1?(We(n,o.off?0:o.len,l,a),r&&or(r,n,o.textBit(l))):(We(n,o.off?0:o.len,i.off?0:i.ins,a),r&&!i.off&&or(r,n,i.text));a=(o.ins>l||i.ins>=0&&i.len>l)&&(a||n.length>c),o.forward2(l),i.forward(l)}}}}class ia{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,s=this.i-2>>1;return s>=t.length?Rt.empty:t[s]}textBit(t){let{inserted:s}=this.set,n=this.i-2>>1;return n>=s.length&&!t?Rt.empty:s[n].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class Vr{constructor(t,s,n){this.from=t,this.to=s,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,s=-1){let n,r;return this.empty?n=r=t.mapPos(this.from,s):(n=t.mapPos(this.from,1),r=t.mapPos(this.to,-1)),n==this.from&&r==this.to?this:new Vr(n,r,this.flags)}extend(t,s=t){if(t<=this.anchor&&s>=this.anchor)return W.range(t,s);let n=Math.abs(t-this.anchor)>Math.abs(s-this.anchor)?t:s;return W.range(this.anchor,n)}eq(t,s=!1){return this.anchor==t.anchor&&this.head==t.head&&(!s||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return W.range(t.anchor,t.head)}static create(t,s,n){return new Vr(t,s,n)}}class W{constructor(t,s){this.ranges=t,this.mainIndex=s}map(t,s=-1){return t.empty?this:W.create(this.ranges.map(n=>n.map(t,s)),this.mainIndex)}eq(t,s=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(t.ranges[n],s))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new W([this.main],0)}addRange(t,s=!0){return W.create([t].concat(this.ranges),s?0:this.mainIndex+1)}replaceRange(t,s=this.mainIndex){let n=this.ranges.slice();return n[s]=t,W.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new W(t.ranges.map(s=>Vr.fromJSON(s)),t.main)}static single(t,s=t){return new W([W.range(t,s)],0)}static create(t,s=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,r=0;r<t.length;r++){let o=t[r];if(o.empty?o.from<=n:o.from<n)return W.normalized(t.slice(),s);n=o.to}return new W(t,s)}static cursor(t,s=0,n,r){return Vr.create(t,t,(s==0?0:s<0?8:16)|(n==null?7:Math.min(6,n))|(r??16777215)<<6)}static range(t,s,n,r){let o=(n??16777215)<<6|(r==null?7:Math.min(6,r));return s<t?Vr.create(s,t,48|o):Vr.create(t,s,(s>t?8:0)|o)}static normalized(t,s=0){let n=t[s];t.sort((r,o)=>r.from-o.from),s=t.indexOf(n);for(let r=1;r<t.length;r++){let o=t[r],i=t[r-1];if(o.empty?o.from<=i.to:o.from<i.to){let a=i.from,l=Math.max(o.to,i.to);r<=s&&s--,t.splice(--r,2,o.anchor>o.head?W.range(l,a):W.range(a,l))}}return new W(t,s)}}function Ob(e,t){for(let s of e.ranges)if(s.to>t)throw new RangeError("Selection points outside of document")}let Tf=0;class tt{constructor(t,s,n,r,o){this.combine=t,this.compareInput=s,this.compare=n,this.isStatic=r,this.id=Tf++,this.default=t([]),this.extensions=typeof o=="function"?o(this):o}get reader(){return this}static define(t={}){return new tt(t.combine||(s=>s),t.compareInput||((s,n)=>s===n),t.compare||(t.combine?(s,n)=>s===n:Pf),!!t.static,t.enables)}of(t){return new hh([],this,0,t)}compute(t,s){if(this.isStatic)throw new Error("Can't compute a static facet");return new hh(t,this,1,s)}computeN(t,s){if(this.isStatic)throw new Error("Can't compute a static facet");return new hh(t,this,2,s)}from(t,s){return s||(s=n=>n),this.compute([t],n=>s(n.field(t)))}}function Pf(e,t){return e==t||e.length==t.length&&e.every((s,n)=>s===t[n])}class hh{constructor(t,s,n,r){this.dependencies=t,this.facet=s,this.type=n,this.value=r,this.id=Tf++}dynamicSlot(t){var s;let n=this.value,r=this.facet.compareInput,o=this.id,i=t[o]>>1,a=this.type==2,l=!1,c=!1,u=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?c=!0:((s=t[h.id])!==null&&s!==void 0?s:1)&1||u.push(t[h.id]);return{create(h){return h.values[i]=n(h),1},update(h,d){if(l&&d.docChanged||c&&(d.docChanged||d.selection)||Mf(h,u)){let f=n(h);if(a?!Tb(f,h.values[i],r):!r(f,h.values[i]))return h.values[i]=f,1}return 0},reconfigure:(h,d)=>{let f,p=d.config.address[o];if(p!=null){let g=dh(d,p);if(this.dependencies.every(m=>m instanceof tt?d.facet(m)===h.facet(m):m instanceof Ne?d.field(m,!1)==h.field(m,!1):!0)||(a?Tb(f=n(h),g,r):r(f=n(h),g)))return h.values[i]=g,0}else f=n(h);return h.values[i]=f,1}}}}function Tb(e,t,s){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!s(e[n],t[n]))return!1;return!0}function Mf(e,t){let s=!1;for(let n of t)la(e,n)&1&&(s=!0);return s}function F$(e,t,s){let n=s.map(l=>e[l.id]),r=s.map(l=>l.type),o=n.filter(l=>!(l&1)),i=e[t.id]>>1;function a(l){let c=[];for(let u=0;u<n.length;u++){let h=dh(l,n[u]);if(r[u]==2)for(let d of h)c.push(d);else c.push(h)}return t.combine(c)}return{create(l){for(let c of n)la(l,c);return l.values[i]=a(l),1},update(l,c){if(!Mf(l,o))return 0;let u=a(l);return t.compare(u,l.values[i])?0:(l.values[i]=u,1)},reconfigure(l,c){let u=Mf(l,n),h=c.config.facets[t.id],d=c.facet(t);if(h&&!u&&Pf(s,h))return l.values[i]=d,0;let f=a(l);return t.compare(f,d)?(l.values[i]=d,0):(l.values[i]=f,1)}}}const Pb=tt.define({static:!0});class Ne{constructor(t,s,n,r,o){this.id=t,this.createF=s,this.updateF=n,this.compareF=r,this.spec=o,this.provides=void 0}static define(t){let s=new Ne(Tf++,t.create,t.update,t.compare||((n,r)=>n===r),t);return t.provide&&(s.provides=t.provide(s)),s}create(t){let s=t.facet(Pb).find(n=>n.field==this);return((s==null?void 0:s.create)||this.createF)(t)}slot(t){let s=t[this.id]>>1;return{create:n=>(n.values[s]=this.create(n),1),update:(n,r)=>{let o=n.values[s],i=this.updateF(o,r);return this.compareF(o,i)?0:(n.values[s]=i,1)},reconfigure:(n,r)=>r.config.address[this.id]!=null?(n.values[s]=r.field(this),0):(n.values[s]=this.create(n),1)}}init(t){return[this,Pb.of({field:this,create:t})]}get extension(){return this}}const zr={lowest:4,low:3,default:2,high:1,highest:0};function aa(e){return t=>new Mb(t,e)}const Ho={highest:aa(zr.highest),high:aa(zr.high),default:aa(zr.default),low:aa(zr.low),lowest:aa(zr.lowest)};class Mb{constructor(t,s){this.inner=t,this.prec=s}}class ch{of(t){return new If(this,t)}reconfigure(t){return ch.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class If{constructor(t,s){this.compartment=t,this.inner=s}}class uh{constructor(t,s,n,r,o,i){for(this.base=t,this.compartments=s,this.dynamicSlots=n,this.address=r,this.staticValues=o,this.facets=i,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(t){let s=this.address[t.id];return s==null?t.default:this.staticValues[s>>1]}static resolve(t,s,n){let r=[],o=Object.create(null),i=new Map;for(let d of V$(t,s,i))d instanceof Ne?r.push(d):(o[d.facet.id]||(o[d.facet.id]=[])).push(d);let a=Object.create(null),l=[],c=[];for(let d of r)a[d.id]=c.length<<1,c.push(f=>d.slot(f));let u=n==null?void 0:n.config.facets;for(let d in o){let f=o[d],p=f[0].facet,g=u&&u[d]||[];if(f.every(m=>m.type==0))if(a[p.id]=l.length<<1|1,Pf(g,f))l.push(n.facet(p));else{let m=p.combine(f.map(y=>y.value));l.push(n&&p.compare(m,n.facet(p))?n.facet(p):m)}else{for(let m of f)m.type==0?(a[m.id]=l.length<<1|1,l.push(m.value)):(a[m.id]=c.length<<1,c.push(y=>m.dynamicSlot(y)));a[p.id]=c.length<<1,c.push(m=>F$(m,p,f))}}let h=c.map(d=>d(a));return new uh(t,i,h,a,l,o)}}function V$(e,t,s){let n=[[],[],[],[],[]],r=new Map;function o(i,a){let l=r.get(i);if(l!=null){if(l<=a)return;let c=n[l].indexOf(i);c>-1&&n[l].splice(c,1),i instanceof If&&s.delete(i.compartment)}if(r.set(i,a),Array.isArray(i))for(let c of i)o(c,a);else if(i instanceof If){if(s.has(i.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=t.get(i.compartment)||i.inner;s.set(i.compartment,c),o(c,a)}else if(i instanceof Mb)o(i.inner,i.prec);else if(i instanceof Ne)n[a].push(i),i.provides&&o(i.provides,a);else if(i instanceof hh)n[a].push(i),i.facet.extensions&&o(i.facet.extensions,zr.default);else{let c=i.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${i}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);o(c,a)}}return o(e,zr.default),n.reduce((i,a)=>i.concat(a))}function la(e,t){if(t&1)return 2;let s=t>>1,n=e.status[s];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;e.status[s]=4;let r=e.computeSlot(e,e.config.dynamicSlots[s]);return e.status[s]=2|r}function dh(e,t){return t&1?e.config.staticValues[t>>1]:e.values[t>>1]}const Ib=tt.define(),Ef=tt.define({combine:e=>e.some(t=>t),static:!0}),Eb=tt.define({combine:e=>e.length?e[0]:void 0,static:!0}),$b=tt.define(),Rb=tt.define(),Db=tt.define(),Nb=tt.define({combine:e=>e.length?e[0]:!1});class Nn{constructor(t,s){this.type=t,this.value=s}static define(){return new z$}}class z${of(t){return new Nn(this,t)}}class G${constructor(t){this.map=t}of(t){return new bt(this,t)}}class bt{constructor(t,s){this.type=t,this.value=s}map(t){let s=this.type.map(this.value,t);return s===void 0?void 0:s==this.value?this:new bt(this.type,s)}is(t){return this.type==t}static define(t={}){return new G$(t.map||(s=>s))}static mapEffects(t,s){if(!t.length)return t;let n=[];for(let r of t){let o=r.map(s);o&&n.push(o)}return n}}bt.reconfigure=bt.define(),bt.appendConfig=bt.define();class xe{constructor(t,s,n,r,o,i){this.startState=t,this.changes=s,this.selection=n,this.effects=r,this.annotations=o,this.scrollIntoView=i,this._doc=null,this._state=null,n&&Ob(n,s.newLength),o.some(a=>a.type==xe.time)||(this.annotations=o.concat(xe.time.of(Date.now())))}static create(t,s,n,r,o,i){return new xe(t,s,n,r,o,i)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let s of this.annotations)if(s.type==t)return s.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let s=this.annotation(xe.userEvent);return!!(s&&(s==t||s.length>t.length&&s.slice(0,t.length)==t&&s[t.length]=="."))}}xe.time=Nn.define(),xe.userEvent=Nn.define(),xe.addToHistory=Nn.define(),xe.remote=Nn.define();function U$(e,t){let s=[];for(let n=0,r=0;;){let o,i;if(n<e.length&&(r==t.length||t[r]>=e[n]))o=e[n++],i=e[n++];else if(r<t.length)o=t[r++],i=t[r++];else return s;!s.length||s[s.length-1]<o?s.push(o,i):s[s.length-1]<i&&(s[s.length-1]=i)}}function Lb(e,t,s){var n;let r,o,i;return s?(r=t.changes,o=we.empty(t.changes.length),i=e.changes.compose(t.changes)):(r=t.changes.map(e.changes),o=e.changes.mapDesc(t.changes,!0),i=e.changes.compose(r)),{changes:i,selection:t.selection?t.selection.map(o):(n=e.selection)===null||n===void 0?void 0:n.map(r),effects:bt.mapEffects(e.effects,r).concat(bt.mapEffects(t.effects,o)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function $f(e,t,s){let n=t.selection,r=Wo(t.annotations);return t.userEvent&&(r=r.concat(xe.userEvent.of(t.userEvent))),{changes:t.changes instanceof we?t.changes:we.of(t.changes||[],s,e.facet(Eb)),selection:n&&(n instanceof W?n:W.single(n.anchor,n.head)),effects:Wo(t.effects),annotations:r,scrollIntoView:!!t.scrollIntoView}}function Bb(e,t,s){let n=$f(e,t.length?t[0]:{},e.doc.length);t.length&&t[0].filter===!1&&(s=!1);for(let o=1;o<t.length;o++){t[o].filter===!1&&(s=!1);let i=!!t[o].sequential;n=Lb(n,$f(e,t[o],i?n.changes.newLength:e.doc.length),i)}let r=xe.create(e,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return W$(s?H$(r):r)}function H$(e){let t=e.startState,s=!0;for(let r of t.facet($b)){let o=r(e);if(o===!1){s=!1;break}Array.isArray(o)&&(s=s===!0?o:U$(s,o))}if(s!==!0){let r,o;if(s===!1)o=e.changes.invertedDesc,r=we.empty(t.doc.length);else{let i=e.changes.filter(s);r=i.changes,o=i.filtered.mapDesc(i.changes).invertedDesc}e=xe.create(t,r,e.selection&&e.selection.map(o),bt.mapEffects(e.effects,o),e.annotations,e.scrollIntoView)}let n=t.facet(Rb);for(let r=n.length-1;r>=0;r--){let o=n[r](e);o instanceof xe?e=o:Array.isArray(o)&&o.length==1&&o[0]instanceof xe?e=o[0]:e=Bb(t,Wo(o),!1)}return e}function W$(e){let t=e.startState,s=t.facet(Db),n=e;for(let r=s.length-1;r>=0;r--){let o=s[r](e);o&&Object.keys(o).length&&(n=Lb(n,$f(t,o,e.changes.newLength),!0))}return n==e?e:xe.create(t,e.changes,e.selection,n.effects,n.annotations,n.scrollIntoView)}const X$=[];function Wo(e){return e==null?X$:Array.isArray(e)?e:[e]}var Kt=function(e){return e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other",e}(Kt||(Kt={}));const Y$=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Rf;try{Rf=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Z$(e){if(Rf)return Rf.test(e);for(let t=0;t<e.length;t++){let s=e[t];if(/\w/.test(s)||s>"\x80"&&(s.toUpperCase()!=s.toLowerCase()||Y$.test(s)))return!0}return!1}function q$(e){return t=>{if(!/\S/.test(t))return Kt.Space;if(Z$(t))return Kt.Word;for(let s=0;s<e.length;s++)if(t.indexOf(e[s])>-1)return Kt.Word;return Kt.Other}}class Mt{constructor(t,s,n,r,o,i){this.config=t,this.doc=s,this.selection=n,this.values=r,this.status=t.statusTemplate.slice(),this.computeSlot=o,i&&(i._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)la(this,a<<1);this.computeSlot=null}field(t,s=!0){let n=this.config.address[t.id];if(n==null){if(s)throw new RangeError("Field is not present in this state");return}return la(this,n),dh(this,n)}update(...t){return Bb(this,t,!0)}applyTransaction(t){let s=this.config,{base:n,compartments:r}=s;for(let a of t.effects)a.is(ch.reconfigure)?(s&&(r=new Map,s.compartments.forEach((l,c)=>r.set(c,l)),s=null),r.set(a.value.compartment,a.value.extension)):a.is(bt.reconfigure)?(s=null,n=a.value):a.is(bt.appendConfig)&&(s=null,n=Wo(n).concat(a.value));let o;s?o=t.startState.values.slice():(s=uh.resolve(n,r,this),o=new Mt(s,this.doc,this.selection,s.dynamicSlots.map(()=>null),(a,l)=>l.reconfigure(a,this),null).values);let i=t.startState.facet(Ef)?t.newSelection:t.newSelection.asSingle();new Mt(s,t.newDoc,i,o,(a,l)=>l.update(a,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:t},range:W.cursor(s.from+t.length)}))}changeByRange(t){let s=this.selection,n=t(s.ranges[0]),r=this.changes(n.changes),o=[n.range],i=Wo(n.effects);for(let a=1;a<s.ranges.length;a++){let l=t(s.ranges[a]),c=this.changes(l.changes),u=c.map(r);for(let d=0;d<a;d++)o[d]=o[d].map(u);let h=r.mapDesc(c,!0);o.push(l.range.map(h)),r=r.compose(u),i=bt.mapEffects(i,u).concat(bt.mapEffects(Wo(l.effects),h))}return{changes:r,selection:W.create(o,s.mainIndex),effects:i}}changes(t=[]){return t instanceof we?t:we.of(t,this.doc.length,this.facet(Mt.lineSeparator))}toText(t){return Rt.of(t.split(this.facet(Mt.lineSeparator)||Sf))}sliceDoc(t=0,s=this.doc.length){return this.doc.sliceString(t,s,this.lineBreak)}facet(t){let s=this.config.address[t.id];return s==null?t.default:(la(this,s),dh(this,s))}toJSON(t){let s={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let n in t){let r=t[n];r instanceof Ne&&this.config.address[r.id]!=null&&(s[n]=r.spec.toJSON(this.field(t[n]),this))}return s}static fromJSON(t,s={},n){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(n){for(let o in n)if(Object.prototype.hasOwnProperty.call(t,o)){let i=n[o],a=t[o];r.push(i.init(l=>i.spec.fromJSON(a,l)))}}return Mt.create({doc:t.doc,selection:W.fromJSON(t.selection),extensions:s.extensions?r.concat([s.extensions]):r})}static create(t={}){let s=uh.resolve(t.extensions||[],new Map),n=t.doc instanceof Rt?t.doc:Rt.of((t.doc||"").split(s.staticFacet(Mt.lineSeparator)||Sf)),r=t.selection?t.selection instanceof W?t.selection:W.single(t.selection.anchor,t.selection.head):W.single(0);return Ob(r,n.length),s.staticFacet(Ef)||(r=r.asSingle()),new Mt(s,n,r,s.dynamicSlots.map(()=>null),(o,i)=>i.create(o),null)}get tabSize(){return this.facet(Mt.tabSize)}get lineBreak(){return this.facet(Mt.lineSeparator)||`
`}get readOnly(){return this.facet(Nb)}phrase(t,...s){for(let n of this.facet(Mt.phrases))if(Object.prototype.hasOwnProperty.call(n,t)){t=n[t];break}return s.length&&(t=t.replace(/\$(\$|\d*)/g,(n,r)=>{if(r=="$")return"$";let o=+(r||1);return!o||o>s.length?n:s[o-1]})),t}languageDataAt(t,s,n=-1){let r=[];for(let o of this.facet(Ib))for(let i of o(this,s,n))Object.prototype.hasOwnProperty.call(i,t)&&r.push(i[t]);return r}charCategorizer(t){return q$(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:s,from:n,length:r}=this.doc.lineAt(t),o=this.charCategorizer(t),i=t-n,a=t-n;for(;i>0;){let l=Re(s,i,!1);if(o(s.slice(l,i))!=Kt.Word)break;i=l}for(;a<r;){let l=Re(s,a);if(o(s.slice(a,l))!=Kt.Word)break;a=l}return i==a?null:W.range(i+n,a+n)}}Mt.allowMultipleSelections=Ef,Mt.tabSize=tt.define({combine:e=>e.length?e[0]:4}),Mt.lineSeparator=Eb,Mt.readOnly=Nb,Mt.phrases=tt.define({compare(e,t){let s=Object.keys(e),n=Object.keys(t);return s.length==n.length&&s.every(r=>e[r]==t[r])}}),Mt.languageData=Ib,Mt.changeFilter=$b,Mt.transactionFilter=Rb,Mt.transactionExtender=Db,ch.reconfigure=bt.define();function pn(e,t,s={}){let n={};for(let r of e)for(let o of Object.keys(r)){let i=r[o],a=n[o];if(a===void 0)n[o]=i;else if(!(a===i||i===void 0))if(Object.hasOwnProperty.call(s,o))n[o]=s[o](a,i);else throw new Error("Config merge conflict for field "+o)}for(let r in t)n[r]===void 0&&(n[r]=t[r]);return n}class Gr{eq(t){return this==t}range(t,s=t){return ha.create(t,s,this)}}Gr.prototype.startSide=Gr.prototype.endSide=0,Gr.prototype.point=!1,Gr.prototype.mapMode=ns.TrackDel;class ha{constructor(t,s,n){this.from=t,this.to=s,this.value=n}static create(t,s,n){return new ha(t,s,n)}}function Df(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class Nf{constructor(t,s,n,r){this.from=t,this.to=s,this.value=n,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(t,s,n,r=0){let o=n?this.to:this.from;for(let i=r,a=o.length;;){if(i==a)return i;let l=i+a>>1,c=o[l]-t||(n?this.value[l].endSide:this.value[l].startSide)-s;if(l==i)return c>=0?i:a;c>=0?a=l:i=l+1}}between(t,s,n,r){for(let o=this.findIndex(s,-1e9,!0),i=this.findIndex(n,1e9,!1,o);o<i;o++)if(r(this.from[o]+t,this.to[o]+t,this.value[o])===!1)return!1}map(t,s){let n=[],r=[],o=[],i=-1,a=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+t,h=this.to[l]+t,d,f;if(u==h){let p=s.mapPos(u,c.startSide,c.mapMode);if(p==null||(d=f=p,c.startSide!=c.endSide&&(f=s.mapPos(u,c.endSide),f<d)))continue}else if(d=s.mapPos(u,c.startSide),f=s.mapPos(h,c.endSide),d>f||d==f&&c.startSide>0&&c.endSide<=0)continue;(f-d||c.endSide-c.startSide)<0||(i<0&&(i=d),c.point&&(a=Math.max(a,f-d)),n.push(c),r.push(d-i),o.push(f-i))}return{mapped:n.length?new Nf(r,o,n,a):null,pos:i}}}class $t{constructor(t,s,n,r){this.chunkPos=t,this.chunk=s,this.nextLayer=n,this.maxPoint=r}static create(t,s,n,r){return new $t(t,s,n,r)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let s of this.chunk)t+=s.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:s=[],sort:n=!1,filterFrom:r=0,filterTo:o=this.length}=t,i=t.filter;if(s.length==0&&!i)return this;if(n&&(s=s.slice().sort(Df)),this.isEmpty)return s.length?$t.of(s):this;let a=new Fb(this,null,-1).goto(0),l=0,c=[],u=new ir;for(;a.value||l<s.length;)if(l<s.length&&(a.from-s[l].from||a.startSide-s[l].value.startSide)>=0){let h=s[l++];u.addInner(h.from,h.to,h.value)||c.push(h)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==s.length||this.chunkEnd(a.chunkIndex)<s[l].from)&&(!i||r>this.chunkEnd(a.chunkIndex)||o<this.chunkPos[a.chunkIndex])&&u.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!i||r>a.to||o<a.from||i(a.from,a.to,a.value))&&(u.addInner(a.from,a.to,a.value)||c.push(ha.create(a.from,a.to,a.value))),a.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?$t.empty:this.nextLayer.update({add:c,filter:i,filterFrom:r,filterTo:o}))}map(t){if(t.empty||this.isEmpty)return this;let s=[],n=[],r=-1;for(let i=0;i<this.chunk.length;i++){let a=this.chunkPos[i],l=this.chunk[i],c=t.touchesRange(a,a+l.length);if(c===!1)r=Math.max(r,l.maxPoint),s.push(l),n.push(t.mapPos(a));else if(c===!0){let{mapped:u,pos:h}=l.map(a,t);u&&(r=Math.max(r,u.maxPoint),s.push(u),n.push(h))}}let o=this.nextLayer.map(t);return s.length==0?o:new $t(n,s,o||$t.empty,r)}between(t,s,n){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let o=this.chunkPos[r],i=this.chunk[r];if(s>=o&&t<=o+i.length&&i.between(o,t-o,s-o,n)===!1)return}this.nextLayer.between(t,s,n)}}iter(t=0){return ca.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,s=0){return ca.from(t).goto(s)}static compare(t,s,n,r,o=-1){let i=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=o),a=s.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=o),l=jb(i,a,n),c=new ua(i,l,o),u=new ua(a,l,o);n.iterGaps((h,d,f)=>Vb(c,h,u,d,f,r)),n.empty&&n.length==0&&Vb(c,0,u,0,0,r)}static eq(t,s,n=0,r){r==null&&(r=999999999);let o=t.filter(u=>!u.isEmpty&&s.indexOf(u)<0),i=s.filter(u=>!u.isEmpty&&t.indexOf(u)<0);if(o.length!=i.length)return!1;if(!o.length)return!0;let a=jb(o,i),l=new ua(o,a,0).goto(n),c=new ua(i,a,0).goto(n);for(;;){if(l.to!=c.to||!Bf(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>r)return!0;l.next(),c.next()}}static spans(t,s,n,r,o=-1){let i=new ua(t,null,o).goto(s),a=s,l=i.openStart;for(;;){let c=Math.min(i.to,n);if(i.point){let u=i.activeForPoint(i.to),h=i.pointFrom<s?u.length+1:Math.min(u.length,l);r.point(a,c,i.point,u,h,i.pointRank),l=Math.min(i.openEnd(c),u.length)}else c>a&&(r.span(a,c,i.active,l),l=i.openEnd(c));if(i.to>n)return l+(i.point&&i.to>n?1:0);a=i.to,i.next()}}static of(t,s=!1){let n=new ir;for(let r of t instanceof ha?[t]:s?Q$(t):t)n.add(r.from,r.to,r.value);return n.finish()}static join(t){if(!t.length)return $t.empty;let s=t[t.length-1];for(let n=t.length-2;n>=0;n--)for(let r=t[n];r!=$t.empty;r=r.nextLayer)s=new $t(r.chunkPos,r.chunk,s,Math.max(r.maxPoint,s.maxPoint));return s}}$t.empty=new $t([],[],null,-1);function Q$(e){if(e.length>1)for(let t=e[0],s=1;s<e.length;s++){let n=e[s];if(Df(t,n)>0)return e.slice().sort(Df);t=n}return e}$t.empty.nextLayer=$t.empty;class ir{finishChunk(t){this.chunks.push(new Nf(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,s,n){this.addInner(t,s,n)||(this.nextLayer||(this.nextLayer=new ir)).add(t,s,n)}addInner(t,s,n){let r=t-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&(t-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(s-this.chunkStart),this.last=n,this.lastFrom=t,this.lastTo=s,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,s-t)),!0)}addChunk(t,s){if((t-this.lastTo||s.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,s.maxPoint),this.chunks.push(s),this.chunkPos.push(t);let n=s.value.length-1;return this.last=s.value[n],this.lastFrom=s.from[n]+t,this.lastTo=s.to[n]+t,!0}finish(){return this.finishInner($t.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let s=$t.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,s}}function jb(e,t,s){let n=new Map;for(let o of e)for(let i=0;i<o.chunk.length;i++)o.chunk[i].maxPoint<=0&&n.set(o.chunk[i],o.chunkPos[i]);let r=new Set;for(let o of t)for(let i=0;i<o.chunk.length;i++){let a=n.get(o.chunk[i]);a!=null&&(s?s.mapPos(a):a)==o.chunkPos[i]&&!(s!=null&&s.touchesRange(a,a+o.chunk[i].length))&&r.add(o.chunk[i])}return r}class Fb{constructor(t,s,n,r=0){this.layer=t,this.skip=s,this.minPoint=n,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,s=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,s,!1),this}gotoInner(t,s,n){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<t||r.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],s,!0);(!n||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(t,s){(this.to-t||this.endSide-s)<0&&this.gotoInner(t,s,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],s=this.layer.chunk[this.chunkIndex],n=t+s.from[this.rangeIndex];if(this.from=n,this.to=t+s.to[this.rangeIndex],this.value=s.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class ca{constructor(t){this.heap=t}static from(t,s=null,n=-1){let r=[];for(let o=0;o<t.length;o++)for(let i=t[o];!i.isEmpty;i=i.nextLayer)i.maxPoint>=n&&r.push(new Fb(i,s,n,o));return r.length==1?r[0]:new ca(r)}get startSide(){return this.value?this.value.startSide:0}goto(t,s=-1e9){for(let n of this.heap)n.goto(t,s);for(let n=this.heap.length>>1;n>=0;n--)Lf(this.heap,n);return this.next(),this}forward(t,s){for(let n of this.heap)n.forward(t,s);for(let n=this.heap.length>>1;n>=0;n--)Lf(this.heap,n);(this.to-t||this.value.endSide-s)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Lf(this.heap,0)}}}function Lf(e,t){for(let s=e[t];;){let n=(t<<1)+1;if(n>=e.length)break;let r=e[n];if(n+1<e.length&&r.compare(e[n+1])>=0&&(r=e[n+1],n++),s.compare(r)<0)break;e[n]=s,e[t]=r,t=n}}class ua{constructor(t,s,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=ca.from(t,s,n)}goto(t,s=-1e9){return this.cursor.goto(t,s),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=s,this.openStart=-1,this.next(),this}forward(t,s){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-s)<0;)this.removeActive(this.minActive);this.cursor.forward(t,s)}removeActive(t){fh(this.active,t),fh(this.activeTo,t),fh(this.activeRank,t),this.minActive=zb(this.active,this.activeTo)}addActive(t){let s=0,{value:n,to:r,rank:o}=this.cursor;for(;s<this.activeRank.length&&(o-this.activeRank[s]||r-this.activeTo[s])>0;)s++;ph(this.active,s,n),ph(this.activeTo,s,r),ph(this.activeRank,s,o),t&&ph(t,s,this.cursor.from),this.minActive=zb(this.active,this.activeTo)}next(){let t=this.to,s=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>t){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&fh(n,r)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(n),this.cursor.next();else if(s&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let r=n.length-1;r>=0&&n[r]<t;r--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let s=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>t||this.activeTo[n]==t&&this.active[n].endSide>=this.point.endSide)&&s.push(this.active[n]);return s.reverse()}openEnd(t){let s=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>t;n--)s++;return s}}function Vb(e,t,s,n,r,o){e.goto(t),s.goto(n);let i=n+r,a=n,l=n-t;for(;;){let c=e.to+l-s.to||e.endSide-s.endSide,u=c<0?e.to+l:s.to,h=Math.min(u,i);if(e.point||s.point?e.point&&s.point&&(e.point==s.point||e.point.eq(s.point))&&Bf(e.activeForPoint(e.to),s.activeForPoint(s.to))||o.comparePoint(a,h,e.point,s.point):h>a&&!Bf(e.active,s.active)&&o.compareRange(a,h,e.active,s.active),u>i)break;a=u,c<=0&&e.next(),c>=0&&s.next()}}function Bf(e,t){if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!=t[s]&&!e[s].eq(t[s]))return!1;return!0}function fh(e,t){for(let s=t,n=e.length-1;s<n;s++)e[s]=e[s+1];e.pop()}function ph(e,t,s){for(let n=e.length-1;n>=t;n--)e[n+1]=e[n];e[t]=s}function zb(e,t){let s=-1,n=1e9;for(let r=0;r<t.length;r++)(t[r]-n||e[r].endSide-e[s].endSide)<0&&(s=r,n=t[r]);return s}function Xo(e,t,s=e.length){let n=0;for(let r=0;r<s;)e.charCodeAt(r)==9?(n+=t-n%t,r++):(n++,r=Re(e,r));return n}function jf(e,t,s,n){for(let r=0,o=0;;){if(o>=t)return r;if(r==e.length)break;o+=e.charCodeAt(r)==9?s-o%s:1,r=Re(e,r)}return n===!0?-1:e.length}const Ff="\u037C",Gb=typeof Symbol>"u"?"__"+Ff:Symbol.for(Ff),Vf=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Ub=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class ar{constructor(t,s){this.rules=[];let{finish:n}=s||{};function r(i){return/^@/.test(i)?[i]:i.split(/,\s*/)}function o(i,a,l,c){let u=[],h=/^@(\w+)\b/.exec(i[0]),d=h&&h[1]=="keyframes";if(h&&a==null)return l.push(i[0]+";");for(let f in a){let p=a[f];if(/&/.test(f))o(f.split(/,\s*/).map(g=>i.map(m=>g.replace(/&/,m))).reduce((g,m)=>g.concat(m)),p,l);else if(p&&typeof p=="object"){if(!h)throw new RangeError("The value of a property ("+f+") should be a primitive value.");o(r(f),p,u,d)}else p!=null&&u.push(f.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+p+";")}(u.length||d)&&l.push((n&&!h&&!c?i.map(n):i).join(", ")+" {"+u.join(" ")+"}")}for(let i in t)o(r(i),t[i],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=Ub[Gb]||1;return Ub[Gb]=t+1,Ff+t.toString(36)}static mount(t,s,n){let r=t[Vf],o=n&&n.nonce;r?o&&r.setNonce(o):r=new K$(t,o),r.mount(Array.isArray(s)?s:[s])}}let Hb=new Map;class K${constructor(t,s){let n=t.ownerDocument||t,r=n.defaultView;if(!t.head&&t.adoptedStyleSheets&&r.CSSStyleSheet){let o=Hb.get(n);if(o)return t.adoptedStyleSheets=[o.sheet,...t.adoptedStyleSheets],t[Vf]=o;this.sheet=new r.CSSStyleSheet,t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets],Hb.set(n,this)}else{this.styleTag=n.createElement("style"),s&&this.styleTag.setAttribute("nonce",s);let o=t.head||t;o.insertBefore(this.styleTag,o.firstChild)}this.modules=[],t[Vf]=this}mount(t){let s=this.sheet,n=0,r=0;for(let o=0;o<t.length;o++){let i=t[o],a=this.modules.indexOf(i);if(a<r&&a>-1&&(this.modules.splice(a,1),r--,a=-1),a==-1){if(this.modules.splice(r++,0,i),s)for(let l=0;l<i.rules.length;l++)s.insertRule(i.rules[l],n++)}else{for(;r<a;)n+=this.modules[r++].rules.length;n+=i.rules.length,r++}}if(!s){let o="";for(let i=0;i<this.modules.length;i++)o+=this.modules[i].getRules()+`
`;this.styleTag.textContent=o}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}for(var lr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},da={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},J$=typeof navigator<"u"&&/Mac/.test(navigator.platform),tR=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Le=0;Le<10;Le++)lr[48+Le]=lr[96+Le]=String(Le);for(var Le=1;Le<=24;Le++)lr[Le+111]="F"+Le;for(var Le=65;Le<=90;Le++)lr[Le]=String.fromCharCode(Le+32),da[Le]=String.fromCharCode(Le);for(var zf in lr)da.hasOwnProperty(zf)||(da[zf]=lr[zf]);function eR(e){var t=J$&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||tR&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",s=!t&&e.key||(e.shiftKey?da:lr)[e.keyCode]||e.key||"Unidentified";return s=="Esc"&&(s="Escape"),s=="Del"&&(s="Delete"),s=="Left"&&(s="ArrowLeft"),s=="Up"&&(s="ArrowUp"),s=="Right"&&(s="ArrowRight"),s=="Down"&&(s="ArrowDown"),s}function mh(e){let t;return e.nodeType==11?t=e.getSelection?e:e.ownerDocument:t=e,t.getSelection()}function Gf(e,t){return t?e==t||e.contains(t.nodeType!=1?t.parentNode:t):!1}function sR(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function gh(e,t){if(!t.anchorNode)return!1;try{return Gf(e,t.anchorNode)}catch{return!1}}function Yo(e){return e.nodeType==3?Ur(e,0,e.nodeValue.length).getClientRects():e.nodeType==1?e.getClientRects():[]}function fa(e,t,s,n){return s?Wb(e,t,s,n,-1)||Wb(e,t,s,n,1):!1}function pa(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t}function Wb(e,t,s,n,r){for(;;){if(e==s&&t==n)return!0;if(t==(r<0?0:Ln(e))){if(e.nodeName=="DIV")return!1;let o=e.parentNode;if(!o||o.nodeType!=1)return!1;t=pa(e)+(r<0?0:1),e=o}else if(e.nodeType==1){if(e=e.childNodes[t+(r<0?-1:0)],e.nodeType==1&&e.contentEditable=="false")return!1;t=r<0?Ln(e):0}else return!1}}function Ln(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function yh(e,t){let s=t?e.left:e.right;return{left:s,right:s,top:e.top,bottom:e.bottom}}function nR(e){return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}function Xb(e,t){let s=t.width/e.offsetWidth,n=t.height/e.offsetHeight;return(s>.995&&s<1.005||!isFinite(s)||Math.abs(t.width-e.offsetWidth)<1)&&(s=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(t.height-e.offsetHeight)<1)&&(n=1),{scaleX:s,scaleY:n}}function rR(e,t,s,n,r,o,i,a){let l=e.ownerDocument,c=l.defaultView||window;for(let u=e,h=!1;u&&!h;)if(u.nodeType==1){let d,f=u==l.body,p=1,g=1;if(f)d=nR(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(h=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let v=u.getBoundingClientRect();({scaleX:p,scaleY:g}=Xb(u,v)),d={left:v.left,right:v.left+u.clientWidth*p,top:v.top,bottom:v.top+u.clientHeight*g}}let m=0,y=0;if(r=="nearest")t.top<d.top?(y=-(d.top-t.top+i),s>0&&t.bottom>d.bottom+y&&(y=t.bottom-d.bottom+y+i)):t.bottom>d.bottom&&(y=t.bottom-d.bottom+i,s<0&&t.top-y<d.top&&(y=-(d.top+y-t.top+i)));else{let v=t.bottom-t.top,b=d.bottom-d.top;y=(r=="center"&&v<=b?t.top+v/2-b/2:r=="start"||r=="center"&&s<0?t.top-i:t.bottom-b+i)-d.top}if(n=="nearest"?t.left<d.left?(m=-(d.left-t.left+o),s>0&&t.right>d.right+m&&(m=t.right-d.right+m+o)):t.right>d.right&&(m=t.right-d.right+o,s<0&&t.left<d.left+m&&(m=-(d.left+m-t.left+o))):m=(n=="center"?t.left+(t.right-t.left)/2-(d.right-d.left)/2:n=="start"==a?t.left-o:t.right-(d.right-d.left)+o)-d.left,m||y)if(f)c.scrollBy(m,y);else{let v=0,b=0;if(y){let w=u.scrollTop;u.scrollTop+=y/g,b=(u.scrollTop-w)*g}if(m){let w=u.scrollLeft;u.scrollLeft+=m/p,v=(u.scrollLeft-w)*p}t={left:t.left-v,top:t.top-b,right:t.right-v,bottom:t.bottom-b},v&&Math.abs(v-m)<1&&(n="nearest"),b&&Math.abs(b-y)<1&&(r="nearest")}if(f)break;u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function oR(e){let t=e.ownerDocument;for(let s=e.parentNode;s&&s!=t.body;)if(s.nodeType==1){if(s.scrollHeight>s.clientHeight||s.scrollWidth>s.clientWidth)return s;s=s.assignedSlot||s.parentNode}else if(s.nodeType==11)s=s.host;else break;return null}class iR{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:s,focusNode:n}=t;this.set(s,Math.min(t.anchorOffset,s?Ln(s):0),n,Math.min(t.focusOffset,n?Ln(n):0))}set(t,s,n,r){this.anchorNode=t,this.anchorOffset=s,this.focusNode=n,this.focusOffset=r}}let Zo=null;function Yb(e){if(e.setActive)return e.setActive();if(Zo)return e.focus(Zo);let t=[];for(let s=e;s&&(t.push(s,s.scrollTop,s.scrollLeft),s!=s.ownerDocument);s=s.parentNode);if(e.focus(Zo==null?{get preventScroll(){return Zo={preventScroll:!0},!0}}:void 0),!Zo){Zo=!1;for(let s=0;s<t.length;){let n=t[s++],r=t[s++],o=t[s++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=o&&(n.scrollLeft=o)}}}let Zb;function Ur(e,t,s=t){let n=Zb||(Zb=document.createRange());return n.setEnd(e,s),n.setStart(e,t),n}function qo(e,t,s){let n={key:t,code:t,keyCode:s,which:s,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,e.dispatchEvent(r);let o=new KeyboardEvent("keyup",n);return o.synthetic=!0,e.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function aR(e){for(;e;){if(e&&(e.nodeType==9||e.nodeType==11&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}function qb(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}function lR(e,t){let s=t.focusNode,n=t.focusOffset;if(!s||t.anchorNode!=s||t.anchorOffset!=n)return!1;for(n=Math.min(n,Ln(s));;)if(n){if(s.nodeType!=1)return!1;let r=s.childNodes[n-1];r.contentEditable=="false"?n--:(s=r,n=Ln(s))}else{if(s==e)return!0;n=pa(s),s=s.parentNode}}function Qb(e){return e.scrollTop>Math.max(1,e.scrollHeight-e.clientHeight-4)}class Xe{constructor(t,s,n=!0){this.node=t,this.offset=s,this.precise=n}static before(t,s){return new Xe(t.parentNode,pa(t),s)}static after(t,s){return new Xe(t.parentNode,pa(t)+1,s)}}const Uf=[];class Yt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let s=this.posAtStart;for(let n of this.children){if(n==t)return s;s+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,s){if(this.flags&2){let n=this.dom,r=null,o;for(let i of this.children){if(i.flags&7){if(!i.dom&&(o=r?r.nextSibling:n.firstChild)){let a=Yt.get(o);(!a||!a.parent&&a.canReuseDOM(i))&&i.reuseDOM(o)}i.sync(t,s),i.flags&=-8}if(o=r?r.nextSibling:n.firstChild,s&&!s.written&&s.node==n&&o!=i.dom&&(s.written=!0),i.dom.parentNode==n)for(;o&&o!=i.dom;)o=Kb(o);else n.insertBefore(i.dom,o);r=i.dom}for(o=r?r.nextSibling:n.firstChild,o&&s&&s.node==n&&(s.written=!0);o;)o=Kb(o)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(t,s),n.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,s){let n;if(t==this.dom)n=this.dom.childNodes[s];else{let r=Ln(t)==0?0:s==0?-1:1;for(;;){let o=t.parentNode;if(o==this.dom)break;r==0&&o.firstChild!=o.lastChild&&(t==o.firstChild?r=-1:r=1),t=o}r<0?n=t:n=t.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!Yt.get(n);)n=n.nextSibling;if(!n)return this.length;for(let r=0,o=0;;r++){let i=this.children[r];if(i.dom==n)return o;o+=i.length+i.breakAfter}}domBoundsAround(t,s,n=0){let r=-1,o=-1,i=-1,a=-1;for(let l=0,c=n,u=n;l<this.children.length;l++){let h=this.children[l],d=c+h.length;if(c<t&&d>s)return h.domBoundsAround(t,s,c);if(d>=t&&r==-1&&(r=l,o=c),c>s&&h.dom.parentNode==this.dom){i=l,a=u;break}u=d,c=d+h.breakAfter}return{from:o,to:a<0?n+this.length:a,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:i<this.children.length&&i>=0?this.children[i].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let s=this.parent;s;s=s.parent){if(t&&(s.flags|=2),s.flags&1)return;s.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let s=t.parent;if(!s)return t;t=s}}replaceChildren(t,s,n=Uf){this.markDirty();for(let r=t;r<s;r++){let o=this.children[r];o.parent==this&&n.indexOf(o)<0&&o.destroy()}this.children.splice(t,s-t,...n);for(let r=0;r<n.length;r++)n[r].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Jb(this.children,t,this.children.length)}childPos(t,s=1){return this.childCursor().findPos(t,s)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,s,n,r,o,i){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}Yt.prototype.breakAfter=0;function Kb(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class Jb{constructor(t,s,n){this.children=t,this.pos=s,this.i=n,this.off=0}findPos(t,s=1){for(;;){if(t>this.pos||t==this.pos&&(s>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function t1(e,t,s,n,r,o,i,a,l){let{children:c}=e,u=c.length?c[t]:null,h=o.length?o[o.length-1]:null,d=h?h.breakAfter:i;if(!(t==n&&u&&!i&&!d&&o.length<2&&u.merge(s,r,o.length?h:null,s==0,a,l))){if(n<c.length){let f=c[n];f&&(r<f.length||f.breakAfter&&(h!=null&&h.breakAfter))?(t==n&&(f=f.split(r),r=0),!d&&h&&f.merge(0,r,h,!0,0,l)?o[o.length-1]=f:((r||f.children.length&&!f.children[0].length)&&f.merge(0,r,null,!1,0,l),o.push(f))):f!=null&&f.breakAfter&&(h?h.breakAfter=1:i=1),n++}for(u&&(u.breakAfter=i,s>0&&(!i&&o.length&&u.merge(s,u.length,o[0],!1,a,0)?u.breakAfter=o.shift().breakAfter:(s<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(s,u.length,null,!1,a,0),t++));t<n&&o.length;)if(c[n-1].become(o[o.length-1]))n--,o.pop(),l=o.length?0:a;else if(c[t].become(o[0]))t++,o.shift(),a=o.length?0:l;else break;!o.length&&t&&n<c.length&&!c[t-1].breakAfter&&c[n].merge(0,0,c[t-1],!1,a,l)&&t--,(t<n||o.length)&&e.replaceChildren(t,n,o)}}function e1(e,t,s,n,r,o){let i=e.childCursor(),{i:a,off:l}=i.findPos(s,1),{i:c,off:u}=i.findPos(t,-1),h=t-s;for(let d of n)h+=d.length;e.length+=h,t1(e,c,u,a,l,n,0,r,o)}let vs=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Hf=typeof document<"u"?document:{documentElement:{style:{}}};const Wf=/Edge\/(\d+)/.exec(vs.userAgent),s1=/MSIE \d/.test(vs.userAgent),Xf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(vs.userAgent),vh=!!(s1||Xf||Wf),n1=!vh&&/gecko\/(\d+)/i.test(vs.userAgent),Yf=!vh&&/Chrome\/(\d+)/.exec(vs.userAgent),r1="webkitFontSmoothing"in Hf.documentElement.style,o1=!vh&&/Apple Computer/.test(vs.vendor),i1=o1&&(/Mobile\/\w+/.test(vs.userAgent)||vs.maxTouchPoints>2);var st={mac:i1||/Mac/.test(vs.platform),windows:/Win/.test(vs.platform),linux:/Linux|X11/.test(vs.platform),ie:vh,ie_version:s1?Hf.documentMode||6:Xf?+Xf[1]:Wf?+Wf[1]:0,gecko:n1,gecko_version:n1?+(/Firefox\/(\d+)/.exec(vs.userAgent)||[0,0])[1]:0,chrome:!!Yf,chrome_version:Yf?+Yf[1]:0,ios:i1,android:/Android\b/.test(vs.userAgent),webkit:r1,safari:o1,webkit_version:r1?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:Hf.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const hR=256;class Bn extends Yt{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,s){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(s&&s.node==this.dom&&(s.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,s,n){return this.flags&8||n&&(!(n instanceof Bn)||this.length-(s-t)+n.length>hR||n.flags&8)?!1:(this.text=this.text.slice(0,t)+(n?n.text:"")+this.text.slice(s),this.markDirty(),!0)}split(t){let s=new Bn(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),s.flags|=this.flags&8,s}localPosFromDOM(t,s){return t==this.dom?s:s?this.text.length:0}domAtPos(t){return new Xe(this.dom,t)}domBoundsAround(t,s,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,s){return cR(this.dom,t,s)}}class jn extends Yt{constructor(t,s=[],n=0){super(),this.mark=t,this.children=s,this.length=n;for(let r of s)r.setParent(this)}setAttrs(t){if(qb(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let s in this.mark.attrs)t.setAttribute(s,this.mark.attrs[s]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,s){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,s)}merge(t,s,n,r,o,i){return n&&(!(n instanceof jn&&n.mark.eq(this.mark))||t&&o<=0||s<this.length&&i<=0)?!1:(e1(this,t,s,n?n.children.slice():[],o-1,i-1),this.markDirty(),!0)}split(t){let s=[],n=0,r=-1,o=0;for(let a of this.children){let l=n+a.length;l>t&&s.push(n<t?a.split(t-n):a),r<0&&n>=t&&(r=o),n=l,o++}let i=this.length-t;return this.length=t,r>-1&&(this.children.length=r,this.markDirty()),new jn(this.mark,s,i)}domAtPos(t){return a1(this,t)}coordsAt(t,s){return h1(this,t,s)}}function cR(e,t,s){let n=e.nodeValue.length;t>n&&(t=n);let r=t,o=t,i=0;t==0&&s<0||t==n&&s>=0?st.chrome||st.gecko||(t?(r--,i=1):o<n&&(o++,i=-1)):s<0?r--:o<n&&o++;let a=Ur(e,r,o).getClientRects();if(!a.length)return null;let l=a[(i?i<0:s>=0)?0:a.length-1];return st.safari&&!i&&l.width==0&&(l=Array.prototype.find.call(a,c=>c.width)||l),i?yh(l,i<0):l||null}class hr extends Yt{static create(t,s,n){return new hr(t,s,n)}constructor(t,s,n){super(),this.widget=t,this.length=s,this.side=n,this.prevWidget=null}split(t){let s=hr.create(this.widget,this.length-t,this.side);return this.length-=t,s}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,s,n,r,o,i){return n&&(!(n instanceof hr)||!this.widget.compare(n.widget)||t>0&&o<=0||s<this.length&&i<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-s),!0)}become(t){return t instanceof hr&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return Rt.empty;let t=this;for(;t.parent;)t=t.parent;let{view:s}=t,n=s&&s.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):Rt.empty}domAtPos(t){return(this.length?t==0:this.side>0)?Xe.before(this.dom):Xe.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,s){let n=this.widget.coordsAt(this.dom,t,s);if(n)return n;let r=this.dom.getClientRects(),o=null;if(!r.length)return null;let i=this.side?this.side<0:t>0;for(let a=i?r.length-1:0;o=r[a],!(t>0?a==0:a==r.length-1||o.top<o.bottom);a+=i?-1:1);return yh(o,!i)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Qo extends Yt{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Qo&&t.side==this.side}split(){return new Qo(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?Xe.before(this.dom):Xe.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Rt.empty}get isHidden(){return!0}}Bn.prototype.children=hr.prototype.children=Qo.prototype.children=Uf;function a1(e,t){let s=e.dom,{children:n}=e,r=0;for(let o=0;r<n.length;r++){let i=n[r],a=o+i.length;if(!(a==o&&i.getSide()<=0)){if(t>o&&t<a&&i.dom.parentNode==s)return i.domAtPos(t-o);if(t<=o)break;o=a}}for(let o=r;o>0;o--){let i=n[o-1];if(i.dom.parentNode==s)return i.domAtPos(i.length)}for(let o=r;o<n.length;o++){let i=n[o];if(i.dom.parentNode==s)return i.domAtPos(0)}return new Xe(s,0)}function l1(e,t,s){let n,{children:r}=e;s>0&&t instanceof jn&&r.length&&(n=r[r.length-1])instanceof jn&&n.mark.eq(t.mark)?l1(n,t.children[0],s-1):(r.push(t),t.setParent(e)),e.length+=t.length}function h1(e,t,s){let n=null,r=-1,o=null,i=-1;function a(c,u){for(let h=0,d=0;h<c.children.length&&d<=u;h++){let f=c.children[h],p=d+f.length;p>=u&&(f.children.length?a(f,u-d):(!o||o.isHidden&&s>0)&&(p>u||d==p&&f.getSide()>0)?(o=f,i=u-d):(d<u||d==p&&f.getSide()<0&&!f.isHidden)&&(n=f,r=u-d)),d=p}}a(e,t);let l=(s<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?r:i),s):uR(e)}function uR(e){let t=e.dom.lastChild;if(!t)return e.dom.getBoundingClientRect();let s=Yo(t);return s[s.length-1]||null}function Zf(e,t){for(let s in e)s=="class"&&t.class?t.class+=" "+e.class:s=="style"&&t.style?t.style+=";"+e.style:t[s]=e[s];return t}const c1=Object.create(null);function qf(e,t,s){if(e==t)return!0;e||(e=c1),t||(t=c1);let n=Object.keys(e),r=Object.keys(t);if(n.length-(s&&n.indexOf(s)>-1?1:0)!=r.length-(s&&r.indexOf(s)>-1?1:0))return!1;for(let o of n)if(o!=s&&(r.indexOf(o)==-1||e[o]!==t[o]))return!1;return!0}function Qf(e,t,s){let n=!1;if(t)for(let r in t)s&&r in s||(n=!0,r=="style"?e.style.cssText="":e.removeAttribute(r));if(s)for(let r in s)t&&t[r]==s[r]||(n=!0,r=="style"?e.style.cssText=s[r]:e.setAttribute(r,s[r]));return n}function dR(e){let t=Object.create(null);for(let s=0;s<e.attributes.length;s++){let n=e.attributes[s];t[n.name]=n.value}return t}class _e extends Yt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,s,n,r,o,i){if(n){if(!(n instanceof _e))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),e1(this,t,s,n?n.children.slice():[],o,i),!0}split(t){let s=new _e;if(s.breakAfter=this.breakAfter,this.length==0)return s;let{i:n,off:r}=this.childPos(t);r&&(s.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let o=n;o<this.children.length;o++)s.append(this.children[o],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=t,s}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){qf(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,s){l1(this,t,s)}addLineDeco(t){let s=t.spec.attributes,n=t.spec.class;s&&(this.attrs=Zf(s,this.attrs||{})),n&&(this.attrs=Zf({class:n},this.attrs||{}))}domAtPos(t){return a1(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,s){var n;this.dom?this.flags&4&&(qb(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Qf(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,s);let r=this.dom.lastChild;for(;r&&Yt.get(r)instanceof jn;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((n=Yt.get(r))===null||n===void 0?void 0:n.isEditable)==!1&&(!st.ios||!this.children.some(o=>o instanceof Bn))){let o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,s;for(let n of this.children){if(!(n instanceof Bn)||/[^ -~]/.test(n.text))return null;let r=Yo(n.dom);if(r.length!=1)return null;t+=r[0].width,s=r[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:s}:null}coordsAt(t,s){let n=h1(this,t,s);if(!this.children.length&&n&&this.parent){let{heightOracle:r}=this.parent.view.viewState,o=n.bottom-n.top;if(Math.abs(o-r.lineHeight)<2&&r.textHeight<o){let i=(o-r.textHeight)/2;return{top:n.top+i,bottom:n.bottom-i,left:n.left,right:n.left}}}return n}become(t){return!1}covers(){return!0}static find(t,s){for(let n=0,r=0;n<t.children.length;n++){let o=t.children[n],i=r+o.length;if(i>=s){if(o instanceof _e)return o;if(i>s)break}r=i+o.breakAfter}return null}}class cr extends Yt{constructor(t,s,n){super(),this.widget=t,this.length=s,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(t,s,n,r,o,i){return n&&(!(n instanceof cr)||!this.widget.compare(n.widget)||t>0&&o<=0||s<this.length&&i<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-s),!0)}domAtPos(t){return t==0?Xe.before(this.dom):Xe.after(this.dom,t==this.length)}split(t){let s=this.length-t;this.length=t;let n=new cr(this.widget,s,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return Uf}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Rt.empty}domBoundsAround(){return null}become(t){return t instanceof cr&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,s){return this.widget.coordsAt(this.dom,t,s)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:s,endSide:n}=this.deco;return s==n?!1:t<0?s<0:n>0}}class Fn{eq(t){return!1}updateDOM(t,s){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,s,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var rs=function(e){return e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",e}(rs||(rs={}));class ut extends Gr{constructor(t,s,n,r){super(),this.startSide=t,this.endSide=s,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(t){return new ma(t)}static widget(t){let s=Math.max(-1e4,Math.min(1e4,t.side||0)),n=!!t.block;return s+=n&&!t.inlineOrder?s>0?3e8:-4e8:s>0?1e8:-1e8,new ur(t,s,s,n,t.widget||null,!1)}static replace(t){let s=!!t.block,n,r;if(t.isBlockGap)n=-5e8,r=4e8;else{let{start:o,end:i}=u1(t,s);n=(o?s?-3e8:-1:5e8)-1,r=(i?s?2e8:1:-6e8)+1}return new ur(t,n,r,s,t.widget||null,!0)}static line(t){return new ga(t)}static set(t,s=!1){return $t.of(t,s)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ut.none=$t.empty;class ma extends ut{constructor(t){let{start:s,end:n}=u1(t);super(s?-1:5e8,n?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var s,n;return this==t||t instanceof ma&&this.tagName==t.tagName&&(this.class||((s=this.attrs)===null||s===void 0?void 0:s.class))==(t.class||((n=t.attrs)===null||n===void 0?void 0:n.class))&&qf(this.attrs,t.attrs,"class")}range(t,s=t){if(t>=s)throw new RangeError("Mark decorations may not be empty");return super.range(t,s)}}ma.prototype.point=!1;class ga extends ut{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof ga&&this.spec.class==t.spec.class&&qf(this.spec.attributes,t.spec.attributes)}range(t,s=t){if(s!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,s)}}ga.prototype.mapMode=ns.TrackBefore,ga.prototype.point=!0;class ur extends ut{constructor(t,s,n,r,o,i){super(s,n,o,t),this.block=r,this.isReplace=i,this.mapMode=r?s<=0?ns.TrackBefore:ns.TrackAfter:ns.TrackDel}get type(){return this.startSide!=this.endSide?rs.WidgetRange:this.startSide<=0?rs.WidgetBefore:rs.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof ur&&fR(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,s=t){if(this.isReplace&&(t>s||t==s&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&s!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,s)}}ur.prototype.point=!0;function u1(e,t=!1){let{inclusiveStart:s,inclusiveEnd:n}=e;return s==null&&(s=e.inclusive),n==null&&(n=e.inclusive),{start:s??t,end:n??t}}function fR(e,t){return e==t||!!(e&&t&&e.compare(t))}function Kf(e,t,s,n=0){let r=s.length-1;r>=0&&s[r]+n>=e?s[r]=Math.max(s[r],t):s.push(e,t)}class ya{constructor(t,s,n,r){this.doc=t,this.pos=s,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=s}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof cr&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new _e),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(bh(new Qo(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof cr)&&this.getLine()}buildText(t,s,n){for(;t>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:i,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=o,this.textOff=0}let r=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(s.slice(s.length-n)),this.getLine().append(bh(new Bn(this.text.slice(this.textOff,this.textOff+r)),s),n),this.atCursorPos=!0,this.textOff+=r,t-=r,n=0}}span(t,s,n,r){this.buildText(s-t,n,r),this.pos=s,this.openStart<0&&(this.openStart=r)}point(t,s,n,r,o,i){if(this.disallowBlockEffectsFor[i]&&n instanceof ur){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(s>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=s-t;if(n instanceof ur)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new cr(n.widget||new d1("div"),a,n));else{let l=hr.create(n.widget||new d1("span"),a,a?0:n.startSide),c=this.atCursorPos&&!l.isEditable&&o<=r.length&&(t<s||n.startSide>0),u=!l.isEditable&&(t<s||o>r.length||n.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),c&&(h.append(bh(new Qo(1),r),o),o=r.length+Math.max(0,o-r.length)),h.append(bh(l,r),o),this.atCursorPos=u,this.pendingBuffer=u?t<s||o>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=s),this.openStart<0&&(this.openStart=o)}static build(t,s,n,r,o){let i=new ya(t,s,n,o);return i.openEnd=$t.spans(r,s,n,i),i.openStart<0&&(i.openStart=i.openEnd),i.finish(i.openEnd),i}}function bh(e,t){for(let s of t)e=new jn(s,[e],e.length);return e}class d1 extends Fn{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}var Zt=function(e){return e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e}(Zt||(Zt={}));const Hr=Zt.LTR,Jf=Zt.RTL;function f1(e){let t=[];for(let s=0;s<e.length;s++)t.push(1<<+e[s]);return t}const pR=f1("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),mR=f1("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),tp=Object.create(null),mn=[];for(let e of["()","[]","{}"]){let t=e.charCodeAt(0),s=e.charCodeAt(1);tp[t]=s,tp[s]=-t}function p1(e){return e<=247?pR[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?mR[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8204?256:64336<=e&&e<=65023?4:1}const gR=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class dr{get dir(){return this.level%2?Jf:Hr}constructor(t,s,n){this.from=t,this.to=s,this.level=n}side(t,s){return this.dir==s==t?this.to:this.from}forward(t,s){return t==(this.dir==s)}static find(t,s,n,r){let o=-1;for(let i=0;i<t.length;i++){let a=t[i];if(a.from<=s&&a.to>=s){if(a.level==n)return i;(o<0||(r!=0?r<0?a.from<s:a.to>s:t[o].level>a.level))&&(o=i)}}if(o<0)throw new RangeError("Index out of range");return o}}function m1(e,t){if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++){let n=e[s],r=t[s];if(n.from!=r.from||n.to!=r.to||n.direction!=r.direction||!m1(n.inner,r.inner))return!1}return!0}const zt=[];function yR(e,t,s,n,r){for(let o=0;o<=n.length;o++){let i=o?n[o-1].to:t,a=o<n.length?n[o].from:s,l=o?256:r;for(let c=i,u=l,h=l;c<a;c++){let d=p1(e.charCodeAt(c));d==512?d=u:d==8&&h==4&&(d=16),zt[c]=d==4?2:d,d&7&&(h=d),u=d}for(let c=i,u=l,h=l;c<a;c++){let d=zt[c];if(d==128)c<a-1&&u==zt[c+1]&&u&24?d=zt[c]=u:zt[c]=256;else if(d==64){let f=c+1;for(;f<a&&zt[f]==64;)f++;let p=c&&u==8||f<s&&zt[f]==8?h==1?1:8:256;for(let g=c;g<f;g++)zt[g]=p;c=f-1}else d==8&&h==1&&(zt[c]=1);u=d,d&7&&(h=d)}}}function vR(e,t,s,n,r){let o=r==1?2:1;for(let i=0,a=0,l=0;i<=n.length;i++){let c=i?n[i-1].to:t,u=i<n.length?n[i].from:s;for(let h=c,d,f,p;h<u;h++)if(f=tp[d=e.charCodeAt(h)])if(f<0){for(let g=a-3;g>=0;g-=3)if(mn[g+1]==-f){let m=mn[g+2],y=m&2?r:m&4?m&1?o:r:0;y&&(zt[h]=zt[mn[g]]=y),a=g;break}}else{if(mn.length==189)break;mn[a++]=h,mn[a++]=d,mn[a++]=l}else if((p=zt[h])==2||p==1){let g=p==r;l=g?0:1;for(let m=a-3;m>=0;m-=3){let y=mn[m+2];if(y&2)break;if(g)mn[m+2]|=2;else{if(y&4)break;mn[m+2]|=4}}}}}function bR(e,t,s,n){for(let r=0,o=n;r<=s.length;r++){let i=r?s[r-1].to:e,a=r<s.length?s[r].from:t;for(let l=i;l<a;){let c=zt[l];if(c==256){let u=l+1;for(;;)if(u==a){if(r==s.length)break;u=s[r++].to,a=r<s.length?s[r].from:t}else if(zt[u]==256)u++;else break;let h=o==1,d=(u<t?zt[u]:n)==1,f=h==d?h?1:2:n;for(let p=u,g=r,m=g?s[g-1].to:e;p>l;)p==m&&(p=s[--g].from,m=g?s[g-1].to:e),zt[--p]=f;l=u}else o=c,l++}}}function ep(e,t,s,n,r,o,i){let a=n%2?2:1;if(n%2==r%2)for(let l=t,c=0;l<s;){let u=!0,h=!1;if(c==o.length||l<o[c].from){let g=zt[l];g!=a&&(u=!1,h=g==16)}let d=!u&&a==1?[]:null,f=u?n:n+1,p=l;t:for(;;)if(c<o.length&&p==o[c].from){if(h)break t;let g=o[c];if(!u)for(let m=g.to,y=c+1;;){if(m==s)break t;if(y<o.length&&o[y].from==m)m=o[y++].to;else{if(zt[m]==a)break t;break}}if(c++,d)d.push(g);else{g.from>l&&i.push(new dr(l,g.from,f));let m=g.direction==Hr!=!(f%2);sp(e,m?n+1:n,r,g.inner,g.from,g.to,i),l=g.to}p=g.to}else{if(p==s||(u?zt[p]!=a:zt[p]==a))break;p++}d?ep(e,l,p,n+1,r,d,i):l<p&&i.push(new dr(l,p,f)),l=p}else for(let l=s,c=o.length;l>t;){let u=!0,h=!1;if(!c||l>o[c-1].to){let g=zt[l-1];g!=a&&(u=!1,h=g==16)}let d=!u&&a==1?[]:null,f=u?n:n+1,p=l;t:for(;;)if(c&&p==o[c-1].to){if(h)break t;let g=o[--c];if(!u)for(let m=g.from,y=c;;){if(m==t)break t;if(y&&o[y-1].to==m)m=o[--y].from;else{if(zt[m-1]==a)break t;break}}if(d)d.push(g);else{g.to<l&&i.push(new dr(g.to,l,f));let m=g.direction==Hr!=!(f%2);sp(e,m?n+1:n,r,g.inner,g.from,g.to,i),l=g.from}p=g.from}else{if(p==t||(u?zt[p-1]!=a:zt[p-1]==a))break;p--}d?ep(e,p,l,n+1,r,d,i):p<l&&i.push(new dr(p,l,f)),l=p}}function sp(e,t,s,n,r,o,i){let a=t%2?2:1;yR(e,r,o,n,a),vR(e,r,o,n,a),bR(r,o,n,a),ep(e,r,o,t,s,n,i)}function wR(e,t,s){if(!e)return[new dr(0,0,t==Jf?1:0)];if(t==Hr&&!s.length&&!gR.test(e))return g1(e.length);if(s.length)for(;e.length>zt.length;)zt[zt.length]=256;let n=[],r=t==Hr?0:1;return sp(e,r,r,s,0,e.length,n),n}function g1(e){return[new dr(0,e,0)]}let y1="";function xR(e,t,s,n,r){var o;let i=n.head-e.from,a=dr.find(t,i,(o=n.bidiLevel)!==null&&o!==void 0?o:-1,n.assoc),l=t[a],c=l.side(r,s);if(i==c){let d=a+=r?1:-1;if(d<0||d>=t.length)return null;l=t[a=d],i=l.side(!r,s),c=l.side(r,s)}let u=Re(e.text,i,l.forward(r,s));(u<l.from||u>l.to)&&(u=c),y1=e.text.slice(Math.min(i,u),Math.max(i,u));let h=a==(r?t.length-1:0)?null:t[a+(r?1:-1)];return h&&u==c&&h.level+(r?0:1)<l.level?W.cursor(h.side(!r,s)+e.from,h.forward(r,s)?1:-1,h.level):W.cursor(u+e.from,l.forward(r,s)?-1:1,l.level)}function _R(e,t,s){for(let n=t;n<s;n++){let r=p1(e.charCodeAt(n));if(r==1)return Hr;if(r==2||r==4)return Jf}return Hr}const v1=tt.define(),b1=tt.define(),w1=tt.define(),x1=tt.define(),np=tt.define(),_1=tt.define(),A1=tt.define(),k1=tt.define({combine:e=>e.some(t=>t)}),S1=tt.define({combine:e=>e.some(t=>t)});class Ko{constructor(t,s="nearest",n="nearest",r=5,o=5,i=!1){this.range=t,this.y=s,this.x=n,this.yMargin=r,this.xMargin=o,this.isSnapshot=i}map(t){return t.empty?this:new Ko(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Ko(W.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const wh=bt.define({map:(e,t)=>e.map(t)});function Ms(e,t,s){let n=e.facet(x1);n.length?n[0](t):window.onerror?window.onerror(String(t),s,void 0,void 0,t):s?console.error(s+":",t):console.error(t)}const xh=tt.define({combine:e=>e.length?e[0]:!0});let AR=0;const va=tt.define();class ie{constructor(t,s,n,r,o){this.id=t,this.create=s,this.domEventHandlers=n,this.domEventObservers=r,this.extension=o(this)}static define(t,s){const{eventHandlers:n,eventObservers:r,provide:o,decorations:i}=s||{};return new ie(AR++,t,n,r,a=>{let l=[va.of(a)];return i&&l.push(ba.of(c=>{let u=c.plugin(a);return u?i(u):ut.none})),o&&l.push(o(a)),l})}static fromClass(t,s){return ie.define(n=>new t(n),s)}}class rp{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let s=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(s)}catch(n){if(Ms(s.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(s){Ms(t.state,s,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var s;if(!((s=this.value)===null||s===void 0)&&s.destroy)try{this.value.destroy()}catch(n){Ms(t.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const C1=tt.define(),op=tt.define(),ba=tt.define(),O1=tt.define(),ip=tt.define(),T1=tt.define();function P1(e,t){let s=e.state.facet(T1);if(!s.length)return s;let n=s.map(o=>o instanceof Function?o(e):o),r=[];return $t.spans(n,t.from,t.to,{point(){},span(o,i,a,l){let c=o-t.from,u=i-t.from,h=r;for(let d=a.length-1;d>=0;d--,l--){let f=a[d].spec.bidiIsolate,p;if(f==null&&(f=_R(t.text,c,u)),l>0&&h.length&&(p=h[h.length-1]).to==c&&p.direction==f)p.to=u,h=p.inner;else{let g={from:c,to:u,direction:f,inner:[]};h.push(g),h=g.inner}}}}),r}const M1=tt.define();function I1(e){let t=0,s=0,n=0,r=0;for(let o of e.state.facet(M1)){let i=o(e);i&&(i.left!=null&&(t=Math.max(t,i.left)),i.right!=null&&(s=Math.max(s,i.right)),i.top!=null&&(n=Math.max(n,i.top)),i.bottom!=null&&(r=Math.max(r,i.bottom)))}return{left:t,right:s,top:n,bottom:r}}const wa=tt.define();class Is{constructor(t,s,n,r){this.fromA=t,this.toA=s,this.fromB=n,this.toB=r}join(t){return new Is(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let s=t.length,n=this;for(;s>0;s--){let r=t[s-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),t.splice(s-1,1)}}return t.splice(s,0,n),t}static extendWithRanges(t,s){if(s.length==0)return t;let n=[];for(let r=0,o=0,i=0,a=0;;r++){let l=r==t.length?null:t[r],c=i-a,u=l?l.fromB:1e9;for(;o<s.length&&s[o]<u;){let h=s[o],d=s[o+1],f=Math.max(a,h),p=Math.min(u,d);if(f<=p&&new Is(f+c,p+c,f,p).addToSet(n),d>u)break;o+=2}if(!l)return n;new Is(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),i=l.toA,a=l.toB}}}class _h{constructor(t,s,n){this.view=t,this.state=s,this.transactions=n,this.flags=0,this.startState=t.state,this.changes=we.empty(this.startState.doc.length);for(let o of n)this.changes=this.changes.compose(o.changes);let r=[];this.changes.iterChangedRanges((o,i,a,l)=>r.push(new Is(o,i,a,l))),this.changedRanges=r}static create(t,s,n){return new _h(t,s,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class E1 extends Yt{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new _e],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Is(0,0,0,t.state.doc.length)],0,null)}update(t){var s;let n=t.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let r=-1;this.view.inputState.composing>=0&&(!((s=this.domChanged)===null||s===void 0)&&s.newSel?r=this.domChanged.newSel.head:!MR(t.changes,this.hasComposition)&&!t.selectionSet&&(r=t.state.selection.main.head));let o=r>-1?SR(this.view,t.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;n=new Is(c,u,t.changes.mapPos(c,-1),t.changes.mapPos(u,1)).addToSet(n.slice())}this.hasComposition=o?{from:o.range.fromB,to:o.range.toB}:null,(st.ie||st.chrome)&&!o&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,a=this.updateDeco(),l=TR(i,a,t.changes);return n=Is.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,t.startState.doc.length,o),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,s,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,s,n);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let i=st.chrome||st.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,i),this.flags&=-8,i&&(i.written||r.selectionRange.focusNode!=i.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(i=>i.flags&=-9);let o=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let i of this.children)i instanceof cr&&i.widget instanceof $1&&o.push(i.dom);r.updateGaps(o)}updateChildren(t,s,n){let r=n?n.range.addToSet(t.slice()):t,o=this.childCursor(s);for(let i=r.length-1;;i--){let a=i>=0?r[i]:null;if(!a)break;let{fromA:l,toA:c,fromB:u,toB:h}=a,d,f,p,g;if(n&&n.range.fromB<h&&n.range.toB>u){let w=ya.build(this.view.state.doc,u,n.range.fromB,this.decorations,this.dynamicDecorationMap),S=ya.build(this.view.state.doc,n.range.toB,h,this.decorations,this.dynamicDecorationMap);f=w.breakAtStart,p=w.openStart,g=S.openEnd;let _=this.compositionView(n);S.breakAtStart?_.breakAfter=1:S.content.length&&_.merge(_.length,_.length,S.content[0],!1,S.openStart,0)&&(_.breakAfter=S.content[0].breakAfter,S.content.shift()),w.content.length&&_.merge(0,0,w.content[w.content.length-1],!0,0,w.openEnd)&&w.content.pop(),d=w.content.concat(_).concat(S.content)}else({content:d,breakAtStart:f,openStart:p,openEnd:g}=ya.build(this.view.state.doc,u,h,this.decorations,this.dynamicDecorationMap));let{i:m,off:y}=o.findPos(c,1),{i:v,off:b}=o.findPos(l,-1);t1(this,v,b,m,y,d,f,p,g)}n&&this.fixCompositionDOM(n)}compositionView(t){let s=new Bn(t.text.nodeValue);s.flags|=8;for(let{deco:r}of t.marks)s=new jn(r,[s],s.length);let n=new _e;return n.append(s,0),n}fixCompositionDOM(t){let s=(o,i)=>{i.flags|=8|(i.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(i);let a=Yt.get(o);a&&a!=i&&(a.dom=null),i.setDOM(o)},n=this.childPos(t.range.fromB,1),r=this.children[n.i];s(t.line,r);for(let o=t.marks.length-1;o>=-1;o--)n=r.childPos(n.off,1),r=r.children[n.i],s(o>=0?t.marks[o].node:t.text,r)}updateSelection(t=!1,s=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,r=n==this.dom,o=!r&&gh(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(r||s||o))return;let i=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),c=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(st.gecko&&a.empty&&!this.hasComposition&&kR(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=c=new Xe(h,0),i=!0}let u=this.view.observer.selectionRange;(i||!u.focusNode||(!fa(l.node,l.offset,u.anchorNode,u.anchorOffset)||!fa(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,a))&&(this.view.observer.ignore(()=>{st.android&&st.chrome&&this.dom.contains(u.focusNode)&&PR(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=mh(this.view.root);if(h)if(a.empty){if(st.gecko){let d=CR(l.node,l.offset);if(d&&d!=3){let f=D1(l.node,l.offset,d==1?1:-1);f&&(l=new Xe(f.node,f.offset))}}h.collapse(l.node,l.offset),a.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=a.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(c.node,c.offset)}catch{}}else{let d=document.createRange();a.anchor>a.head&&([l,c]=[c,l]),d.setEnd(c.node,c.offset),d.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(d)}o&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new Xe(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new Xe(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(t,s){return this.hasComposition&&s.empty&&fa(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==s.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,s=t.state.selection.main,n=mh(t.root),{anchorNode:r,anchorOffset:o}=t.observer.selectionRange;if(!n||!s.empty||!s.assoc||!n.modify)return;let i=_e.find(this,s.head);if(!i)return;let a=i.posAtStart;if(s.head==a||s.head==a+i.length)return;let l=this.coordsAt(s.head,-1),c=this.coordsAt(s.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(s.head+s.assoc);n.collapse(u.node,u.offset),n.modify("move",s.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let h=t.observer.selectionRange;t.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=s.from&&n.collapse(r,o)}moveToLine(t){let s=this.dom,n;if(t.node!=s)return t;for(let r=t.offset;!n&&r<s.childNodes.length;r++){let o=Yt.get(s.childNodes[r]);o instanceof _e&&(n=o.domAtPos(0))}for(let r=t.offset-1;!n&&r>=0;r--){let o=Yt.get(s.childNodes[r]);o instanceof _e&&(n=o.domAtPos(o.length))}return n?new Xe(n.node,n.offset,!0):t}nearest(t){for(let s=t;s;){let n=Yt.get(s);if(n&&n.rootView==this)return n;s=s.parentNode}return null}posFromDOM(t,s){let n=this.nearest(t);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(t,s)+n.posAtStart}domAtPos(t){let{i:s,off:n}=this.childCursor().findPos(t,-1);for(;s<this.children.length-1;){let r=this.children[s];if(n<r.length||r instanceof _e)break;s++,n=0}return this.children[s].domAtPos(n)}coordsAt(t,s){let n=null,r=0;for(let o=this.length,i=this.children.length-1;i>=0;i--){let a=this.children[i],l=o-a.breakAfter,c=l-a.length;if(l<t)break;c<=t&&(c<t||a.covers(-1))&&(l>t||a.covers(1))&&(!n||a instanceof _e&&!(n instanceof _e&&s>=0))&&(n=a,r=c),o=c}return n?n.coordsAt(t-r,s):null}coordsForChar(t){let{i:s,off:n}=this.childPos(t,1),r=this.children[s];if(!(r instanceof _e))return null;for(;r.children.length;){let{i:a,off:l}=r.childPos(n,1);for(;;a++){if(a==r.children.length)return null;if((r=r.children[a]).length)break}n=l}if(!(r instanceof Bn))return null;let o=Re(r.text,n);if(o==n)return null;let i=Ur(r.dom,n,o).getClientRects();for(let a=0;a<i.length;a++){let l=i[a];if(a==i.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(t){let s=[],{from:n,to:r}=t,o=this.view.contentDOM.clientWidth,i=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==Zt.LTR;for(let c=0,u=0;u<this.children.length;u++){let h=this.children[u],d=c+h.length;if(d>r)break;if(c>=n){let f=h.dom.getBoundingClientRect();if(s.push(f.height),i){let p=h.dom.lastChild,g=p?Yo(p):[];if(g.length){let m=g[g.length-1],y=l?m.right-f.left:f.right-m.left;y>a&&(a=y,this.minWidth=o,this.minWidthFrom=c,this.minWidthTo=d)}}}c=d+h.breakAfter}return s}textDirectionAt(t){let{i:s}=this.childPos(t,1);return getComputedStyle(this.children[s].dom).direction=="rtl"?Zt.RTL:Zt.LTR}measureTextSize(){for(let o of this.children)if(o instanceof _e){let i=o.measureTextSize();if(i)return i}let t=document.createElement("div"),s,n,r;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let o=Yo(t.firstChild)[0];s=t.getBoundingClientRect().height,n=o?o.width/27:7,r=o?o.height:s,t.remove()}),{lineHeight:s,charWidth:n,textHeight:r}}childCursor(t=this.length){let s=this.children.length;return s&&(t-=this.children[--s].length),new Jb(this.children,t,s)}computeBlockGapDeco(){let t=[],s=this.view.viewState;for(let n=0,r=0;;r++){let o=r==s.viewports.length?null:s.viewports[r],i=o?o.from-1:this.length;if(i>n){let a=(s.lineBlockAt(i).bottom-s.lineBlockAt(n).top)/this.view.scaleY;t.push(ut.replace({widget:new $1(a),block:!0,inclusive:!0,isBlockGap:!0}).range(n,i))}if(!o)break;n=o.to+1}return ut.set(t)}updateDeco(){let t=this.view.state.facet(ba).map((r,o)=>(this.dynamicDecorationMap[o]=typeof r=="function")?r(this.view):r),s=!1,n=this.view.state.facet(O1).map((r,o)=>{let i=typeof r=="function";return i&&(s=!0),i?r(this.view):r});n.length&&(this.dynamicDecorationMap[t.length]=s,t.push($t.join(n)));for(let r=t.length;r<t.length+3;r++)this.dynamicDecorationMap[r]=!1;return this.decorations=[...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){if(t.isSnapshot){let c=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=c.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}let{range:s}=t,n=this.coordsAt(s.head,s.empty?s.assoc:s.head>s.anchor?-1:1),r;if(!n)return;!s.empty&&(r=this.coordsAt(s.anchor,s.anchor>s.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let o=I1(this.view),i={left:n.left-o.left,top:n.top-o.top,right:n.right+o.right,bottom:n.bottom+o.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;rR(this.view.scrollDOM,i,s.head<s.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,a),-a),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==Zt.LTR)}}function kR(e){return e.node.nodeType==1&&e.node.firstChild&&(e.offset==0||e.node.childNodes[e.offset-1].contentEditable=="false")&&(e.offset==e.node.childNodes.length||e.node.childNodes[e.offset].contentEditable=="false")}class $1 extends Fn{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}}function R1(e,t){let s=e.observer.selectionRange,n=s.focusNode&&D1(s.focusNode,s.focusOffset,0);if(!n)return null;let r=t-n.offset;return{from:r,to:r+n.node.nodeValue.length,node:n.node}}function SR(e,t,s){let n=R1(e,s);if(!n)return null;let{node:r,from:o,to:i}=n,a=r.nodeValue;if(/[\n\r]/.test(a)||e.state.doc.sliceString(n.from,n.to)!=a)return null;let l=t.invertedDesc,c=new Is(l.mapPos(o),l.mapPos(i),o,i),u=[];for(let h=r.parentNode;;h=h.parentNode){let d=Yt.get(h);if(d instanceof jn)u.push({node:h,deco:d.mark});else{if(d instanceof _e||h.nodeName=="DIV"&&h.parentNode==e.contentDOM)return{range:c,text:r,marks:u,line:h};if(h!=e.contentDOM)u.push({node:h,deco:new ma({inclusive:!0,attributes:dR(h),tagName:h.tagName.toLowerCase()})});else return null}}}function D1(e,t,s){if(s<=0)for(let n=e,r=t;;){if(n.nodeType==3)return{node:n,offset:r};if(n.nodeType==1&&r>0)n=n.childNodes[r-1],r=Ln(n);else break}if(s>=0)for(let n=e,r=t;;){if(n.nodeType==3)return{node:n,offset:r};if(n.nodeType==1&&r<n.childNodes.length&&s>=0)n=n.childNodes[r],r=0;else break}return null}function CR(e,t){return e.nodeType!=1?0:(t&&e.childNodes[t-1].contentEditable=="false"?1:0)|(t<e.childNodes.length&&e.childNodes[t].contentEditable=="false"?2:0)}let OR=class{constructor(){this.changes=[]}compareRange(e,t){Kf(e,t,this.changes)}comparePoint(e,t){Kf(e,t,this.changes)}};function TR(e,t,s){let n=new OR;return $t.compare(e,t,s,n),n.changes}function PR(e,t){for(let s=e;s&&s!=t;s=s.assignedSlot||s.parentNode)if(s.nodeType==1&&s.contentEditable=="false")return!0;return!1}function MR(e,t){let s=!1;return t&&e.iterChangedRanges((n,r)=>{n<t.to&&r>t.from&&(s=!0)}),s}function IR(e,t,s=1){let n=e.charCategorizer(t),r=e.doc.lineAt(t),o=t-r.from;if(r.length==0)return W.cursor(t);o==0?s=1:o==r.length&&(s=-1);let i=o,a=o;s<0?i=Re(r.text,o,!1):a=Re(r.text,o);let l=n(r.text.slice(i,a));for(;i>0;){let c=Re(r.text,i,!1);if(n(r.text.slice(c,i))!=l)break;i=c}for(;a<r.length;){let c=Re(r.text,a);if(n(r.text.slice(a,c))!=l)break;a=c}return W.range(i+r.from,a+r.from)}function ER(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function $R(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function ap(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function N1(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function L1(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function lp(e,t,s){let n,r,o,i,a=!1,l,c,u,h;for(let p=e.firstChild;p;p=p.nextSibling){let g=Yo(p);for(let m=0;m<g.length;m++){let y=g[m];r&&ap(r,y)&&(y=N1(L1(y,r.bottom),r.top));let v=ER(t,y),b=$R(s,y);if(v==0&&b==0)return p.nodeType==3?B1(p,t,s):lp(p,t,s);if(!n||i>b||i==b&&o>v){n=p,r=y,o=v,i=b;let w=b?s<y.top?-1:1:v?t<y.left?-1:1:0;a=!w||(w>0?m<g.length-1:m>0)}v==0?s>y.bottom&&(!u||u.bottom<y.bottom)?(l=p,u=y):s<y.top&&(!h||h.top>y.top)&&(c=p,h=y):u&&ap(u,y)?u=L1(u,y.bottom):h&&ap(h,y)&&(h=N1(h,y.top))}}if(u&&u.bottom>=s?(n=l,r=u):h&&h.top<=s&&(n=c,r=h),!n)return{node:e,offset:0};let d=Math.max(r.left,Math.min(r.right,t));if(n.nodeType==3)return B1(n,d,s);if(a&&n.contentEditable!="false")return lp(n,d,s);let f=Array.prototype.indexOf.call(e.childNodes,n)+(t>=(r.left+r.right)/2?1:0);return{node:e,offset:f}}function B1(e,t,s){let n=e.nodeValue.length,r=-1,o=1e9,i=0;for(let a=0;a<n;a++){let l=Ur(e,a,a+1).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(u.top==u.bottom)continue;i||(i=t-u.left);let h=(u.top>s?u.top-s:s-u.bottom)-1;if(u.left-1<=t&&u.right+1>=t&&h<o){let d=t>=(u.left+u.right)/2,f=d;if((st.chrome||st.gecko)&&Ur(e,a).getBoundingClientRect().left==u.right&&(f=!d),h<=0)return{node:e,offset:a+(f?1:0)};r=a+(f?1:0),o=h}}}return{node:e,offset:r>-1?r:i>0?e.nodeValue.length:0}}function j1(e,t,s,n=-1){var r,o;let i=e.contentDOM.getBoundingClientRect(),a=i.top+e.viewState.paddingTop,l,{docHeight:c}=e.viewState,{x:u,y:h}=t,d=h-a;if(d<0)return 0;if(d>c)return e.state.doc.length;for(let w=e.viewState.heightOracle.textHeight/2,S=!1;l=e.elementAtHeight(d),l.type!=rs.Text;)for(;d=n>0?l.bottom+w:l.top-w,!(d>=0&&d<=c);){if(S)return s?null:0;S=!0,n=-n}h=a+d;let f=l.from;if(f<e.viewport.from)return e.viewport.from==0?0:s?null:F1(e,i,l,u,h);if(f>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:s?null:F1(e,i,l,u,h);let p=e.dom.ownerDocument,g=e.root.elementFromPoint?e.root:p,m=g.elementFromPoint(u,h);m&&!e.contentDOM.contains(m)&&(m=null),m||(u=Math.max(i.left+1,Math.min(i.right-1,u)),m=g.elementFromPoint(u,h),m&&!e.contentDOM.contains(m)&&(m=null));let y,v=-1;if(m&&((r=e.docView.nearest(m))===null||r===void 0?void 0:r.isEditable)!=!1){if(p.caretPositionFromPoint){let w=p.caretPositionFromPoint(u,h);w&&({offsetNode:y,offset:v}=w)}else if(p.caretRangeFromPoint){let w=p.caretRangeFromPoint(u,h);w&&({startContainer:y,startOffset:v}=w,(!e.contentDOM.contains(y)||st.safari&&RR(y,v,u)||st.chrome&&DR(y,v,u))&&(y=void 0))}}if(!y||!e.docView.dom.contains(y)){let w=_e.find(e.docView,f);if(!w)return d>l.top+l.height/2?l.to:l.from;({node:y,offset:v}=lp(w.dom,u,h))}let b=e.docView.nearest(y);if(!b)return null;if(b.isWidget&&((o=b.dom)===null||o===void 0?void 0:o.nodeType)==1){let w=b.dom.getBoundingClientRect();return t.y<w.top||t.y<=w.bottom&&t.x<=(w.left+w.right)/2?b.posAtStart:b.posAtEnd}else return b.localPosFromDOM(y,v)+b.posAtStart}function F1(e,t,s,n,r){let o=Math.round((n-t.left)*e.defaultCharacterWidth);if(e.lineWrapping&&s.height>e.defaultLineHeight*1.5){let a=e.viewState.heightOracle.textHeight,l=Math.floor((r-s.top-(e.defaultLineHeight-a)*.5)/a);o+=l*e.viewState.heightOracle.lineLength}let i=e.state.sliceDoc(s.from,s.to);return s.from+jf(i,o,e.state.tabSize)}function RR(e,t,s){let n;if(e.nodeType!=3||t!=(n=e.nodeValue.length))return!1;for(let r=e.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return Ur(e,n-1,n).getBoundingClientRect().left>s}function DR(e,t,s){if(t!=0)return!1;for(let r=e;;){let o=r.parentNode;if(!o||o.nodeType!=1||o.firstChild!=r)return!1;if(o.classList.contains("cm-line"))break;r=o}let n=e.nodeType==1?e.getBoundingClientRect():Ur(e,0,Math.max(e.nodeValue.length,1)).getBoundingClientRect();return s-n.left>5}function hp(e,t){let s=e.lineBlockAt(t);if(Array.isArray(s.type)){for(let n of s.type)if(n.to>t||n.to==t&&(n.to==s.to||n.type==rs.Text))return n}return s}function NR(e,t,s,n){let r=hp(e,t.head),o=!n||r.type!=rs.Text||!(e.lineWrapping||r.widgetLineBreaks)?null:e.coordsAtPos(t.assoc<0&&t.head>r.from?t.head-1:t.head);if(o){let i=e.dom.getBoundingClientRect(),a=e.textDirectionAt(r.from),l=e.posAtCoords({x:s==(a==Zt.LTR)?i.right-1:i.left+1,y:(o.top+o.bottom)/2});if(l!=null)return W.cursor(l,s?-1:1)}return W.cursor(s?r.to:r.from,s?-1:1)}function V1(e,t,s,n){let r=e.state.doc.lineAt(t.head),o=e.bidiSpans(r),i=e.textDirectionAt(r.from);for(let a=t,l=null;;){let c=xR(r,o,i,a,s),u=y1;if(!c){if(r.number==(s?e.state.doc.lines:1))return a;u=`
`,r=e.state.doc.line(r.number+(s?1:-1)),o=e.bidiSpans(r),c=e.visualLineSide(r,!s)}if(l){if(!l(u))return a}else{if(!n)return c;l=n(u)}a=c}}function LR(e,t,s){let n=e.state.charCategorizer(t),r=n(s);return o=>{let i=n(o);return r==Kt.Space&&(r=i),r==i}}function BR(e,t,s,n){let r=t.head,o=s?1:-1;if(r==(s?e.state.doc.length:0))return W.cursor(r,t.assoc);let i=t.goalColumn,a,l=e.contentDOM.getBoundingClientRect(),c=e.coordsAtPos(r,t.assoc||-1),u=e.documentTop;if(c)i==null&&(i=c.left-l.left),a=o<0?c.top:c.bottom;else{let f=e.viewState.lineBlockAt(r);i==null&&(i=Math.min(l.right-l.left,e.defaultCharacterWidth*(r-f.from))),a=(o<0?f.top:f.bottom)+u}let h=l.left+i,d=n??e.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let p=a+(d+f)*o,g=j1(e,{x:h,y:p},!1,o);if(p<l.top||p>l.bottom||(o<0?g<r:g>r)){let m=e.docView.coordsForChar(g),y=!m||p<m.top?-1:1;return W.cursor(g,y,void 0,i)}}}function Ah(e,t,s){for(;;){let n=0;for(let r of e)r.between(t-1,t+1,(o,i,a)=>{if(t>o&&t<i){let l=n||s||(t-o<i-t?-1:1);t=l<0?o:i,n=l}});if(!n)return t}}function cp(e,t,s){let n=Ah(e.state.facet(ip).map(r=>r(e)),s.from,t.head>s.from?-1:1);return n==s.from?s:W.cursor(n,n<s.from?1:-1)}class jR{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,st.safari&&t.contentDOM.addEventListener("input",()=>null),st.gecko&&eD(t.contentDOM.ownerDocument)}handleEvent(t){!XR(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||this.runHandlers(t.type,t)}runHandlers(t,s){let n=this.handlers[t];if(n){for(let r of n.observers)r(this.view,s);for(let r of n.handlers){if(s.defaultPrevented)break;if(r(this.view,s)){s.preventDefault();break}}}}ensureHandlers(t){let s=FR(t),n=this.handlers,r=this.view.contentDOM;for(let o in s)if(o!="scroll"){let i=!s[o].handlers.length,a=n[o];a&&i!=!a.handlers.length&&(r.removeEventListener(o,this.handleEvent),a=null),a||r.addEventListener(o,this.handleEvent,{passive:i})}for(let o in n)o!="scroll"&&!s[o]&&r.removeEventListener(o,this.handleEvent);this.handlers=s}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(t.keyCode!=27&&U1.indexOf(t.keyCode)<0&&(this.view.inputState.lastEscPress=0),st.android&&st.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let s;return st.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((s=G1.find(n=>n.keyCode==t.keyCode))&&!t.ctrlKey||VR.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=s||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,qo(this.view.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:st.safari&&!st.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function z1(e,t){return(s,n)=>{try{return t.call(e,n,s)}catch(r){Ms(s.state,r)}}}function FR(e){let t=Object.create(null);function s(n){return t[n]||(t[n]={observers:[],handlers:[]})}for(let n of e){let r=n.spec;if(r&&r.domEventHandlers)for(let o in r.domEventHandlers){let i=r.domEventHandlers[o];i&&s(o).handlers.push(z1(n.value,i))}if(r&&r.domEventObservers)for(let o in r.domEventObservers){let i=r.domEventObservers[o];i&&s(o).observers.push(z1(n.value,i))}}for(let n in Xs)s(n).handlers.push(Xs[n]);for(let n in Ys)s(n).observers.push(Ys[n]);return t}const G1=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],VR="dthko",U1=[16,17,18,20,91,92,224,225],kh=6;function Sh(e){return Math.max(0,e)*.7+8}function zR(e,t){return Math.max(Math.abs(e.clientX-t.clientX),Math.abs(e.clientY-t.clientY))}class GR{constructor(t,s,n,r){this.view=t,this.startEvent=s,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=s,this.scrollParent=oR(t.contentDOM),this.atoms=t.state.facet(ip).map(i=>i(t));let o=t.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=s.shiftKey,this.multiple=t.state.facet(Mt.allowMultipleSelections)&&UR(t,s),this.dragging=WR(t,s)&&tw(s)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){var s;if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&zR(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let n=0,r=0,o=((s=this.scrollParent)===null||s===void 0?void 0:s.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},i=I1(this.view);t.clientX-i.left<=o.left+kh?n=-Sh(o.left-t.clientX):t.clientX+i.right>=o.right-kh&&(n=Sh(t.clientX-o.right)),t.clientY-i.top<=o.top+kh?r=-Sh(o.top-t.clientY):t.clientY+i.bottom>=o.bottom-kh&&(r=Sh(t.clientY-o.bottom)),this.setScrollSpeed(n,r)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,s){this.scrollSpeed={x:t,y:s},t||s?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let s=null;for(let n=0;n<t.ranges.length;n++){let r=t.ranges[n],o=null;if(r.empty){let i=Ah(this.atoms,r.from,0);i!=r.from&&(o=W.cursor(i,-1))}else{let i=Ah(this.atoms,r.from,-1),a=Ah(this.atoms,r.to,1);(i!=r.from||a!=r.to)&&(o=W.range(r.from==r.anchor?i:a,r.from==r.head?i:a))}o&&(s||(s=t.ranges.slice()),s[n]=o)}return s?W.create(s,t.mainIndex):t}select(t){let{view:s}=this,n=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!n.eq(s.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function UR(e,t){let s=e.state.facet(v1);return s.length?s[0](t):st.mac?t.metaKey:t.ctrlKey}function HR(e,t){let s=e.state.facet(b1);return s.length?s[0](t):st.mac?!t.altKey:!t.ctrlKey}function WR(e,t){let{main:s}=e.state.selection;if(s.empty)return!1;let n=mh(e.root);if(!n||n.rangeCount==0)return!0;let r=n.getRangeAt(0).getClientRects();for(let o=0;o<r.length;o++){let i=r[o];if(i.left<=t.clientX&&i.right>=t.clientX&&i.top<=t.clientY&&i.bottom>=t.clientY)return!0}return!1}function XR(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let s=t.target,n;s!=e.contentDOM;s=s.parentNode)if(!s||s.nodeType==11||(n=Yt.get(s))&&n.ignoreEvent(t))return!1;return!0}const Xs=Object.create(null),Ys=Object.create(null),H1=st.ie&&st.ie_version<15||st.ios&&st.webkit_version<604;function YR(e){let t=e.dom.parentNode;if(!t)return;let s=t.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.focus(),setTimeout(()=>{e.focus(),s.remove(),W1(e,s.value)},50)}function W1(e,t){let{state:s}=e,n,r=1,o=s.toText(t),i=o.lines==s.selection.ranges.length;if(up!=null&&s.selection.ranges.every(a=>a.empty)&&up==o.toString()){let a=-1;n=s.changeByRange(l=>{let c=s.doc.lineAt(l.from);if(c.from==a)return{range:l};a=c.from;let u=s.toText((i?o.line(r++).text:t)+s.lineBreak);return{changes:{from:c.from,insert:u},range:W.cursor(l.from+u.length)}})}else i?n=s.changeByRange(a=>{let l=o.line(r++);return{changes:{from:a.from,to:a.to,insert:l.text},range:W.cursor(a.from+l.length)}}):n=s.replaceSelection(o);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Ys.scroll=e=>{e.inputState.lastScrollTop=e.scrollDOM.scrollTop,e.inputState.lastScrollLeft=e.scrollDOM.scrollLeft},Xs.keydown=(e,t)=>(e.inputState.setSelectionOrigin("select"),t.keyCode==27&&(e.inputState.lastEscPress=Date.now()),!1),Ys.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},Ys.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},Xs.mousedown=(e,t)=>{if(e.observer.flush(),e.inputState.lastTouchTime>Date.now()-2e3)return!1;let s=null;for(let n of e.state.facet(w1))if(s=n(e,t),s)break;if(!s&&t.button==0&&(s=QR(e,t)),s){let n=!e.hasFocus;e.inputState.startMouseSelection(new GR(e,t,s,n)),n&&e.observer.ignore(()=>Yb(e.contentDOM));let r=e.inputState.mouseSelection;if(r)return r.start(t),r.dragging===!1}return!1};function X1(e,t,s,n){if(n==1)return W.cursor(t,s);if(n==2)return IR(e.state,t,s);{let r=_e.find(e.docView,t),o=e.state.doc.lineAt(r?r.posAtEnd:t),i=r?r.posAtStart:o.from,a=r?r.posAtEnd:o.to;return a<e.state.doc.length&&a==o.to&&a++,W.range(i,a)}}let Y1=(e,t)=>e>=t.top&&e<=t.bottom,Z1=(e,t,s)=>Y1(t,s)&&e>=s.left&&e<=s.right;function ZR(e,t,s,n){let r=_e.find(e.docView,t);if(!r)return 1;let o=t-r.posAtStart;if(o==0)return 1;if(o==r.length)return-1;let i=r.coordsAt(o,-1);if(i&&Z1(s,n,i))return-1;let a=r.coordsAt(o,1);return a&&Z1(s,n,a)?1:i&&Y1(n,i)?-1:1}function q1(e,t){let s=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:s,bias:ZR(e,s,t.clientX,t.clientY)}}const qR=st.ie&&st.ie_version<=11;let Q1=null,K1=0,J1=0;function tw(e){if(!qR)return e.detail;let t=Q1,s=J1;return Q1=e,J1=Date.now(),K1=!t||s>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(K1+1)%3:1}function QR(e,t){let s=q1(e,t),n=tw(t),r=e.state.selection;return{update(o){o.docChanged&&(s.pos=o.changes.mapPos(s.pos),r=r.map(o.changes))},get(o,i,a){let l=q1(e,o),c,u=X1(e,l.pos,l.bias,n);if(s.pos!=l.pos&&!i){let h=X1(e,s.pos,s.bias,n),d=Math.min(h.from,u.from),f=Math.max(h.to,u.to);u=d<u.from?W.range(d,f):W.range(f,d)}return i?r.replaceRange(r.main.extend(u.from,u.to)):a&&n==1&&r.ranges.length>1&&(c=KR(r,l.pos))?c:a?r.addRange(u):W.create([u])}}}function KR(e,t){for(let s=0;s<e.ranges.length;s++){let{from:n,to:r}=e.ranges[s];if(n<=t&&r>=t)return W.create(e.ranges.slice(0,s).concat(e.ranges.slice(s+1)),e.mainIndex==s?0:e.mainIndex-(e.mainIndex>s?1:0))}return null}Xs.dragstart=(e,t)=>{let{selection:{main:s}}=e.state;if(t.target.draggable){let r=e.docView.nearest(t.target);if(r&&r.isWidget){let o=r.posAtStart,i=o+r.length;(o>=s.to||i<=s.from)&&(s=W.range(o,i))}}let{inputState:n}=e;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=s,t.dataTransfer&&(t.dataTransfer.setData("Text",e.state.sliceDoc(s.from,s.to)),t.dataTransfer.effectAllowed="copyMove"),!1},Xs.dragend=e=>(e.inputState.draggedContent=null,!1);function ew(e,t,s,n){if(!s)return;let r=e.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:o}=e.inputState,i=n&&o&&HR(e,t)?{from:o.from,to:o.to}:null,a={from:r,insert:s},l=e.state.changes(i?[i,a]:a);e.focus(),e.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:i?"move.drop":"input.drop"}),e.inputState.draggedContent=null}Xs.drop=(e,t)=>{if(!t.dataTransfer)return!1;if(e.state.readOnly)return!0;let s=t.dataTransfer.files;if(s&&s.length){let n=Array(s.length),r=0,o=()=>{++r==s.length&&ew(e,t,n.filter(i=>i!=null).join(e.state.lineBreak),!1)};for(let i=0;i<s.length;i++){let a=new FileReader;a.onerror=o,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(n[i]=a.result),o()},a.readAsText(s[i])}return!0}else{let n=t.dataTransfer.getData("Text");if(n)return ew(e,t,n,!0),!0}return!1},Xs.paste=(e,t)=>{if(e.state.readOnly)return!0;e.observer.flush();let s=H1?null:t.clipboardData;return s?(W1(e,s.getData("text/plain")||s.getData("text/uri-text")),!0):(YR(e),!1)};function JR(e,t){let s=e.dom.parentNode;if(!s)return;let n=s.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=t,n.focus(),n.selectionEnd=t.length,n.selectionStart=0,setTimeout(()=>{n.remove(),e.focus()},50)}function tD(e){let t=[],s=[],n=!1;for(let r of e.selection.ranges)r.empty||(t.push(e.sliceDoc(r.from,r.to)),s.push(r));if(!t.length){let r=-1;for(let{from:o}of e.selection.ranges){let i=e.doc.lineAt(o);i.number>r&&(t.push(i.text),s.push({from:i.from,to:Math.min(e.doc.length,i.to+1)})),r=i.number}n=!0}return{text:t.join(e.lineBreak),ranges:s,linewise:n}}let up=null;Xs.copy=Xs.cut=(e,t)=>{let{text:s,ranges:n,linewise:r}=tD(e.state);if(!s&&!r)return!1;up=r?s:null,t.type=="cut"&&!e.state.readOnly&&e.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=H1?null:t.clipboardData;return o?(o.clearData(),o.setData("text/plain",s),!0):(JR(e,s),!1)};const sw=Nn.define();function nw(e,t){let s=[];for(let n of e.facet(A1)){let r=n(e,t);r&&s.push(r)}return s?e.update({effects:s,annotations:sw.of(!0)}):null}function rw(e){setTimeout(()=>{let t=e.hasFocus;if(t!=e.inputState.notifiedFocused){let s=nw(e.state,t);s?e.dispatch(s):e.update([])}},10)}Ys.focus=e=>{e.inputState.lastFocusTime=Date.now(),!e.scrollDOM.scrollTop&&(e.inputState.lastScrollTop||e.inputState.lastScrollLeft)&&(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),rw(e)},Ys.blur=e=>{e.observer.clearSelectionRange(),rw(e)},Ys.compositionstart=Ys.compositionupdate=e=>{e.inputState.compositionFirstChange==null&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0)},Ys.compositionend=e=>{e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=e.observer.pendingRecords().length>0,e.inputState.compositionFirstChange=null,st.chrome&&st.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then(()=>e.observer.flush()):setTimeout(()=>{e.inputState.composing<0&&e.docView.hasComposition&&e.update([])},50)},Ys.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},Xs.beforeinput=(e,t)=>{var s;let n;if(st.chrome&&st.android&&(n=G1.find(r=>r.inputType==t.inputType))&&(e.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let r=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())},100)}return!1};const ow=new Set;function eD(e){ow.has(e)||(ow.add(e),e.addEventListener("copy",()=>{}),e.addEventListener("cut",()=>{}))}const iw=["pre-wrap","normal","pre-line","break-spaces"];class sD{constructor(t){this.lineWrapping=t,this.doc=Rt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(t,s){let n=this.doc.lineAt(s).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((s-t-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return iw.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let s=!1;for(let n=0;n<t.length;n++){let r=t[n];r<0?n++:this.heightSamples[Math.floor(r*10)]||(s=!0,this.heightSamples[Math.floor(r*10)]=!0)}return s}refresh(t,s,n,r,o,i){let a=iw.indexOf(t)>-1,l=Math.round(s)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=s,this.charWidth=n,this.textHeight=r,this.lineLength=o,l){this.heightSamples={};for(let c=0;c<i.length;c++){let u=i[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class nD{constructor(t,s){this.from=t,this.heights=s,this.index=0}get more(){return this.index<this.heights.length}}class gn{constructor(t,s,n,r,o){this.from=t,this.length=s,this.top=n,this.height=r,this._content=o}get type(){return typeof this._content=="number"?rs.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ur?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let s=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new gn(this.from,this.length+t.length,this.top,this.height+t.height,s)}}var qt=function(e){return e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight",e}(qt||(qt={}));const Ch=.001;class os{constructor(t,s,n=2){this.length=t,this.height=s,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t,s){this.height!=s&&(Math.abs(this.height-s)>Ch&&(t.heightChanged=!0),this.height=s)}replace(t,s,n){return os.of(n)}decomposeLeft(t,s){s.push(this)}decomposeRight(t,s){s.push(this)}applyChanges(t,s,n,r){let o=this,i=n.doc;for(let a=r.length-1;a>=0;a--){let{fromA:l,toA:c,fromB:u,toB:h}=r[a],d=o.lineAt(l,qt.ByPosNoHeight,n.setDoc(s),0,0),f=d.to>=c?d:o.lineAt(c,qt.ByPosNoHeight,n,0,0);for(h+=f.to-c,c=f.to;a>0&&d.from<=r[a-1].toA;)l=r[a-1].fromA,u=r[a-1].fromB,a--,l<d.from&&(d=o.lineAt(l,qt.ByPosNoHeight,n,0,0));u+=d.from-l,l=d.from;let p=dp.build(n.setDoc(i),t,u,h);o=o.replace(l,c,p)}return o.updateHeight(n,0)}static empty(){return new bs(0,0)}static of(t){if(t.length==1)return t[0];let s=0,n=t.length,r=0,o=0;for(;;)if(s==n)if(r>o*2){let a=t[s-1];a.break?t.splice(--s,1,a.left,null,a.right):t.splice(--s,1,a.left,a.right),n+=1+a.break,r-=a.size}else if(o>r*2){let a=t[n];a.break?t.splice(n,1,a.left,null,a.right):t.splice(n,1,a.left,a.right),n+=2+a.break,o-=a.size}else break;else if(r<o){let a=t[s++];a&&(r+=a.size)}else{let a=t[--n];a&&(o+=a.size)}let i=0;return t[s-1]==null?(i=1,s--):t[s]==null&&(i=1,n++),new rD(os.of(t.slice(0,s)),i,os.of(t.slice(n)))}}os.prototype.size=1;class aw extends os{constructor(t,s,n){super(t,s),this.deco=n}blockAt(t,s,n,r){return new gn(r,this.length,n,this.height,this.deco||0)}lineAt(t,s,n,r,o){return this.blockAt(0,n,r,o)}forEachLine(t,s,n,r,o,i){t<=o+this.length&&s>=o&&i(this.blockAt(0,n,r,o))}updateHeight(t,s=0,n=!1,r){return r&&r.from<=s&&r.more&&this.setHeight(t,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class bs extends aw{constructor(t,s){super(t,s,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,s,n,r){return new gn(r,this.length,n,this.height,this.breaks)}replace(t,s,n){let r=n[0];return n.length==1&&(r instanceof bs||r instanceof Be&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Be?r=new bs(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):os.of(n)}updateHeight(t,s=0,n=!1,r){return r&&r.from<=s&&r.more?this.setHeight(t,r.heights[r.index++]):(n||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Be extends os{constructor(t){super(t,0)}heightMetrics(t,s){let n=t.doc.lineAt(s).number,r=t.doc.lineAt(s+this.length).number,o=r-n+1,i,a=0;if(t.lineWrapping){let l=Math.min(this.height,t.lineHeight*o);i=l/o,this.length>o+1&&(a=(this.height-l)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:r,perLine:i,perChar:a}}blockAt(t,s,n,r){let{firstLine:o,lastLine:i,perLine:a,perChar:l}=this.heightMetrics(s,r);if(s.lineWrapping){let c=r+Math.round(Math.max(0,Math.min(1,(t-n)/this.height))*this.length),u=s.doc.lineAt(c),h=a+u.length*l,d=Math.max(n,t-h/2);return new gn(u.from,u.length,d,h,0)}else{let c=Math.max(0,Math.min(i-o,Math.floor((t-n)/a))),{from:u,length:h}=s.doc.line(o+c);return new gn(u,h,n+a*c,a,0)}}lineAt(t,s,n,r,o){if(s==qt.ByHeight)return this.blockAt(t,n,r,o);if(s==qt.ByPosNoHeight){let{from:f,to:p}=n.doc.lineAt(t);return new gn(f,p-f,0,0,0)}let{firstLine:i,perLine:a,perChar:l}=this.heightMetrics(n,o),c=n.doc.lineAt(t),u=a+c.length*l,h=c.number-i,d=r+a*h+l*(c.from-o-h);return new gn(c.from,c.length,Math.max(r,Math.min(d,r+this.height-u)),u,0)}forEachLine(t,s,n,r,o,i){t=Math.max(t,o),s=Math.min(s,o+this.length);let{firstLine:a,perLine:l,perChar:c}=this.heightMetrics(n,o);for(let u=t,h=r;u<=s;){let d=n.doc.lineAt(u);if(u==t){let p=d.number-a;h+=l*p+c*(t-o-p)}let f=l+c*d.length;i(new gn(d.from,d.length,h,f,0)),h+=f,u=d.to+1}}replace(t,s,n){let r=this.length-s;if(r>0){let o=n[n.length-1];o instanceof Be?n[n.length-1]=new Be(o.length+r):n.push(null,new Be(r-1))}if(t>0){let o=n[0];o instanceof Be?n[0]=new Be(t+o.length):n.unshift(new Be(t-1),null)}return os.of(n)}decomposeLeft(t,s){s.push(new Be(t-1),null)}decomposeRight(t,s){s.push(null,new Be(this.length-t-1))}updateHeight(t,s=0,n=!1,r){let o=s+this.length;if(r&&r.from<=s+this.length&&r.more){let i=[],a=Math.max(s,r.from),l=-1;for(r.from>s&&i.push(new Be(r.from-s-1).updateHeight(t,s));a<=o&&r.more;){let u=t.doc.lineAt(a).length;i.length&&i.push(null);let h=r.heights[r.index++];l==-1?l=h:Math.abs(h-l)>=Ch&&(l=-2);let d=new bs(u,h);d.outdated=!1,i.push(d),a+=u+1}a<=o&&i.push(null,new Be(o-a).updateHeight(t,a));let c=os.of(i);return(l<0||Math.abs(c.height-this.height)>=Ch||Math.abs(l-this.heightMetrics(t,s).perLine)>=Ch)&&(t.heightChanged=!0),c}else(n||this.outdated)&&(this.setHeight(t,t.heightForGap(s,s+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class rD extends os{constructor(t,s,n){super(t.length+s+n.length,t.height+n.height,s|(t.outdated||n.outdated?2:0)),this.left=t,this.right=n,this.size=t.size+n.size}get break(){return this.flags&1}blockAt(t,s,n,r){let o=n+this.left.height;return t<o?this.left.blockAt(t,s,n,r):this.right.blockAt(t,s,o,r+this.left.length+this.break)}lineAt(t,s,n,r,o){let i=r+this.left.height,a=o+this.left.length+this.break,l=s==qt.ByHeight?t<i:t<a,c=l?this.left.lineAt(t,s,n,r,o):this.right.lineAt(t,s,n,i,a);if(this.break||(l?c.to<a:c.from>a))return c;let u=s==qt.ByPosNoHeight?qt.ByPosNoHeight:qt.ByPos;return l?c.join(this.right.lineAt(a,u,n,i,a)):this.left.lineAt(a,u,n,r,o).join(c)}forEachLine(t,s,n,r,o,i){let a=r+this.left.height,l=o+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,s,n,r,o,i),s>=l&&this.right.forEachLine(t,s,n,a,l,i);else{let c=this.lineAt(l,qt.ByPos,n,r,o);t<c.from&&this.left.forEachLine(t,c.from-1,n,r,o,i),c.to>=t&&c.from<=s&&i(c),s>c.to&&this.right.forEachLine(c.to+1,s,n,a,l,i)}}replace(t,s,n){let r=this.left.length+this.break;if(s<r)return this.balanced(this.left.replace(t,s,n),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-r,s-r,n));let o=[];t>0&&this.decomposeLeft(t,o);let i=o.length;for(let a of n)o.push(a);if(t>0&&lw(o,i-1),s<this.length){let a=o.length;this.decomposeRight(s,o),lw(o,a)}return os.of(o)}decomposeLeft(t,s){let n=this.left.length;if(t<=n)return this.left.decomposeLeft(t,s);s.push(this.left),this.break&&(n++,t>=n&&s.push(null)),t>n&&this.right.decomposeLeft(t-n,s)}decomposeRight(t,s){let n=this.left.length,r=n+this.break;if(t>=r)return this.right.decomposeRight(t-r,s);t<n&&this.left.decomposeRight(t,s),this.break&&t<r&&s.push(null),s.push(this.right)}balanced(t,s){return t.size>2*s.size||s.size>2*t.size?os.of(this.break?[t,null,s]:[t,s]):(this.left=t,this.right=s,this.height=t.height+s.height,this.outdated=t.outdated||s.outdated,this.size=t.size+s.size,this.length=t.length+this.break+s.length,this)}updateHeight(t,s=0,n=!1,r){let{left:o,right:i}=this,a=s+o.length+this.break,l=null;return r&&r.from<=s+o.length&&r.more?l=o=o.updateHeight(t,s,n,r):o.updateHeight(t,s,n),r&&r.from<=a+i.length&&r.more?l=i=i.updateHeight(t,a,n,r):i.updateHeight(t,a,n),l?this.balanced(o,i):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function lw(e,t){let s,n;e[t]==null&&(s=e[t-1])instanceof Be&&(n=e[t+1])instanceof Be&&e.splice(t-1,3,new Be(s.length+1+n.length))}const oD=5;class dp{constructor(t,s){this.pos=t,this.oracle=s,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,s){if(this.lineStart>-1){let n=Math.min(s,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof bs?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new bs(n-this.pos,-1)),this.writtenTo=n,s>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=s}point(t,s,n){if(t<s||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0,o=n.widget?n.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let i=s-t;n.block?this.addBlock(new aw(i,r,n)):(i||o||r>=oD)&&this.addLineDeco(r,o,i)}else s>t&&this.span(t,s);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:s}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=s,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new bs(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,s){let n=new Be(s-t);return this.oracle.doc.lineAt(t).to==s&&(n.flags|=4),n}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof bs)return t;let s=new bs(0,-1);return this.nodes.push(s),s}addBlock(t){this.enterLine();let s=t.deco;s&&s.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,s&&s.endSide>0&&(this.covering=t)}addLineDeco(t,s,n){let r=this.ensureLine();r.length+=n,r.collapsed+=n,r.widgetHeight=Math.max(r.widgetHeight,t),r.breaks+=s,this.writtenTo=this.pos=this.pos+n}finish(t){let s=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(s instanceof bs)&&!this.isCovered?this.nodes.push(new bs(0,-1)):(this.writtenTo<this.pos||s==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=t;for(let r of this.nodes)r instanceof bs&&r.updateHeight(this.oracle,n),n+=r?r.length:1;return this.nodes}static build(t,s,n,r){let o=new dp(n,t);return $t.spans(s,n,r,o,0),o.finish(n)}}function iD(e,t,s){let n=new aD;return $t.compare(e,t,s,n,0),n.changes}class aD{constructor(){this.changes=[]}compareRange(){}comparePoint(t,s,n,r){(t<s||n&&n.heightRelevant||r&&r.heightRelevant)&&Kf(t,s,this.changes,5)}}function lD(e,t){let s=e.getBoundingClientRect(),n=e.ownerDocument,r=n.defaultView||window,o=Math.max(0,s.left),i=Math.min(r.innerWidth,s.right),a=Math.max(0,s.top),l=Math.min(r.innerHeight,s.bottom);for(let c=e.parentNode;c&&c!=n.body;)if(c.nodeType==1){let u=c,h=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&h.overflow!="visible"){let d=u.getBoundingClientRect();o=Math.max(o,d.left),i=Math.min(i,d.right),a=Math.max(a,d.top),l=c==e.parentNode?d.bottom:Math.min(l,d.bottom)}c=h.position=="absolute"||h.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:o-s.left,right:Math.max(o,i)-s.left,top:a-(s.top+t),bottom:Math.max(a,l)-(s.top+t)}}function hD(e,t){let s=e.getBoundingClientRect();return{left:0,right:s.right-s.left,top:t,bottom:s.bottom-(s.top+t)}}class fp{constructor(t,s,n){this.from=t,this.to=s,this.size=n}static same(t,s){if(t.length!=s.length)return!1;for(let n=0;n<t.length;n++){let r=t[n],o=s[n];if(r.from!=o.from||r.to!=o.to||r.size!=o.size)return!1}return!0}draw(t,s){return ut.replace({widget:new cD(this.size*(s?t.scaleY:t.scaleX),s)}).range(this.from,this.to)}}class cD extends Fn{constructor(t,s){super(),this.size=t,this.vertical=s}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class hw{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=cw,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Zt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let s=t.facet(op).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new sD(s),this.stateDeco=t.facet(ba).filter(n=>typeof n!="function"),this.heightMap=os.empty().applyChanges(this.stateDeco,Rt.empty,this.heightOracle.setDoc(t.doc),[new Is(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ut.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:s}=this.state.selection;for(let n=0;n<=1;n++){let r=n?s.head:s.anchor;if(!t.some(({from:o,to:i})=>r>=o&&r<=i)){let{from:o,to:i}=this.lineBlockAt(r);t.push(new Oh(o,i))}}this.viewports=t.sort((n,r)=>n.from-r.from),this.scaler=this.heightMap.height<=7e6?cw:new fD(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(this.scaler.scale==1?t:xa(t,this.scaler))})}update(t,s=null){this.state=t.state;let n=this.stateDeco;this.stateDeco=this.state.facet(ba).filter(u=>typeof u!="function");let r=t.changedRanges,o=Is.extendWithRanges(r,iD(n,this.stateDeco,t?t.changes:we.empty(this.state.doc.length))),i=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),o),this.heightMap.height!=i&&(t.flags|=2),a?(this.scrollAnchorPos=t.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=o.length?this.mapViewport(this.viewport,t.changes):this.viewport;(s&&(s.range.head<l.from||s.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,s));let c=!t.changes.empty||t.flags&2||l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,this.updateForViewport(),c&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),s&&(this.scrollTarget=s),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(S1)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let s=t.contentDOM,n=window.getComputedStyle(s),r=this.heightOracle,o=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Zt.RTL:Zt.LTR;let i=this.heightOracle.mustRefreshForWrapping(o),a=s.getBoundingClientRect(),l=i||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let c=0,u=0;if(a.width&&a.height){let{scaleX:w,scaleY:S}=Xb(s,a);(this.scaleX!=w||this.scaleY!=S)&&(this.scaleX=w,this.scaleY=S,c|=8,i=l=!0)}let h=(parseInt(n.paddingTop)||0)*this.scaleY,d=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=d)&&(this.paddingTop=h,this.paddingBottom=d,c|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,c|=8);let f=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=f&&(this.scrollAnchorHeight=-1,this.scrollTop=f),this.scrolledToBottom=Qb(t.scrollDOM);let p=(this.printing?hD:lD)(s,this.paddingTop),g=p.top-this.pixelViewport.top,m=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let y=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(y!=this.inView&&(this.inView=y,y&&(l=!0)),!this.inView&&!this.scrollTarget)return 0;let v=a.width;if((this.contentDOMWidth!=v||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=t.scrollDOM.clientHeight,c|=8),l){let w=t.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(w)&&(i=!0),i||r.lineWrapping&&Math.abs(v-this.contentDOMWidth)>r.charWidth){let{lineHeight:S,charWidth:_,textHeight:A}=t.docView.measureTextSize();i=S>0&&r.refresh(o,S,_,A,v/_,w),i&&(t.docView.minWidth=0,c|=8)}g>0&&m>0?u=Math.max(g,m):g<0&&m<0&&(u=Math.min(g,m)),r.heightChanged=!1;for(let S of this.viewports){let _=S.from==this.viewport.from?w:t.docView.measureVisibleLineHeights(S);this.heightMap=(i?os.empty().applyChanges(this.stateDeco,Rt.empty,this.heightOracle,[new Is(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(r,0,i,new nD(S.from,_))}r.heightChanged&&(c|=2)}let b=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return b&&(this.viewport=this.getViewport(u,this.scrollTarget)),this.updateForViewport(),(c&2||b)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(i?[]:this.lineGaps,t)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,s){let n=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),r=this.heightMap,o=this.heightOracle,{visibleTop:i,visibleBottom:a}=this,l=new Oh(r.lineAt(i-n*1e3,qt.ByHeight,o,0,0).from,r.lineAt(a+(1-n)*1e3,qt.ByHeight,o,0,0).to);if(s){let{head:c}=s.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=r.lineAt(c,qt.ByPos,o,0,0),d;s.y=="center"?d=(h.top+h.bottom)/2-u/2:s.y=="start"||s.y=="nearest"&&c<l.from?d=h.top:d=h.bottom-u,l=new Oh(r.lineAt(d-500,qt.ByHeight,o,0,0).from,r.lineAt(d+u+500,qt.ByHeight,o,0,0).to)}}return l}mapViewport(t,s){let n=s.mapPos(t.from,-1),r=s.mapPos(t.to,1);return new Oh(this.heightMap.lineAt(n,qt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,qt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:s},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(t,qt.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(s,qt.ByPos,this.heightOracle,0,0),{visibleTop:i,visibleBottom:a}=this;return(t==0||r<=i-Math.max(10,Math.min(-n,250)))&&(s==this.state.doc.length||o>=a+Math.max(10,Math.min(n,250)))&&r>i-2e3&&o<a+2e3}mapLineGaps(t,s){if(!t.length||s.empty)return t;let n=[];for(let r of t)s.touchesRange(r.from,r.to)||n.push(new fp(s.mapPos(r.from),s.mapPos(r.to),r.size));return n}ensureLineGaps(t,s){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,o=r>>1,i=r<<1;if(this.defaultTextDirection!=Zt.LTR&&!n)return[];let a=[],l=(c,u,h,d)=>{if(u-c<o)return;let f=this.state.selection.main,p=[f.from];f.empty||p.push(f.to);for(let m of p)if(m>c&&m<u){l(c,m-10,h,d),l(m+10,u,h,d);return}let g=dD(t,m=>m.from>=h.from&&m.to<=h.to&&Math.abs(m.from-c)<o&&Math.abs(m.to-u)<o&&!p.some(y=>m.from<y&&m.to>y));if(!g){if(u<h.to&&s&&n&&s.visibleRanges.some(m=>m.from<=u&&m.to>=u)){let m=s.moveToLineBoundary(W.cursor(u),!1,!0).head;m>c&&(u=m)}g=new fp(c,u,this.gapSize(h,c,u,d))}a.push(g)};for(let c of this.viewportLines){if(c.length<i)continue;let u=uD(c.from,c.to,this.stateDeco);if(u.total<i)continue;let h=this.scrollTarget?this.scrollTarget.range.head:null,d,f;if(n){let p=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,g,m;if(h!=null){let y=Ph(u,h),v=((this.visibleBottom-this.visibleTop)/2+p)/c.height;g=y-v,m=y+v}else g=(this.visibleTop-c.top-p)/c.height,m=(this.visibleBottom-c.top+p)/c.height;d=Th(u,g),f=Th(u,m)}else{let p=u.total*this.heightOracle.charWidth,g=r*this.heightOracle.charWidth,m,y;if(h!=null){let v=Ph(u,h),b=((this.pixelViewport.right-this.pixelViewport.left)/2+g)/p;m=v-b,y=v+b}else m=(this.pixelViewport.left-g)/p,y=(this.pixelViewport.right+g)/p;d=Th(u,m),f=Th(u,y)}d>c.from&&l(c.from,d,c,u),f<c.to&&l(f,c.to,c,u)}return a}gapSize(t,s,n,r){let o=Ph(r,n)-Ph(r,s);return this.heightOracle.lineWrapping?t.height*o:r.total*this.heightOracle.charWidth*o}updateLineGaps(t){fp.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=ut.set(t.map(s=>s.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let s=[];$t.spans(t,this.viewport.from,this.viewport.to,{span(r,o){s.push({from:r,to:o})},point(){}},20);let n=s.length!=this.visibleRanges.length||this.visibleRanges.some((r,o)=>r.from!=s[o].from||r.to!=s[o].to);return this.visibleRanges=s,n?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(s=>s.from<=t&&s.to>=t)||xa(this.heightMap.lineAt(t,qt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return xa(this.heightMap.lineAt(this.scaler.fromDOM(t),qt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let s=this.lineBlockAtHeight(t+8);return s.from>=this.viewport.from||this.viewportLines[0].top-t>200?s:this.viewportLines[0]}elementAtHeight(t){return xa(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Oh{constructor(t,s){this.from=t,this.to=s}}function uD(e,t,s){let n=[],r=e,o=0;return $t.spans(s,e,t,{span(){},point(i,a){i>r&&(n.push({from:r,to:i}),o+=i-r),r=a}},20),r<t&&(n.push({from:r,to:t}),o+=t-r),{total:o,ranges:n}}function Th({total:e,ranges:t},s){if(s<=0)return t[0].from;if(s>=1)return t[t.length-1].to;let n=Math.floor(e*s);for(let r=0;;r++){let{from:o,to:i}=t[r],a=i-o;if(n<=a)return o+n;n-=a}}function Ph(e,t){let s=0;for(let{from:n,to:r}of e.ranges){if(t<=r){s+=t-n;break}s+=r-n}return s/e.total}function dD(e,t){for(let s of e)if(t(s))return s}const cw={toDOM(e){return e},fromDOM(e){return e},scale:1};class fD{constructor(t,s,n){let r=0,o=0,i=0;this.viewports=n.map(({from:a,to:l})=>{let c=s.lineAt(a,qt.ByPos,t,0,0).top,u=s.lineAt(l,qt.ByPos,t,0,0).bottom;return r+=u-c,{from:a,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(s.height-r);for(let a of this.viewports)a.domTop=i+(a.top-o)*this.scale,i=a.domBottom=a.domTop+(a.bottom-a.top),o=a.bottom}toDOM(t){for(let s=0,n=0,r=0;;s++){let o=s<this.viewports.length?this.viewports[s]:null;if(!o||t<o.top)return r+(t-n)*this.scale;if(t<=o.bottom)return o.domTop+(t-o.top);n=o.bottom,r=o.domBottom}}fromDOM(t){for(let s=0,n=0,r=0;;s++){let o=s<this.viewports.length?this.viewports[s]:null;if(!o||t<o.domTop)return n+(t-r)/this.scale;if(t<=o.domBottom)return o.top+(t-o.domTop);n=o.bottom,r=o.domBottom}}}function xa(e,t){if(t.scale==1)return e;let s=t.toDOM(e.top),n=t.toDOM(e.bottom);return new gn(e.from,e.length,s,n-s,Array.isArray(e._content)?e._content.map(r=>xa(r,t)):e._content)}const Mh=tt.define({combine:e=>e.join(" ")}),pp=tt.define({combine:e=>e.indexOf(!0)>-1}),mp=ar.newName(),uw=ar.newName(),dw=ar.newName(),fw={"&light":"."+uw,"&dark":"."+dw};function gp(e,t,s){return new ar(t,{finish(n){return/&/.test(n)?n.replace(/&\w*/,r=>{if(r=="&")return e;if(!s||!s[r])throw new RangeError(`Unsupported selector: ${r}`);return s[r]}):e+" "+n}})}const pD=gp("."+mp,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},fw),_a="\uFFFF";class mD{constructor(t,s){this.points=t,this.text="",this.lineSeparator=s.facet(Mt.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=_a}readRange(t,s){if(!t)return this;let n=t.parentNode;for(let r=t;;){this.findPointBefore(n,r);let o=this.text.length;this.readNode(r);let i=r.nextSibling;if(i==s)break;let a=Yt.get(r),l=Yt.get(i);(a&&l?a.breakAfter:(a?a.breakAfter:pw(r))||pw(i)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>o)&&this.lineBreak(),r=i}return this.findPointBefore(n,s),this}readTextNode(t){let s=t.nodeValue;for(let n of this.points)n.node==t&&(n.pos=this.text.length+Math.min(n.offset,s.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,i=1,a;if(this.lineSeparator?(o=s.indexOf(this.lineSeparator,n),i=this.lineSeparator.length):(a=r.exec(s))&&(o=a.index,i=a[0].length),this.append(s.slice(n,o<0?s.length:o)),o<0)break;if(this.lineBreak(),i>1)for(let l of this.points)l.node==t&&l.pos>this.text.length&&(l.pos-=i-1);n=o+i}}readNode(t){if(t.cmIgnore)return;let s=Yt.get(t),n=s&&s.overrideDOMText;if(n!=null){this.findPointInside(t,n.length);for(let r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,s){for(let n of this.points)n.node==t&&t.childNodes[n.offset]==s&&(n.pos=this.text.length)}findPointInside(t,s){for(let n of this.points)(t.nodeType==3?n.node==t:t.contains(n.node))&&(n.pos=this.text.length+(gD(t,n.node,n.offset)?s:0))}}function gD(e,t,s){for(;;){if(!t||s<Ln(t))return!1;if(t==e)return!0;s=pa(t)+1,t=t.parentNode}}function pw(e){return e.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}class mw{constructor(t,s){this.node=t,this.offset=s,this.pos=-1}}class yD{constructor(t,s,n,r){this.typeOver=r,this.bounds=null,this.text="";let{impreciseHead:o,impreciseAnchor:i}=t.docView;if(t.state.readOnly&&s>-1)this.newSel=null;else if(s>-1&&(this.bounds=t.docView.domBoundsAround(s,n,0))){let a=o||i?[]:wD(t),l=new mD(a,t.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=xD(a,this.bounds.from)}else{let a=t.observer.selectionRange,l=o&&o.node==a.focusNode&&o.offset==a.focusOffset||!Gf(t.contentDOM,a.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(a.focusNode,a.focusOffset),c=i&&i.node==a.anchorNode&&i.offset==a.anchorOffset||!Gf(t.contentDOM,a.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(a.anchorNode,a.anchorOffset),u=t.viewport;if(st.ios&&t.state.selection.main.empty&&l!=c&&(u.from>0||u.to<t.state.doc.length)){let h=u.from-Math.min(l,c),d=u.to-Math.max(l,c);(h==0||h==1)&&(d==0||d==-1)&&(l=0,c=t.state.doc.length)}this.newSel=W.single(c,l)}}}function gw(e,t){let s,{newSel:n}=t,r=e.state.selection.main,o=e.inputState.lastKeyTime>Date.now()-100?e.inputState.lastKeyCode:-1;if(t.bounds){let{from:i,to:a}=t.bounds,l=r.from,c=null;(o===8||st.android&&t.text.length<a-i)&&(l=r.to,c="end");let u=bD(e.state.doc.sliceString(i,a,_a),t.text,l-i,c);u&&(st.chrome&&o==13&&u.toB==u.from+2&&t.text.slice(u.from,u.toB)==_a+_a&&u.toB--,s={from:i+u.from,to:i+u.toA,insert:Rt.of(t.text.slice(u.from,u.toB).split(_a))})}else n&&(!e.hasFocus&&e.state.facet(xh)||n.main.eq(r))&&(n=null);if(!s&&!n)return!1;if(!s&&t.typeOver&&!r.empty&&n&&n.main.empty?s={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,r.to)}:s&&s.from>=r.from&&s.to<=r.to&&(s.from!=r.from||s.to!=r.to)&&r.to-r.from-(s.to-s.from)<=4?s={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,s.from).append(s.insert).append(e.state.doc.slice(s.to,r.to))}:(st.mac||st.android)&&s&&s.from==s.to&&s.from==r.head-1&&/^\. ?$/.test(s.insert.toString())&&e.contentDOM.getAttribute("autocorrect")=="off"?(n&&s.insert.length==2&&(n=W.single(n.main.anchor-1,n.main.head-1)),s={from:r.from,to:r.to,insert:Rt.of([" "])}):st.chrome&&s&&s.from==s.to&&s.from==r.head&&s.insert.toString()==`
 `&&e.lineWrapping&&(n&&(n=W.single(n.main.anchor-1,n.main.head-1)),s={from:r.from,to:r.to,insert:Rt.of([" "])}),s){if(st.ios&&e.inputState.flushIOSKey()||st.android&&(s.from==r.from&&s.to==r.to&&s.insert.length==1&&s.insert.lines==2&&qo(e.contentDOM,"Enter",13)||(s.from==r.from-1&&s.to==r.to&&s.insert.length==0||o==8&&s.insert.length<s.to-s.from&&s.to>r.head)&&qo(e.contentDOM,"Backspace",8)||s.from==r.from&&s.to==r.to+1&&s.insert.length==0&&qo(e.contentDOM,"Delete",46)))return!0;let i=s.insert.toString();e.inputState.composing>=0&&e.inputState.composing++;let a,l=()=>a||(a=vD(e,s,n));return e.state.facet(_1).some(c=>c(e,s.from,s.to,i,l))||e.dispatch(l()),!0}else if(n&&!n.main.eq(r)){let i=!1,a="select";return e.inputState.lastSelectionTime>Date.now()-50&&(e.inputState.lastSelectionOrigin=="select"&&(i=!0),a=e.inputState.lastSelectionOrigin),e.dispatch({selection:n,scrollIntoView:i,userEvent:a}),!0}else return!1}function vD(e,t,s){let n,r=e.state,o=r.selection.main;if(t.from>=o.from&&t.to<=o.to&&t.to-t.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==t.from+t.insert.length)&&e.inputState.composing<0){let a=o.from<t.from?r.sliceDoc(o.from,t.from):"",l=o.to>t.to?r.sliceDoc(t.to,o.to):"";n=r.replaceSelection(e.state.toText(a+t.insert.sliceString(0,void 0,e.state.lineBreak)+l))}else{let a=r.changes(t),l=s&&s.main.to<=a.newLength?s.main:void 0;if(r.selection.ranges.length>1&&e.inputState.composing>=0&&t.to<=o.to&&t.to>=o.to-10){let c=e.state.sliceDoc(t.from,t.to),u,h=s&&R1(e,s.main.head);if(h){let p=t.insert.length-(t.to-t.from);u={from:h.from,to:h.to-p}}else u=e.state.doc.lineAt(o.head);let d=o.to-t.to,f=o.to-o.from;n=r.changeByRange(p=>{if(p.from==o.from&&p.to==o.to)return{changes:a,range:l||p.map(a)};let g=p.to-d,m=g-c.length;if(p.to-p.from!=f||e.state.sliceDoc(m,g)!=c||p.to>=u.from&&p.from<=u.to)return{range:p};let y=r.changes({from:m,to:g,insert:t.insert}),v=p.to-o.to;return{changes:y,range:l?W.range(Math.max(0,l.anchor+v),Math.max(0,l.head+v)):p.map(y)}})}else n={changes:a,selection:l&&r.selection.replaceRange(l)}}let i="input.type";return(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,i+=".compose",e.inputState.compositionFirstChange&&(i+=".start",e.inputState.compositionFirstChange=!1)),r.update(n,{userEvent:i,scrollIntoView:!0})}function bD(e,t,s,n){let r=Math.min(e.length,t.length),o=0;for(;o<r&&e.charCodeAt(o)==t.charCodeAt(o);)o++;if(o==r&&e.length==t.length)return null;let i=e.length,a=t.length;for(;i>0&&a>0&&e.charCodeAt(i-1)==t.charCodeAt(a-1);)i--,a--;if(n=="end"){let l=Math.max(0,o-Math.min(i,a));s-=i+l-o}if(i<o&&e.length<t.length){let l=s<=o&&s>=i?o-s:0;o-=l,a=o+(a-i),i=o}else if(a<o){let l=s<=o&&s>=a?o-s:0;o-=l,i=o+(i-a),a=o}return{from:o,toA:i,toB:a}}function wD(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:s,anchorOffset:n,focusNode:r,focusOffset:o}=e.observer.selectionRange;return s&&(t.push(new mw(s,n)),(r!=s||o!=n)&&t.push(new mw(r,o))),t}function xD(e,t){if(e.length==0)return null;let s=e[0].pos,n=e.length==2?e[1].pos:s;return s>-1&&n>-1?W.single(s+t,n+t):null}const _D={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},yp=st.ie&&st.ie_version<=11;class AD{constructor(t){this.view=t,this.active=!1,this.selectionRange=new iR,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(s=>{for(let n of s)this.queue.push(n);(st.ie&&st.ie_version<=11||st.ios&&t.composing)&&s.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),yp&&(this.onCharData=s=>{this.queue.push({target:s.target,type:"characterData",oldValue:s.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var s;((s=this.view.docView)===null||s===void 0?void 0:s.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(s=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),s.length>0&&s[s.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(s=>{s.length>0&&s[s.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((s,n)=>s!=t[n]))){this.gapIntersection.disconnect();for(let s of t)this.gapIntersection.observe(s);this.gaps=t}}onSelectionChange(t){let s=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(xh)?n.root.activeElement!=this.dom:!gh(n.dom,r))return;let o=r.anchorNode&&n.docView.nearest(r.anchorNode);if(o&&o.ignoreEvent(t)){s||(this.selectionChanged=!1);return}(st.ie&&st.ie_version<=11||st.android&&st.chrome)&&!n.state.selection.main.empty&&r.focusNode&&fa(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,s=st.safari&&t.root.nodeType==11&&sR(this.dom.ownerDocument)==this.dom&&kD(this.view)||mh(t.root);if(!s||this.selectionRange.eq(s))return!1;let n=gh(this.dom,s);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&lR(this.dom,s)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(s),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,s){this.selectionRange.set(t.node,t.offset,s.node,s.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,s=null;for(let n=this.dom;n;)if(n.nodeType==1)!s&&t<this.scrollTargets.length&&this.scrollTargets[t]==n?t++:s||(s=this.scrollTargets.slice(0,t)),s&&s.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(t<this.scrollTargets.length&&!s&&(s=this.scrollTargets.slice(0,t)),s){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=s)n.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,_D),yp&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),yp&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,s){var n;if(!this.delayedAndroidKey){let r=()=>{let o=this.delayedAndroidKey;o&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=o.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&o.force&&qo(this.dom,o.key,o.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:s,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let s=-1,n=-1,r=!1;for(let o of t){let i=this.readMutation(o);i&&(i.typeOver&&(r=!0),s==-1?{from:s,to:n}=i:(s=Math.min(i.from,s),n=Math.max(i.to,n)))}return{from:s,to:n,typeOver:r}}readChange(){let{from:t,to:s,typeOver:n}=this.processRecords(),r=this.selectionChanged&&gh(this.dom,this.selectionRange);if(t<0&&!r)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=new yD(this.view,t,s,n);return this.view.docView.domChanged={newSel:o.newSel?o.newSel.main:null},o}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let s=this.readChange();if(!s)return this.view.requestMeasure(),!1;let n=this.view.state,r=gw(this.view,s);return this.view.state==n&&this.view.update([]),r}readMutation(t){let s=this.view.docView.nearest(t.target);if(!s||s.ignoreMutation(t))return null;if(s.markDirty(t.type=="attributes"),t.type=="attributes"&&(s.flags|=4),t.type=="childList"){let n=yw(s,t.previousSibling||t.target.previousSibling,-1),r=yw(s,t.nextSibling||t.target.nextSibling,1);return{from:n?s.posAfter(n):s.posAtStart,to:r?s.posBefore(r):s.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:s.posAtStart,to:s.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var t,s,n;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(s=this.gapIntersection)===null||s===void 0||s.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function yw(e,t,s){for(;t;){let n=Yt.get(t);if(n&&n.parent==e)return n;let r=t.parentNode;t=r!=e.dom?r:s>0?t.nextSibling:t.previousSibling}return null}function kD(e){let t=null;function s(l){l.preventDefault(),l.stopImmediatePropagation(),t=l.getTargetRanges()[0]}if(e.contentDOM.addEventListener("beforeinput",s,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",s,!0),!t)return null;let n=t.startContainer,r=t.startOffset,o=t.endContainer,i=t.endOffset,a=e.docView.domAtPos(e.state.selection.main.anchor);return fa(a.node,a.offset,o,i)&&([n,r,o,i]=[o,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}let et=class Rm{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:s}=t;this.dispatchTransactions=t.dispatchTransactions||s&&(n=>n.forEach(r=>s(r,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=t.root||aR(t.parent)||document,this.viewState=new hw(t.state||Mt.create(t)),t.scrollTo&&t.scrollTo.is(wh)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(va).map(n=>new rp(n));for(let n of this.plugins)n.update(this);this.observer=new AD(this),this.inputState=new jR(this),this.inputState.ensureHandlers(this.plugins),this.docView=new E1(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...t){let s=t.length==1&&t[0]instanceof xe?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(s,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let s=!1,n=!1,r,o=this.state;for(let d of t){if(d.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=d.state}if(this.destroyed){this.viewState.state=o;return}let i=this.hasFocus,a=0,l=null;t.some(d=>d.annotation(sw))?(this.inputState.notifiedFocused=i,a=1):i!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=i,l=nw(o,i),l||(a=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(u=null)):this.observer.clear(),o.facet(Mt.phrases)!=this.state.facet(Mt.phrases))return this.setState(o);r=_h.create(this,o,t),r.flags|=a;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let d of t){if(h&&(h=h.map(d.changes)),d.scrollIntoView){let{main:f}=d.state.selection;h=new Ko(f.empty?f:W.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of d.effects)f.is(wh)&&(h=f.value.clip(this.state))}this.viewState.update(r,h),this.bidiCache=Ih.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),s=this.docView.update(r),this.state.facet(wa)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(s,t.some(d=>d.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Mh)!=r.state.facet(Mh)&&(this.viewState.mustMeasureContent=!0),(s||n||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!r.empty)for(let d of this.state.facet(np))try{d(r)}catch(f){Ms(this.state,f,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!gw(this,u)&&c.force&&qo(this.contentDOM,c.key,c.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let s=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new hw(t),this.plugins=t.facet(va).map(n=>new rp(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new E1(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}s&&this.focus(),this.requestMeasure()}updatePlugins(t){let s=t.startState.facet(va),n=t.state.facet(va);if(s!=n){let r=[];for(let o of n){let i=s.indexOf(o);if(i<0)r.push(new rp(o));else{let a=this.plugins[i];a.mustUpdate=t,r.push(a)}}for(let o of this.plugins)o.mustUpdate!=t&&o.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=t;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);s!=n&&this.inputState.ensureHandlers(this.plugins)}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let s=null,n=this.scrollDOM,r=n.scrollTop*this.scaleY,{scrollAnchorPos:o,scrollAnchorHeight:i}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(i=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(i<0)if(Qb(n))o=-1,i=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(r);o=f.from,i=f.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(f=>{try{return f.read(this)}catch(p){return Ms(this.state,p),vw}}),h=_h.create(this,this.state,[]),d=!1;h.flags|=l,s?s.flags|=l:s=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),d=this.docView.update(h));for(let f=0;f<c.length;f++)if(u[f]!=vw)try{let p=c[f];p.write&&p.write(u[f],this)}catch(p){Ms(this.state,p)}if(d&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,i=-1;continue}else{let f=(o<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(o).top)-i;if(f>1||f<-1){r=r+f,n.scrollTop=r/this.scaleY,i=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(s&&!s.empty)for(let a of this.state.facet(np))a(s)}get themeClasses(){return mp+" "+(this.state.facet(pp)?dw:uw)+" "+this.state.facet(Mh)}updateAttrs(){let t=bw(this,C1,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),s={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(xh)?"true":"false",class:"cm-content",style:`${st.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(s["aria-readonly"]="true"),bw(this,op,s);let n=this.observer.ignore(()=>{let r=Qf(this.contentDOM,this.contentAttrs,s),o=Qf(this.dom,this.editorAttrs,t);return r||o});return this.editorAttrs=t,this.contentAttrs=s,n}showAnnouncements(t){let s=!0;for(let n of t)for(let r of n.effects)if(r.is(Rm.announce)){s&&(this.announceDOM.textContent=""),s=!1;let o=this.announceDOM.appendChild(document.createElement("div"));o.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(wa);let t=this.state.facet(Rm.cspNonce);ar.mount(this.root,this.styleModules.concat(pD).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let s=0;s<this.measureRequests.length;s++)if(this.measureRequests[s].key===t.key){this.measureRequests[s]=t;return}}this.measureRequests.push(t)}}plugin(t){let s=this.pluginMap.get(t);return(s===void 0||s&&s.spec!=t)&&this.pluginMap.set(t,s=this.plugins.find(n=>n.spec==t)||null),s&&s.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,s,n){return cp(this,t,V1(this,t,s,n))}moveByGroup(t,s){return cp(this,t,V1(this,t,s,n=>LR(this,t.head,n)))}visualLineSide(t,s){let n=this.bidiSpans(t),r=this.textDirectionAt(t.from),o=n[s?n.length-1:0];return W.cursor(o.side(s,r)+t.from,o.forward(!s,r)?1:-1)}moveToLineBoundary(t,s,n=!0){return NR(this,t,s,n)}moveVertically(t,s,n){return cp(this,t,BR(this,t,s,n))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,s=0){return this.docView.posFromDOM(t,s)}posAtCoords(t,s=!0){return this.readMeasured(),j1(this,t,s)}coordsAtPos(t,s=1){this.readMeasured();let n=this.docView.coordsAt(t,s);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(t),o=this.bidiSpans(r),i=o[dr.find(o,t-r.from,-1,s)];return yh(n,i.dir==Zt.LTR==s>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(k1)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>SD)return g1(t.length);let s=this.textDirectionAt(t.from),n;for(let o of this.bidiCache)if(o.from==t.from&&o.dir==s&&(o.fresh||m1(o.isolates,n=P1(this,t))))return o.order;n||(n=P1(this,t));let r=wR(t.text,s,n);return this.bidiCache.push(new Ih(t.from,t.to,s,n,!0,r)),r}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||st.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Yb(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,s={}){return wh.of(new Ko(typeof t=="number"?W.cursor(t):t,s.y,s.x,s.yMargin,s.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:s}=this.scrollDOM,n=this.viewState.scrollAnchorAt(t);return wh.of(new Ko(W.cursor(n.from),"start","start",n.top-t,s,!0))}static domEventHandlers(t){return ie.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return ie.define(()=>({}),{eventObservers:t})}static theme(t,s){let n=ar.newName(),r=[Mh.of(n),wa.of(gp(`.${n}`,t))];return s&&s.dark&&r.push(pp.of(!0)),r}static baseTheme(t){return Ho.lowest(wa.of(gp("."+mp,t,fw)))}static findFromDOM(t){var s;let n=t.querySelector(".cm-content"),r=n&&Yt.get(n)||Yt.get(t);return((s=r==null?void 0:r.rootView)===null||s===void 0?void 0:s.view)||null}};et.styleModule=wa,et.inputHandler=_1,et.focusChangeEffect=A1,et.perLineTextDirection=k1,et.exceptionSink=x1,et.updateListener=np,et.editable=xh,et.mouseSelectionStyle=w1,et.dragMovesSelection=b1,et.clickAddsSelectionRange=v1,et.decorations=ba,et.outerDecorations=O1,et.atomicRanges=ip,et.bidiIsolatedRanges=T1,et.scrollMargins=M1,et.darkTheme=pp,et.cspNonce=tt.define({combine:e=>e.length?e[0]:""}),et.contentAttributes=op,et.editorAttributes=C1,et.lineWrapping=et.contentAttributes.of({class:"cm-lineWrapping"}),et.announce=bt.define();const SD=4096,vw={};class Ih{constructor(t,s,n,r,o,i){this.from=t,this.to=s,this.dir=n,this.isolates=r,this.fresh=o,this.order=i}static update(t,s){if(s.empty&&!t.some(o=>o.fresh))return t;let n=[],r=t.length?t[t.length-1].dir:Zt.LTR;for(let o=Math.max(0,t.length-10);o<t.length;o++){let i=t[o];i.dir==r&&!s.touchesRange(i.from,i.to)&&n.push(new Ih(s.mapPos(i.from,1),s.mapPos(i.to,-1),i.dir,i.isolates,!1,i.order))}return n}}function bw(e,t,s){for(let n=e.state.facet(t),r=n.length-1;r>=0;r--){let o=n[r],i=typeof o=="function"?o(e):o;i&&Zf(i,s)}return s}const CD=st.mac?"mac":st.windows?"win":st.linux?"linux":"key";function OD(e,t){const s=e.split(/-(?!$)/);let n=s[s.length-1];n=="Space"&&(n=" ");let r,o,i,a;for(let l=0;l<s.length-1;++l){const c=s[l];if(/^(cmd|meta|m)$/i.test(c))a=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))o=!0;else if(/^s(hift)?$/i.test(c))i=!0;else if(/^mod$/i.test(c))t=="mac"?a=!0:o=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(n="Alt-"+n),o&&(n="Ctrl-"+n),a&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function Eh(e,t,s){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),s!==!1&&t.shiftKey&&(e="Shift-"+e),e}const TD=Ho.default(et.domEventHandlers({keydown(e,t){return _w(xw(t.state),e,t,"editor")}})),$h=tt.define({enables:TD}),ww=new WeakMap;function xw(e){let t=e.facet($h),s=ww.get(t);return s||ww.set(t,s=ID(t.reduce((n,r)=>n.concat(r),[]))),s}function PD(e,t,s){return _w(xw(e.state),t,e,s)}let fr=null;const MD=4e3;function ID(e,t=CD){let s=Object.create(null),n=Object.create(null),r=(i,a)=>{let l=n[i];if(l==null)n[i]=a;else if(l!=a)throw new Error("Key binding "+i+" is used both as a regular binding and as a multi-stroke prefix")},o=(i,a,l,c,u)=>{var h,d;let f=s[i]||(s[i]=Object.create(null)),p=a.split(/ (?!$)/).map(y=>OD(y,t));for(let y=1;y<p.length;y++){let v=p.slice(0,y).join(" ");r(v,!0),f[v]||(f[v]={preventDefault:!0,stopPropagation:!1,run:[b=>{let w=fr={view:b,prefix:v,scope:i};return setTimeout(()=>{fr==w&&(fr=null)},MD),!0}]})}let g=p.join(" ");r(g,!1);let m=f[g]||(f[g]={preventDefault:!1,stopPropagation:!1,run:((d=(h=f._any)===null||h===void 0?void 0:h.run)===null||d===void 0?void 0:d.slice())||[]});l&&m.run.push(l),c&&(m.preventDefault=!0),u&&(m.stopPropagation=!0)};for(let i of e){let a=i.scope?i.scope.split(" "):["editor"];if(i.any)for(let c of a){let u=s[c]||(s[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let h in u)u[h].run.push(i.any)}let l=i[t]||i.key;if(l)for(let c of a)o(c,l,i.run,i.preventDefault,i.stopPropagation),i.shift&&o(c,"Shift-"+l,i.shift,i.preventDefault,i.stopPropagation)}return s}function _w(e,t,s,n){let r=eR(t),o=De(r,0),i=Ps(o)==r.length&&r!=" ",a="",l=!1,c=!1,u=!1;fr&&fr.view==s&&fr.scope==n&&(a=fr.prefix+" ",U1.indexOf(t.keyCode)<0&&(c=!0,fr=null));let h=new Set,d=m=>{if(m){for(let y of m.run)if(!h.has(y)&&(h.add(y),y(s,t)))return m.stopPropagation&&(u=!0),!0;m.preventDefault&&(m.stopPropagation&&(u=!0),c=!0)}return!1},f=e[n],p,g;return f&&(d(f[a+Eh(r,t,!i)])?l=!0:i&&(t.altKey||t.metaKey||t.ctrlKey)&&!(st.windows&&t.ctrlKey&&t.altKey)&&(p=lr[t.keyCode])&&p!=r?(d(f[a+Eh(p,t,!0)])||t.shiftKey&&(g=da[t.keyCode])!=r&&g!=p&&d(f[a+Eh(g,t,!1)]))&&(l=!0):i&&t.shiftKey&&d(f[a+Eh(r,t,!0)])&&(l=!0),!l&&d(f._any)&&(l=!0)),c&&(l=!0),l&&u&&t.stopPropagation(),l}class Aa{constructor(t,s,n,r,o){this.className=t,this.left=s,this.top=n,this.width=r,this.height=o}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,s){return s.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width!=null&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,s,n){if(n.empty){let r=t.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let o=Aw(t);return[new Aa(s,r.left-o.left,r.top-o.top,null,r.bottom-r.top)]}else return ED(t,s,n)}}function Aw(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==Zt.LTR?t.left:t.right-e.scrollDOM.clientWidth*e.scaleX)-e.scrollDOM.scrollLeft*e.scaleX,top:t.top-e.scrollDOM.scrollTop*e.scaleY}}function kw(e,t,s){let n=W.cursor(t);return{from:Math.max(s.from,e.moveToLineBoundary(n,!1,!0).from),to:Math.min(s.to,e.moveToLineBoundary(n,!0,!0).from),type:rs.Text}}function ED(e,t,s){if(s.to<=e.viewport.from||s.from>=e.viewport.to)return[];let n=Math.max(s.from,e.viewport.from),r=Math.min(s.to,e.viewport.to),o=e.textDirection==Zt.LTR,i=e.contentDOM,a=i.getBoundingClientRect(),l=Aw(e),c=i.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),h=a.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),d=a.right-(u?parseInt(u.paddingRight):0),f=hp(e,n),p=hp(e,r),g=f.type==rs.Text?f:null,m=p.type==rs.Text?p:null;if(g&&(e.lineWrapping||f.widgetLineBreaks)&&(g=kw(e,n,g)),m&&(e.lineWrapping||p.widgetLineBreaks)&&(m=kw(e,r,m)),g&&m&&g.from==m.from)return v(b(s.from,s.to,g));{let S=g?b(s.from,null,g):w(f,!1),_=m?b(null,s.to,m):w(p,!0),A=[];return(g||f).to<(m||p).from-(g&&m?1:0)||f.widgetLineBreaks>1&&S.bottom+e.defaultLineHeight/2<_.top?A.push(y(h,S.bottom,d,_.top)):S.bottom<_.top&&e.elementAtHeight((S.bottom+_.top)/2).type==rs.Text&&(S.bottom=_.top=(S.bottom+_.top)/2),v(S).concat(A).concat(v(_))}function y(S,_,A,O){return new Aa(t,S-l.left,_-l.top-.01,A-S,O-_+.01)}function v({top:S,bottom:_,horizontal:A}){let O=[];for(let P=0;P<A.length;P+=2)O.push(y(A[P],S,A[P+1],_));return O}function b(S,_,A){let O=1e9,P=-1e9,R=[];function X(j,K,nt,ht,St){let U=e.coordsAtPos(j,j==A.to?-2:2),N=e.coordsAtPos(nt,nt==A.from?2:-2);!U||!N||(O=Math.min(U.top,N.top,O),P=Math.max(U.bottom,N.bottom,P),St==Zt.LTR?R.push(o&&K?h:U.left,o&&ht?d:N.right):R.push(!o&&ht?h:N.left,!o&&K?d:U.right))}let B=S??A.from,H=_??A.to;for(let j of e.visibleRanges)if(j.to>B&&j.from<H)for(let K=Math.max(j.from,B),nt=Math.min(j.to,H);;){let ht=e.state.doc.lineAt(K);for(let St of e.bidiSpans(ht)){let U=St.from+ht.from,N=St.to+ht.from;if(U>=nt)break;N>K&&X(Math.max(U,K),S==null&&U<=B,Math.min(N,nt),_==null&&N>=H,St.dir)}if(K=ht.to+1,K>=nt)break}return R.length==0&&X(B,S==null,H,_==null,e.textDirection),{top:O,bottom:P,horizontal:R}}function w(S,_){let A=a.top+(_?S.top:S.bottom);return{top:A,bottom:A,horizontal:[]}}}function $D(e,t){return e.constructor==t.constructor&&e.eq(t)}class RD{constructor(t,s){this.view=t,this.layer=s,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),s.above&&this.dom.classList.add("cm-layer-above"),s.class&&this.dom.classList.add(s.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),s.mount&&s.mount(this.dom,t)}update(t){t.startState.facet(Rh)!=t.state.facet(Rh)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}setOrder(t){let s=0,n=t.facet(Rh);for(;s<n.length&&n[s]!=this.layer;)s++;this.dom.style.zIndex=String((this.layer.above?150:-1)-s)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:s}=this.view;(t!=this.scaleX||s!=this.scaleY)&&(this.scaleX=t,this.scaleY=s,this.dom.style.transform=`scale(${1/t}, ${1/s})`)}draw(t){if(t.length!=this.drawn.length||t.some((s,n)=>!$D(s,this.drawn[n]))){let s=this.dom.firstChild,n=0;for(let r of t)r.update&&s&&r.constructor&&this.drawn[n].constructor&&r.update(s,this.drawn[n])?(s=s.nextSibling,n++):this.dom.insertBefore(r.draw(),s);for(;s;){let r=s.nextSibling;s.remove(),s=r}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Rh=tt.define();function Sw(e){return[ie.define(t=>new RD(t,e)),Rh.of(e)]}const Cw=!st.ios,ka=tt.define({combine(e){return pn(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,s)=>Math.min(t,s),drawRangeCursor:(t,s)=>t||s})}});function DD(e={}){return[ka.of(e),ND,LD,BD,S1.of(!0)]}function Ow(e){return e.startState.facet(ka)!=e.state.facet(ka)}const ND=Sw({above:!0,markers(e){let{state:t}=e,s=t.facet(ka),n=[];for(let r of t.selection.ranges){let o=r==t.selection.main;if(r.empty?!o||Cw:s.drawRangeCursor){let i=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=r.empty?r:W.cursor(r.head,r.head>r.anchor?-1:1);for(let l of Aa.forRange(e,i,a))n.push(l)}}return n},update(e,t){e.transactions.some(n=>n.selection)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let s=Ow(e);return s&&Tw(e.state,t),e.docChanged||e.selectionSet||s},mount(e,t){Tw(t.state,e)},class:"cm-cursorLayer"});function Tw(e,t){t.style.animationDuration=e.facet(ka).cursorBlinkRate+"ms"}const LD=Sw({above:!1,markers(e){return e.state.selection.ranges.map(t=>t.empty?[]:Aa.forRange(e,"cm-selectionBackground",t)).reduce((t,s)=>t.concat(s))},update(e,t){return e.docChanged||e.selectionSet||e.viewportChanged||Ow(e)},class:"cm-selectionLayer"}),vp={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Cw&&(vp[".cm-line"].caretColor="transparent !important",vp[".cm-content"]={caretColor:"transparent !important"});const BD=Ho.highest(et.theme(vp)),Pw=bt.define({map(e,t){return e==null?null:t.mapPos(e)}}),Sa=Ne.define({create(){return null},update(e,t){return e!=null&&(e=t.changes.mapPos(e)),t.effects.reduce((s,n)=>n.is(Pw)?n.value:s,e)}}),jD=ie.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let s=e.state.field(Sa);s==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(Sa)!=s||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:e}=this,t=e.state.field(Sa),s=t!=null&&e.coordsAtPos(t);if(!s)return null;let n=e.scrollDOM.getBoundingClientRect();return{left:s.left-n.left+e.scrollDOM.scrollLeft*e.scaleX,top:s.top-n.top+e.scrollDOM.scrollTop*e.scaleY,height:s.bottom-s.top}}drawCursor(e){if(this.cursor){let{scaleX:t,scaleY:s}=this.view;e?(this.cursor.style.left=e.left/t+"px",this.cursor.style.top=e.top/s+"px",this.cursor.style.height=e.height/s+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(Sa)!=e&&this.view.dispatch({effects:Pw.of(e)})}},{eventObservers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){(e.target==this.view.contentDOM||!this.view.contentDOM.contains(e.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function FD(){return[Sa,jD]}function Mw(e,t,s,n,r){t.lastIndex=0;for(let o=e.iterRange(s,n),i=s,a;!o.next().done;i+=o.value.length)if(!o.lineBreak)for(;a=t.exec(o.value);)r(i+a.index,a)}function VD(e,t){let s=e.visibleRanges;if(s.length==1&&s[0].from==e.viewport.from&&s[0].to==e.viewport.to)return s;let n=[];for(let{from:r,to:o}of s)r=Math.max(e.state.doc.lineAt(r).from,r-t),o=Math.min(e.state.doc.lineAt(o).to,o+t),n.length&&n[n.length-1].to>=r?n[n.length-1].to=o:n.push({from:r,to:o});return n}class zD{constructor(t){const{regexp:s,decoration:n,decorate:r,boundary:o,maxLength:i=1e3}=t;if(!s.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=s,r)this.addMatch=(a,l,c,u)=>r(u,c,c+a[0].length,a,l);else if(typeof n=="function")this.addMatch=(a,l,c,u)=>{let h=n(a,l,c);h&&u(c,c+a[0].length,h)};else if(n)this.addMatch=(a,l,c,u)=>u(c,c+a[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=o,this.maxLength=i}createDeco(t){let s=new ir,n=s.add.bind(s);for(let{from:r,to:o}of VD(t,this.maxLength))Mw(t.state.doc,this.regexp,r,o,(i,a)=>this.addMatch(a,t,i,n));return s.finish()}updateDeco(t,s){let n=1e9,r=-1;return t.docChanged&&t.changes.iterChanges((o,i,a,l)=>{l>t.view.viewport.from&&a<t.view.viewport.to&&(n=Math.min(a,n),r=Math.max(l,r))}),t.viewportChanged||r-n>1e3?this.createDeco(t.view):r>-1?this.updateRange(t.view,s.map(t.changes),n,r):s}updateRange(t,s,n,r){for(let o of t.visibleRanges){let i=Math.max(o.from,n),a=Math.min(o.to,r);if(a>i){let l=t.state.doc.lineAt(i),c=l.to<a?t.state.doc.lineAt(a):l,u=Math.max(o.from,l.from),h=Math.min(o.to,c.to);if(this.boundary){for(;i>l.from;i--)if(this.boundary.test(l.text[i-1-l.from])){u=i;break}for(;a<c.to;a++)if(this.boundary.test(c.text[a-c.from])){h=a;break}}let d=[],f,p=(g,m,y)=>d.push(y.range(g,m));if(l==c)for(this.regexp.lastIndex=u-l.from;(f=this.regexp.exec(l.text))&&f.index<h-l.from;)this.addMatch(f,t,f.index+l.from,p);else Mw(t.state.doc,this.regexp,u,h,(g,m)=>this.addMatch(m,t,g,p));s=s.update({filterFrom:u,filterTo:h,filter:(g,m)=>g<u||m>h,add:d})}}return s}}const bp=/x/.unicode!=null?"gu":"g",GD=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,bp),UD={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let wp=null;function HD(){var e;if(wp==null&&typeof document<"u"&&document.body){let t=document.body.style;wp=((e=t.tabSize)!==null&&e!==void 0?e:t.MozTabSize)!=null}return wp||!1}const Dh=tt.define({combine(e){let t=pn(e,{render:null,specialChars:GD,addSpecialChars:null});return(t.replaceTabs=!HD())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,bp)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,bp)),t}});function WD(e={}){return[Dh.of(e),XD()]}let Iw=null;function XD(){return Iw||(Iw=ie.fromClass(class{constructor(e){this.view=e,this.decorations=ut.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(Dh)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new zD({regexp:e.specialChars,decoration:(t,s,n)=>{let{doc:r}=s.state,o=De(t[0],0);if(o==9){let i=r.lineAt(n),a=s.state.tabSize,l=Xo(i.text,a,n-i.from);return ut.replace({widget:new QD((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[o]||(this.decorationCache[o]=ut.replace({widget:new qD(e,o)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(Dh);e.startState.facet(Dh)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))}const YD="\u2022";function ZD(e){return e>=32?YD:e==10?"\u2424":String.fromCharCode(9216+e)}class qD extends Fn{constructor(t,s){super(),this.options=t,this.code=s}eq(t){return t.code==this.code}toDOM(t){let s=ZD(this.code),n=t.state.phrase("Control character")+" "+(UD[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,n,s);if(r)return r;let o=document.createElement("span");return o.textContent=s,o.title=n,o.setAttribute("aria-label",n),o.className="cm-specialChar",o}ignoreEvent(){return!1}}class QD extends Fn{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}function KD(){return tN}const JD=ut.line({class:"cm-activeLine"}),tN=ie.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,s=[];for(let n of e.state.selection.ranges){let r=e.lineBlockAt(n.head);r.from>t&&(s.push(JD.range(r.from)),t=r.from)}return ut.set(s)}},{decorations:e=>e.decorations});class eN extends Fn{constructor(t){super(),this.content=t}toDOM(){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(t){let s=t.firstChild?Yo(t.firstChild):[];if(!s.length)return null;let n=window.getComputedStyle(t.parentNode),r=yh(s[0],n.direction!="rtl"),o=parseInt(n.lineHeight);return r.bottom-r.top>o*1.5?{left:r.left,right:r.right,top:r.top,bottom:r.top+o}:r}ignoreEvent(){return!1}}function sN(e){return ie.fromClass(class{constructor(t){this.view=t,this.placeholder=e?ut.set([ut.widget({widget:new eN(e),side:1}).range(0)]):ut.none}get decorations(){return this.view.state.doc.length?ut.none:this.placeholder}},{decorations:t=>t.decorations})}const xp=2e3;function nN(e,t,s){let n=Math.min(t.line,s.line),r=Math.max(t.line,s.line),o=[];if(t.off>xp||s.off>xp||t.col<0||s.col<0){let i=Math.min(t.off,s.off),a=Math.max(t.off,s.off);for(let l=n;l<=r;l++){let c=e.doc.line(l);c.length<=a&&o.push(W.range(c.from+i,c.to+a))}}else{let i=Math.min(t.col,s.col),a=Math.max(t.col,s.col);for(let l=n;l<=r;l++){let c=e.doc.line(l),u=jf(c.text,i,e.tabSize,!0);if(u<0)o.push(W.cursor(c.to));else{let h=jf(c.text,a,e.tabSize);o.push(W.range(c.from+u,c.from+h))}}}return o}function rN(e,t){let s=e.coordsAtPos(e.viewport.from);return s?Math.round(Math.abs((s.left-t)/e.defaultCharacterWidth)):-1}function Ew(e,t){let s=e.posAtCoords({x:t.clientX,y:t.clientY},!1),n=e.state.doc.lineAt(s),r=s-n.from,o=r>xp?-1:r==n.length?rN(e,t.clientX):Xo(n.text,e.state.tabSize,s-n.from);return{line:n.number,col:o,off:r}}function oN(e,t){let s=Ew(e,t),n=e.state.selection;return s?{update(r){if(r.docChanged){let o=r.changes.mapPos(r.startState.doc.line(s.line).from),i=r.state.doc.lineAt(o);s={line:i.number,col:s.col,off:Math.min(s.off,i.length)},n=n.map(r.changes)}},get(r,o,i){let a=Ew(e,r);if(!a)return n;let l=nN(e.state,s,a);return l.length?i?W.create(l.concat(n.ranges)):W.create(l):n}}:null}function iN(e){let t=(e==null?void 0:e.eventFilter)||(s=>s.altKey&&s.button==0);return et.mouseSelectionStyle.of((s,n)=>t(n)?oN(s,n):null)}const aN={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},lN={style:"cursor: crosshair"};function hN(e={}){let[t,s]=aN[e.key||"Alt"],n=ie.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==t||s(r))},keyup(r){(r.keyCode==t||!s(r))&&this.set(!1)},mousemove(r){this.set(s(r))}}});return[n,et.contentAttributes.of(r=>{var o;return!((o=r.plugin(n))===null||o===void 0)&&o.isDown?lN:null})]}const Ca="-10000px";class $w{constructor(t,s,n,r){this.facet=s,this.createTooltipView=n,this.removeTooltipView=r,this.input=t.state.facet(s),this.tooltips=this.input.filter(o=>o),this.tooltipViews=this.tooltips.map(n)}update(t,s){var n;let r=t.state.facet(this.facet),o=r.filter(l=>l);if(r===this.input){for(let l of this.tooltipViews)l.update&&l.update(t);return!1}let i=[],a=s?[]:null;for(let l=0;l<o.length;l++){let c=o[l],u=-1;if(c){for(let h=0;h<this.tooltips.length;h++){let d=this.tooltips[h];d&&d.create==c.create&&(u=h)}if(u<0)i[l]=this.createTooltipView(c),a&&(a[l]=!!c.above);else{let h=i[l]=this.tooltipViews[u];a&&(a[l]=s[u]),h.update&&h.update(t)}}}for(let l of this.tooltipViews)i.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return s&&(a.forEach((l,c)=>s[c]=l),s.length=a.length),this.input=r,this.tooltips=o,this.tooltipViews=i,!0}}function cN(e){let{win:t}=e;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}const _p=tt.define({combine:e=>{var t,s,n;return{position:st.ios?"absolute":((t=e.find(r=>r.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((s=e.find(r=>r.parent))===null||s===void 0?void 0:s.parent)||null,tooltipSpace:((n=e.find(r=>r.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||cN}}}),Rw=new WeakMap,Ap=ie.fromClass(class{constructor(e){this.view=e,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=e.state.facet(_p);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new $w(e,kp,s=>this.createTooltip(s),s=>{this.resizeObserver&&this.resizeObserver.unobserve(s.dom),s.dom.remove()}),this.above=this.manager.tooltips.map(s=>!!s.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(s=>{Date.now()>this.lastTransaction-50&&s.length>0&&s[s.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),e.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let e of this.manager.tooltipViews)this.intersectionObserver.observe(e.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e,this.above);t&&this.observeIntersection();let s=t||e.geometryChanged,n=e.state.facet(_p);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;s=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);s=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);s&&this.maybeMeasure()}createTooltip(e){let t=e.create(this.view);if(t.dom.classList.add("cm-tooltip"),e.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",t.dom.appendChild(s)}return t.dom.style.position=this.position,t.dom.style.top=Ca,t.dom.style.left="0px",this.container.appendChild(t.dom),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var e,t,s;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(e=n.destroy)===null||e===void 0||e.call(n);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(s=this.intersectionObserver)===null||s===void 0||s.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let e=this.view.dom.getBoundingClientRect(),t=1,s=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(st.gecko)n=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==Ca&&r.style.left=="0px"){let o=r.getBoundingClientRect();n=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(n||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(t=r.width/this.parent.offsetWidth,s=r.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:s}=this.view.viewState);return{editor:e,parent:this.parent?this.container.getBoundingClientRect():e,pos:this.manager.tooltips.map((r,o)=>{let i=this.manager.tooltipViews[o];return i.getCoords?i.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(_p).tooltipSpace(this.view),scaleX:t,scaleY:s,makeAbsolute:n}}writeMeasure(e){var t;if(e.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{editor:s,space:n,scaleX:r,scaleY:o}=e,i=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:u}=c,h=e.pos[a],d=e.size[a];if(!h||h.bottom<=Math.max(s.top,n.top)||h.top>=Math.min(s.bottom,n.bottom)||h.right<Math.max(s.left,n.left)-.1||h.left>Math.min(s.right,n.right)+.1){u.style.top=Ca;continue}let f=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=f?7:0,g=d.right-d.left,m=(t=Rw.get(c))!==null&&t!==void 0?t:d.bottom-d.top,y=c.offset||dN,v=this.view.textDirection==Zt.LTR,b=d.width>n.right-n.left?v?n.left:n.right-d.width:v?Math.min(h.left-(f?14:0)+y.x,n.right-g):Math.max(n.left,h.left-g+(f?14:0)-y.x),w=this.above[a];!l.strictSide&&(w?h.top-(d.bottom-d.top)-y.y<n.top:h.bottom+(d.bottom-d.top)+y.y>n.bottom)&&w==n.bottom-h.bottom>h.top-n.top&&(w=this.above[a]=!w);let S=(w?h.top-n.top:n.bottom-h.bottom)-p;if(S<m&&c.resize!==!1){if(S<this.view.defaultLineHeight){u.style.top=Ca;continue}Rw.set(c,m),u.style.height=(m=S)/o+"px"}else u.style.height&&(u.style.height="");let _=w?h.top-m-p-y.y:h.bottom+p+y.y,A=b+g;if(c.overlap!==!0)for(let O of i)O.left<A&&O.right>b&&O.top<_+m&&O.bottom>_&&(_=w?O.top-m-2-p:O.bottom+p+2);if(this.position=="absolute"?(u.style.top=(_-e.parent.top)/o+"px",u.style.left=(b-e.parent.left)/r+"px"):(u.style.top=_/o+"px",u.style.left=b/r+"px"),f){let O=h.left+(v?y.x:-y.x)-(b+14-7);f.style.left=O/r+"px"}c.overlap!==!0&&i.push({left:b,top:_,right:A,bottom:_+m}),u.classList.toggle("cm-tooltip-above",w),u.classList.toggle("cm-tooltip-below",!w),c.positioned&&c.positioned(e.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let e of this.manager.tooltipViews)e.dom.style.top=Ca}},{eventObservers:{scroll(){this.maybeMeasure()}}}),uN=et.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),dN={x:0,y:0},kp=tt.define({enables:[Ap,uN]}),Nh=tt.define();class Lh{static create(t){return new Lh(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new $w(t,Nh,s=>this.createHostedView(s),s=>s.dom.remove())}createHostedView(t){let s=t.create(this.view);return s.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(s.dom),this.mounted&&s.mount&&s.mount(this.view),s}mount(t){for(let s of this.manager.tooltipViews)s.mount&&s.mount(t);this.mounted=!0}positioned(t){for(let s of this.manager.tooltipViews)s.positioned&&s.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let s of this.manager.tooltipViews)(t=s.destroy)===null||t===void 0||t.call(s)}passProp(t){let s;for(let n of this.manager.tooltipViews){let r=n[t];if(r!==void 0){if(s===void 0)s=r;else if(s!==r)return}}return s}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const fN=kp.compute([Nh],e=>{let t=e.facet(Nh).filter(s=>s);return t.length===0?null:{pos:Math.min(...t.map(s=>s.pos)),end:Math.max(...t.map(s=>{var n;return(n=s.end)!==null&&n!==void 0?n:s.pos})),create:Lh.create,above:t[0].above,arrow:t.some(s=>s.arrow)}});class pN{constructor(t,s,n,r,o){this.view=t,this.source=s,this.field=n,this.setHover=r,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:s}=this,n=t.docView.nearest(s.target);if(!n)return;let r,o=1;if(n instanceof hr)r=n.posAtStart;else{if(r=t.posAtCoords(s),r==null)return;let a=t.coordsAtPos(r);if(!a||s.y<a.top||s.y>a.bottom||s.x<a.left-t.defaultCharacterWidth||s.x>a.right+t.defaultCharacterWidth)return;let l=t.bidiSpans(t.state.doc.lineAt(r)).find(u=>u.from<=r&&u.to>=r),c=l&&l.dir==Zt.RTL?-1:1;o=s.x<a.left?-c:c}let i=this.source(t,r,o);if(i!=null&&i.then){let a=this.pending={pos:r};i.then(l=>{this.pending==a&&(this.pending=null,l&&t.dispatch({effects:this.setHover.of(l)}))},l=>Ms(t.state,l,"hover tooltip"))}else i&&t.dispatch({effects:this.setHover.of(i)})}get tooltip(){let t=this.view.plugin(Ap),s=t?t.manager.tooltips.findIndex(n=>n.create==Lh.create):-1;return s>-1?t.manager.tooltipViews[s]:null}mousemove(t){var s;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:r}=this;if(n&&r&&!mN(r.dom,t)||this.pending){let{pos:o}=n||this.pending,i=(s=n==null?void 0:n.end)!==null&&s!==void 0?s:o;(o==i?this.view.posAtCoords(this.lastMove)!=o:!gN(this.view,o,i,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:s}=this;if(s){let{tooltip:n}=this;n&&n.dom.contains(t.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of(null)})}}watchTooltipLeave(t){let s=n=>{t.removeEventListener("mouseleave",s),this.active&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})};t.addEventListener("mouseleave",s)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Bh=4;function mN(e,t){let s=e.getBoundingClientRect();return t.clientX>=s.left-Bh&&t.clientX<=s.right+Bh&&t.clientY>=s.top-Bh&&t.clientY<=s.bottom+Bh}function gN(e,t,s,n,r,o){let i=e.scrollDOM.getBoundingClientRect(),a=e.documentTop+e.documentPadding.top+e.contentHeight;if(i.left>n||i.right<n||i.top>r||Math.min(i.bottom,a)<r)return!1;let l=e.posAtCoords({x:n,y:r},!1);return l>=t&&l<=s}function yN(e,t={}){let s=bt.define(),n=Ne.define({create(){return null},update(r,o){if(r&&(t.hideOnChange&&(o.docChanged||o.selection)||t.hideOn&&t.hideOn(o,r)))return null;if(r&&o.docChanged){let i=o.changes.mapPos(r.pos,-1,ns.TrackDel);if(i==null)return null;let a=Object.assign(Object.create(null),r);a.pos=i,r.end!=null&&(a.end=o.changes.mapPos(r.end)),r=a}for(let i of o.effects)i.is(s)&&(r=i.value),i.is(vN)&&(r=null);return r},provide:r=>Nh.from(r)});return[n,ie.define(r=>new pN(r,e,n,s,t.hoverTime||300)),fN]}function Dw(e,t){let s=e.plugin(Ap);if(!s)return null;let n=s.manager.tooltips.indexOf(t);return n<0?null:s.manager.tooltipViews[n]}const vN=bt.define(),Nw=tt.define({combine(e){let t,s;for(let n of e)t=t||n.topContainer,s=s||n.bottomContainer;return{topContainer:t,bottomContainer:s}}});function Oa(e,t){let s=e.plugin(Lw),n=s?s.specs.indexOf(t):-1;return n>-1?s.panels[n]:null}const Lw=ie.fromClass(class{constructor(e){this.input=e.state.facet(Ta),this.specs=this.input.filter(s=>s),this.panels=this.specs.map(s=>s(e));let t=e.state.facet(Nw);this.top=new jh(e,!0,t.topContainer),this.bottom=new jh(e,!1,t.bottomContainer),this.top.sync(this.panels.filter(s=>s.top)),this.bottom.sync(this.panels.filter(s=>!s.top));for(let s of this.panels)s.dom.classList.add("cm-panel"),s.mount&&s.mount()}update(e){let t=e.state.facet(Nw);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new jh(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new jh(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let s=e.state.facet(Ta);if(s!=this.input){let n=s.filter(l=>l),r=[],o=[],i=[],a=[];for(let l of n){let c=this.specs.indexOf(l),u;c<0?(u=l(e.view),a.push(u)):(u=this.panels[c],u.update&&u.update(e)),r.push(u),(u.top?o:i).push(u)}this.specs=n,this.panels=r,this.top.sync(o),this.bottom.sync(i);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(e)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:e=>et.scrollMargins.of(t=>{let s=t.plugin(e);return s&&{top:s.top.scrollMargin(),bottom:s.bottom.scrollMargin()}})});class jh{constructor(t,s,n){this.view=t,this.top=s,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let s of this.panels)s.destroy&&t.indexOf(s)<0&&s.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let s=this.container||this.view.dom;s.insertBefore(this.dom,this.top?s.firstChild:null)}let t=this.dom.firstChild;for(let s of this.panels)if(s.dom.parentNode==this.dom){for(;t!=s.dom;)t=Bw(t);t=t.nextSibling}else this.dom.insertBefore(s.dom,t);for(;t;)t=Bw(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Bw(e){let t=e.nextSibling;return e.remove(),t}const Ta=tt.define({enables:Lw});class Vn extends Gr{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Vn.prototype.elementClass="",Vn.prototype.toDOM=void 0,Vn.prototype.mapMode=ns.TrackBefore,Vn.prototype.startSide=Vn.prototype.endSide=-1,Vn.prototype.point=!0;const Fh=tt.define(),bN={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>$t.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Pa=tt.define();function wN(e){return[jw(),Pa.of(Object.assign(Object.assign({},bN),e))]}const Sp=tt.define({combine:e=>e.some(t=>t)});function jw(e){let t=[xN];return e&&e.fixed===!1&&t.push(Sp.of(!0)),t}const xN=ie.fromClass(class{constructor(e){this.view=e,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=e.state.facet(Pa).map(t=>new Vw(e,t));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!e.state.facet(Sp),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}update(e){if(this.updateGutters(e)){let t=this.prevViewport,s=e.view.viewport,n=Math.min(t.to,s.to)-Math.max(t.from,s.from);this.syncGutters(n<(s.to-s.from)*.8)}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Sp)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&this.dom.remove();let s=$t.iter(this.view.state.facet(Fh),this.view.viewport.from),n=[],r=this.gutters.map(o=>new _N(o,this.view.viewport,-this.view.documentPadding.top));for(let o of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(o.type)){let i=!0;for(let a of o.type)if(a.type==rs.Text&&i){Cp(s,n,a.from);for(let l of r)l.line(this.view,a,n);i=!1}else if(a.widget)for(let l of r)l.widget(this.view,a)}else if(o.type==rs.Text){Cp(s,n,o.from);for(let i of r)i.line(this.view,o,n)}else if(o.widget)for(let i of r)i.widget(this.view,o);for(let o of r)o.finish();e&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(e){let t=e.startState.facet(Pa),s=e.state.facet(Pa),n=e.docChanged||e.heightChanged||e.viewportChanged||!$t.eq(e.startState.facet(Fh),e.state.facet(Fh),e.view.viewport.from,e.view.viewport.to);if(t==s)for(let r of this.gutters)r.update(e)&&(n=!0);else{n=!0;let r=[];for(let o of s){let i=t.indexOf(o);i<0?r.push(new Vw(this.view,o)):(this.gutters[i].update(e),r.push(this.gutters[i]))}for(let o of this.gutters)o.dom.remove(),r.indexOf(o)<0&&o.destroy();for(let o of r)this.dom.appendChild(o.dom);this.gutters=r}return n}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove()}},{provide:e=>et.scrollMargins.of(t=>{let s=t.plugin(e);return!s||s.gutters.length==0||!s.fixed?null:t.textDirection==Zt.LTR?{left:s.dom.offsetWidth*t.scaleX}:{right:s.dom.offsetWidth*t.scaleX}})});function Fw(e){return Array.isArray(e)?e:[e]}function Cp(e,t,s){for(;e.value&&e.from<=s;)e.from==s&&t.push(e.value),e.next()}class _N{constructor(t,s,n){this.gutter=t,this.height=n,this.i=0,this.cursor=$t.iter(t.markers,s.from)}addElement(t,s,n){let{gutter:r}=this,o=(s.top-this.height)/t.scaleY,i=s.height/t.scaleY;if(this.i==r.elements.length){let a=new zw(t,i,o,n);r.elements.push(a),r.dom.appendChild(a.dom)}else r.elements[this.i].update(t,i,o,n);this.height=s.bottom,this.i++}line(t,s,n){let r=[];Cp(this.cursor,r,s.from),n.length&&(r=r.concat(n));let o=this.gutter.config.lineMarker(t,s,r);o&&r.unshift(o);let i=this.gutter;r.length==0&&!i.config.renderEmptyElements||this.addElement(t,s,r)}widget(t,s){let n=this.gutter.config.widgetMarker(t,s.widget,s);n&&this.addElement(t,s,[n])}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let s=t.elements.pop();t.dom.removeChild(s.dom),s.destroy()}}}class Vw{constructor(t,s){this.view=t,this.config=s,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in s.domEventHandlers)this.dom.addEventListener(n,r=>{let o=r.target,i;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let l=o.getBoundingClientRect();i=(l.top+l.bottom)/2}else i=r.clientY;let a=t.lineBlockAtHeight(i-t.documentTop);s.domEventHandlers[n](t,a,r)&&r.preventDefault()});this.markers=Fw(s.markers(t)),s.initialSpacer&&(this.spacer=new zw(t,0,0,[s.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let s=this.markers;if(this.markers=Fw(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],t);r!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[r])}let n=t.view.viewport;return!$t.eq(this.markers,s,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class zw{constructor(t,s,n,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,s,n,r)}update(t,s,n,r){this.height!=s&&(this.height=s,this.dom.style.height=s+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),AN(this.markers,r)||this.setMarkers(t,r)}setMarkers(t,s){let n="cm-gutterElement",r=this.dom.firstChild;for(let o=0,i=0;;){let a=i,l=o<s.length?s[o++]:null,c=!1;if(l){let u=l.elementClass;u&&(n+=" "+u);for(let h=i;h<this.markers.length;h++)if(this.markers[h].compare(l)){a=h,c=!0;break}}else a=this.markers.length;for(;i<a;){let u=this.markers[i++];if(u.toDOM){u.destroy(r);let h=r.nextSibling;r.remove(),r=h}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(t),r)),c&&i++}this.dom.className=n,this.markers=s}destroy(){this.setMarkers(null,[])}}function AN(e,t){if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++)if(!e[s].compare(t[s]))return!1;return!0}const kN=tt.define(),Jo=tt.define({combine(e){return pn(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,s){let n=Object.assign({},t);for(let r in s){let o=n[r],i=s[r];n[r]=o?(a,l,c)=>o(a,l,c)||i(a,l,c):i}return n}})}});class Op extends Vn{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Tp(e,t){return e.state.facet(Jo).formatNumber(t,e.state)}const SN=Pa.compute([Jo],e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(kN)},lineMarker(t,s,n){return n.some(r=>r.toDOM)?null:new Op(Tp(t,t.state.doc.lineAt(s.from).number))},widgetMarker:()=>null,lineMarkerChange:t=>t.startState.facet(Jo)!=t.state.facet(Jo),initialSpacer(t){return new Op(Tp(t,Gw(t.state.doc.lines)))},updateSpacer(t,s){let n=Tp(s.view,Gw(s.view.state.doc.lines));return n==t.number?t:new Op(n)},domEventHandlers:e.facet(Jo).domEventHandlers}));function CN(e={}){return[Jo.of(e),jw(),SN]}function Gw(e){let t=9;for(;t<e;)t=t*10+9;return t}const ON=new class extends Vn{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},TN=Fh.compute(["selection"],e=>{let t=[],s=-1;for(let n of e.selection.ranges){let r=e.doc.lineAt(n.head).from;r>s&&(s=r,t.push(ON.range(r)))}return $t.of(t)});function PN(){return TN}var Pp;const ti=new kt;function MN(e){return tt.define({combine:e?t=>t.concat(e):void 0})}const IN=new kt;class Zs{constructor(t,s,n=[],r=""){this.data=t,this.name=r,Mt.prototype.hasOwnProperty("tree")||Object.defineProperty(Mt.prototype,"tree",{get(){return Ye(this)}}),this.parser=s,this.extension=[pr.of(this),Mt.languageData.of((o,i,a)=>{let l=Uw(o,i,a),c=l.type.prop(ti);if(!c)return[];let u=o.facet(c),h=l.type.prop(IN);if(h){let d=l.resolve(i-l.from,a);for(let f of h)if(f.test(d,o)){let p=o.facet(f.facet);return f.type=="replace"?p:p.concat(u)}}return u})].concat(n)}isActiveAt(t,s,n=-1){return Uw(t,s,n).type.prop(ti)==this.data}findRegions(t){let s=t.facet(pr);if((s==null?void 0:s.data)==this.data)return[{from:0,to:t.doc.length}];if(!s||!s.allowsNesting)return[];let n=[],r=(o,i)=>{if(o.prop(ti)==this.data){n.push({from:i,to:i+o.length});return}let a=o.prop(kt.mounted);if(a){if(a.tree.prop(ti)==this.data){if(a.overlay)for(let l of a.overlay)n.push({from:l.from+i,to:l.to+i});else n.push({from:i,to:i+o.length});return}else if(a.overlay){let l=n.length;if(r(a.tree,a.overlay[0].from+i),n.length>l)return}}for(let l=0;l<o.children.length;l++){let c=o.children[l];c instanceof de&&r(c,o.positions[l]+i)}};return r(Ye(t),0),n}get allowsNesting(){return!0}}Zs.setState=bt.define();function Uw(e,t,s){let n=e.facet(pr),r=Ye(e).topNode;if(!n||n.allowsNesting)for(let o=r;o;o=o.enter(t,s,Pe.ExcludeBuffers))o.type.isTop&&(r=o);return r}class Vh extends Zs{constructor(t,s,n){super(t,s,[],n),this.parser=s}static define(t){let s=MN(t.languageData);return new Vh(s,t.parser.configure({props:[ti.add(n=>n.isTop?s:void 0)]}),t.name)}configure(t,s){return new Vh(this.data,this.parser.configure(t),s||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ye(e){let t=e.field(Zs.state,!1);return t?t.tree:de.empty}class EN{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,s){let n=this.cursorPos-this.string.length;return t<n||s>=this.cursorPos?this.doc.sliceString(t,s):this.string.slice(t-n,s-n)}}let Ma=null;class zh{constructor(t,s,n=[],r,o,i,a,l){this.parser=t,this.state=s,this.fragments=n,this.tree=r,this.treeLen=o,this.viewport=i,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,s,n){return new zh(t,s,[],de.empty,0,n,[],null)}startParse(){return this.parser.startParse(new EN(this.state.doc),this.fragments)}work(t,s){return s!=null&&s>=this.state.doc.length&&(s=void 0),this.tree!=de.empty&&this.isDone(s??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof t=="number"){let r=Date.now()+t;t=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),s!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>s)&&s<this.state.doc.length&&this.parse.stopAt(s);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(Lr.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(s??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,s;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(s=this.parse.advance()););}),this.treeLen=t,this.tree=s,this.fragments=this.withoutTempSkipped(Lr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let s=Ma;Ma=this;try{return t()}finally{Ma=s}}withoutTempSkipped(t){for(let s;s=this.tempSkipped.pop();)t=Hw(t,s.from,s.to);return t}changes(t,s){let{fragments:n,tree:r,treeLen:o,viewport:i,skipped:a}=this;if(this.takeTree(),!t.empty){let l=[];if(t.iterChangedRanges((c,u,h,d)=>l.push({fromA:c,toA:u,fromB:h,toB:d})),n=Lr.applyChanges(n,l),r=de.empty,o=0,i={from:t.mapPos(i.from,-1),to:t.mapPos(i.to,1)},this.skipped.length){a=[];for(let c of this.skipped){let u=t.mapPos(c.from,1),h=t.mapPos(c.to,-1);u<h&&a.push({from:u,to:h})}}}return new zh(this.parser,s,n,r,o,i,a,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let s=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:r,to:o}=this.skipped[n];r<t.to&&o>t.from&&(this.fragments=Hw(this.fragments,r,o),this.skipped.splice(n--,1))}return this.skipped.length>=s?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,s){this.skipped.push({from:t,to:s})}static getSkippingParser(t){return new class extends qv{createParse(s,n,r){let o=r[0].from,i=r[r.length-1].to;return{parsedPos:o,advance(){let a=Ma;if(a){for(let l of r)a.tempSkipped.push(l);t&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,t]):t)}return this.parsedPos=i,new de(cs.none,[],[],i-o)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let s=this.fragments;return this.treeLen>=t&&s.length&&s[0].from==0&&s[0].to>=t}static get(){return Ma}}function Hw(e,t,s){return Lr.applyChanges(e,[{fromA:t,toA:s,fromB:t,toB:s}])}class ei{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let s=this.context.changes(t.changes,t.state),n=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),s.viewport.to);return s.work(20,n)||s.takeTree(),new ei(s)}static init(t){let s=Math.min(3e3,t.doc.length),n=zh.create(t.facet(pr).parser,t,{from:0,to:s});return n.work(20,s)||n.takeTree(),new ei(n)}}Zs.state=Ne.define({create:ei.init,update(e,t){for(let s of t.effects)if(s.is(Zs.setState))return s.value;return t.startState.facet(pr)!=t.state.facet(pr)?ei.init(t.state):e.apply(t)}});let Ww=e=>{let t=setTimeout(()=>e(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Ww=e=>{let t=-1,s=setTimeout(()=>{t=requestIdleCallback(e,{timeout:500-100})},100);return()=>t<0?clearTimeout(s):cancelIdleCallback(t)});const Mp=typeof navigator<"u"&&!((Pp=navigator.scheduling)===null||Pp===void 0)&&Pp.isInputPending?()=>navigator.scheduling.isInputPending():null,$N=ie.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Zs.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Zs.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=Ww(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:s,viewport:{to:n}}=this.view,r=s.field(Zs.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Mp?Math.max(25,e.timeRemaining()-5):1e9),i=r.context.treeLen<n&&s.doc.length>n+1e3,a=r.context.work(()=>Mp&&Mp()||Date.now()>o,n+(i?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Zs.setState.of(new ei(r.context))})),this.chunkBudget>0&&!(a&&!i)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Ms(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),pr=tt.define({combine(e){return e.length?e[0]:null},enables:e=>[Zs.state,$N,et.contentAttributes.compute([e],t=>{let s=t.facet(e);return s&&s.name?{"data-language":s.name}:{}})]});class RN{constructor(t,s=[]){this.language=t,this.support=s,this.extension=[t,s]}}const DN=tt.define(),Gh=tt.define({combine:e=>{if(!e.length)return"  ";let t=e[0];if(!t||/\S/.test(t)||Array.from(t).some(s=>s!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function Uh(e){let t=e.facet(Gh);return t.charCodeAt(0)==9?e.tabSize*t.length:t.length}function Ia(e,t){let s="",n=e.tabSize,r=e.facet(Gh)[0];if(r=="	"){for(;t>=n;)s+="	",t-=n;r=" "}for(let o=0;o<t;o++)s+=r;return s}function Ip(e,t){e instanceof Mt&&(e=new Hh(e));for(let n of e.state.facet(DN)){let r=n(e,t);if(r!==void 0)return r}let s=Ye(e.state);return s.length>=t?NN(e,s,t):null}class Hh{constructor(t,s={}){this.state=t,this.options=s,this.unit=Uh(t)}lineAt(t,s=1){let n=this.state.doc.lineAt(t),{simulateBreak:r,simulateDoubleBreak:o}=this.options;return r!=null&&r>=n.from&&r<=n.to?o&&r==t?{text:"",from:t}:(s<0?r<t:r<=t)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(t,s=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(t,s);return n.slice(t-r,Math.min(n.length,t+100-r))}column(t,s=1){let{text:n,from:r}=this.lineAt(t,s),o=this.countColumn(n,t-r),i=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return i>-1&&(o+=i-this.countColumn(n,n.search(/\S|$/))),o}countColumn(t,s=t.length){return Xo(t,this.state.tabSize,s)}lineIndent(t,s=1){let{text:n,from:r}=this.lineAt(t,s),o=this.options.overrideIndentation;if(o){let i=o(r);if(i>-1)return i}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Xw=new kt;function NN(e,t,s){let n=t.resolveStack(s),r=n.node.enterUnfinishedNodesBefore(s);if(r!=n.node){let o=[];for(let i=r;i!=n.node;i=i.parent)o.push(i);for(let i=o.length-1;i>=0;i--)n={node:o[i],next:n}}return Yw(n,e,s)}function Yw(e,t,s){for(let n=e;n;n=n.next){let r=BN(n.node);if(r)return r(Ep.create(t,s,n))}return 0}function LN(e){return e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak}function BN(e){let t=e.type.prop(Xw);if(t)return t;let s=e.firstChild,n;if(s&&(n=s.type.prop(kt.closedBy))){let r=e.lastChild,o=r&&n.indexOf(r.name)>-1;return i=>qw(i,!0,1,void 0,o&&!LN(i)?r.from:void 0)}return e.parent==null?jN:null}function jN(){return 0}class Ep extends Hh{constructor(t,s,n){super(t.state,t.options),this.base=t,this.pos=s,this.context=n}get node(){return this.context.node}static create(t,s,n){return new Ep(t,s,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let s=this.state.doc.lineAt(t.from);for(;;){let n=t.resolve(s.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(FN(n,t))break;s=this.state.doc.lineAt(n.from)}return this.lineIndent(s.from)}continue(){return Yw(this.context.next,this.base,this.pos)}}function FN(e,t){for(let s=t;s;s=s.parent)if(e==s)return!0;return!1}function VN(e){let t=e.node,s=t.childAfter(t.from),n=t.lastChild;if(!s)return null;let r=e.options.simulateBreak,o=e.state.doc.lineAt(s.from),i=r==null||r<=o.from?o.to:Math.min(o.to,r);for(let a=s.to;;){let l=t.childAfter(a);if(!l||l==n)return null;if(!l.type.isSkipped)return l.from<i?s:null;a=l.to}}function Zw({closing:e,align:t=!0,units:s=1}){return n=>qw(n,t,s,e)}function qw(e,t,s,n,r){let o=e.textAfter,i=o.match(/^\s*/)[0].length,a=n&&o.slice(i,i+n.length)==n||r==e.pos+i,l=t?VN(e):null;return l?a?e.column(l.from):e.column(l.to):e.baseIndent+(a?0:e.unit*s)}const zN=200;function GN(){return Mt.transactionFilter.of(e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let s=e.newDoc,{head:n}=e.newSelection.main,r=s.lineAt(n);if(n>r.from+zN)return e;let o=s.sliceString(r.from,n);if(!t.some(c=>c.test(o)))return e;let{state:i}=e,a=-1,l=[];for(let{head:c}of i.selection.ranges){let u=i.doc.lineAt(c);if(u.from==a)continue;a=u.from;let h=Ip(i,u.from);if(h==null)continue;let d=/^\s*/.exec(u.text)[0],f=Ia(i,h);d!=f&&l.push({from:u.from,to:u.from+d.length,insert:f})}return l.length?[e,{changes:l,sequential:!0}]:e})}const UN=tt.define(),Qw=new kt;function HN(e){let t=e.firstChild,s=e.lastChild;return t&&t.to<s.from?{from:t.to,to:s.type.isError?e.to:s.from}:null}function WN(e,t,s){let n=Ye(e);if(n.length<s)return null;let r=n.resolveStack(s,1),o=null;for(let i=r;i;i=i.next){let a=i.node;if(a.to<=s||a.from>s)continue;if(o&&a.from<t)break;let l=a.type.prop(Qw);if(l&&(a.to<n.length-50||n.length==e.doc.length||!XN(a))){let c=l(a,e);c&&c.from<=s&&c.from>=t&&c.to>s&&(o=c)}}return o}function XN(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}function Wh(e,t,s){for(let n of e.facet(UN)){let r=n(e,t,s);if(r)return r}return WN(e,t,s)}function Kw(e,t){let s=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);return s>=n?void 0:{from:s,to:n}}const Xh=bt.define({map:Kw}),Ea=bt.define({map:Kw});function Jw(e){let t=[];for(let{head:s}of e.state.selection.ranges)t.some(n=>n.from<=s&&n.to>=s)||t.push(e.lineBlockAt(s));return t}const Wr=Ne.define({create(){return ut.none},update(e,t){e=e.map(t.changes);for(let s of t.effects)if(s.is(Xh)&&!YN(e,s.value.from,s.value.to)){let{preparePlaceholder:n}=t.state.facet($p),r=n?ut.replace({widget:new eL(n(t.state,s.value))}):rx;e=e.update({add:[r.range(s.value.from,s.value.to)]})}else s.is(Ea)&&(e=e.update({filter:(n,r)=>s.value.from!=n||s.value.to!=r,filterFrom:s.value.from,filterTo:s.value.to}));if(t.selection){let s=!1,{head:n}=t.selection.main;e.between(n,n,(r,o)=>{r<n&&o>n&&(s=!0)}),s&&(e=e.update({filterFrom:n,filterTo:n,filter:(r,o)=>o<=n||r>=n}))}return e},provide:e=>et.decorations.from(e),toJSON(e,t){let s=[];return e.between(0,t.doc.length,(n,r)=>{s.push(n,r)}),s},fromJSON(e){if(!Array.isArray(e)||e.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let s=0;s<e.length;){let n=e[s++],r=e[s++];if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");t.push(rx.range(n,r))}return ut.set(t,!0)}});function Yh(e,t,s){var n;let r=null;return(n=e.field(Wr,!1))===null||n===void 0||n.between(t,s,(o,i)=>{(!r||r.from>o)&&(r={from:o,to:i})}),r}function YN(e,t,s){let n=!1;return e.between(t,t,(r,o)=>{r==t&&o==s&&(n=!0)}),n}function tx(e,t){return e.field(Wr,!1)?t:t.concat(bt.appendConfig.of(sx()))}const ZN=e=>{for(let t of Jw(e)){let s=Wh(e.state,t.from,t.to);if(s)return e.dispatch({effects:tx(e.state,[Xh.of(s),ex(e,s)])}),!0}return!1},qN=e=>{if(!e.state.field(Wr,!1))return!1;let t=[];for(let s of Jw(e)){let n=Yh(e.state,s.from,s.to);n&&t.push(Ea.of(n),ex(e,n,!1))}return t.length&&e.dispatch({effects:t}),t.length>0};function ex(e,t,s=!0){let n=e.state.doc.lineAt(t.from).number,r=e.state.doc.lineAt(t.to).number;return et.announce.of(`${e.state.phrase(s?"Folded lines":"Unfolded lines")} ${n} ${e.state.phrase("to")} ${r}.`)}const QN=e=>{let{state:t}=e,s=[];for(let n=0;n<t.doc.length;){let r=e.lineBlockAt(n),o=Wh(t,r.from,r.to);o&&s.push(Xh.of(o)),n=(o?e.lineBlockAt(o.to):r).to+1}return s.length&&e.dispatch({effects:tx(e.state,s)}),!!s.length},KN=e=>{let t=e.state.field(Wr,!1);if(!t||!t.size)return!1;let s=[];return t.between(0,e.state.doc.length,(n,r)=>{s.push(Ea.of({from:n,to:r}))}),e.dispatch({effects:s}),!0},JN=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:ZN},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:qN},{key:"Ctrl-Alt-[",run:QN},{key:"Ctrl-Alt-]",run:KN}],tL={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},$p=tt.define({combine(e){return pn(e,tL)}});function sx(e){let t=[Wr,rL];return e&&t.push($p.of(e)),t}function nx(e,t){let{state:s}=e,n=s.facet($p),r=i=>{let a=e.lineBlockAt(e.posAtDOM(i.target)),l=Yh(e.state,a.from,a.to);l&&e.dispatch({effects:Ea.of(l)}),i.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(e,r,t);let o=document.createElement("span");return o.textContent=n.placeholderText,o.setAttribute("aria-label",s.phrase("folded code")),o.title=s.phrase("unfold"),o.className="cm-foldPlaceholder",o.onclick=r,o}const rx=ut.replace({widget:new class extends Fn{toDOM(e){return nx(e,null)}}});class eL extends Fn{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return nx(t,this.value)}}const sL={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Rp extends Vn{constructor(t,s){super(),this.config=t,this.open=s}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let s=document.createElement("span");return s.textContent=this.open?this.config.openText:this.config.closedText,s.title=t.state.phrase(this.open?"Fold line":"Unfold line"),s}}function nL(e={}){let t=Object.assign(Object.assign({},sL),e),s=new Rp(t,!0),n=new Rp(t,!1),r=ie.fromClass(class{constructor(i){this.from=i.viewport.from,this.markers=this.buildMarkers(i)}update(i){(i.docChanged||i.viewportChanged||i.startState.facet(pr)!=i.state.facet(pr)||i.startState.field(Wr,!1)!=i.state.field(Wr,!1)||Ye(i.startState)!=Ye(i.state)||t.foldingChanged(i))&&(this.markers=this.buildMarkers(i.view))}buildMarkers(i){let a=new ir;for(let l of i.viewportLineBlocks){let c=Yh(i.state,l.from,l.to)?n:Wh(i.state,l.from,l.to)?s:null;c&&a.add(l.from,l.from,c)}return a.finish()}}),{domEventHandlers:o}=t;return[r,wN({class:"cm-foldGutter",markers(i){var a;return((a=i.plugin(r))===null||a===void 0?void 0:a.markers)||$t.empty},initialSpacer(){return new Rp(t,!1)},domEventHandlers:Object.assign(Object.assign({},o),{click:(i,a,l)=>{if(o.click&&o.click(i,a,l))return!0;let c=Yh(i.state,a.from,a.to);if(c)return i.dispatch({effects:Ea.of(c)}),!0;let u=Wh(i.state,a.from,a.to);return u?(i.dispatch({effects:Xh.of(u)}),!0):!1}})}),sx()]}const rL=et.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class $a{constructor(t,s){this.specs=t;let n;function r(a){let l=ar.newName();return(n||(n=Object.create(null)))["."+l]=a,l}const o=typeof s.all=="string"?s.all:s.all?r(s.all):void 0,i=s.scope;this.scope=i instanceof Zs?a=>a.prop(ti)==i.data:i?a=>a==i:void 0,this.style=ob(t.map(a=>({tag:a.tag,class:a.class||r(Object.assign({},a,{tag:null}))})),{all:o}).style,this.module=n?new ar(n):null,this.themeType=s.themeType}static define(t,s){return new $a(t,s||{})}}const Dp=tt.define(),ox=tt.define({combine(e){return e.length?[e[0]]:null}});function Np(e){let t=e.facet(Dp);return t.length?t:e.facet(ox)}function ix(e,t){let s=[iL],n;return e instanceof $a&&(e.module&&s.push(et.styleModule.of(e.module)),n=e.themeType),t!=null&&t.fallback?s.push(ox.of(e)):n?s.push(Dp.computeN([et.darkTheme],r=>r.facet(et.darkTheme)==(n=="dark")?[e]:[])):s.push(Dp.of(e)),s}class oL{constructor(t){this.markCache=Object.create(null),this.tree=Ye(t.state),this.decorations=this.buildDeco(t,Np(t.state)),this.decoratedTo=t.viewport.to}update(t){let s=Ye(t.state),n=Np(t.state),r=n!=Np(t.startState),{viewport:o}=t.view,i=t.changes.mapPos(this.decoratedTo,1);s.length<o.to&&!r&&s.type==this.tree.type&&i>=o.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=i):(s!=this.tree||t.viewportChanged||r)&&(this.tree=s,this.decorations=this.buildDeco(t.view,n),this.decoratedTo=o.to)}buildDeco(t,s){if(!s||!this.tree.length)return ut.none;let n=new ir;for(let{from:r,to:o}of t.visibleRanges)o$(this.tree,s,(i,a,l)=>{n.add(i,a,this.markCache[l]||(this.markCache[l]=ut.mark({class:l})))},r,o);return n.finish()}}const iL=Ho.high(ie.fromClass(oL,{decorations:e=>e.decorations})),aL=$a.define([{tag:I.meta,color:"#404740"},{tag:I.link,textDecoration:"underline"},{tag:I.heading,textDecoration:"underline",fontWeight:"bold"},{tag:I.emphasis,fontStyle:"italic"},{tag:I.strong,fontWeight:"bold"},{tag:I.strikethrough,textDecoration:"line-through"},{tag:I.keyword,color:"#708"},{tag:[I.atom,I.bool,I.url,I.contentSeparator,I.labelName],color:"#219"},{tag:[I.literal,I.inserted],color:"#164"},{tag:[I.string,I.deleted],color:"#a11"},{tag:[I.regexp,I.escape,I.special(I.string)],color:"#e40"},{tag:I.definition(I.variableName),color:"#00f"},{tag:I.local(I.variableName),color:"#30a"},{tag:[I.typeName,I.namespace],color:"#085"},{tag:I.className,color:"#167"},{tag:[I.special(I.variableName),I.macroName],color:"#256"},{tag:I.definition(I.propertyName),color:"#00c"},{tag:I.comment,color:"#940"},{tag:I.invalid,color:"#f00"}]),lL=et.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),ax=1e4,lx="()[]{}",hx=tt.define({combine(e){return pn(e,{afterCursor:!0,brackets:lx,maxScanDistance:ax,renderMatch:uL})}}),hL=ut.mark({class:"cm-matchingBracket"}),cL=ut.mark({class:"cm-nonmatchingBracket"});function uL(e){let t=[],s=e.matched?hL:cL;return t.push(s.range(e.start.from,e.start.to)),e.end&&t.push(s.range(e.end.from,e.end.to)),t}const dL=Ne.define({create(){return ut.none},update(e,t){if(!t.docChanged&&!t.selection)return e;let s=[],n=t.state.facet(hx);for(let r of t.state.selection.ranges){if(!r.empty)continue;let o=yn(t.state,r.head,-1,n)||r.head>0&&yn(t.state,r.head-1,1,n)||n.afterCursor&&(yn(t.state,r.head,1,n)||r.head<t.state.doc.length&&yn(t.state,r.head+1,-1,n));o&&(s=s.concat(n.renderMatch(o,t.state)))}return ut.set(s,!0)},provide:e=>et.decorations.from(e)}),fL=[dL,lL];function pL(e={}){return[hx.of(e),fL]}const mL=new kt;function Lp(e,t,s){let n=e.prop(t<0?kt.openedBy:kt.closedBy);if(n)return n;if(e.name.length==1){let r=s.indexOf(e.name);if(r>-1&&r%2==(t<0?1:0))return[s[r+t]]}return null}function Bp(e){let t=e.type.prop(mL);return t?t(e.node):e}function yn(e,t,s,n={}){let r=n.maxScanDistance||ax,o=n.brackets||lx,i=Ye(e),a=i.resolveInner(t,s);for(let l=a;l;l=l.parent){let c=Lp(l.type,s,o);if(c&&l.from<l.to){let u=Bp(l);if(u&&(s>0?t>=u.from&&t<u.to:t>u.from&&t<=u.to))return gL(e,t,s,l,u,c,o)}}return yL(e,t,s,i,a.type,r,o)}function gL(e,t,s,n,r,o,i){let a=n.parent,l={from:r.from,to:r.to},c=0,u=a==null?void 0:a.cursor();if(u&&(s<0?u.childBefore(n.from):u.childAfter(n.to)))do if(s<0?u.to<=n.from:u.from>=n.to){if(c==0&&o.indexOf(u.type.name)>-1&&u.from<u.to){let h=Bp(u);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(Lp(u.type,s,i))c++;else if(Lp(u.type,-s,i)){if(c==0){let h=Bp(u);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}c--}}while(s<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function yL(e,t,s,n,r,o,i){let a=s<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=i.indexOf(a);if(l<0||l%2==0!=s>0)return null;let c={from:s<0?t-1:t,to:s>0?t+1:t},u=e.doc.iterRange(t,s>0?e.doc.length:0),h=0;for(let d=0;!u.next().done&&d<=o;){let f=u.value;s<0&&(d+=f.length);let p=t+d*s;for(let g=s>0?0:f.length-1,m=s>0?f.length:-1;g!=m;g+=s){let y=i.indexOf(f[g]);if(!(y<0||n.resolveInner(p+g,1).type!=r))if(y%2==0==s>0)h++;else{if(h==1)return{start:c,end:{from:p+g,to:p+g+1},matched:y>>1==l>>1};h--}}s>0&&(d+=f.length)}return u.done?{start:c,matched:!1}:null}const vL=Object.create(null),cx=[cs.none],ux=[],dx=Object.create(null),bL=Object.create(null);for(let[e,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])bL[e]=wL(vL,t);function jp(e,t){ux.indexOf(e)>-1||(ux.push(e),console.warn(t))}function wL(e,t){let s=[];for(let a of t.split(" ")){let l=[];for(let c of a.split(".")){let u=e[c]||I[c];u?typeof u=="function"?l.length?l=l.map(u):jp(c,`Modifier ${c} used at start of tag`):l.length?jp(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:jp(c,`Unknown highlighting tag ${c}`)}for(let c of l)s.push(c)}if(!s.length)return 0;let n=t.replace(/ /g,"_"),r=n+" "+s.map(a=>a.id),o=dx[r];if(o)return o.id;let i=dx[r]=cs.define({id:cx.length,name:n,props:[nb({[n]:s})]});return cx.push(i),i.id}Zt.RTL,Zt.LTR;const xL=Vh.define({name:"yaml",parser:D$.configure({props:[Xw.add({Stream:e=>{for(let t=e.node.resolve(e.pos,-1);t&&t.to>=e.pos;t=t.parent){if(t.name=="BlockLiteralContent"&&t.from<t.to)return e.baseIndentFor(t);if(t.name=="BlockLiteral")return e.baseIndentFor(t)+e.unit;if(t.name=="BlockSequence"||t.name=="BlockMapping")return e.column(t.from,1);if(t.name=="QuotedLiteral")return null;if(t.name=="Literal"){let s=e.column(t.from,1);if(s==e.lineIndent(t.from,1))return s;if(t.to>e.pos)return null}}return null},FlowMapping:Zw({closing:"}"}),FlowSequence:Zw({closing:"]"})}),Qw.add({"FlowMapping FlowSequence":HN,"BlockSequence BlockMapping BlockLiteral":(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})})]}),languageData:{commentTokens:{line:"#"},indentOnInput:/^\s*[\]\}]$/}});function _L(){return new RN(xL)}function Zh(){return Zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},Zh.apply(this,arguments)}var fx=e=>{var{theme:t,settings:s={},styles:n=[]}=e,r={".cm-gutters":{}},o={};s.background&&(o.backgroundColor=s.background),s.backgroundImage&&(o.backgroundImage=s.backgroundImage),s.foreground&&(o.color=s.foreground),(s.background||s.foreground)&&(r["&"]=o),s.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:s.fontFamily}),s.gutterBackground&&(r[".cm-gutters"].backgroundColor=s.gutterBackground),s.gutterForeground&&(r[".cm-gutters"].color=s.gutterForeground),s.gutterBorder&&(r[".cm-gutters"].borderRightColor=s.gutterBorder),s.caret&&(r[".cm-content"]={caretColor:s.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:s.caret});var i={};s.gutterActiveForeground&&(i.color=s.gutterActiveForeground),s.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:s.lineHighlight},i.backgroundColor=s.lineHighlight),r[".cm-activeLineGutter"]=i,s.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:s.selection+" !important"}),s.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:s.selectionMatch});var a=et.theme(r,{dark:t==="dark"}),l=$a.define(n),c=[a,ix(l)];return c},AL={background:"#2e3235",foreground:"#bdbdbd",caret:"#a0a4ae",selection:"#d7d4f063",selectionMatch:"#d7d4f063",gutterBackground:"#2e3235",gutterForeground:"#999",gutterActiveForeground:"#4f5b66",lineHighlight:"#545b6130"},px=e=>{var{theme:t="dark",settings:s={},styles:n=[]}=e||{};return fx({theme:t,settings:Zh({},AL,s),styles:[{tag:I.keyword,color:"#cf6edf"},{tag:[I.name,I.deleted,I.character,I.macroName],color:"#56c8d8"},{tag:[I.propertyName],color:"#facf4e"},{tag:[I.variableName],color:"#bdbdbd"},{tag:[I.function(I.variableName)],color:"#56c8d8"},{tag:[I.labelName],color:"#cf6edf"},{tag:[I.color,I.constant(I.name),I.standard(I.name)],color:"#facf4e"},{tag:[I.definition(I.name),I.separator],color:"#fa5788"},{tag:[I.brace],color:"#cf6edf"},{tag:[I.annotation],color:"#ff5f52"},{tag:[I.number,I.changed,I.annotation,I.modifier,I.self,I.namespace],color:"#ffad42"},{tag:[I.typeName,I.className],color:"#ffad42"},{tag:[I.operator,I.operatorKeyword],color:"#7186f0"},{tag:[I.tagName],color:"#99d066"},{tag:[I.squareBracket],color:"#ff5f52"},{tag:[I.angleBracket],color:"#606f7a"},{tag:[I.attributeName],color:"#bdbdbd"},{tag:[I.regexp],color:"#ff5f52"},{tag:[I.quote],color:"#6abf69"},{tag:[I.string],color:"#99d066"},{tag:I.link,color:"#56c8d8",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[I.url,I.escape,I.special(I.string)],color:"#facf4e"},{tag:[I.meta],color:"#707d8b"},{tag:[I.comment],color:"#707d8b",fontStyle:"italic"},{tag:I.monospace,color:"#bdbdbd"},{tag:I.strong,fontWeight:"bold",color:"#ff5f52"},{tag:I.emphasis,fontStyle:"italic",color:"#99d066"},{tag:I.strikethrough,textDecoration:"line-through"},{tag:I.heading,fontWeight:"bold",color:"#facf4e"},{tag:I.heading1,fontWeight:"bold",color:"#facf4e"},{tag:[I.heading2,I.heading3,I.heading4],fontWeight:"bold",color:"#facf4e"},{tag:[I.heading5,I.heading6],color:"#facf4e"},{tag:[I.atom,I.bool,I.special(I.variableName)],color:"#56c8d8"},{tag:[I.processingInstruction,I.inserted],color:"#ff5f52"},{tag:[I.contentSeparator],color:"#56c8d8"},{tag:I.invalid,color:"#606f7a",borderBottom:"1px dotted #ff5f52"},...n]})},kL=px();px();var SL={background:"#FAFAFA",foreground:"#90A4AE",caret:"#272727",selection:"#80CBC440",selectionMatch:"#80CBC440",gutterBackground:"#FAFAFA",gutterForeground:"#90A4AE",gutterBorder:"transparent",lineHighlight:"#CCD7DA50"},CL=e=>{var{theme:t="light",settings:s={},styles:n=[]}=e||{};return fx({theme:t,settings:Zh({},SL,s),styles:[{tag:I.keyword,color:"#39ADB5"},{tag:[I.name,I.deleted,I.character,I.macroName],color:"#90A4AE"},{tag:[I.propertyName],color:"#6182B8"},{tag:[I.processingInstruction,I.string,I.inserted,I.special(I.string)],color:"#91B859"},{tag:[I.function(I.variableName),I.labelName],color:"#6182B8"},{tag:[I.color,I.constant(I.name),I.standard(I.name)],color:"#39ADB5"},{tag:[I.definition(I.name),I.separator],color:"#90A4AE"},{tag:[I.className],color:"#E2931D"},{tag:[I.number,I.changed,I.annotation,I.modifier,I.self,I.namespace],color:"#F76D47"},{tag:[I.typeName],color:"#E2931D",fontStyle:"#E2931D"},{tag:[I.operator,I.operatorKeyword],color:"#39ADB5"},{tag:[I.url,I.escape,I.regexp,I.link],color:"#91B859"},{tag:[I.meta,I.comment],color:"#90A4AE"},{tag:I.strong,fontWeight:"bold"},{tag:I.emphasis,fontStyle:"italic"},{tag:I.link,textDecoration:"underline"},{tag:I.heading,fontWeight:"bold",color:"#39ADB5"},{tag:[I.atom,I.bool,I.special(I.variableName)],color:"#90A4AE"},{tag:I.invalid,color:"#E5393570"},{tag:I.strikethrough,textDecoration:"line-through"},...n]})};CL();const OL=e=>{let{state:t}=e,s=t.doc.lineAt(t.selection.main.from),n=Vp(e.state,s.from);return n.line?TL(e):n.block?ML(e):!1};function Fp(e,t){return({state:s,dispatch:n})=>{if(s.readOnly)return!1;let r=e(t,s);return r?(n(s.update(r)),!0):!1}}const TL=Fp($L,0),PL=Fp(mx,0),ML=Fp((e,t)=>mx(e,t,EL(t)),0);function Vp(e,t){let s=e.languageDataAt("commentTokens",t);return s.length?s[0]:{}}const Ra=50;function IL(e,{open:t,close:s},n,r){let o=e.sliceDoc(n-Ra,n),i=e.sliceDoc(r,r+Ra),a=/\s*$/.exec(o)[0].length,l=/^\s*/.exec(i)[0].length,c=o.length-a;if(o.slice(c-t.length,c)==t&&i.slice(l,l+s.length)==s)return{open:{pos:n-a,margin:a&&1},close:{pos:r+l,margin:l&&1}};let u,h;r-n<=2*Ra?u=h=e.sliceDoc(n,r):(u=e.sliceDoc(n,n+Ra),h=e.sliceDoc(r-Ra,r));let d=/^\s*/.exec(u)[0].length,f=/\s*$/.exec(h)[0].length,p=h.length-f-s.length;return u.slice(d,d+t.length)==t&&h.slice(p,p+s.length)==s?{open:{pos:n+d+t.length,margin:/\s/.test(u.charAt(d+t.length))?1:0},close:{pos:r-f-s.length,margin:/\s/.test(h.charAt(p-1))?1:0}}:null}function EL(e){let t=[];for(let s of e.selection.ranges){let n=e.doc.lineAt(s.from),r=s.to<=n.to?n:e.doc.lineAt(s.to),o=t.length-1;o>=0&&t[o].to>n.from?t[o].to=r.to:t.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:r.to})}return t}function mx(e,t,s=t.selection.ranges){let n=s.map(o=>Vp(t,o.from).block);if(!n.every(o=>o))return null;let r=s.map((o,i)=>IL(t,n[i],o.from,o.to));if(e!=2&&!r.every(o=>o))return{changes:t.changes(s.map((o,i)=>r[i]?[]:[{from:o.from,insert:n[i].open+" "},{from:o.to,insert:" "+n[i].close}]))};if(e!=1&&r.some(o=>o)){let o=[];for(let i=0,a;i<r.length;i++)if(a=r[i]){let l=n[i],{open:c,close:u}=a;o.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:o}}return null}function $L(e,t,s=t.selection.ranges){let n=[],r=-1;for(let{from:o,to:i}of s){let a=n.length,l=1e9,c=Vp(t,o).line;if(c){for(let u=o;u<=i;){let h=t.doc.lineAt(u);if(h.from>r&&(o==i||i>h.from)){r=h.from;let d=/^\s*/.exec(h.text)[0].length,f=d==h.length,p=h.text.slice(d,d+c.length)==c?d:-1;d<h.text.length&&d<l&&(l=d),n.push({line:h,comment:p,token:c,indent:d,empty:f,single:!1})}u=h.to+1}if(l<1e9)for(let u=a;u<n.length;u++)n[u].indent<n[u].line.text.length&&(n[u].indent=l);n.length==a+1&&(n[a].single=!0)}}if(e!=2&&n.some(o=>o.comment<0&&(!o.empty||o.single))){let o=[];for(let{line:a,token:l,indent:c,empty:u,single:h}of n)(h||!u)&&o.push({from:a.from+c,insert:l+" "});let i=t.changes(o);return{changes:i,selection:t.selection.map(i,1)}}else if(e!=1&&n.some(o=>o.comment>=0)){let o=[];for(let{line:i,comment:a,token:l}of n)if(a>=0){let c=i.from+a,u=c+l.length;i.text[u-i.from]==" "&&u++,o.push({from:c,to:u})}return{changes:o}}return null}const zp=Nn.define(),RL=Nn.define(),DL=tt.define(),gx=tt.define({combine(e){return pn(e,{minDepth:100,newGroupDelay:500,joinToEvent:(t,s)=>s},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,s)=>(n,r)=>t(n,r)||s(n,r)})}}),yx=Ne.define({create(){return vn.empty},update(e,t){let s=t.state.facet(gx),n=t.annotation(zp);if(n){let l=us.fromTransaction(t,n.selection),c=n.side,u=c==0?e.undone:e.done;return l?u=Qh(u,u.length,s.minDepth,l):u=wx(u,t.startState.selection),new vn(c==0?n.rest:u,c==0?u:n.rest)}let r=t.annotation(RL);if((r=="full"||r=="before")&&(e=e.isolate()),t.annotation(xe.addToHistory)===!1)return t.changes.empty?e:e.addMapping(t.changes.desc);let o=us.fromTransaction(t),i=t.annotation(xe.time),a=t.annotation(xe.userEvent);return o?e=e.addChanges(o,i,a,s,t):t.selection&&(e=e.addSelection(t.startState.selection,i,a,s.newGroupDelay)),(r=="full"||r=="after")&&(e=e.isolate()),e},toJSON(e){return{done:e.done.map(t=>t.toJSON()),undone:e.undone.map(t=>t.toJSON())}},fromJSON(e){return new vn(e.done.map(us.fromJSON),e.undone.map(us.fromJSON))}});function NL(e={}){return[yx,gx.of(e),et.domEventHandlers({beforeinput(t,s){let n=t.inputType=="historyUndo"?vx:t.inputType=="historyRedo"?Gp:null;return n?(t.preventDefault(),n(s)):!1}})]}function qh(e,t){return function({state:s,dispatch:n}){if(!t&&s.readOnly)return!1;let r=s.field(yx,!1);if(!r)return!1;let o=r.pop(e,s,t);return o?(n(o),!0):!1}}const vx=qh(0,!1),Gp=qh(1,!1),LL=qh(0,!0),BL=qh(1,!0);class us{constructor(t,s,n,r,o){this.changes=t,this.effects=s,this.mapped=n,this.startSelection=r,this.selectionsAfter=o}setSelAfter(t){return new us(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,s,n;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(s=this.mapped)===null||s===void 0?void 0:s.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(t){return new us(t.changes&&we.fromJSON(t.changes),[],t.mapped&&fn.fromJSON(t.mapped),t.startSelection&&W.fromJSON(t.startSelection),t.selectionsAfter.map(W.fromJSON))}static fromTransaction(t,s){let n=Es;for(let r of t.startState.facet(DL)){let o=r(t);o.length&&(n=n.concat(o))}return!n.length&&t.changes.empty?null:new us(t.changes.invert(t.startState.doc),n,void 0,s||t.startState.selection,Es)}static selection(t){return new us(void 0,Es,void 0,void 0,t)}}function Qh(e,t,s,n){let r=t+1>s+20?t-s-1:0,o=e.slice(r,t);return o.push(n),o}function jL(e,t){let s=[],n=!1;return e.iterChangedRanges((r,o)=>s.push(r,o)),t.iterChangedRanges((r,o,i,a)=>{for(let l=0;l<s.length;){let c=s[l++],u=s[l++];a>=c&&i<=u&&(n=!0)}}),n}function FL(e,t){return e.ranges.length==t.ranges.length&&e.ranges.filter((s,n)=>s.empty!=t.ranges[n].empty).length===0}function bx(e,t){return e.length?t.length?e.concat(t):e:t}const Es=[],VL=200;function wx(e,t){if(e.length){let s=e[e.length-1],n=s.selectionsAfter.slice(Math.max(0,s.selectionsAfter.length-VL));return n.length&&n[n.length-1].eq(t)?e:(n.push(t),Qh(e,e.length-1,1e9,s.setSelAfter(n)))}else return[us.selection([t])]}function zL(e){let t=e[e.length-1],s=e.slice();return s[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),s}function Up(e,t){if(!e.length)return e;let s=e.length,n=Es;for(;s;){let r=GL(e[s-1],t,n);if(r.changes&&!r.changes.empty||r.effects.length){let o=e.slice(0,s);return o[s-1]=r,o}else t=r.mapped,s--,n=r.selectionsAfter}return n.length?[us.selection(n)]:Es}function GL(e,t,s){let n=bx(e.selectionsAfter.length?e.selectionsAfter.map(a=>a.map(t)):Es,s);if(!e.changes)return us.selection(n);let r=e.changes.map(t),o=t.mapDesc(e.changes,!0),i=e.mapped?e.mapped.composeDesc(o):o;return new us(r,bt.mapEffects(e.effects,t),i,e.startSelection.map(o),n)}const UL=/^(input\.type|delete)($|\.)/;class vn{constructor(t,s,n=0,r=void 0){this.done=t,this.undone=s,this.prevTime=n,this.prevUserEvent=r}isolate(){return this.prevTime?new vn(this.done,this.undone):this}addChanges(t,s,n,r,o){let i=this.done,a=i[i.length-1];return a&&a.changes&&!a.changes.empty&&t.changes&&(!n||UL.test(n))&&(!a.selectionsAfter.length&&s-this.prevTime<r.newGroupDelay&&r.joinToEvent(o,jL(a.changes,t.changes))||n=="input.type.compose")?i=Qh(i,i.length-1,r.minDepth,new us(t.changes.compose(a.changes),bx(t.effects,a.effects),a.mapped,a.startSelection,Es)):i=Qh(i,i.length,r.minDepth,t),new vn(i,Es,s,n)}addSelection(t,s,n,r){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:Es;return o.length>0&&s-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&FL(o[o.length-1],t)?this:new vn(wx(this.done,t),this.undone,s,n)}addMapping(t){return new vn(Up(this.done,t),Up(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,s,n){let r=t==0?this.done:this.undone;if(r.length==0)return null;let o=r[r.length-1],i=o.selectionsAfter[0]||s.selection;if(n&&o.selectionsAfter.length)return s.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:zp.of({side:t,rest:zL(r),selection:i}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let a=r.length==1?Es:r.slice(0,r.length-1);return o.mapped&&(a=Up(a,o.mapped)),s.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:zp.of({side:t,rest:a,selection:i}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}vn.empty=new vn(Es,Es);const HL=[{key:"Mod-z",run:vx,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Gp,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Gp,preventDefault:!0},{key:"Mod-u",run:LL,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:BL,preventDefault:!0}];function si(e,t){return W.create(e.ranges.map(t),e.mainIndex)}function bn(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function qs({state:e,dispatch:t},s){let n=si(e.selection,s);return n.eq(e.selection,!0)?!1:(t(bn(e,n)),!0)}function Kh(e,t){return W.cursor(t?e.to:e.from)}function xx(e,t){return qs(e,s=>s.empty?e.moveByChar(s,t):Kh(s,t))}function Ze(e){return e.textDirectionAt(e.state.selection.main.head)==Zt.LTR}const _x=e=>xx(e,!Ze(e)),Ax=e=>xx(e,Ze(e));function kx(e,t){return qs(e,s=>s.empty?e.moveByGroup(s,t):Kh(s,t))}const WL=e=>kx(e,!Ze(e)),XL=e=>kx(e,Ze(e));function YL(e,t,s){if(t.type.prop(s))return!0;let n=t.to-t.from;return n&&(n>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function Jh(e,t,s){let n=Ye(e).resolveInner(t.head),r=s?kt.closedBy:kt.openedBy;for(let l=t.head;;){let c=s?n.childAfter(l):n.childBefore(l);if(!c)break;YL(e,c,r)?n=c:l=s?c.to:c.from}let o=n.type.prop(r),i,a;return o&&(i=s?yn(e,n.from,1):yn(e,n.to,-1))&&i.matched?a=s?i.end.to:i.end.from:a=s?n.to:n.from,W.cursor(a,s?-1:1)}const ZL=e=>qs(e,t=>Jh(e.state,t,!Ze(e))),qL=e=>qs(e,t=>Jh(e.state,t,Ze(e)));function Sx(e,t){return qs(e,s=>{if(!s.empty)return Kh(s,t);let n=e.moveVertically(s,t);return n.head!=s.head?n:e.moveToLineBoundary(s,t)})}const Cx=e=>Sx(e,!1),Ox=e=>Sx(e,!0);function Tx(e){let t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,s=0,n=0,r;if(t){for(let o of e.state.facet(et.scrollMargins)){let i=o(e);i!=null&&i.top&&(s=Math.max(i==null?void 0:i.top,s)),i!=null&&i.bottom&&(n=Math.max(i==null?void 0:i.bottom,n))}r=e.scrollDOM.clientHeight-s-n}else r=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:s,marginBottom:n,selfScroll:t,height:Math.max(e.defaultLineHeight,r-5)}}function Px(e,t){let s=Tx(e),{state:n}=e,r=si(n.selection,i=>i.empty?e.moveVertically(i,t,s.height):Kh(i,t));if(r.eq(n.selection))return!1;let o;if(s.selfScroll){let i=e.coordsAtPos(n.selection.main.head),a=e.scrollDOM.getBoundingClientRect(),l=a.top+s.marginTop,c=a.bottom-s.marginBottom;i&&i.top>l&&i.bottom<c&&(o=et.scrollIntoView(r.main.head,{y:"start",yMargin:i.top-l}))}return e.dispatch(bn(n,r),{effects:o}),!0}const Mx=e=>Px(e,!1),Hp=e=>Px(e,!0);function mr(e,t,s){let n=e.lineBlockAt(t.head),r=e.moveToLineBoundary(t,s);if(r.head==t.head&&r.head!=(s?n.to:n.from)&&(r=e.moveToLineBoundary(t,s,!1)),!s&&r.head==n.from&&n.length){let o=/^\s*/.exec(e.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;o&&t.head!=n.from+o&&(r=W.cursor(n.from+o))}return r}const QL=e=>qs(e,t=>mr(e,t,!0)),KL=e=>qs(e,t=>mr(e,t,!1)),JL=e=>qs(e,t=>mr(e,t,!Ze(e))),tB=e=>qs(e,t=>mr(e,t,Ze(e))),eB=e=>qs(e,t=>W.cursor(e.lineBlockAt(t.head).from,1)),sB=e=>qs(e,t=>W.cursor(e.lineBlockAt(t.head).to,-1));function nB(e,t,s){let n=!1,r=si(e.selection,o=>{let i=yn(e,o.head,-1)||yn(e,o.head,1)||o.head>0&&yn(e,o.head-1,1)||o.head<e.doc.length&&yn(e,o.head+1,-1);if(!i||!i.end)return o;n=!0;let a=i.start.from==o.head?i.end.to:i.end.from;return s?W.range(o.anchor,a):W.cursor(a)});return n?(t(bn(e,r)),!0):!1}const rB=({state:e,dispatch:t})=>nB(e,t,!1);function $s(e,t){let s=si(e.state.selection,n=>{let r=t(n);return W.range(n.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return s.eq(e.state.selection)?!1:(e.dispatch(bn(e.state,s)),!0)}function Ix(e,t){return $s(e,s=>e.moveByChar(s,t))}const Ex=e=>Ix(e,!Ze(e)),$x=e=>Ix(e,Ze(e));function Rx(e,t){return $s(e,s=>e.moveByGroup(s,t))}const oB=e=>Rx(e,!Ze(e)),iB=e=>Rx(e,Ze(e)),aB=e=>$s(e,t=>Jh(e.state,t,!Ze(e))),lB=e=>$s(e,t=>Jh(e.state,t,Ze(e)));function Dx(e,t){return $s(e,s=>e.moveVertically(s,t))}const Nx=e=>Dx(e,!1),Lx=e=>Dx(e,!0);function Bx(e,t){return $s(e,s=>e.moveVertically(s,t,Tx(e).height))}const jx=e=>Bx(e,!1),Fx=e=>Bx(e,!0),hB=e=>$s(e,t=>mr(e,t,!0)),cB=e=>$s(e,t=>mr(e,t,!1)),uB=e=>$s(e,t=>mr(e,t,!Ze(e))),dB=e=>$s(e,t=>mr(e,t,Ze(e))),fB=e=>$s(e,t=>W.cursor(e.lineBlockAt(t.head).from)),pB=e=>$s(e,t=>W.cursor(e.lineBlockAt(t.head).to)),Vx=({state:e,dispatch:t})=>(t(bn(e,{anchor:0})),!0),zx=({state:e,dispatch:t})=>(t(bn(e,{anchor:e.doc.length})),!0),Gx=({state:e,dispatch:t})=>(t(bn(e,{anchor:e.selection.main.anchor,head:0})),!0),Ux=({state:e,dispatch:t})=>(t(bn(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0),mB=({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0),gB=({state:e,dispatch:t})=>{let s=ec(e).map(({from:n,to:r})=>W.range(n,Math.min(r+1,e.doc.length)));return t(e.update({selection:W.create(s),userEvent:"select"})),!0},yB=({state:e,dispatch:t})=>{let s=si(e.selection,n=>{var r;let o=Ye(e).resolveStack(n.from,1);for(let i=o;i;i=i.next){let{node:a}=i;if((a.from<n.from&&a.to>=n.to||a.to>n.to&&a.from<=n.from)&&!((r=a.parent)===null||r===void 0)&&r.parent)return W.range(a.to,a.from)}return n});return t(bn(e,s)),!0},vB=({state:e,dispatch:t})=>{let s=e.selection,n=null;return s.ranges.length>1?n=W.create([s.main]):s.main.empty||(n=W.create([W.cursor(s.main.head)])),n?(t(bn(e,n)),!0):!1};function Da(e,t){if(e.state.readOnly)return!1;let s="delete.selection",{state:n}=e,r=n.changeByRange(o=>{let{from:i,to:a}=o;if(i==a){let l=t(o);l<i?(s="delete.backward",l=tc(e,l,!1)):l>i&&(s="delete.forward",l=tc(e,l,!0)),i=Math.min(i,l),a=Math.max(a,l)}else i=tc(e,i,!1),a=tc(e,a,!0);return i==a?{range:o}:{changes:{from:i,to:a},range:W.cursor(i,i<o.head?-1:1)}});return r.changes.empty?!1:(e.dispatch(n.update(r,{scrollIntoView:!0,userEvent:s,effects:s=="delete.selection"?et.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function tc(e,t,s){if(e instanceof et)for(let n of e.state.facet(et.atomicRanges).map(r=>r(e)))n.between(t,t,(r,o)=>{r<t&&o>t&&(t=s?o:r)});return t}const Hx=(e,t)=>Da(e,s=>{let n=s.from,{state:r}=e,o=r.doc.lineAt(n),i,a;if(!t&&n>o.from&&n<o.from+200&&!/[^ \t]/.test(i=o.text.slice(0,n-o.from))){if(i[i.length-1]=="	")return n-1;let l=Xo(i,r.tabSize),c=l%Uh(r)||Uh(r);for(let u=0;u<c&&i[i.length-1-u]==" ";u++)n--;a=n}else a=Re(o.text,n-o.from,t,t)+o.from,a==n&&o.number!=(t?r.doc.lines:1)?a+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,n-o.from))&&(a=Re(o.text,a-o.from,!1,!1)+o.from);return a}),Wp=e=>Hx(e,!1),Wx=e=>Hx(e,!0),Xx=(e,t)=>Da(e,s=>{let n=s.head,{state:r}=e,o=r.doc.lineAt(n),i=r.charCategorizer(n);for(let a=null;;){if(n==(t?o.to:o.from)){n==s.head&&o.number!=(t?r.doc.lines:1)&&(n+=t?1:-1);break}let l=Re(o.text,n-o.from,t)+o.from,c=o.text.slice(Math.min(n,l)-o.from,Math.max(n,l)-o.from),u=i(c);if(a!=null&&u!=a)break;(c!=" "||n!=s.head)&&(a=u),n=l}return n}),Yx=e=>Xx(e,!1),bB=e=>Xx(e,!0),wB=e=>Da(e,t=>{let s=e.lineBlockAt(t.head).to;return t.head<s?s:Math.min(e.state.doc.length,t.head+1)}),xB=e=>Da(e,t=>{let s=e.moveToLineBoundary(t,!1).head;return t.head>s?s:Math.max(0,t.head-1)}),_B=e=>Da(e,t=>{let s=e.moveToLineBoundary(t,!0).head;return t.head<s?s:Math.min(e.state.doc.length,t.head+1)}),AB=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let s=e.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:Rt.of(["",""])},range:W.cursor(n.from)}));return t(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0},kB=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let s=e.changeByRange(n=>{if(!n.empty||n.from==0||n.from==e.doc.length)return{range:n};let r=n.from,o=e.doc.lineAt(r),i=r==o.from?r-1:Re(o.text,r-o.from,!1)+o.from,a=r==o.to?r+1:Re(o.text,r-o.from,!0)+o.from;return{changes:{from:i,to:a,insert:e.doc.slice(r,a).append(e.doc.slice(i,r))},range:W.cursor(a)}});return s.changes.empty?!1:(t(e.update(s,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function ec(e){let t=[],s=-1;for(let n of e.selection.ranges){let r=e.doc.lineAt(n.from),o=e.doc.lineAt(n.to);if(!n.empty&&n.to==o.from&&(o=e.doc.lineAt(n.to-1)),s>=r.number){let i=t[t.length-1];i.to=o.to,i.ranges.push(n)}else t.push({from:r.from,to:o.to,ranges:[n]});s=o.number+1}return t}function Zx(e,t,s){if(e.readOnly)return!1;let n=[],r=[];for(let o of ec(e)){if(s?o.to==e.doc.length:o.from==0)continue;let i=e.doc.lineAt(s?o.to+1:o.from-1),a=i.length+1;if(s){n.push({from:o.to,to:i.to},{from:o.from,insert:i.text+e.lineBreak});for(let l of o.ranges)r.push(W.range(Math.min(e.doc.length,l.anchor+a),Math.min(e.doc.length,l.head+a)))}else{n.push({from:i.from,to:o.from},{from:o.to,insert:e.lineBreak+i.text});for(let l of o.ranges)r.push(W.range(l.anchor-a,l.head-a))}}return n.length?(t(e.update({changes:n,scrollIntoView:!0,selection:W.create(r,e.selection.mainIndex),userEvent:"move.line"})),!0):!1}const SB=({state:e,dispatch:t})=>Zx(e,t,!1),CB=({state:e,dispatch:t})=>Zx(e,t,!0);function qx(e,t,s){if(e.readOnly)return!1;let n=[];for(let r of ec(e))s?n.push({from:r.from,insert:e.doc.slice(r.from,r.to)+e.lineBreak}):n.push({from:r.to,insert:e.lineBreak+e.doc.slice(r.from,r.to)});return t(e.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const OB=({state:e,dispatch:t})=>qx(e,t,!1),TB=({state:e,dispatch:t})=>qx(e,t,!0),PB=e=>{if(e.state.readOnly)return!1;let{state:t}=e,s=t.changes(ec(t).map(({from:r,to:o})=>(r>0?r--:o<t.doc.length&&o++,{from:r,to:o}))),n=si(t.selection,r=>e.moveVertically(r,!0)).map(s);return e.dispatch({changes:s,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function MB(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let s=Ye(e).resolveInner(t),n=s.childBefore(t),r=s.childAfter(t),o;return n&&r&&n.to<=t&&r.from>=t&&(o=n.type.prop(kt.closedBy))&&o.indexOf(r.name)>-1&&e.doc.lineAt(n.to).from==e.doc.lineAt(r.from).from&&!/\S/.test(e.sliceDoc(n.to,r.from))?{from:n.to,to:r.from}:null}const IB=Qx(!1),EB=Qx(!0);function Qx(e){return({state:t,dispatch:s})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>{let{from:o,to:i}=r,a=t.doc.lineAt(o),l=!e&&o==i&&MB(t,o);e&&(o=i=(i<=a.to?a:t.doc.lineAt(i)).to);let c=new Hh(t,{simulateBreak:o,simulateDoubleBreak:!!l}),u=Ip(c,o);for(u==null&&(u=Xo(/^\s*/.exec(t.doc.lineAt(o).text)[0],t.tabSize));i<a.to&&/\s/.test(a.text[i-a.from]);)i++;l?{from:o,to:i}=l:o>a.from&&o<a.from+100&&!/\S/.test(a.text.slice(0,o))&&(o=a.from);let h=["",Ia(t,u)];return l&&h.push(Ia(t,c.lineIndent(a.from,-1))),{changes:{from:o,to:i,insert:Rt.of(h)},range:W.cursor(o+1+h[1].length)}});return s(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function Xp(e,t){let s=-1;return e.changeByRange(n=>{let r=[];for(let i=n.from;i<=n.to;){let a=e.doc.lineAt(i);a.number>s&&(n.empty||n.to>a.from)&&(t(a,r,n),s=a.number),i=a.to+1}let o=e.changes(r);return{changes:r,range:W.range(o.mapPos(n.anchor,1),o.mapPos(n.head,1))}})}const $B=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let s=Object.create(null),n=new Hh(e,{overrideIndentation:o=>s[o]??-1}),r=Xp(e,(o,i,a)=>{let l=Ip(n,o.from);if(l==null)return;/\S/.test(o.text)||(l=0);let c=/^\s*/.exec(o.text)[0],u=Ia(e,l);(c!=u||a.from<o.from+c.length)&&(s[o.from]=l,i.push({from:o.from,to:o.from+c.length,insert:u}))});return r.changes.empty||t(e.update(r,{userEvent:"indent"})),!0},Kx=({state:e,dispatch:t})=>e.readOnly?!1:(t(e.update(Xp(e,(s,n)=>{n.push({from:s.from,insert:e.facet(Gh)})}),{userEvent:"input.indent"})),!0),Jx=({state:e,dispatch:t})=>e.readOnly?!1:(t(e.update(Xp(e,(s,n)=>{let r=/^\s*/.exec(s.text)[0];if(!r)return;let o=Xo(r,e.tabSize),i=0,a=Ia(e,Math.max(0,o-Uh(e)));for(;i<r.length&&i<a.length&&r.charCodeAt(i)==a.charCodeAt(i);)i++;n.push({from:s.from+i,to:s.from+r.length,insert:a.slice(i)})}),{userEvent:"delete.dedent"})),!0),RB=[{key:"Ctrl-b",run:_x,shift:Ex,preventDefault:!0},{key:"Ctrl-f",run:Ax,shift:$x},{key:"Ctrl-p",run:Cx,shift:Nx},{key:"Ctrl-n",run:Ox,shift:Lx},{key:"Ctrl-a",run:eB,shift:fB},{key:"Ctrl-e",run:sB,shift:pB},{key:"Ctrl-d",run:Wx},{key:"Ctrl-h",run:Wp},{key:"Ctrl-k",run:wB},{key:"Ctrl-Alt-h",run:Yx},{key:"Ctrl-o",run:AB},{key:"Ctrl-t",run:kB},{key:"Ctrl-v",run:Hp}],DB=[{key:"ArrowLeft",run:_x,shift:Ex,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:WL,shift:oB,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:JL,shift:uB,preventDefault:!0},{key:"ArrowRight",run:Ax,shift:$x,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:XL,shift:iB,preventDefault:!0},{mac:"Cmd-ArrowRight",run:tB,shift:dB,preventDefault:!0},{key:"ArrowUp",run:Cx,shift:Nx,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Vx,shift:Gx},{mac:"Ctrl-ArrowUp",run:Mx,shift:jx},{key:"ArrowDown",run:Ox,shift:Lx,preventDefault:!0},{mac:"Cmd-ArrowDown",run:zx,shift:Ux},{mac:"Ctrl-ArrowDown",run:Hp,shift:Fx},{key:"PageUp",run:Mx,shift:jx},{key:"PageDown",run:Hp,shift:Fx},{key:"Home",run:KL,shift:cB,preventDefault:!0},{key:"Mod-Home",run:Vx,shift:Gx},{key:"End",run:QL,shift:hB,preventDefault:!0},{key:"Mod-End",run:zx,shift:Ux},{key:"Enter",run:IB},{key:"Mod-a",run:mB},{key:"Backspace",run:Wp,shift:Wp},{key:"Delete",run:Wx},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Yx},{key:"Mod-Delete",mac:"Alt-Delete",run:bB},{mac:"Mod-Backspace",run:xB},{mac:"Mod-Delete",run:_B}].concat(RB.map(e=>({mac:e.key,run:e.run,shift:e.shift}))),NB=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:ZL,shift:aB},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:qL,shift:lB},{key:"Alt-ArrowUp",run:SB},{key:"Shift-Alt-ArrowUp",run:OB},{key:"Alt-ArrowDown",run:CB},{key:"Shift-Alt-ArrowDown",run:TB},{key:"Escape",run:vB},{key:"Mod-Enter",run:EB},{key:"Alt-l",mac:"Ctrl-l",run:gB},{key:"Mod-i",run:yB,preventDefault:!0},{key:"Mod-[",run:Jx},{key:"Mod-]",run:Kx},{key:"Mod-Alt-\\",run:$B},{key:"Shift-Mod-k",run:PB},{key:"Shift-Mod-\\",run:rB},{key:"Mod-/",run:OL},{key:"Alt-A",run:PL}].concat(DB),LB={key:"Tab",run:Kx,shift:Jx};function Ut(){var e=arguments[0];typeof e=="string"&&(e=document.createElement(e));var t=1,s=arguments[1];if(s&&typeof s=="object"&&s.nodeType==null&&!Array.isArray(s)){for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){var r=s[n];typeof r=="string"?e.setAttribute(n,r):r!=null&&(e[n]=r)}t++}for(;t<arguments.length;t++)t_(e,arguments[t]);return e}function t_(e,t){if(typeof t=="string")e.appendChild(document.createTextNode(t));else if(t!=null)if(t.nodeType!=null)e.appendChild(t);else if(Array.isArray(t))for(var s=0;s<t.length;s++)t_(e,t[s]);else throw new RangeError("Unsupported child node: "+t)}const e_=typeof String.prototype.normalize=="function"?e=>e.normalize("NFKD"):e=>e;class ni{constructor(t,s,n=0,r=t.length,o,i){this.test=i,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(n,r),this.bufferStart=n,this.normalize=o?a=>o(e_(a)):e_,this.query=this.normalize(s)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return De(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let s=kf(t),n=this.bufferStart+this.bufferPos;this.bufferPos+=Ps(t);let r=this.normalize(s);for(let o=0,i=n;;o++){let a=r.charCodeAt(o),l=this.match(a,i,this.bufferPos+this.bufferStart);if(o==r.length-1){if(l)return this.value=l,this;break}i==n&&o<s.length&&s.charCodeAt(o)==a&&i++}}}match(t,s,n){let r=null;for(let o=0;o<this.matches.length;o+=2){let i=this.matches[o],a=!1;this.query.charCodeAt(i)==t&&(i==this.query.length-1?r={from:this.matches[o+1],to:n}:(this.matches[o]++,a=!0)),a||(this.matches.splice(o,2),o-=2)}return this.query.charCodeAt(0)==t&&(this.query.length==1?r={from:s,to:n}:this.matches.push(1,s)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(ni.prototype[Symbol.iterator]=function(){return this});const s_={from:-1,to:-1,match:/.*/.exec("")},Yp="gm"+(/x/.unicode==null?"":"u");class n_{constructor(t,s,n,r=0,o=t.length){if(this.text=t,this.to=o,this.curLine="",this.done=!1,this.value=s_,/\\[sWDnr]|\n|\r|\[\^/.test(s))return new r_(t,s,n,r,o);this.re=new RegExp(s,Yp+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=t.iter();let i=t.lineAt(r);this.curLineStart=i.from,this.matchPos=sc(t,r),this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let s=this.matchPos<=this.to&&this.re.exec(this.curLine);if(s){let n=this.curLineStart+s.index,r=n+s[0].length;if(this.matchPos=sc(this.text,r+(n==r?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,s)))return this.value={from:n,to:r,match:s},this;t=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),t=0;else return this.done=!0,this}}}const Zp=new WeakMap;class ri{constructor(t,s){this.from=t,this.text=s}get to(){return this.from+this.text.length}static get(t,s,n){let r=Zp.get(t);if(!r||r.from>=n||r.to<=s){let a=new ri(s,t.sliceString(s,n));return Zp.set(t,a),a}if(r.from==s&&r.to==n)return r;let{text:o,from:i}=r;return i>s&&(o=t.sliceString(s,i)+o,i=s),r.to<n&&(o+=t.sliceString(r.to,n)),Zp.set(t,new ri(i,o)),new ri(s,o.slice(s-i,n-i))}}class r_{constructor(t,s,n,r,o){this.text=t,this.to=o,this.done=!1,this.value=s_,this.matchPos=sc(t,r),this.re=new RegExp(s,Yp+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=ri.get(t,r,this.chunkEnd(r+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,s=this.re.exec(this.flat.text);if(s&&!s[0]&&s.index==t&&(this.re.lastIndex=t+1,s=this.re.exec(this.flat.text)),s){let n=this.flat.from+s.index,r=n+s[0].length;if((this.flat.to>=this.to||s.index+s[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,r,s)))return this.value={from:n,to:r,match:s},this.matchPos=sc(this.text,r+(n==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=ri.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(n_.prototype[Symbol.iterator]=r_.prototype[Symbol.iterator]=function(){return this});function BB(e){try{return new RegExp(e,Yp),!0}catch{return!1}}function sc(e,t){if(t>=e.length)return t;let s=e.lineAt(t),n;for(;t<s.to&&(n=s.text.charCodeAt(t-s.from))>=56320&&n<57344;)t++;return t}function qp(e){let t=String(e.state.doc.lineAt(e.state.selection.main.head).number),s=Ut("input",{class:"cm-textfield",name:"line",value:t}),n=Ut("form",{class:"cm-gotoLine",onkeydown:o=>{o.keyCode==27?(o.preventDefault(),e.dispatch({effects:nc.of(!1)}),e.focus()):o.keyCode==13&&(o.preventDefault(),r())},onsubmit:o=>{o.preventDefault(),r()}},Ut("label",e.state.phrase("Go to line"),": ",s)," ",Ut("button",{class:"cm-button",type:"submit"},e.state.phrase("go")));function r(){let o=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(s.value);if(!o)return;let{state:i}=e,a=i.doc.lineAt(i.selection.main.head),[,l,c,u,h]=o,d=u?+u.slice(1):0,f=c?+c:a.number;if(c&&h){let m=f/100;l&&(m=m*(l=="-"?-1:1)+a.number/i.doc.lines),f=Math.round(i.doc.lines*m)}else c&&l&&(f=f*(l=="-"?-1:1)+a.number);let p=i.doc.line(Math.max(1,Math.min(i.doc.lines,f))),g=W.cursor(p.from+Math.max(0,Math.min(d,p.length)));e.dispatch({effects:[nc.of(!1),et.scrollIntoView(g.from,{y:"center"})],selection:g}),e.focus()}return{dom:n}}const nc=bt.define(),o_=Ne.define({create(){return!0},update(e,t){for(let s of t.effects)s.is(nc)&&(e=s.value);return e},provide:e=>Ta.from(e,t=>t?qp:null)}),jB=e=>{let t=Oa(e,qp);if(!t){let s=[nc.of(!0)];e.state.field(o_,!1)==null&&s.push(bt.appendConfig.of([o_,FB])),e.dispatch({effects:s}),t=Oa(e,qp)}return t&&t.dom.querySelector("input").select(),!0},FB=et.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),VB={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},i_=tt.define({combine(e){return pn(e,VB,{highlightWordAroundCursor:(t,s)=>t||s,minSelectionLength:Math.min,maxMatches:Math.min})}});function zB(e){let t=[XB,WB];return e&&t.push(i_.of(e)),t}const GB=ut.mark({class:"cm-selectionMatch"}),UB=ut.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function a_(e,t,s,n){return(s==0||e(t.sliceDoc(s-1,s))!=Kt.Word)&&(n==t.doc.length||e(t.sliceDoc(n,n+1))!=Kt.Word)}function HB(e,t,s,n){return e(t.sliceDoc(s,s+1))==Kt.Word&&e(t.sliceDoc(n-1,n))==Kt.Word}const WB=ie.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(i_),{state:s}=e,n=s.selection;if(n.ranges.length>1)return ut.none;let r=n.main,o,i=null;if(r.empty){if(!t.highlightWordAroundCursor)return ut.none;let l=s.wordAt(r.head);if(!l)return ut.none;i=s.charCategorizer(r.head),o=s.sliceDoc(l.from,l.to)}else{let l=r.to-r.from;if(l<t.minSelectionLength||l>200)return ut.none;if(t.wholeWords){if(o=s.sliceDoc(r.from,r.to),i=s.charCategorizer(r.head),!(a_(i,s,r.from,r.to)&&HB(i,s,r.from,r.to)))return ut.none}else if(o=s.sliceDoc(r.from,r.to),!o)return ut.none}let a=[];for(let l of e.visibleRanges){let c=new ni(s.doc,o,l.from,l.to);for(;!c.next().done;){let{from:u,to:h}=c.value;if((!i||a_(i,s,u,h))&&(r.empty&&u<=r.from&&h>=r.to?a.push(UB.range(u,h)):(u>=r.to||h<=r.from)&&a.push(GB.range(u,h)),a.length>t.maxMatches))return ut.none}}return ut.set(a)}},{decorations:e=>e.decorations}),XB=et.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),YB=({state:e,dispatch:t})=>{let{selection:s}=e,n=W.create(s.ranges.map(r=>e.wordAt(r.head)||W.cursor(r.head)),s.mainIndex);return n.eq(s)?!1:(t(e.update({selection:n})),!0)};function ZB(e,t){let{main:s,ranges:n}=e.selection,r=e.wordAt(s.head),o=r&&r.from==s.from&&r.to==s.to;for(let i=!1,a=new ni(e.doc,t,n[n.length-1].to);;)if(a.next(),a.done){if(i)return null;a=new ni(e.doc,t,0,Math.max(0,n[n.length-1].from-1)),i=!0}else{if(i&&n.some(l=>l.from==a.value.from))continue;if(o){let l=e.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const qB=({state:e,dispatch:t})=>{let{ranges:s}=e.selection;if(s.some(o=>o.from===o.to))return YB({state:e,dispatch:t});let n=e.sliceDoc(s[0].from,s[0].to);if(e.selection.ranges.some(o=>e.sliceDoc(o.from,o.to)!=n))return!1;let r=ZB(e,n);return r?(t(e.update({selection:e.selection.addRange(W.range(r.from,r.to),!1),effects:et.scrollIntoView(r.to)})),!0):!1},oi=tt.define({combine(e){return pn(e,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:t=>new l5(t),scrollToMatch:t=>et.scrollIntoView(t)})}});class l_{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||BB(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}unquote(t){return this.literal?t:t.replace(/\\([nrt\\])/g,(s,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp&&this.wholeWord==t.wholeWord}create(){return this.regexp?new t5(this):new KB(this)}getCursor(t,s=0,n){let r=t.doc?t:Mt.create({doc:t});return n==null&&(n=r.doc.length),this.regexp?ai(this,r,s,n):ii(this,r,s,n)}}class h_{constructor(t){this.spec=t}}function ii(e,t,s,n){return new ni(t.doc,e.unquoted,s,n,e.caseSensitive?void 0:r=>r.toLowerCase(),e.wholeWord?QB(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}function QB(e,t){return(s,n,r,o)=>((o>s||o+r.length<n)&&(o=Math.max(0,s-2),r=e.sliceString(o,Math.min(e.length,n+2))),(t(rc(r,s-o))!=Kt.Word||t(oc(r,s-o))!=Kt.Word)&&(t(oc(r,n-o))!=Kt.Word||t(rc(r,n-o))!=Kt.Word))}class KB extends h_{constructor(t){super(t)}nextMatch(t,s,n){let r=ii(this.spec,t,n,t.doc.length).nextOverlapping();return r.done&&(r=ii(this.spec,t,0,s).nextOverlapping()),r.done?null:r.value}prevMatchInRange(t,s,n){for(let r=n;;){let o=Math.max(s,r-1e4-this.spec.unquoted.length),i=ii(this.spec,t,o,r),a=null;for(;!i.nextOverlapping().done;)a=i.value;if(a)return a;if(o==s)return null;r-=1e4}}prevMatch(t,s,n){return this.prevMatchInRange(t,0,s)||this.prevMatchInRange(t,n,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace)}matchAll(t,s){let n=ii(this.spec,t,0,t.doc.length),r=[];for(;!n.next().done;){if(r.length>=s)return null;r.push(n.value)}return r}highlight(t,s,n,r){let o=ii(this.spec,t,Math.max(0,s-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,t.doc.length));for(;!o.next().done;)r(o.value.from,o.value.to)}}function ai(e,t,s,n){return new n_(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?JB(t.charCategorizer(t.selection.main.head)):void 0},s,n)}function rc(e,t){return e.slice(Re(e,t,!1),t)}function oc(e,t){return e.slice(t,Re(e,t))}function JB(e){return(t,s,n)=>!n[0].length||(e(rc(n.input,n.index))!=Kt.Word||e(oc(n.input,n.index))!=Kt.Word)&&(e(oc(n.input,n.index+n[0].length))!=Kt.Word||e(rc(n.input,n.index+n[0].length))!=Kt.Word)}class t5 extends h_{nextMatch(t,s,n){let r=ai(this.spec,t,n,t.doc.length).next();return r.done&&(r=ai(this.spec,t,0,s).next()),r.done?null:r.value}prevMatchInRange(t,s,n){for(let r=1;;r++){let o=Math.max(s,n-r*1e4),i=ai(this.spec,t,o,n),a=null;for(;!i.next().done;)a=i.value;if(a&&(o==s||a.from>o+10))return a;if(o==s)return null}}prevMatch(t,s,n){return this.prevMatchInRange(t,0,s)||this.prevMatchInRange(t,n,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(s,n)=>n=="$"?"$":n=="&"?t.match[0]:n!="0"&&+n<t.match.length?t.match[n]:s)}matchAll(t,s){let n=ai(this.spec,t,0,t.doc.length),r=[];for(;!n.next().done;){if(r.length>=s)return null;r.push(n.value)}return r}highlight(t,s,n,r){let o=ai(this.spec,t,Math.max(0,s-250),Math.min(n+250,t.doc.length));for(;!o.next().done;)r(o.value.from,o.value.to)}}const Na=bt.define(),Qp=bt.define(),gr=Ne.define({create(e){return new Kp(tm(e).create(),null)},update(e,t){for(let s of t.effects)s.is(Na)?e=new Kp(s.value.create(),e.panel):s.is(Qp)&&(e=new Kp(e.query,s.value?Jp:null));return e},provide:e=>Ta.from(e,t=>t.panel)});class Kp{constructor(t,s){this.query=t,this.panel=s}}const e5=ut.mark({class:"cm-searchMatch"}),s5=ut.mark({class:"cm-searchMatch cm-searchMatch-selected"}),n5=ie.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(gr))}update(e){let t=e.state.field(gr);(t!=e.startState.field(gr)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return ut.none;let{view:s}=this,n=new ir;for(let r=0,o=s.visibleRanges,i=o.length;r<i;r++){let{from:a,to:l}=o[r];for(;r<i-1&&l>o[r+1].from-2*250;)l=o[++r].to;e.highlight(s.state,a,l,(c,u)=>{let h=s.state.selection.ranges.some(d=>d.from==c&&d.to==u);n.add(c,u,h?s5:e5)})}return n.finish()}},{decorations:e=>e.decorations});function La(e){return t=>{let s=t.state.field(gr,!1);return s&&s.query.spec.valid?e(t,s):f_(t)}}const ic=La((e,{query:t})=>{let{to:s}=e.state.selection.main,n=t.nextMatch(e.state,s,s);if(!n)return!1;let r=W.single(n.from,n.to),o=e.state.facet(oi);return e.dispatch({selection:r,effects:[em(e,n),o.scrollToMatch(r.main,e)],userEvent:"select.search"}),d_(e),!0}),ac=La((e,{query:t})=>{let{state:s}=e,{from:n}=s.selection.main,r=t.prevMatch(s,n,n);if(!r)return!1;let o=W.single(r.from,r.to),i=e.state.facet(oi);return e.dispatch({selection:o,effects:[em(e,r),i.scrollToMatch(o.main,e)],userEvent:"select.search"}),d_(e),!0}),r5=La((e,{query:t})=>{let s=t.matchAll(e.state,1e3);return!s||!s.length?!1:(e.dispatch({selection:W.create(s.map(n=>W.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),o5=({state:e,dispatch:t})=>{let s=e.selection;if(s.ranges.length>1||s.main.empty)return!1;let{from:n,to:r}=s.main,o=[],i=0;for(let a=new ni(e.doc,e.sliceDoc(n,r));!a.next().done;){if(o.length>1e3)return!1;a.value.from==n&&(i=o.length),o.push(W.range(a.value.from,a.value.to))}return t(e.update({selection:W.create(o,i),userEvent:"select.search.matches"})),!0},c_=La((e,{query:t})=>{let{state:s}=e,{from:n,to:r}=s.selection.main;if(s.readOnly)return!1;let o=t.nextMatch(s,n,n);if(!o)return!1;let i=[],a,l,c=[];if(o.from==n&&o.to==r&&(l=s.toText(t.getReplacement(o)),i.push({from:o.from,to:o.to,insert:l}),o=t.nextMatch(s,o.from,o.to),c.push(et.announce.of(s.phrase("replaced match on line $",s.doc.lineAt(n).number)+"."))),o){let u=i.length==0||i[0].from>=o.to?0:o.to-o.from-l.length;a=W.single(o.from-u,o.to-u),c.push(em(e,o)),c.push(s.facet(oi).scrollToMatch(a.main,e))}return e.dispatch({changes:i,selection:a,effects:c,userEvent:"input.replace"}),!0}),i5=La((e,{query:t})=>{if(e.state.readOnly)return!1;let s=t.matchAll(e.state,1e9).map(r=>{let{from:o,to:i}=r;return{from:o,to:i,insert:t.getReplacement(r)}});if(!s.length)return!1;let n=e.state.phrase("replaced $ matches",s.length)+".";return e.dispatch({changes:s,effects:et.announce.of(n),userEvent:"input.replace.all"}),!0});function Jp(e){return e.state.facet(oi).createPanel(e)}function tm(e,t){var s,n,r,o,i;let a=e.selection.main,l=a.empty||a.to>a.from+100?"":e.sliceDoc(a.from,a.to);if(t&&!l)return t;let c=e.facet(oi);return new l_({search:((s=t==null?void 0:t.literal)!==null&&s!==void 0?s:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=t==null?void 0:t.caseSensitive)!==null&&n!==void 0?n:c.caseSensitive,literal:(r=t==null?void 0:t.literal)!==null&&r!==void 0?r:c.literal,regexp:(o=t==null?void 0:t.regexp)!==null&&o!==void 0?o:c.regexp,wholeWord:(i=t==null?void 0:t.wholeWord)!==null&&i!==void 0?i:c.wholeWord})}function u_(e){let t=Oa(e,Jp);return t&&t.dom.querySelector("[main-field]")}function d_(e){let t=u_(e);t&&t==e.root.activeElement&&t.select()}const f_=e=>{let t=e.state.field(gr,!1);if(t&&t.panel){let s=u_(e);if(s&&s!=e.root.activeElement){let n=tm(e.state,t.query.spec);n.valid&&e.dispatch({effects:Na.of(n)}),s.focus(),s.select()}}else e.dispatch({effects:[Qp.of(!0),t?Na.of(tm(e.state,t.query.spec)):bt.appendConfig.of(c5)]});return!0},p_=e=>{let t=e.state.field(gr,!1);if(!t||!t.panel)return!1;let s=Oa(e,Jp);return s&&s.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:Qp.of(!1)}),!0},a5=[{key:"Mod-f",run:f_,scope:"editor search-panel"},{key:"F3",run:ic,shift:ac,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:ic,shift:ac,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:p_,scope:"editor search-panel"},{key:"Mod-Shift-l",run:o5},{key:"Mod-Alt-g",run:jB},{key:"Mod-d",run:qB,preventDefault:!0}];class l5{constructor(t){this.view=t;let s=this.query=t.state.field(gr).query.spec;this.commit=this.commit.bind(this),this.searchField=Ut("input",{value:s.search,placeholder:ws(t,"Find"),"aria-label":ws(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Ut("input",{value:s.replace,placeholder:ws(t,"Replace"),"aria-label":ws(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Ut("input",{type:"checkbox",name:"case",form:"",checked:s.caseSensitive,onchange:this.commit}),this.reField=Ut("input",{type:"checkbox",name:"re",form:"",checked:s.regexp,onchange:this.commit}),this.wordField=Ut("input",{type:"checkbox",name:"word",form:"",checked:s.wholeWord,onchange:this.commit});function n(r,o,i){return Ut("button",{class:"cm-button",name:r,onclick:o,type:"button"},i)}this.dom=Ut("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,n("next",()=>ic(t),[ws(t,"next")]),n("prev",()=>ac(t),[ws(t,"previous")]),n("select",()=>r5(t),[ws(t,"all")]),Ut("label",null,[this.caseField,ws(t,"match case")]),Ut("label",null,[this.reField,ws(t,"regexp")]),Ut("label",null,[this.wordField,ws(t,"by word")]),...t.state.readOnly?[]:[Ut("br"),this.replaceField,n("replace",()=>c_(t),[ws(t,"replace")]),n("replaceAll",()=>i5(t),[ws(t,"replace all")])],Ut("button",{name:"close",onclick:()=>p_(t),"aria-label":ws(t,"close"),type:"button"},["\xD7"])])}commit(){let t=new l_({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:Na.of(t)}))}keydown(t){PD(this.view,t,"search-panel")?t.preventDefault():t.keyCode==13&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?ac:ic)(this.view)):t.keyCode==13&&t.target==this.replaceField&&(t.preventDefault(),c_(this.view))}update(t){for(let s of t.transactions)for(let n of s.effects)n.is(Na)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp,this.wordField.checked=t.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(oi).top}}function ws(e,t){return e.state.phrase(t)}const lc=30,hc=/[\s\.,:;?!]/;function em(e,{from:t,to:s}){let n=e.state.doc.lineAt(t),r=e.state.doc.lineAt(s).to,o=Math.max(n.from,t-lc),i=Math.min(r,s+lc),a=e.state.sliceDoc(o,i);if(o!=n.from){for(let l=0;l<lc;l++)if(!hc.test(a[l+1])&&hc.test(a[l])){a=a.slice(l);break}}if(i!=r){for(let l=a.length-1;l>a.length-lc;l--)if(!hc.test(a[l-1])&&hc.test(a[l])){a=a.slice(0,l);break}}return et.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${n.number}.`)}const h5=et.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),c5=[gr,Ho.low(n5),h5];class m_{constructor(t,s,n){this.state=t,this.pos=s,this.explicit=n,this.abortListeners=[]}tokenBefore(t){let s=Ye(this.state).resolveInner(this.pos,-1);for(;s&&t.indexOf(s.name)<0;)s=s.parent;return s?{from:s.from,to:this.pos,text:this.state.sliceDoc(s.from,this.pos),type:s.type}:null}matchBefore(t){let s=this.state.doc.lineAt(this.pos),n=Math.max(s.from,this.pos-250),r=s.text.slice(n-s.from,this.pos-s.from),o=r.search(v_(t,!1));return o<0?null:{from:n+o,to:this.pos,text:r.slice(o)}}get aborted(){return this.abortListeners==null}addEventListener(t,s){t=="abort"&&this.abortListeners&&this.abortListeners.push(s)}}function g_(e){let t=Object.keys(e).join(""),s=/\w/.test(t);return s&&(t=t.replace(/\w/g,"")),`[${s?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function u5(e){let t=Object.create(null),s=Object.create(null);for(let{label:r}of e){t[r[0]]=!0;for(let o=1;o<r.length;o++)s[r[o]]=!0}let n=g_(t)+g_(s)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function d5(e){let t=e.map(r=>typeof r=="string"?{label:r}:r),[s,n]=t.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:u5(t);return r=>{let o=r.matchBefore(n);return o||r.explicit?{from:o?o.from:r.pos,options:t,validFor:s}:null}}class y_{constructor(t,s,n,r){this.completion=t,this.source=s,this.match=n,this.score=r}}function yr(e){return e.selection.main.from}function v_(e,t){var s;let{source:n}=e,r=t&&n[0]!="^",o=n[n.length-1]!="$";return!r&&!o?e:new RegExp(`${r?"^":""}(?:${n})${o?"$":""}`,(s=e.flags)!==null&&s!==void 0?s:e.ignoreCase?"i":"")}const f5=Nn.define();function p5(e,t,s,n){let{main:r}=e.selection,o=s-r.from,i=n-r.from;return Object.assign(Object.assign({},e.changeByRange(a=>a!=r&&s!=n&&e.sliceDoc(a.from+o,a.from+i)!=e.sliceDoc(s,n)?{range:a}:{changes:{from:a.from+o,to:n==r.from?a.to:a.from+i,insert:t},range:W.cursor(a.from+o+t.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const b_=new WeakMap;function m5(e){if(!Array.isArray(e))return e;let t=b_.get(e);return t||b_.set(e,t=d5(e)),t}const cc=bt.define(),Ba=bt.define();class g5{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let s=0;s<t.length;){let n=De(t,s),r=Ps(n);this.chars.push(n);let o=t.slice(s,s+r),i=o.toUpperCase();this.folded.push(De(i==o?o.toLowerCase():i,0)),s+=r}this.astral=t.length!=this.chars.length}ret(t,s){return this.score=t,this.matched=s,!0}match(t){if(this.pattern.length==0)return this.ret(-100,[]);if(t.length<this.pattern.length)return!1;let{chars:s,folded:n,any:r,precise:o,byWord:i}=this;if(s.length==1){let v=De(t,0),b=Ps(v),w=b==t.length?0:-100;if(v!=s[0])if(v==n[0])w+=-200;else return!1;return this.ret(w,[0,b])}let a=t.indexOf(this.pattern);if(a==0)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=s.length,c=0;if(a<0){for(let v=0,b=Math.min(t.length,200);v<b&&c<l;){let w=De(t,v);(w==s[c]||w==n[c])&&(r[c++]=v),v+=Ps(w)}if(c<l)return!1}let u=0,h=0,d=!1,f=0,p=-1,g=-1,m=/[a-z]/.test(t),y=!0;for(let v=0,b=Math.min(t.length,200),w=0;v<b&&h<l;){let S=De(t,v);a<0&&(u<l&&S==s[u]&&(o[u++]=v),f<l&&(S==s[f]||S==n[f]?(f==0&&(p=v),g=v+1,f++):f=0));let _,A=S<255?S>=48&&S<=57||S>=97&&S<=122?2:S>=65&&S<=90?1:0:(_=kf(S))!=_.toLowerCase()?1:_!=_.toUpperCase()?2:0;(!v||A==1&&m||w==0&&A!=0)&&(s[h]==S||n[h]==S&&(d=!0)?i[h++]=v:i.length&&(y=!1)),w=A,v+=Ps(S)}return h==l&&i[0]==0&&y?this.result(-100+(d?-200:0),i,t):f==l&&p==0?this.ret(-200-t.length+(g==t.length?0:-100),[0,g]):a>-1?this.ret(-700-t.length,[a,a+this.pattern.length]):f==l?this.ret(-900-t.length,[p,g]):h==l?this.result(-100+(d?-200:0)+-700+(y?0:-1100),i,t):s.length==2?!1:this.result((r[0]?-700:0)+-200+-1100,r,t)}result(t,s,n){let r=[],o=0;for(let i of s){let a=i+(this.astral?Ps(De(n,i)):1);o&&r[o-1]==i?r[o-1]=a:(r[o++]=i,r[o++]=a)}return this.ret(t-n.length,r)}}const je=tt.define({combine(e){return pn(e,{activateOnTyping:!0,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:y5,compareCompletions:(t,s)=>t.label.localeCompare(s.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,s)=>t&&s,closeOnBlur:(t,s)=>t&&s,icons:(t,s)=>t&&s,tooltipClass:(t,s)=>n=>w_(t(n),s(n)),optionClass:(t,s)=>n=>w_(t(n),s(n)),addToOptions:(t,s)=>t.concat(s)})}});function w_(e,t){return e?t?e+" "+t:e:t}function y5(e,t,s,n,r,o){let i=e.textDirection==Zt.RTL,a=i,l=!1,c="top",u,h,d=t.left-r.left,f=r.right-t.right,p=n.right-n.left,g=n.bottom-n.top;if(a&&d<Math.min(p,f)?a=!1:!a&&f<Math.min(p,d)&&(a=!0),p<=(a?d:f))u=Math.max(r.top,Math.min(s.top,r.bottom-g))-t.top,h=Math.min(400,a?d:f);else{l=!0,h=Math.min(400,(i?t.right:r.right-t.left)-30);let v=r.bottom-t.bottom;v>=g||v>t.top?u=s.bottom-t.top:(c="bottom",u=t.bottom-s.top)}let m=(t.bottom-t.top)/o.offsetHeight,y=(t.right-t.left)/o.offsetWidth;return{style:`${c}: ${u/m}px; max-width: ${h/y}px`,class:"cm-completionInfo-"+(l?i?"left-narrow":"right-narrow":a?"left":"right")}}function v5(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(s){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),s.type&&n.classList.add(...s.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),n.setAttribute("aria-hidden","true"),n},position:20}),t.push({render(s,n,r,o){let i=document.createElement("span");i.className="cm-completionLabel";let a=s.displayLabel||s.label,l=0;for(let c=0;c<o.length;){let u=o[c++],h=o[c++];u>l&&i.appendChild(document.createTextNode(a.slice(l,u)));let d=i.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(a.slice(u,h))),d.className="cm-completionMatchedText",l=h}return l<a.length&&i.appendChild(document.createTextNode(a.slice(l))),i},position:50},{render(s){if(!s.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=s.detail,n},position:80}),t.sort((s,n)=>s.position-n.position).map(s=>s.render)}function sm(e,t,s){if(e<=s)return{from:0,to:e};if(t<0&&(t=0),t<=e>>1){let r=Math.floor(t/s);return{from:r*s,to:(r+1)*s}}let n=Math.floor((e-t)/s);return{from:e-(n+1)*s,to:e-n*s}}class b5{constructor(t,s,n){this.view=t,this.stateField=s,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let r=t.state.field(s),{options:o,selected:i}=r.open,a=t.state.facet(je);this.optionContent=v5(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=sm(o.length,i,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=t.state.field(s).open;for(let u=l.target,h;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(h=/-(\d+)$/.exec(u.id))&&+h[1]<c.length){this.applyCompletion(t,c[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=t.state.field(this.stateField,!1);c&&c.tooltip&&t.state.facet(je).closeOnBlur&&l.relatedTarget!=t.contentDOM&&t.dispatch({effects:Ba.of(null)})}),this.showOptions(o,r.id)}mount(){this.updateSel()}showOptions(t,s){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,s,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var s;let n=t.state.field(this.stateField),r=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),n!=r){let{options:o,selected:i,disabled:a}=n.open;(!r.open||r.open.options!=o)&&(this.range=sm(o.length,i,t.state.facet(je).maxRenderedOptions),this.showOptions(o,n.id)),this.updateSel(),a!=((s=r.open)===null||s===void 0?void 0:s.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(t){let s=this.tooltipClass(t);if(s!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of s.split(" "))n&&this.dom.classList.add(n);this.currentClass=s}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),s=t.open;if((s.selected>-1&&s.selected<this.range.from||s.selected>=this.range.to)&&(this.range=sm(s.options.length,s.selected,this.view.state.facet(je).maxRenderedOptions),this.showOptions(s.options,t.id)),this.updateSelectedOption(s.selected)){this.destroyInfo();let{completion:n}=s.options[s.selected],{info:r}=n;if(!r)return;let o=typeof r=="string"?document.createTextNode(r):r(n);if(!o)return;"then"in o?o.then(i=>{i&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(i,n)}).catch(i=>Ms(this.view.state,i,"completion info")):this.addInfoPane(o,n)}}addInfoPane(t,s){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",t.nodeType!=null)n.appendChild(t),this.infoDestroy=null;else{let{dom:r,destroy:o}=t;n.appendChild(r),this.infoDestroy=o||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let s=null;for(let n=this.list.firstChild,r=this.range.from;n;n=n.nextSibling,r++)n.nodeName!="LI"||!n.id?r--:r==t?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),s=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return s&&x5(this.list,s),s}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let s=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),r=t.getBoundingClientRect(),o=this.space;if(!o){let i=this.dom.ownerDocument.defaultView||window;o={left:0,top:0,right:i.innerWidth,bottom:i.innerHeight}}return r.top>Math.min(o.bottom,s.bottom)-10||r.bottom<Math.max(o.top,s.top)+10?null:this.view.state.facet(je).positionInfo(this.view,s,r,n,o,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,s,n){const r=document.createElement("ul");r.id=s,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let o=null;for(let i=n.from;i<n.to;i++){let{completion:a,match:l}=t[i],{section:c}=a;if(c){let d=typeof c=="string"?c:c.name;if(d!=o&&(i>n.from||n.from==0))if(o=d,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let f=r.appendChild(document.createElement("completion-section"));f.textContent=d}}const u=r.appendChild(document.createElement("li"));u.id=s+"-"+i,u.setAttribute("role","option");let h=this.optionClass(a);h&&(u.className=h);for(let d of this.optionContent){let f=d(a,this.view.state,this.view,l);f&&u.appendChild(f)}}return n.from&&r.classList.add("cm-completionListIncompleteTop"),n.to<t.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function w5(e,t){return s=>new b5(s,e,t)}function x5(e,t){let s=e.getBoundingClientRect(),n=t.getBoundingClientRect(),r=s.height/e.offsetHeight;n.top<s.top?e.scrollTop-=(s.top-n.top)/r:n.bottom>s.bottom&&(e.scrollTop+=(n.bottom-s.bottom)/r)}function x_(e){return(e.boost||0)*100+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}function _5(e,t){let s=[],n=null,r=l=>{s.push(l);let{section:c}=l.completion;if(c){n||(n=[]);let u=typeof c=="string"?c:c.name;n.some(h=>h.name==u)||n.push(typeof c=="string"?{name:u}:c)}};for(let l of e)if(l.hasResult()){let c=l.result.getMatch;if(l.result.filter===!1)for(let u of l.result.options)r(new y_(u,l.source,c?c(u):[],1e9-s.length));else{let u=new g5(t.sliceDoc(l.from,l.to));for(let h of l.result.options)if(u.match(h.label)){let d=h.displayLabel?c?c(h,u.matched):[]:u.matched;r(new y_(h,l.source,d,u.score+(h.boost||0)))}}}if(n){let l=Object.create(null),c=0,u=(h,d)=>{var f,p;return((f=h.rank)!==null&&f!==void 0?f:1e9)-((p=d.rank)!==null&&p!==void 0?p:1e9)||(h.name<d.name?-1:1)};for(let h of n.sort(u))c-=1e5,l[h.name]=c;for(let h of s){let{section:d}=h.completion;d&&(h.score+=l[typeof d=="string"?d:d.name])}}let o=[],i=null,a=t.facet(je).compareCompletions;for(let l of s.sort((c,u)=>u.score-c.score||a(c.completion,u.completion))){let c=l.completion;!i||i.label!=c.label||i.detail!=c.detail||i.type!=null&&c.type!=null&&i.type!=c.type||i.apply!=c.apply||i.boost!=c.boost?o.push(l):x_(l.completion)>x_(i)&&(o[o.length-1]=l),i=l.completion}return o}class li{constructor(t,s,n,r,o,i){this.options=t,this.attrs=s,this.tooltip=n,this.timestamp=r,this.selected=o,this.disabled=i}setSelected(t,s){return t==this.selected||t>=this.options.length?this:new li(this.options,__(s,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,s,n,r,o){let i=_5(t,s);if(!i.length)return r&&t.some(l=>l.state==1)?new li(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let a=s.facet(je).selectOnOpen?0:-1;if(r&&r.selected!=a&&r.selected!=-1){let l=r.options[r.selected].completion;for(let c=0;c<i.length;c++)if(i[c].completion==l){a=c;break}}return new li(i,__(n,a),{pos:t.reduce((l,c)=>c.hasResult()?Math.min(l,c.from):l,1e8),create:O5,above:o.aboveCursor},r?r.timestamp:Date.now(),a,!1)}map(t){return new li(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class uc{constructor(t,s,n){this.active=t,this.id=s,this.open=n}static start(){return new uc(S5,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(t){let{state:s}=t,n=s.facet(je),r=(n.override||s.languageDataAt("autocomplete",yr(s)).map(m5)).map(i=>(this.active.find(a=>a.source==i)||new ds(i,this.active.some(a=>a.state!=0)?1:0)).update(t,n));r.length==this.active.length&&r.every((i,a)=>i==this.active[a])&&(r=this.active);let o=this.open;o&&t.docChanged&&(o=o.map(t.changes)),t.selection||r.some(i=>i.hasResult()&&t.changes.touchesRange(i.from,i.to))||!A5(r,this.active)?o=li.build(r,s,this.id,o,n):o&&o.disabled&&!r.some(i=>i.state==1)&&(o=null),!o&&r.every(i=>i.state!=1)&&r.some(i=>i.hasResult())&&(r=r.map(i=>i.hasResult()?new ds(i.source,0):i));for(let i of t.effects)i.is(k_)&&(o=o&&o.setSelected(i.value,this.id));return r==this.active&&o==this.open?this:new uc(r,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:k5}}function A5(e,t){if(e==t)return!0;for(let s=0,n=0;;){for(;s<e.length&&!e[s].hasResult;)s++;for(;n<t.length&&!t[n].hasResult;)n++;let r=s==e.length,o=n==t.length;if(r||o)return r==o;if(e[s++].result!=t[n++].result)return!1}}const k5={"aria-autocomplete":"list"};function __(e,t){let s={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(s["aria-activedescendant"]=e+"-"+t),s}const S5=[];function nm(e){return e.isUserEvent("input.type")?"input":e.isUserEvent("delete.backward")?"delete":null}class ds{constructor(t,s,n=-1){this.source=t,this.state=s,this.explicitPos=n}hasResult(){return!1}update(t,s){let n=nm(t),r=this;n?r=r.handleUserEvent(t,n,s):t.docChanged?r=r.handleChange(t):t.selection&&r.state!=0&&(r=new ds(r.source,0));for(let o of t.effects)if(o.is(cc))r=new ds(r.source,1,o.value?yr(t.state):-1);else if(o.is(Ba))r=new ds(r.source,0);else if(o.is(A_))for(let i of o.value)i.source==r.source&&(r=i);return r}handleUserEvent(t,s,n){return s=="delete"||!n.activateOnTyping?this.map(t.changes):new ds(this.source,1)}handleChange(t){return t.changes.touchesRange(yr(t.startState))?new ds(this.source,0):this.map(t.changes)}map(t){return t.empty||this.explicitPos<0?this:new ds(this.source,this.state,t.mapPos(this.explicitPos))}}class hi extends ds{constructor(t,s,n,r,o){super(t,2,s),this.result=n,this.from=r,this.to=o}hasResult(){return!0}handleUserEvent(t,s,n){var r;let o=t.changes.mapPos(this.from),i=t.changes.mapPos(this.to,1),a=yr(t.state);if((this.explicitPos<0?a<=o:a<this.from)||a>i||s=="delete"&&yr(t.startState)==this.from)return new ds(this.source,s=="input"&&n.activateOnTyping?1:0);let l=this.explicitPos<0?-1:t.changes.mapPos(this.explicitPos),c;return C5(this.result.validFor,t.state,o,i)?new hi(this.source,l,this.result,o,i):this.result.update&&(c=this.result.update(this.result,o,i,new m_(t.state,a,l>=0)))?new hi(this.source,l,c,c.from,(r=c.to)!==null&&r!==void 0?r:yr(t.state)):new ds(this.source,1,l)}handleChange(t){return t.changes.touchesRange(this.from,this.to)?new ds(this.source,0):this.map(t.changes)}map(t){return t.empty?this:new hi(this.source,this.explicitPos<0?-1:t.mapPos(this.explicitPos),this.result,t.mapPos(this.from),t.mapPos(this.to,1))}}function C5(e,t,s,n){if(!e)return!1;let r=t.sliceDoc(s,n);return typeof e=="function"?e(r,s,n,t):v_(e,!0).test(r)}const A_=bt.define({map(e,t){return e.map(s=>s.map(t))}}),k_=bt.define(),xs=Ne.define({create(){return uc.start()},update(e,t){return e.update(t)},provide:e=>[kp.from(e,t=>t.tooltip),et.contentAttributes.from(e,t=>t.attrs)]});function S_(e,t){const s=t.completion.apply||t.completion.label;let n=e.state.field(xs).active.find(r=>r.source==t.source);return n instanceof hi?(typeof s=="string"?e.dispatch(Object.assign(Object.assign({},p5(e.state,s,n.from,n.to)),{annotations:f5.of(t.completion)})):s(e,t.completion,n.from,n.to),!0):!1}const O5=w5(xs,S_);function dc(e,t="option"){return s=>{let n=s.state.field(xs,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<s.state.facet(je).interactionDelay)return!1;let r=1,o;t=="page"&&(o=Dw(s,n.open.tooltip))&&(r=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:i}=n.open.options,a=n.open.selected>-1?n.open.selected+r*(e?1:-1):e?0:i-1;return a<0?a=t=="page"?0:i-1:a>=i&&(a=t=="page"?i-1:0),s.dispatch({effects:k_.of(a)}),!0}}const T5=e=>{let t=e.state.field(xs,!1);return e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(je).interactionDelay?!1:S_(e,t.open.options[t.open.selected])},P5=e=>e.state.field(xs,!1)?(e.dispatch({effects:cc.of(!0)}),!0):!1,M5=e=>{let t=e.state.field(xs,!1);return!t||!t.active.some(s=>s.state!=0)?!1:(e.dispatch({effects:Ba.of(null)}),!0)};class I5{constructor(t,s){this.active=t,this.context=s,this.time=Date.now(),this.updates=[],this.done=void 0}}const E5=50,$5=1e3,R5=ie.fromClass(class{constructor(e){this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of e.state.field(xs).active)t.state==1&&this.startQuery(t)}update(e){let t=e.state.field(xs);if(!e.selectionSet&&!e.docChanged&&e.startState.field(xs)==t)return;let s=e.transactions.some(r=>(r.selection||r.docChanged)&&!nm(r));for(let r=0;r<this.running.length;r++){let o=this.running[r];if(s||o.updates.length+e.transactions.length>E5&&Date.now()-o.time>$5){for(let i of o.context.abortListeners)try{i()}catch(a){Ms(this.view.state,a)}o.context.abortListeners=null,this.running.splice(r--,1)}else o.updates.push(...e.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),e.transactions.some(r=>r.effects.some(o=>o.is(cc)))&&(this.pendingStart=!0);let n=this.pendingStart?50:e.state.facet(je).activateOnTypingDelay;if(this.debounceUpdate=t.active.some(r=>r.state==1&&!this.running.some(o=>o.active.source==r.source))?setTimeout(()=>this.startUpdate(),n):-1,this.composing!=0)for(let r of e.transactions)nm(r)=="input"?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:e}=this.view,t=e.field(xs);for(let s of t.active)s.state==1&&!this.running.some(n=>n.active.source==s.source)&&this.startQuery(s)}startQuery(e){let{state:t}=this.view,s=yr(t),n=new m_(t,s,e.explicitPos==s),r=new I5(e,n);this.running.push(r),Promise.resolve(e.source(n)).then(o=>{r.context.aborted||(r.done=o||null,this.scheduleAccept())},o=>{this.view.dispatch({effects:Ba.of(null)}),Ms(this.view.state,o)})}scheduleAccept(){this.running.every(e=>e.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(je).updateSyncTime))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],s=this.view.state.facet(je);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(r.done===void 0)continue;if(this.running.splice(n--,1),r.done){let i=new hi(r.active.source,r.active.explicitPos,r.done,r.done.from,(e=r.done.to)!==null&&e!==void 0?e:yr(r.updates.length?r.updates[0].startState:this.view.state));for(let a of r.updates)i=i.update(a,s);if(i.hasResult()){t.push(i);continue}}let o=this.view.state.field(xs).active.find(i=>i.source==r.active.source);if(o&&o.state==1)if(r.done==null){let i=new ds(r.active.source,0);for(let a of r.updates)i=i.update(a,s);i.state!=1&&t.push(i)}else this.startQuery(o)}t.length&&this.view.dispatch({effects:A_.of(t)})}},{eventHandlers:{blur(e){let t=this.view.state.field(xs,!1);if(t&&t.tooltip&&this.view.state.facet(je).closeOnBlur){let s=t.open&&Dw(this.view,t.open.tooltip);(!s||!s.dom.contains(e.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Ba.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:cc.of(!1)}),20),this.composing=0}}}),D5=et.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),ja={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Xr=bt.define({map(e,t){return t.mapPos(e,-1,ns.TrackAfter)??void 0}}),rm=new class extends Gr{};rm.startSide=1,rm.endSide=-1;const C_=Ne.define({create(){return $t.empty},update(e,t){if(e=e.map(t.changes),t.selection){let s=t.state.doc.lineAt(t.selection.main.head);e=e.update({filter:n=>n>=s.from&&n<=s.to})}for(let s of t.effects)s.is(Xr)&&(e=e.update({add:[rm.range(s.value,s.value+1)]}));return e}});function N5(){return[B5,C_]}const om="()[]{}<>";function O_(e){for(let t=0;t<om.length;t+=2)if(om.charCodeAt(t)==e)return om.charAt(t+1);return kf(e<128?e:e+1)}function T_(e,t){return e.languageDataAt("closeBrackets",t)[0]||ja}const L5=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),B5=et.inputHandler.of((e,t,s,n)=>{if((L5?e.composing:e.compositionStarted)||e.state.readOnly)return!1;let r=e.state.selection.main;if(n.length>2||n.length==2&&Ps(De(n,0))==1||t!=r.from||s!=r.to)return!1;let o=V5(e.state,n);return o?(e.dispatch(o),!0):!1}),j5=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let s=T_(e,e.selection.main.head).brackets||ja.brackets,n=null,r=e.changeByRange(o=>{if(o.empty){let i=z5(e.doc,o.head);for(let a of s)if(a==i&&fc(e.doc,o.head)==O_(De(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:W.cursor(o.head-a.length)}}return{range:n=o}});return n||t(e.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},F5=[{key:"Backspace",run:j5}];function V5(e,t){let s=T_(e,e.selection.main.head),n=s.brackets||ja.brackets;for(let r of n){let o=O_(De(r,0));if(t==r)return o==r?H5(e,r,n.indexOf(r+r+r)>-1,s):G5(e,r,o,s.before||ja.before);if(t==o&&P_(e,e.selection.main.from))return U5(e,r,o)}return null}function P_(e,t){let s=!1;return e.field(C_).between(0,e.doc.length,n=>{n==t&&(s=!0)}),s}function fc(e,t){let s=e.sliceString(t,t+2);return s.slice(0,Ps(De(s,0)))}function z5(e,t){let s=e.sliceString(t-2,t);return Ps(De(s,0))==s.length?s:s.slice(1)}function G5(e,t,s,n){let r=null,o=e.changeByRange(i=>{if(!i.empty)return{changes:[{insert:t,from:i.from},{insert:s,from:i.to}],effects:Xr.of(i.to+t.length),range:W.range(i.anchor+t.length,i.head+t.length)};let a=fc(e.doc,i.head);return!a||/\s/.test(a)||n.indexOf(a)>-1?{changes:{insert:t+s,from:i.head},effects:Xr.of(i.head+t.length),range:W.cursor(i.head+t.length)}:{range:r=i}});return r?null:e.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function U5(e,t,s){let n=null,r=e.changeByRange(o=>o.empty&&fc(e.doc,o.head)==s?{changes:{from:o.head,to:o.head+s.length,insert:s},range:W.cursor(o.head+s.length)}:n={range:o});return n?null:e.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function H5(e,t,s,n){let r=n.stringPrefixes||ja.stringPrefixes,o=null,i=e.changeByRange(a=>{if(!a.empty)return{changes:[{insert:t,from:a.from},{insert:t,from:a.to}],effects:Xr.of(a.to+t.length),range:W.range(a.anchor+t.length,a.head+t.length)};let l=a.head,c=fc(e.doc,l),u;if(c==t){if(M_(e,l))return{changes:{insert:t+t,from:l},effects:Xr.of(l+t.length),range:W.cursor(l+t.length)};if(P_(e,l)){let h=s&&e.sliceDoc(l,l+t.length*3)==t+t+t?t+t+t:t;return{changes:{from:l,to:l+h.length,insert:h},range:W.cursor(l+h.length)}}}else{if(s&&e.sliceDoc(l-2*t.length,l)==t+t&&(u=I_(e,l-2*t.length,r))>-1&&M_(e,u))return{changes:{insert:t+t+t+t,from:l},effects:Xr.of(l+t.length),range:W.cursor(l+t.length)};if(e.charCategorizer(l)(c)!=Kt.Word&&I_(e,l,r)>-1&&!W5(e,l,t,r))return{changes:{insert:t+t,from:l},effects:Xr.of(l+t.length),range:W.cursor(l+t.length)}}return{range:o=a}});return o?null:e.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function M_(e,t){let s=Ye(e).resolveInner(t+1);return s.parent&&s.from==t}function W5(e,t,s,n){let r=Ye(e).resolveInner(t,-1),o=n.reduce((i,a)=>Math.max(i,a.length),0);for(let i=0;i<5;i++){let a=e.sliceDoc(r.from,Math.min(r.to,r.from+s.length+o)),l=a.indexOf(s);if(!l||l>-1&&n.indexOf(a.slice(0,l))>-1){let u=r.firstChild;for(;u&&u.from==r.from&&u.to-u.from>s.length+l;){if(e.sliceDoc(u.to-s.length,u.to)==s)return!1;u=u.firstChild}return!0}let c=r.to==t&&r.parent;if(!c)break;r=c}return!1}function I_(e,t,s){let n=e.charCategorizer(t);if(n(e.sliceDoc(t-1,t))!=Kt.Word)return t;for(let r of s){let o=t-r.length;if(e.sliceDoc(o,t)==r&&n(e.sliceDoc(o-1,o))!=Kt.Word)return o}return-1}function X5(e={}){return[xs,je.of(e),R5,Y5,D5]}const E_=[{key:"Ctrl-Space",run:P5},{key:"Escape",run:M5},{key:"ArrowDown",run:dc(!0)},{key:"ArrowUp",run:dc(!1)},{key:"PageDown",run:dc(!0,"page")},{key:"PageUp",run:dc(!1,"page")},{key:"Enter",run:T5}],Y5=Ho.highest($h.computeN([je],e=>e.facet(je).defaultKeymap?[E_]:[]));class Z5{constructor(t,s,n){this.from=t,this.to=s,this.diagnostic=n}}class Yr{constructor(t,s,n){this.diagnostics=t,this.panel=s,this.selected=n}static init(t,s,n){let r=t,o=n.facet(N_).markerFilter;o&&(r=o(r,n));let i=ut.set(r.map(a=>a.from==a.to||a.from==a.to-1&&n.doc.lineAt(a.from).to==a.from?ut.widget({widget:new r3(a),diagnostic:a}).range(a.from):ut.mark({attributes:{class:"cm-lintRange cm-lintRange-"+a.severity+(a.markClass?" "+a.markClass:"")},diagnostic:a,inclusive:!0}).range(a.from,a.to)),!0);return new Yr(i,s,ci(i))}}function ci(e,t=null,s=0){let n=null;return e.between(s,1e9,(r,o,{spec:i})=>{if(!(t&&i.diagnostic!=t))return n=new Z5(r,o,i.diagnostic),!1}),n}function q5(e,t){let s=e.startState.doc.lineAt(t.pos);return!!(e.effects.some(n=>n.is($_))||e.changes.touchesRange(s.from,s.to))}function Q5(e,t){return e.field(_s,!1)?t:t.concat(bt.appendConfig.of(a3))}const $_=bt.define(),im=bt.define(),R_=bt.define(),_s=Ne.define({create(){return new Yr(ut.none,null,null)},update(e,t){if(t.docChanged){let s=e.diagnostics.map(t.changes),n=null;if(e.selected){let r=t.changes.mapPos(e.selected.from,1);n=ci(s,e.selected.diagnostic,r)||ci(s,null,r)}e=new Yr(s,e.panel,n)}for(let s of t.effects)s.is($_)?e=Yr.init(s.value,e.panel,t.state):s.is(im)?e=new Yr(e.diagnostics,s.value?pc.open:null,e.selected):s.is(R_)&&(e=new Yr(e.diagnostics,e.panel,s.value));return e},provide:e=>[Ta.from(e,t=>t.panel),et.decorations.from(e,t=>t.diagnostics)]}),K5=ut.mark({class:"cm-lintRange cm-lintRange-active",inclusive:!0});function J5(e,t,s){let{diagnostics:n}=e.state.field(_s),r=[],o=2e8,i=0;n.between(t-(s<0?1:0),t+(s>0?1:0),(l,c,{spec:u})=>{t>=l&&t<=c&&(l==c||(t>l||s>0)&&(t<c||s<0))&&(r.push(u.diagnostic),o=Math.min(l,o),i=Math.max(c,i))});let a=e.state.facet(N_).tooltipFilter;return a&&(r=a(r,e.state)),r.length?{pos:o,end:i,above:e.state.doc.lineAt(o).to<i,create(){return{dom:t3(e,r)}}}:null}function t3(e,t){return Ut("ul",{class:"cm-tooltip-lint"},t.map(s=>B_(e,s,!1)))}const e3=e=>{let t=e.state.field(_s,!1);(!t||!t.panel)&&e.dispatch({effects:Q5(e.state,[im.of(!0)])});let s=Oa(e,pc.open);return s&&s.dom.querySelector(".cm-panel-lint ul").focus(),!0},D_=e=>{let t=e.state.field(_s,!1);return!t||!t.panel?!1:(e.dispatch({effects:im.of(!1)}),!0)},s3=e=>{let t=e.state.field(_s,!1);if(!t)return!1;let s=e.state.selection.main,n=t.diagnostics.iter(s.to+1);return!n.value&&(n=t.diagnostics.iter(0),!n.value||n.from==s.from&&n.to==s.to)?!1:(e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},n3=[{key:"Mod-Shift-m",run:e3,preventDefault:!0},{key:"F8",run:s3}],N_=tt.define({combine(e){return Object.assign({sources:e.map(t=>t.source).filter(t=>t!=null)},pn(e.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(t,s)=>t?s?n=>t(n)||s(n):t:s}))}});function L_(e){let t=[];if(e)t:for(let{name:s}of e){for(let n=0;n<s.length;n++){let r=s[n];if(/[a-zA-Z]/.test(r)&&!t.some(o=>o.toLowerCase()==r.toLowerCase())){t.push(r);continue t}}t.push("")}return t}function B_(e,t,s){var n;let r=s?L_(t.actions):[];return Ut("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},Ut("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage():t.message),(n=t.actions)===null||n===void 0?void 0:n.map((o,i)=>{let a=!1,l=d=>{if(d.preventDefault(),a)return;a=!0;let f=ci(e.state.field(_s).diagnostics,t);f&&o.apply(e,f.from,f.to)},{name:c}=o,u=r[i]?c.indexOf(r[i]):-1,h=u<0?c:[c.slice(0,u),Ut("u",c.slice(u,u+1)),c.slice(u+1)];return Ut("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${c}${u<0?"":` (access key "${r[i]})"`}.`},h)}),t.source&&Ut("div",{class:"cm-diagnosticSource"},t.source))}class r3 extends Fn{constructor(t){super(),this.diagnostic=t}eq(t){return t.diagnostic==this.diagnostic}toDOM(){return Ut("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class j_{constructor(t,s){this.diagnostic=s,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=B_(t,s,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class pc{constructor(t){this.view=t,this.items=[];let s=r=>{if(r.keyCode==27)D_(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:o}=this.items[this.selectedIndex],i=L_(o.actions);for(let a=0;a<i.length;a++)if(i[a].toUpperCase().charCodeAt(0)==r.keyCode){let l=ci(this.view.state.field(_s).diagnostics,o);l&&o.actions[a].apply(t,l.from,l.to)}}else return;r.preventDefault()},n=r=>{for(let o=0;o<this.items.length;o++)this.items[o].dom.contains(r.target)&&this.moveSelection(o)};this.list=Ut("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:s,onclick:n}),this.dom=Ut("div",{class:"cm-panel-lint"},this.list,Ut("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>D_(this.view)},"\xD7")),this.update()}get selectedIndex(){let t=this.view.state.field(_s).selected;if(!t)return-1;for(let s=0;s<this.items.length;s++)if(this.items[s].diagnostic==t.diagnostic)return s;return-1}update(){let{diagnostics:t,selected:s}=this.view.state.field(_s),n=0,r=!1,o=null;for(t.between(0,this.view.state.doc.length,(i,a,{spec:l})=>{let c=-1,u;for(let h=n;h<this.items.length;h++)if(this.items[h].diagnostic==l.diagnostic){c=h;break}c<0?(u=new j_(this.view,l.diagnostic),this.items.splice(n,0,u),r=!0):(u=this.items[c],c>n&&(this.items.splice(n,c-n),r=!0)),s&&u.diagnostic==s.diagnostic?u.dom.hasAttribute("aria-selected")||(u.dom.setAttribute("aria-selected","true"),o=u):u.dom.hasAttribute("aria-selected")&&u.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new j_(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:i,panel:a})=>{let l=a.height/this.list.offsetHeight;i.top<a.top?this.list.scrollTop-=(a.top-i.top)/l:i.bottom>a.bottom&&(this.list.scrollTop+=(i.bottom-a.bottom)/l)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let t=this.list.firstChild;function s(){let n=t;t=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;t!=n.dom;)s();t=n.dom.nextSibling}else this.list.insertBefore(n.dom,t);for(;t;)s()}moveSelection(t){if(this.selectedIndex<0)return;let s=this.view.state.field(_s),n=ci(s.diagnostics,this.items[t].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:R_.of(n)})}static open(t){return new pc(t)}}function o3(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}function mc(e){return o3(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const i3=et.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:mc("#d11")},".cm-lintRange-warning":{backgroundImage:mc("orange")},".cm-lintRange-info":{backgroundImage:mc("#999")},".cm-lintRange-hint":{backgroundImage:mc("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),a3=[_s,et.decorations.compute([_s],e=>{let{selected:t,panel:s}=e.field(_s);return!t||!s||t.from==t.to?ut.none:ut.set([K5.range(t.from,t.to)])}),yN(J5,{hideOn:q5}),i3],l3=(()=>[CN(),PN(),WD(),NL(),nL(),DD(),FD(),Mt.allowMultipleSelections.of(!0),GN(),ix(aL,{fallback:!0}),pL(),N5(),X5(),iN(),hN(),KD(),zB(),$h.of([...F5,...NB,...a5,...HL,...JN,...E_,...n3])])();function h3(e,t,s=!1){let n;return function(...r){const o=this;n?clearTimeout(n):s&&e.apply(o,r),n=setTimeout(i,t||100);function i(){s||e.apply(o,r),n=null}}}function c3(e){let t,s,n,r,o,i;return{c(){t=q("div"),s=q("div"),s.innerHTML='<div class="scm-loading__spinner svelte-kcx0g9"></div> <p class="scm-loading__text svelte-kcx0g9">Loading editor...</p>',n=it(),r=q("pre"),o=vt(e[0]),Q(s,"class","scm-waiting__loading scm-loading svelte-kcx0g9"),Q(r,"class","scm-pre cm-editor svelte-kcx0g9"),Q(t,"class",i="scm-waiting "+e[1]+" svelte-kcx0g9")},m(a,l){Ct(a,t,l),V(t,s),V(t,n),V(t,r),V(r,o)},p(a,l){l[0]&1&&ne(o,a[0]),l[0]&2&&i!==(i="scm-waiting "+a[1]+" svelte-kcx0g9")&&Q(t,"class",i)},d(a){a&&xt(t)}}}function u3(e){let t,s;return{c(){t=q("div"),Q(t,"class",s="codemirror-wrapper "+e[1]+" svelte-kcx0g9")},m(n,r){Ct(n,t,r),e[18](t)},p(n,r){r[0]&2&&s!==(s="codemirror-wrapper "+n[1]+" svelte-kcx0g9")&&Q(t,"class",s)},d(n){n&&xt(t),e[18](null)}}}function d3(e){let t;function s(r,o){return r[3]?u3:c3}let n=s(e)(e);return{c(){n.c(),t=ml()},m(r,o){n.m(r,o),Ct(r,t,o)},p(r,o){n.p(r,o)},i:jt,o:jt,d(r){r&&xt(t),n.d(r)}}}function f3(e,t,s){let n,r,{class:o=""}=t,{value:i=""}=t,{basic:a=!0}=t,{lang:l=void 0}=t,{theme:c=void 0}=t,{extensions:u=[]}=t,{useTab:h=!0}=t,{tabSize:d=2}=t,{styles:f=void 0}=t,{lineWrapping:p=!1}=t,{editable:g=!0}=t,{readonly:m=!1}=t,{placeholder:y=void 0}=t,{nodebounce:v=!1}=t;const b=typeof window<"u",w=Pi();let S,_,A=!1,O=!1,P=!0,R=!0;Tr(()=>s(16,_=X())),g0(()=>_==null?void 0:_.destroy());function X(){return new et({parent:S,state:K(i),dispatch(U){_.update([U]),!A&&U.docChanged&&r()}})}function B(){if(P){P=!1;return}_.dispatch({effects:bt.reconfigure.of(n)})}function H(U){if(R){R=!1;return}if(O){O=!1;return}A=!0,_.setState(K(U)),A=!1}function j(){const U=_.state.doc.toString();U!==i&&(O=!0,s(0,i=U),w("change",i))}function K(U){return Mt.create({doc:U??void 0,extensions:n})}function nt(U,N,E,L,D,x,C,$){const F=[Gh.of(" ".repeat(E)),et.editable.of(x),Mt.readOnly.of(C)];return U&&F.push(l3),N&&F.push($h.of([LB])),D&&F.push(sN(D)),$&&F.push($),L&&F.push(et.lineWrapping),F}function ht(U,N){const E=[];return N&&E.push(et.theme(N)),U&&E.push(U),E}function St(U){sn[U?"unshift":"push"](()=>{S=U,s(2,S)})}return e.$$set=U=>{"class"in U&&s(1,o=U.class),"value"in U&&s(0,i=U.value),"basic"in U&&s(4,a=U.basic),"lang"in U&&s(5,l=U.lang),"theme"in U&&s(6,c=U.theme),"extensions"in U&&s(7,u=U.extensions),"useTab"in U&&s(8,h=U.useTab),"tabSize"in U&&s(9,d=U.tabSize),"styles"in U&&s(10,f=U.styles),"lineWrapping"in U&&s(11,p=U.lineWrapping),"editable"in U&&s(12,g=U.editable),"readonly"in U&&s(13,m=U.readonly),"placeholder"in U&&s(14,y=U.placeholder),"nodebounce"in U&&s(15,v=U.nodebounce)},e.$$.update=()=>{e.$$.dirty[0]&32752&&s(17,n=[...nt(a,h,d,p,y,g,m,l),...ht(c,f),...u]),e.$$.dirty[0]&65537&&_&&H(i),e.$$.dirty[0]&196608&&_&&n&&B(),e.$$.dirty[0]&32768&&(r=v?j:h3(j,300))},[i,o,S,b,a,l,c,u,h,d,f,p,g,m,y,v,_,n,St]}class p3 extends ye{constructor(t){super(),ge(this,t,f3,d3,ce,{class:1,value:0,basic:4,lang:5,theme:6,extensions:7,useTab:8,tabSize:9,styles:10,lineWrapping:11,editable:12,readonly:13,placeholder:14,nodebounce:15},null,[-1,-1])}get class(){return this.$$.ctx[1]}set class(t){this.$$set({class:t}),ft()}get value(){return this.$$.ctx[0]}set value(t){this.$$set({value:t}),ft()}get basic(){return this.$$.ctx[4]}set basic(t){this.$$set({basic:t}),ft()}get lang(){return this.$$.ctx[5]}set lang(t){this.$$set({lang:t}),ft()}get theme(){return this.$$.ctx[6]}set theme(t){this.$$set({theme:t}),ft()}get extensions(){return this.$$.ctx[7]}set extensions(t){this.$$set({extensions:t}),ft()}get useTab(){return this.$$.ctx[8]}set useTab(t){this.$$set({useTab:t}),ft()}get tabSize(){return this.$$.ctx[9]}set tabSize(t){this.$$set({tabSize:t}),ft()}get styles(){return this.$$.ctx[10]}set styles(t){this.$$set({styles:t}),ft()}get lineWrapping(){return this.$$.ctx[11]}set lineWrapping(t){this.$$set({lineWrapping:t}),ft()}get editable(){return this.$$.ctx[12]}set editable(t){this.$$set({editable:t}),ft()}get readonly(){return this.$$.ctx[13]}set readonly(t){this.$$set({readonly:t}),ft()}get placeholder(){return this.$$.ctx[14]}set placeholder(t){this.$$set({placeholder:t}),ft()}get nodebounce(){return this.$$.ctx[15]}set nodebounce(t){this.$$set({nodebounce:t}),ft()}}function m3(e){var B,H;let t,s,n,r,o,i,a,l,c,u,h,d,f=(((B=e[0].audio)==null?void 0:B.name)??"[None]")+"",p,g,m,y,v,b,w,S,_,A=(((H=e[0].background)==null?void 0:H.name)??"[None]")+"",O,P,R,X;return o=new gs({props:{icon:"Close"}}),o.$on("click",e[4]),m=new gs({props:{icon:"Edit"}}),m.$on("click",e[2]),R=new gs({props:{icon:"Edit"}}),R.$on("click",e[3]),{c(){t=q("div"),s=q("div"),n=q("h2"),n.textContent="Asset Editor",r=it(),Pt(o.$$.fragment),i=it(),a=q("ol"),l=q("li"),c=q("h3"),c.textContent="Audio",u=it(),h=q("div"),d=q("p"),p=vt(f),g=it(),Pt(m.$$.fragment),y=it(),v=q("li"),b=q("h3"),b.textContent="Background",w=it(),S=q("div"),_=q("p"),O=vt(A),P=it(),Pt(R.$$.fragment),Q(n,"class","svelte-zkito1"),Q(s,"class","header svelte-zkito1"),Q(c,"class","svelte-zkito1"),Q(d,"class","asset-name svelte-zkito1"),Q(h,"class","asset-value svelte-zkito1"),Q(l,"class","asset svelte-zkito1"),Q(b,"class","svelte-zkito1"),Q(_,"class","asset-name svelte-zkito1"),Q(S,"class","asset-value svelte-zkito1"),Q(v,"class","asset svelte-zkito1"),Q(a,"class","svelte-zkito1"),Q(t,"class","asset-browser svelte-zkito1")},m(j,K){Ct(j,t,K),V(t,s),V(s,n),V(s,r),Ot(o,s,null),V(t,i),V(t,a),V(a,l),V(l,c),V(l,u),V(l,h),V(h,d),V(d,p),V(h,g),Ot(m,h,null),V(a,y),V(a,v),V(v,b),V(v,w),V(v,S),V(S,_),V(_,O),V(S,P),Ot(R,S,null),X=!0},p(j,[K]){var nt,ht;(!X||K&1)&&f!==(f=(((nt=j[0].audio)==null?void 0:nt.name)??"[None]")+"")&&ne(p,f),(!X||K&1)&&A!==(A=(((ht=j[0].background)==null?void 0:ht.name)??"[None]")+"")&&ne(O,A)},i(j){X||(dt(o.$$.fragment,j),dt(m.$$.fragment,j),dt(R.$$.fragment,j),X=!0)},o(j){gt(o.$$.fragment,j),gt(m.$$.fragment,j),gt(R.$$.fragment,j),X=!1},d(j){j&&xt(t),Tt(o),Tt(m),Tt(R)}}}const g3=".mp3,.ogg",y3=".jpeg,.jpg";function F_(e){const t=document.createElement("input");return t.type="file",t.accept=e,t.click(),new Promise(s=>{t.addEventListener("change",()=>{t.files.length===0&&s(null);const n=t.files[0],r=new FileReader;r.onload=o=>{const i=o.target.result;s([n.name,i])},r.readAsDataURL(n)})})}function v3(e,t,s){const n=Pi();let{beatmapAssets:r}=t;async function o(){const l=await F_(g3);if(!l)return;const[c,u]=l;n("audiochange",{name:c,uri:u})}async function i(){const l=await F_(y3);if(!l)return;const[c,u]=l;n("backgroundchange",{name:c,uri:u})}const a=()=>n("close");return e.$$set=l=>{"beatmapAssets"in l&&s(0,r=l.beatmapAssets)},[r,n,o,i,a]}class b3 extends ye{constructor(t){super(),ge(this,t,v3,m3,ce,{beatmapAssets:0})}get beatmapAssets(){return this.$$.ctx[0]}set beatmapAssets(t){this.$$set({beatmapAssets:t}),ft()}}function V_(e,t,s){const n=e.slice();return n[3]=t[s],n}function z_(e){let t,s=e[3]+"",n,r;return{c(){t=q("option"),n=vt(s),t.__value=r=e[3],u0(t,t.__value)},m(o,i){Ct(o,t,i),V(t,n)},p(o,i){i&2&&s!==(s=o[3]+"")&&ne(n,s),i&2&&r!==(r=o[3])&&(t.__value=r,u0(t,t.__value))},d(o){o&&xt(t)}}}function w3(e){let t,s,n,r,o,i=bl(e[1]),a=[];for(let l=0;l<i.length;l+=1)a[l]=z_(V_(e,i,l));return{c(){t=q("label"),t.textContent="Division",s=it(),n=q("select");for(let l=0;l<a.length;l+=1)a[l].c();Q(t,"for","division"),Q(t,"class","svelte-peph8p"),Q(n,"id","division"),Q(n,"class","svelte-peph8p"),e[0]===void 0&&wo(()=>e[2].call(n))},m(l,c){Ct(l,t,c),Ct(l,s,c),Ct(l,n,c);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(n,null);d0(n,e[0],!0),r||(o=Te(n,"change",e[2]),r=!0)},p(l,[c]){if(c&2){i=bl(l[1]);let u;for(u=0;u<i.length;u+=1){const h=V_(l,i,u);a[u]?a[u].p(h,c):(a[u]=z_(h),a[u].c(),a[u].m(n,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}c&3&&d0(n,l[0])},i:jt,o:jt,d(l){l&&(xt(t),xt(s),xt(n)),PC(a,l),r=!1,o()}}}function x3(e,t,s){let{divisions:n}=t,{selected:r}=t;function o(){r=IC(this),s(0,r),s(1,n)}return e.$$set=i=>{"divisions"in i&&s(1,n=i.divisions),"selected"in i&&s(0,r=i.selected)},[r,n,o]}class _3 extends ye{constructor(t){super(),ge(this,t,x3,w3,ce,{divisions:1,selected:0})}get divisions(){return this.$$.ctx[1]}set divisions(t){this.$$set({divisions:t}),ft()}get selected(){return this.$$.ctx[0]}set selected(t){this.$$set({selected:t}),ft()}}class gc extends te{constructor(){super();const t=new Zn(H_);t.x=Rs.getTrackX(0);const s=new Zn(W_);s.x=Rs.getTrackX(1);const n=new Zn(W_);n.x=Rs.getTrackX(2);const r=new Zn(H_);r.x=Rs.getTrackX(3),this._buttons=[t,s,n,r],this._buttons.forEach(o=>this.addChild(o))}holdButton(t,s){if(!this._buttons[t])throw new Error("Track index has no corresponding button.");this._buttons[t].hold(s)}releaseButton(t,s){this._buttons[t].release(s)}update(t){this._buttons.forEach(s=>s.update(t))}}Ua(gc,"HIT_BUTTON_MARGIN",.3);const A3=new no().roundRect(0,0,Io,7,5).fill(15263976),k3=.25;class S3 extends te{constructor(t){super({alpha:.39,blendMode:"overlay"}),this.elapsedTime=0,this.hitLineToTopDist=0,this.hitLineToBottomDist=0,this.beatmap=t,this._measureDivision=1}get measureDivision(){return this._measureDivision}set measureDivision(t){if(Math.log2(t)%1!==0)throw new Error("Measure division must be a power of 2.");this._measureDivision=t}update(){this.removeChildren();for(const t of this._getVisibleLines()){const{atTime:s,isMeasure:n,velocity:r}=t,o=A3.clone(!0);o.scale.y=n?1:k3,o.pivot.y=o.height/2,o.y=r*(this.elapsedTime-s),this.addChild(o)}}getPreviousLineTime(){const t=this.beatmap.getTimingEventIndex(this.elapsedTime),s=this.beatmap.timingEvents[t],n=this.elapsedTime;this.elapsedTime=this.elapsedTime-s.timePerMeasure;let r=this.elapsedTime;for(;;)if(r=Math.max(this.elapsedTime,this.beatmap.startTimestamp),this.elapsedTime=this.getNextLineTime(),this.elapsedTime>=n)return this.elapsedTime=r,r}getNextLineTime(){let t=this.beatmap.getTimingEventIndex(this.elapsedTime),s=this.beatmap.timingEvents[t],n=Math.max(G_(s.timePerMeasure,s.atTime,this.elapsedTime),this.beatmap.timingEvents[0].atTime),r=n,o=0;for(;;){if(Math.round(r)>Math.round(this.elapsedTime))return r;const i=s.timePerBeat*(4/this._measureDivision),a=Math.min(r+i,n+s.timePerMeasure),l=this.beatmap.getTimingEventIndex(a);if(l!==t){const c=this.beatmap.timingEvents[l];t=l,s=c,r=c.atTime,o=0}else r=a,o=(o+1)%Math.ceil(s.beatsPerMeasure*(this._measureDivision/4));o===0&&(n=r)}}*_getVisibleLines(){for(const t of this.beatmap.timingEvents.keys()){if(this._timingEventNotInDisplayBounds(t))continue;const s=this._getEarliestMeasureLineTime(t);yield*this._getVisibleLinesForTimingEvent(t,s)}}_timingEventNotInDisplayBounds(t){const s=this.beatmap.timingEvents[t];if(this._getAssumedLineY(s.atTime)<-this.hitLineToTopDist)return!0;const n=t+1;if(n===this.beatmap.timingEvents.length)return!1;const r=this.beatmap.timingEvents[n];return this._getAssumedLineY(r.atTime)>this.hitLineToBottomDist}_getAssumedLineY(t){return this.beatmap.getVelocity(t)*(this.elapsedTime-t)}_getEarliestMeasureLineTime(t){const s=this.beatmap.timingEvents[t],n=this.beatmap.getVelocity(this.elapsedTime),r=this.hitLineToBottomDist/n+this.elapsedTime,o=G_(s.timePerMeasure,s.atTime,r)-s.timePerMeasure;return Math.max(o,s.atTime)}*_getVisibleLinesForTimingEvent(t,s){const n=this.beatmap.timingEvents[t],r=t+1,o=this.beatmap.timingEvents[r];let i=s,a=0,l=i;for(;!(o&&Math.round(i)>=o.atTime);){const c=this.beatmap.getVelocity(i);if(c*(this.elapsedTime-i)<-this.hitLineToTopDist)break;yield{atTime:i,velocity:c,isMeasure:a===0};const u=n.timePerBeat*(4/this._measureDivision);i=Math.min(i+u,l+n.timePerMeasure),a=(a+1)%Math.ceil(n.beatsPerMeasure*(this._measureDivision/4)),a===0&&(l=i)}}}function G_(e,t,s){return Math.floor((s-t)/e)*e+t}const am=200;class C3 extends Je{constructor(t){super({texture:me.get(t?"note_head_0":"note_head_1"),anchor:.5})}playHitAnimation(t,s){this.alpha=Vs(1,0,t,t+am,s),this.scale.set(Vs(1,3,t,t+250,s))}}class O3 extends te{constructor(t){super(),this._head=new Je({texture:me.get(t?"note_head_0":"note_head_1"),anchor:.5}),this._tail=new Je({texture:me.get(t?"hold_note_tail_0":"hold_note_tail_1"),anchor:{x:.5,y:1}}),this._tailMaskBody=new no({scale:-1}).rect(-this._tail.width/2,0,this._tail.width,this._tail.height).fill(16711680),this._tailMaskEnd=new no().circle(0,0,this._tail.width/2).fill(65280),this._tailMask=new te,this._tailMask.addChild(this._tailMaskBody),this._tailMask.addChild(this._tailMaskEnd),this._tail.mask=this._tailMask,this.tailLength=this._tail.height,this.addChild(this._tail),this.addChild(this._head),this.addChild(this._tailMask)}get tailLength(){return this._tail.height-this._tail.width}set tailLength(t){this._tail.height=t;const s=this._tail.width/2;this._tailMaskBody.height=this._tail.height-s,this._tailMaskEnd.y=-this._tailMaskBody.height}playHitAnimation(t,s){this.alpha=Vs(1,0,t,t+am,s),this.scale.set(Vs(1,3,t,t+250,s))}}class T3 extends Je{constructor(t){super({texture:me.get(t?"trick_note_head_0":"trick_note_head_1"),anchor:.5})}playHitAnimation(t,s){this.alpha=Vs(1,0,t,t+am,s),this.scale.set(Vs(1,3,t,t+250,s))}}class P3{constructor(t){this._note=t,this.holdTime=null,this.releaseTime=null,this.judgement=null}get note(){return this._note}get holdDuration(){return this.releaseTime-this.holdTime}hasBeenHeldBy(t){return this.holdTime!==null&&t>=this.holdTime}hasBeenReleasedBy(t){return this.releaseTime!==null&&t>=this.releaseTime}}const ui=150;class M3 extends te{constructor(t){super(),this._beatmap=t,this._noteHitInfos=U_(t.notes)}get beatmap(){return this._beatmap}set beatmap(t){this._beatmap=t,this._noteHitInfos=U_(this._beatmap.notes)}holdNote(t,s){const n=this._noteHitInfos.find(r=>r.note.index===t);n.holdTime=s}judgeNote(t,s){const n=this._noteHitInfos.find(r=>r.note.index===t);n.judgement=s}releaseNote(t,s){const n=this._noteHitInfos.find(r=>r.note.index===t);n.releaseTime=s}update(t){this.removeChildren();for(const s of this._noteHitInfos){const n=s.note,r=n.velocity*(t-n.atTime);if(n instanceof Dv){if(r>Fi+ui||r<-900-ui)continue;this._renderHitNote(s,t)}else if(n instanceof tf){const o=r;if(n.velocity*(t-n.untilTime)>Fi+ui||o<-900-ui)continue;this._renderHoldNote(s,t)}else if(n instanceof ef){if(r>Fi+ui||r<-900-ui)continue;this._renderTrickNote(s,t)}}}_renderHitNote(t,s){const n=t.note,r=new C3(lm(n.track));r.x=Rs.getTrackX(n.track),t.hasBeenHeldBy(s)?(r.y=n.velocity*(t.holdTime-n.atTime),r.playHitAnimation(t.holdTime,s)):r.y=n.velocity*(s-n.atTime),this.addChild(r)}_renderHoldNote(t,s){const n=t.note,r=new O3(lm(n.track));if(r.x=Rs.getTrackX(n.track),this.addChild(r),t.judgement==="miss"){const o=t.holdTime-n.atTime,i=s-t.releaseTime;r.y=n.velocity*(i+o),r.tailLength=n.velocity*(n.duration-t.holdDuration),r.alpha=.5;return}if(!t.hasBeenHeldBy(s))r.y=n.velocity*(s-n.atTime),r.tailLength=n.velocity*n.duration;else if(t.hasBeenReleasedBy(s)){r.y=n.velocity*(t.holdTime-n.atTime);const o=t.releaseTime-t.holdTime;r.tailLength=n.velocity*(n.duration-o),r.playHitAnimation(t.releaseTime,s)}else{r.y=n.velocity*(t.holdTime-n.atTime);const o=s-t.holdTime;r.tailLength=n.velocity*(n.duration-o)}}_renderTrickNote(t,s){const n=t.note,r=new T3(lm(n.toTrack));s<n.switchStartTime?r.x=Rs.getTrackX(n.track):s<n.switchEndTime?r.x=Vs(Rs.getTrackX(n.track),Rs.getTrackX(n.toTrack),n.switchStartTime,n.switchEndTime,s):r.x=Rs.getTrackX(n.toTrack),t.hasBeenHeldBy(s)?(r.y=n.velocity*(t.holdTime-n.atTime),r.playHitAnimation(t.holdTime,s)):r.y=n.velocity*(s-n.atTime),this.addChild(r)}}function lm(e){return e===0||e===3}function U_(e){return e.map(t=>new P3(t))}const H_=15813249,W_=15155177;class Rs extends te{constructor(t,s){super(),this._beatmap=t,this._elapsedTime=s,this._measureDivision=1,this._lines=new S3(t),this._lines.measureDivision=this._measureDivision,this._hitButtons=new gc,this._notes=new M3(t),this.addChild(this._lines),this.addChild(this._hitButtons),this.addChild(this._notes),this._updateFromElapsedTime()}static getTrackX(t){const s=Io-8*Zn.RADIUS,n=s*gc.HIT_BUTTON_MARGIN/2,r=s*(1-gc.HIT_BUTTON_MARGIN)/3;return n+Zn.RADIUS+(r+2*Zn.RADIUS)*t}get beatmap(){return this._beatmap}set beatmap(t){this._beatmap=t,this._lines.beatmap=this._beatmap,this._notes.beatmap=this._beatmap,this._updateFromElapsedTime()}get elapsedTime(){return this._elapsedTime}set elapsedTime(t){this._elapsedTime=t,this._updateFromElapsedTime()}get measureDivision(){return this._measureDivision}set measureDivision(t){this._measureDivision=t,this._lines.measureDivision=this._measureDivision,this._lines.update()}get hitButtons(){return this._hitButtons}get lines(){return this._lines}get notes(){return this._notes}_updateFromElapsedTime(){this._lines.elapsedTime=this._elapsedTime,this._lines.hitLineToBottomDist=Fi,this._lines.hitLineToTopDist=!this.parent||this.parent.pivot.y===0?td:-this.parent.pivot.y,this._lines.update(),this._notes.update(this._elapsedTime),this._hitButtons.update(this._elapsedTime)}}function I3(e){let t,s,n={};return t=new Iy({props:n}),e[6](t),{c(){Pt(t.$$.fragment)},m(r,o){Ot(t,r,o),s=!0},p(r,[o]){const i={};t.$set(i)},i(r){s||(dt(t.$$.fragment,r),s=!0)},o(r){gt(t.$$.fragment,r),s=!1},d(r){e[6](null),Tt(t,r)}}}function E3(e,t,s){let{beatmap:n}=t,{elapsedTime:r}=t,{measureDivision:o}=t,i;const a=new Rs(n,r);Tr(()=>{i.getPixiApp().stage.addChild(a),a.elapsedTime=r});function l(){return a}function c(){return i?-i.getPixiApp().stage.pivot.y:0}function u(h){sn[h?"unshift":"push"](()=>{i=h,s(0,i)})}return e.$$set=h=>{"beatmap"in h&&s(1,n=h.beatmap),"elapsedTime"in h&&s(2,r=h.elapsedTime),"measureDivision"in h&&s(3,o=h.measureDivision)},e.$$.update=()=>{e.$$.dirty&2&&(a.beatmap=n),e.$$.dirty&4&&(a.elapsedTime=r),e.$$.dirty&8&&(a.measureDivision=o)},[i,n,r,o,l,c,u]}class $3 extends ye{constructor(t){super(),ge(this,t,E3,I3,ce,{beatmap:1,elapsedTime:2,measureDivision:3,getInstance:4,getHitLineToTopDist:5})}get beatmap(){return this.$$.ctx[1]}set beatmap(t){this.$$set({beatmap:t}),ft()}get elapsedTime(){return this.$$.ctx[2]}set elapsedTime(t){this.$$set({elapsedTime:t}),ft()}get measureDivision(){return this.$$.ctx[3]}set measureDivision(t){this.$$set({measureDivision:t}),ft()}get getInstance(){return this.$$.ctx[4]}get getHitLineToTopDist(){return this.$$.ctx[5]}}function R3(e){let t,s,n;return{c(){t=q("input"),Q(t,"type","range"),Q(t,"min",e[1]),Q(t,"max",e[2]),t.value=e[0],Q(t,"class","svelte-1vil3w4")},m(r,o){Ct(r,t,o),s||(n=Te(t,"input",e[3]),s=!0)},p(r,[o]){o&2&&Q(t,"min",r[1]),o&4&&Q(t,"max",r[2]),o&1&&(t.value=r[0])},i:jt,o:jt,d(r){r&&xt(t),s=!1,n()}}}function D3(e,t,s){const n=Pi();let{currTime:r}=t,{minTime:o}=t,{maxTime:i}=t;function a(l){n("scrub",Number(l.target.value))}return e.$$set=l=>{"currTime"in l&&s(0,r=l.currTime),"minTime"in l&&s(1,o=l.minTime),"maxTime"in l&&s(2,i=l.maxTime)},[r,o,i,a]}class N3 extends ye{constructor(t){super(),ge(this,t,D3,R3,ce,{currTime:0,minTime:1,maxTime:2})}get currTime(){return this.$$.ctx[0]}set currTime(t){this.$$set({currTime:t}),ft()}get minTime(){return this.$$.ctx[1]}set minTime(t){this.$$set({minTime:t}),ft()}get maxTime(){return this.$$.ctx[2]}set maxTime(t){this.$$set({maxTime:t}),ft()}}function L3(e){let t,s,n,r,o,i,a,l,c,u;return{c(){t=q("p"),s=vt(e[3]),n=vt(e[2]),r=vt("/"),o=vt(e[1]),i=it(),a=q("span"),l=vt("("),c=vt(e[0]),u=vt(" ms)"),Q(a,"class","svelte-1w6hwso"),Q(t,"class","scrubber-time svelte-1w6hwso")},m(h,d){Ct(h,t,d),V(t,s),V(t,n),V(t,r),V(t,o),V(t,i),V(t,a),V(a,l),V(a,c),V(a,u)},p(h,[d]){d&8&&ne(s,h[3]),d&4&&ne(n,h[2]),d&2&&ne(o,h[1]),d&1&&ne(c,h[0])},i:jt,o:jt,d(h){h&&xt(t)}}}function X_(e){const t=Math.abs(Math.floor(e/6e4)),s=Math.abs(Math.round(e%6e4/1e3)),n=t.toString().padStart(2,"0"),r=s.toString().padStart(2,"0");return`${n}:${r}`}function B3(e,t,s){let n,r,o,i,{currTime:a}=t,{maxTime:l}=t;return e.$$set=c=>{"currTime"in c&&s(4,a=c.currTime),"maxTime"in c&&s(5,l=c.maxTime)},e.$$.update=()=>{e.$$.dirty&16&&s(3,n=a<0?"-":" "),e.$$.dirty&16&&s(2,r=X_(a)),e.$$.dirty&32&&s(1,o=X_(l)),e.$$.dirty&16&&s(0,i=Math.round(a))},[i,o,r,n,a,l]}class j3 extends ye{constructor(t){super(),ge(this,t,B3,L3,ce,{currTime:4,maxTime:5})}get currTime(){return this.$$.ctx[4]}set currTime(t){this.$$set({currTime:t}),ft()}get maxTime(){return this.$$.ctx[5]}set maxTime(t){this.$$set({maxTime:t}),ft()}}class F3 extends As{constructor(t){super(),this._prevTimestamp=0,this._elapsedTime=t,this._ticker=new eo,this._ticker.add(this._updateElapsedTime,this)}get elapsedTime(){return this._elapsedTime}finalize(){this._ticker.destroy()}start(){this._prevTimestamp=performance.now(),this._ticker.start()}pause(){this._ticker.stop(),this.emit("pause")}resume(){this._ticker.start(),this.emit("resume")}seek(t){this._elapsedTime=t,this.emit("seek",this._elapsedTime)}_updateElapsedTime(){const t=performance.now();this._elapsedTime+=t-this._prevTimestamp,this._prevTimestamp=t,this.emit("tick",this._elapsedTime)}}function Y_(e){const t=new F3(e),s=Mn(t.elapsedTime);return g0(()=>{t.finalize()}),t.on("seek",n=>{s.set(n)}),t.on("tick",n=>{s.set(n)}),[t,s]}const V3=700;function z3(e){let t=null;function s(){t!==null&&clearTimeout(t),setTimeout(()=>{e(),t=null},V3)}return s}function G3(e){const t=JSON.parse(e);if(!Object.hasOwn(t,"assets")||!Object.hasOwn(t,"yaml"))throw new Error("Cannot import invalid beatmap.");return new Promise(s=>{const n=ts.new(t.yaml,t.assets);s(n)})}function U3(e){const t=new Blob([JSON.stringify(e)],{type:"application/json"}),s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=`${e.id}.json`,n.click(),URL.revokeObjectURL(s)}function Z_(e){let t,s;return t=new b3({props:{beatmapAssets:e[3]}}),t.$on("audiochange",e[22]),t.$on("backgroundchange",e[23]),t.$on("close",e[24]),{c(){Pt(t.$$.fragment)},m(n,r){Ot(t,n,r),s=!0},p(n,r){const o={};r[0]&8&&(o.beatmapAssets=n[3]),t.$set(o)},i(n){s||(dt(t.$$.fragment,n),s=!0)},o(n){gt(t.$$.fragment,n),s=!1},d(n){Tt(t,n)}}}function q_(e){let t,s,n;return{c(){t=q("div"),s=q("p"),n=vt(e[2]),Q(t,"role","status"),Q(t,"class","message-popup svelte-3cazn")},m(r,o){Ct(r,t,o),V(t,s),V(s,n)},p(r,o){o[0]&4&&ne(n,r[2])},d(r){r&&xt(t)}}}function H3(e){let t,s,n,r,o,i,a,l,c,u,h,d,f,p,g,m,y,v,b,w,S,_,A,O,P,R,X,B,H,j,K,nt,ht,St,U,N,E,L,D,x,C;t=new Hl({});let $=e[4]&&Z_(e);a=new gs({props:{icon:"arrow_back"}}),a.$on("click",e[12]),c=new gs({props:{icon:"folder_copy"}}),c.$on("click",e[25]),h=new gs({props:{icon:"export_notes"}}),h.$on("click",e[14]),p=new gs({props:{icon:"play_arrow"}}),p.$on("click",e[17]),m=new gs({props:{icon:"stop"}}),m.$on("click",e[18]),v=new gs({props:{icon:"first_page"}}),v.$on("click",e[19]),w=new N3({props:{currTime:e[7],minTime:e[1].startTimestamp,maxTime:Lt.currentSong.duration()*1e3}}),w.$on("scrub",e[26]),_=new j3({props:{currTime:e[7],maxTime:Lt.currentSong.duration()*1e3}});function F(J){e[27](J)}let Y={divisions:e[8]};e[6]!==void 0&&(Y.selected=e[6]),P=new _3({props:Y}),sn.push(()=>x0(P,"selected",F)),B=new gs({props:{icon:"navigate_before"}}),B.$on("click",e[28]),j=new gs({props:{icon:"navigate_next"}}),j.$on("click",e[29]);let ct={beatmap:e[1],elapsedTime:e[7],measureDivision:e[6]};St=new $3({props:ct}),e[30](St);function wt(J){e[31](J)}let Ft={class:"codemirror-editor",lang:_L(),theme:kL,styles:{"codemirror-wrapper":{overflow:"hidden"},"&":{height:"100%","background-color":"#111111ed","font-size":"0.85rem"},".cm-scroller":{overflow:"auto","scrollbar-color":"#666 #111"}}};e[5]!==void 0&&(Ft.value=e[5]),N=new p3({props:Ft}),sn.push(()=>x0(N,"value",wt)),N.$on("change",e[11]);let Nt=e[2]&&q_(e);return{c(){Pt(t.$$.fragment),s=it(),$&&$.c(),n=it(),r=q("div"),o=q("div"),i=q("div"),Pt(a.$$.fragment),l=it(),Pt(c.$$.fragment),u=it(),Pt(h.$$.fragment),d=it(),f=q("div"),Pt(p.$$.fragment),g=it(),Pt(m.$$.fragment),y=it(),Pt(v.$$.fragment),b=it(),Pt(w.$$.fragment),S=it(),Pt(_.$$.fragment),A=it(),O=q("div"),Pt(P.$$.fragment),X=it(),Pt(B.$$.fragment),H=it(),Pt(j.$$.fragment),K=it(),nt=q("div"),ht=q("div"),Pt(St.$$.fragment),U=it(),Pt(N.$$.fragment),L=it(),Nt&&Nt.c(),Q(i,"class","control-group svelte-3cazn"),Q(f,"class","playback-controls control-group svelte-3cazn"),Q(O,"class","control-group svelte-3cazn"),Q(o,"class","control-bar svelte-3cazn"),Q(ht,"class","scroller-wrapper svelte-3cazn"),Q(nt,"class","editor-body svelte-3cazn"),Q(r,"class","editor-view svelte-3cazn")},m(J,Gt){Ot(t,J,Gt),Ct(J,s,Gt),$&&$.m(J,Gt),Ct(J,n,Gt),Ct(J,r,Gt),V(r,o),V(o,i),Ot(a,i,null),V(i,l),Ot(c,i,null),V(i,u),Ot(h,i,null),V(o,d),V(o,f),Ot(p,f,null),V(f,g),Ot(m,f,null),V(f,y),Ot(v,f,null),V(f,b),Ot(w,f,null),V(f,S),Ot(_,f,null),V(o,A),V(o,O),Ot(P,O,null),V(O,X),Ot(B,O,null),V(O,H),Ot(j,O,null),V(r,K),V(r,nt),V(nt,ht),Ot(St,ht,null),V(nt,U),Ot(N,nt,null),V(r,L),Nt&&Nt.m(r,null),D=!0,x||(C=Te(window,"keydown",e[13]),x=!0)},p(J,Gt){J[4]?$?($.p(J,Gt),Gt[0]&16&&dt($,1)):($=Z_(J),$.c(),dt($,1),$.m(n.parentNode,n)):$&&(Ii(),gt($,1,1,()=>{$=null}),Ei());const Ve={};Gt[0]&128&&(Ve.currTime=J[7]),Gt[0]&2&&(Ve.minTime=J[1].startTimestamp),w.$set(Ve);const Jt={};Gt[0]&128&&(Jt.currTime=J[7]),_.$set(Jt);const qe={};!R&&Gt[0]&64&&(R=!0,qe.selected=J[6],y0(()=>R=!1)),P.$set(qe);const Ae={};Gt[0]&2&&(Ae.beatmap=J[1]),Gt[0]&128&&(Ae.elapsedTime=J[7]),Gt[0]&64&&(Ae.measureDivision=J[6]),St.$set(Ae);const Qs={};!E&&Gt[0]&32&&(E=!0,Qs.value=J[5],y0(()=>E=!1)),N.$set(Qs),J[2]?Nt?Nt.p(J,Gt):(Nt=q_(J),Nt.c(),Nt.m(r,null)):Nt&&(Nt.d(1),Nt=null)},i(J){D||(dt(t.$$.fragment,J),dt($),dt(a.$$.fragment,J),dt(c.$$.fragment,J),dt(h.$$.fragment,J),dt(p.$$.fragment,J),dt(m.$$.fragment,J),dt(v.$$.fragment,J),dt(w.$$.fragment,J),dt(_.$$.fragment,J),dt(P.$$.fragment,J),dt(B.$$.fragment,J),dt(j.$$.fragment,J),dt(St.$$.fragment,J),dt(N.$$.fragment,J),D=!0)},o(J){gt(t.$$.fragment,J),gt($),gt(a.$$.fragment,J),gt(c.$$.fragment,J),gt(h.$$.fragment,J),gt(p.$$.fragment,J),gt(m.$$.fragment,J),gt(v.$$.fragment,J),gt(w.$$.fragment,J),gt(_.$$.fragment,J),gt(P.$$.fragment,J),gt(B.$$.fragment,J),gt(j.$$.fragment,J),gt(St.$$.fragment,J),gt(N.$$.fragment,J),D=!1},d(J){J&&(xt(s),xt(n),xt(r)),Tt(t,J),$&&$.d(J),Tt(a),Tt(c),Tt(h),Tt(p),Tt(m),Tt(v),Tt(w),Tt(_),Tt(P),Tt(B),Tt(j),e[30](null),Tt(St),Tt(N),Nt&&Nt.d(),x=!1,C()}}}function W3(e,t,s){let n;const r=[1,2,4,8,16],o={id:null,assets:{audio:null,background:null},yaml:O0};let{beatmapId:i}=t,a;const l=ts.get(i);let c=O(l),u="",h=l.assets,d=!1,f=l.yaml,p=r[0];const[g,m]=Y_(c.startTimestamp);en(e,m,F=>s(7,n=F));const y=z3(P);Tr(()=>{g.on("pause",b),g.on("seek",w),g.on("tick",S),B()});function v(){Lt.pause(),ts.setBody(i,f),nn.set(bc)}function b(){Lt.pauseImmediately()}async function w(){Lt.seek(n),n<0&&Lt.pauseImmediately()}async function S(){!Lt.playing&&n>=0&&(await Lt.play(),Lt.seek(n)),n>=Lt.currentSong.duration()*1e3&&(g.pause(),Lt.pause())}function _(F){F.ctrlKey&&F.key==="s"&&(F.preventDefault(),P())}function A(){P(),U3(l)}function O(F){return Ws.checkStructure(F)===""?Ws.parseWhole(F):Ws.parseWhole(o)}function P(){ts.setBody(i,f),B()}function R(F){s(3,h.audio=F,h),s(3,h),ts.setAudio(i,F),B()}function X(F){s(3,h.background=F,h),s(3,h),ts.setBackground(i,F),B()}async function B(){var F,Y,ct;s(2,u=Ws.checkStructure(l)),u===""&&(s(1,c=Ws.parseWhole(l)),(F=l.assets.background)!=null&&F.uri?nf((Y=l.assets.background)==null?void 0:Y.uri):rf(),await Lt.load(((ct=l.assets.audio)==null?void 0:ct.uri)??""),Lt.seek(n))}async function H(){var F;await Lt.load(((F=l.assets.audio)==null?void 0:F.uri)??""),n<0||(await Lt.play(),Lt.seek(n)),g.start()}function j(){g.pause()}function K(){g.seek(c.startTimestamp)}function nt(F){g.seek(F)}const ht=({detail:F})=>R(F),St=({detail:F})=>X(F),U=()=>s(4,d=!1),N=()=>s(4,d=!0),E=({detail:F})=>nt(F);function L(F){p=F,s(6,p)}const D=()=>g.seek(a.getInstance().lines.getPreviousLineTime()),x=()=>g.seek(a.getInstance().lines.getNextLineTime());function C(F){sn[F?"unshift":"push"](()=>{a=F,s(0,a)})}function $(F){f=F,s(5,f)}return e.$$set=F=>{"beatmapId"in F&&s(21,i=F.beatmapId)},[a,c,u,h,d,f,p,n,r,g,m,y,v,_,A,R,X,H,j,K,nt,i,ht,St,U,N,E,L,D,x,C,$]}class Q_ extends ye{constructor(t){super(),ge(this,t,W3,H3,ce,{beatmapId:21},null,[-1,-1])}get beatmapId(){return this.$$.ctx[21]}set beatmapId(t){this.$$set({beatmapId:t}),ft()}}const K_=75,hm=.55;class X3 extends Je{constructor(){super({anchor:.5,scale:hm}),this._elapsedTime=0,this._lastFlashTimestamp=0}flashPerfect(){this.texture=me.get("judgement_text_great"),this._lastFlashTimestamp=this._elapsedTime}flashGood(){this.texture=me.get("judgement_text_good"),this._lastFlashTimestamp=this._elapsedTime}flashOk(){this.texture=me.get("judgement_text_ok"),this._lastFlashTimestamp=this._elapsedTime}flashMiss(){this.texture=me.get("judgement_text_miss"),this._lastFlashTimestamp=this._elapsedTime}update(t){this._elapsedTime=t,this.alpha=Math.min(Vs(0,1,this._lastFlashTimestamp,this._lastFlashTimestamp+K_,this._elapsedTime),1),this.scale=Math.min(Vs(.2,hm,this._lastFlashTimestamp,this._lastFlashTimestamp+K_*1.5,this._elapsedTime),hm)}}class Y3{constructor(t){this._queue=Z3(t)}get nextAtTime(){return this._queue.length===0?Number.POSITIVE_INFINITY:this._queue[0][0].atTime}dequeue(t){if(this._queue.length===0)throw new Error("Cannot dequeue empty JudgeQueue.");const s=this._queue[0],n=s.findIndex(o=>o instanceof ef?o.toTrack===t:o.track===t);if(n===-1)return null;const r=s[n];return s.splice(n,1),s.length===0&&this._queue.shift(),r}dequeueNextAll(){if(this._queue.length===0)throw new Error("Cannot dequeue empty JudgeQueue.");return this._queue.shift()}}function Z3(e){const t=[];for(let s=0;s<e.length;){const n=[e[s]];for(s+=1;s<e.length&&n[0].atTime===e[s].atTime;)n.push(e[s]),s+=1;t.push(n)}return t}const Fe=Object.freeze({PERFECT_UB:60,GOOD_UB:140,OK_UB:160,MISS_UB:180});class q3 extends As{constructor(t){super(),this._beatmap=t,this._elapsedTime=0,this._noteQueue=new Y3(t._notes),this._heldNotes=[]}holdKey(t){if(!this._hasJudgableNoteAt(this._noteQueue.nextAtTime))return;const s=this._noteQueue.dequeue(t);s&&(s instanceof tf?this._queueHoldNote(s):this._judgeHitOrTrickNote(s),this.emit("judgedhold",s.index,this._elapsedTime))}releaseKey(t){for(const[s,n]of this._heldNotes.entries()){const r=n.note;r.track===t&&(this._judgeQueuedHoldNote(this._heldNotes[s]),this._heldNotes.splice(s,1),this.emit("judgedrelease",r.index,this._elapsedTime))}}update(t){this._elapsedTime=t,this._judgeNoLongerHittableNotes(),this._tickHeldNoteCombos()}_computeHoldNoteTickInterval(t){return this._beatmap.getTimingEvent(t.atTime).timePerBeat}_hasJudgableNoteAt(t){return this._elapsedTime>=t-Fe.MISS_UB}_nextNoteNoLongerJudgableAt(t){return this._elapsedTime>t+Fe.OK_UB}_judgeHitOrTrickNote(t){const s=this._elapsedTime-t.atTime,n=Math.abs(s);let r="miss";n<=Fe.PERFECT_UB?r="perfect":n<=Fe.GOOD_UB?r="good":n<=Fe.OK_UB&&(r="ok"),r!=="miss"&&this.emit("judgedcombo"),this.emit("judgement",t.index,r,s)}_queueHoldNote(t){const s=this._elapsedTime-t.atTime;if(Math.abs(s)>=Fe.OK_UB&&Math.abs(s)<=Fe.MISS_UB){this.emit("judgement",t.index,"miss",s),this.emit("judgedrelease",t.index,this._elapsedTime);return}const n=new Q3(t,this._elapsedTime);this._heldNotes.push(n),this.emit("judgedcombo")}_tickHeldNoteCombos(){for(const t of this._heldNotes){const s=this._computeHoldNoteTickInterval(t.note),n=Math.floor((this._elapsedTime-t.lastTickTime)/s);for(let r=0;r<n;r++)this.emit("judgedcombo"),t.lastTickTime+=s}}_judgeQueuedHoldNote(t){const s=t.note,n=t.holdTime,r=this._elapsedTime,o=n-s.atTime,i=r-s.untilTime,a=Math.abs(o),l=Math.abs(i),c=Math.max(a,l),u=a>l?o:i;let h="miss";c<=Fe.PERFECT_UB?h="perfect":c<=Fe.GOOD_UB?h="good":c<=Fe.OK_UB&&(h="ok"),this.emit("judgement",t.note.index,h,u)}_judgeNoLongerHittableNotes(){for(;this._nextNoteNoLongerJudgableAt(this._noteQueue.nextAtTime);){const t=this._noteQueue.dequeueNextAll();for(const s of t)this.emit("judgement",s.index,"miss")}for(const[t,s]of this._heldNotes.entries()){const n=s.note;this._elapsedTime>n.untilTime+Fe.MISS_UB&&(this.emit("judgement",n.index,"ok",this._elapsedTime-n.untilTime),this.emit("judgedrelease",n.index,this._elapsedTime),this._heldNotes.splice(t,1))}}}class Q3{constructor(t,s){this._note=t,this._holdTime=s,this.lastTickTime=this._note.atTime}get holdTime(){return this._holdTime}get note(){return this._note}}const yc=330,cm=10,J_=17;class K3 extends te{constructor(){super(),this._okLine=new Je({texture:me.get("ur_bar_ok"),width:yc,height:cm,anchor:.5}),this._goodLine=new Je({texture:me.get("ur_bar_good"),width:yc*(Fe.GOOD_UB/Fe.OK_UB),height:cm,anchor:.5}),this._perfectLine=new Je({texture:me.get("ur_bar_perfect"),width:yc*(Fe.PERFECT_UB/Fe.OK_UB),height:cm,anchor:.5}),this._markers=[],this.addChild(this._okLine,this._goodLine,this._perfectLine);for(let t=0;t<10;t++){const s=new Je({texture:me.get("ur_bar_marker"),anchor:.5,width:J_,height:J_});this._markers.push(s),this.addChild(s)}}pushTimeDiff(t){if(!(Math.abs(t)>Fe.OK_UB)){for(let s=0;s<this._markers.length-1;s++){const n=this._markers[s],r=this._markers[s+1];n.x=r.x,n.alpha=.8*Math.exp(.3*(s-10))+.2}this._markers.at(-1).x=t/Fe.OK_UB*(yc/2)}}}const tA=27;class J3 extends te{constructor(){super(),this._judgementText=new X3,this._judgementText.y=-tA,this._urBar=new K3,this._urBar.y=tA,this.addChild(this._judgementText),this.addChild(this._urBar)}display(t,s){switch(t){case"perfect":this._judgementText.flashPerfect();break;case"good":this._judgementText.flashGood();break;case"ok":this._judgementText.flashOk();break;case"miss":this._judgementText.flashMiss();break}this._urBar.pushTimeDiff(s)}update(t){this._judgementText.update(t)}}function tj(e){let t,s,n={};return t=new Iy({props:n}),e[9](t),{c(){Pt(t.$$.fragment)},m(r,o){Ot(t,r,o),s=!0},p(r,[o]){const i={};t.$set(i)},i(r){s||(dt(t.$$.fragment,r),s=!0)},o(r){gt(t.$$.fragment,r),s=!1},d(r){e[9](null),Tt(t,r)}}}function ej(e,t,s){let{beatmap:n}=t,{elapsedTime:r}=t,o;const i=new Rs(n,r),a=new J3;Tr(()=>{const m=o.getPixiApp();a.x=Io/2,a.y=-td*.6,m.stage.addChild(i),m.stage.addChild(a)});function l(m,y){a.display(m,y)}function c(m){i.hitButtons.holdButton(m,r)}function u(m){i.hitButtons.releaseButton(m,r)}function h(m,y){i.notes.holdNote(m,y)}function d(m,y){i.notes.judgeNote(m,y)}function f(m,y){i.notes.releaseNote(m,y)}function p(m){i.elapsedTime=m,a.update(m)}function g(m){sn[m?"unshift":"push"](()=>{o=m,s(0,o)})}return e.$$set=m=>{"beatmap"in m&&s(1,n=m.beatmap),"elapsedTime"in m&&s(2,r=m.elapsedTime)},e.$$.update=()=>{e.$$.dirty&2&&(i.beatmap=n),e.$$.dirty&4&&p(r)},[o,n,r,l,c,u,h,d,f,g]}class sj extends ye{constructor(t){super(),ge(this,t,ej,tj,ce,{beatmap:1,elapsedTime:2,displayJudgement:3,holdHitButton:4,releaseHitButton:5,holdNote:6,judgeNote:7,releaseNote:8})}get beatmap(){return this.$$.ctx[1]}set beatmap(t){this.$$set({beatmap:t}),ft()}get elapsedTime(){return this.$$.ctx[2]}set elapsedTime(t){this.$$set({elapsedTime:t}),ft()}get displayJudgement(){return this.$$.ctx[3]}get holdHitButton(){return this.$$.ctx[4]}get releaseHitButton(){return this.$$.ctx[5]}get holdNote(){return this.$$.ctx[6]}get judgeNote(){return this.$$.ctx[7]}get releaseNote(){return this.$$.ctx[8]}}function nj(e,t,s){const n=Mn(e);let r=null,o=e;function i(a){n.update(l=>{const c=a<l?l-t:l+t;return a<l&&c<=a||a>l&&c>=a?(clearInterval(r),a):c})}return{subscribe:n.subscribe,set(a){r!==null&&(clearInterval(r),n.set(o)),o=a,r=setInterval(()=>i(a),s)}}}function rj(e){let t,s,n,r,o,i,a,l,c,u,h,d,f,p,g,m;return{c(){t=q("div"),s=q("p"),n=vt(e[1]),r=it(),o=q("div"),i=q("p"),a=vt(e[0]),l=vt("\xD7"),c=it(),u=q("p"),u.textContent="COMBO",h=it(),d=q("p"),f=vt(e[2]),p=vt("%"),g=it(),m=q("p"),m.textContent="ACCURACY",Q(s,"class","score stat-text svelte-om3y3w"),Q(i,"class","side-stat stat-text svelte-om3y3w"),Q(u,"class","side-stat-name stat-text svelte-om3y3w"),Q(d,"class","side-stat stat-text svelte-om3y3w"),Q(m,"class","side-stat-name stat-text svelte-om3y3w"),Q(o,"class","side-stat-list svelte-om3y3w"),Q(t,"class","stats-overlay svelte-om3y3w")},m(y,v){Ct(y,t,v),V(t,s),V(s,n),V(t,r),V(t,o),V(o,i),V(i,a),V(i,l),V(o,c),V(o,u),V(o,h),V(o,d),V(d,f),V(d,p),V(o,g),V(o,m)},p(y,[v]){v&2&&ne(n,y[1]),v&1&&ne(a,y[0]),v&4&&ne(f,y[2])},i:jt,o:jt,d(y){y&&xt(t)}}}function oj(e,t,s){let n,r,o,{accuracy:i}=t,{combo:a}=t,{score:l}=t;const c=nj(l,1e3,16);return en(e,c,u=>s(6,o=u)),e.$$set=u=>{"accuracy"in u&&s(4,i=u.accuracy),"combo"in u&&s(0,a=u.combo),"score"in u&&s(5,l=u.score)},e.$$.update=()=>{e.$$.dirty&32&&c.set(l),e.$$.dirty&16&&s(2,n=Math.round(i*100)/100),e.$$.dirty&64&&s(1,r=Math.round(o).toString().padStart(7,"0"))},[a,r,n,c,i,l,o]}class ij extends ye{constructor(t){super(),ge(this,t,oj,rj,ce,{accuracy:4,combo:0,score:5})}get accuracy(){return this.$$.ctx[4]}set accuracy(t){this.$$set({accuracy:t}),ft()}get combo(){return this.$$.ctx[0]}set combo(t){this.$$set({combo:t}),ft()}get score(){return this.$$.ctx[5]}set score(t){this.$$set({score:t}),ft()}}function aj(e){let t,s,n,r,o,i,a,l,c,u;return{c(){t=q("div"),s=q("div"),n=it(),r=q("div"),o=it(),i=q("div"),a=it(),l=q("div"),Q(s,"role","button"),Q(r,"role","button"),Q(i,"role","button"),Q(l,"role","button"),Q(t,"class","touch-overlay svelte-420avt")},m(h,d){Ct(h,t,d),V(t,s),V(t,n),V(t,r),V(t,o),V(t,i),V(t,a),V(t,l),c||(u=[Te(s,"touchstart",e[2],{passive:!0}),Te(s,"touchend",e[3],{passive:!0}),Te(r,"touchstart",e[4],{passive:!0}),Te(r,"touchend",e[5],{passive:!0}),Te(i,"touchstart",e[6],{passive:!0}),Te(i,"touchend",e[7],{passive:!0}),Te(l,"touchstart",e[8],{passive:!0}),Te(l,"touchend",e[9],{passive:!0})],c=!0)},p:jt,i:jt,o:jt,d(h){h&&xt(t),c=!1,Tn(u)}}}function lj(e){const t=Pi();function s(r){t("trackhold",r)}function n(r){t("trackrelease",r)}return[s,n,()=>s(0),()=>n(0),()=>s(1),()=>n(1),()=>s(2),()=>n(2),()=>s(3),()=>n(3)]}class hj extends ye{constructor(t){super(),ge(this,t,lj,aj,ce,{})}}const eA=new Map([["d",0],["f",1],["j",2],["k",3]]),vc={includes(e){return eA.has(e)},getTrackIndex(e){if(!this.includes(e))throw new Error("Key has no corresponding track index.");return eA.get(e)}};function cj(e){const t=new Set;function s(r){t.has(r.key)||(e.dispatchEvent(new CustomEvent("keyhold",{detail:r.key})),t.add(r.key))}function n(r){e.dispatchEvent(new CustomEvent("keyrelease",{detail:r.key})),t.delete(r.key)}return e.addEventListener("keydown",s),e.addEventListener("keyup",n),{destroy(){e.removeEventListener("keydown",s),e.removeEventListener("keyup",n)}}}var uj=dj;function dj(e){return!isNaN(parseFloat(e))&&isFinite(e)}var fj=vj,pj=uj;function um(e){var t=[];if(e==null)return t;for(var s=0;s<e.length;s++)pj(e[s])&&t.push(+e[s]);return t}function mj(e){e=um(e);for(var t=0,s=0;s<e.length;s++)t+=e[s];return t}function sA(e){return e=um(e),e.length===0?NaN:mj(e)/e.length}function gj(e){e=um(e);for(var t=sA(e),s=[],n=0;n<e.length;n++)s.push(Math.pow(e[n]-t,2));return s}function yj(e){return sA(gj(e))}function vj(e){return Math.sqrt(yj(e))}const bj=1e6;class wj extends As{constructor(t){super(),this._deltaScore=bj/t,this._maxPossibleCombo=t,this._timeDiffs=[],this._combo=0,this._score=0,this._maxCombo=0,this._judgedCombo=0,this._numPerfect=0,this._numMissed=0,this._numGood=0,this._numOk=0}get accuracy(){const t=this._numPerfect+this._numGood+this._numOk+this._numMissed;if(t===0)return 100;const s=300*this._numPerfect,n=100*this._numGood,r=50*this._numOk;return 100*((s+n+r)/(300*t))}get combo(){return this._combo}get maxCombo(){return this._maxCombo}get missCount(){return this._numMissed}get score(){return this._score}get unstableRate(){return fj(this._timeDiffs)||0}considerCombo(){this._judgedCombo+=1,this._combo+=1,this._maxCombo=Math.max(this._combo,this._maxCombo),this.emit("statsupdate")}considerJudgement(t,s){this._timeDiffs.push(s);const n=this._combo/(this._judgedCombo||1);switch(t){case"perfect":this._numPerfect+=1,this._score+=1*n*this._deltaScore;break;case"good":this._numGood+=1,this._score+=.3333333333333333*n*this._deltaScore;break;case"ok":this._numOk+=1,this._score+=.16666666666666666*n*this._deltaScore;break;case"miss":this._combo=0,this._numMissed+=1;break}this.emit("statsupdate")}}function xj(e){const t=new wj(e),s=WC({score:t.score,accuracy:t.accuracy,combo:t.combo,maxCombo:t.maxCombo,misses:t.missCount,unstableRate:t.unstableRate},n=>{function r(){n({score:t.score,accuracy:t.accuracy,combo:t.combo,maxCombo:t.maxCombo,misses:t.missCount,unstableRate:t.unstableRate})}return t.on("statsupdate",r),()=>t.off("statupdate",r)});return[t,s]}const _j=""+new URL("don-f3ca2a8b.wav",import.meta.url).href,Aj=""+new URL("ka-4bc11eb0.wav",import.meta.url).href,kj=new Ao.Howl({src:[_j],volume:.3}),Sj=new Ao.Howl({src:[Aj],volume:.15}),dm={playPrimaryHitSound(){kj.play()},playSecondaryHitSound(){Sj.play()}};function Cj(e){let t;return{c(){t=vt("Restart")},m(s,n){Ct(s,t,n)},d(s){s&&xt(t)}}}function Oj(e){let t;return{c(){t=vt("Back")},m(s,n){Ct(s,t,n)},d(s){s&&xt(t)}}}function Tj(e){let t,s,n,r,o,i,a=e[0].meta.title+"",l,c,u,h=e[0].meta.artist+"",d,f,p,g,m,y,v,b,w,S,_,A,O,P,R,X,B,H,j,K,nt,ht,St,U,N,E,L,D,x,C;return t=new Hl({}),L=new Wl({props:{icon:"restart_alt",$$slots:{default:[Cj]},$$scope:{ctx:e}}}),L.$on("click",e[7]),x=new Wl({props:{icon:"arrow_back",$$slots:{default:[Oj]},$$scope:{ctx:e}}}),x.$on("click",e[6]),{c(){Pt(t.$$.fragment),s=it(),n=q("div"),r=q("div"),o=q("div"),i=q("h2"),l=vt(a),c=it(),u=q("p"),d=vt(h),f=it(),p=q("div"),g=q("p"),m=vt("Score: "),y=vt(e[4]),v=it(),b=q("p"),w=vt("Accuracy: "),S=vt(e[5]),_=vt("%"),A=it(),O=q("p"),P=vt("Max Combo: "),R=vt(e[1]),X=vt("\xD7"),B=it(),H=q("p"),j=vt("Misses: "),K=vt(e[2]),nt=it(),ht=q("p"),St=vt("UR: "),U=vt(e[3]),N=it(),E=q("div"),Pt(L.$$.fragment),D=it(),Pt(x.$$.fragment),Q(o,"class","meta svelte-pwabz2"),Q(p,"class","stats svelte-pwabz2"),Q(E,"class","actions svelte-pwabz2"),Q(r,"class","results-box svelte-pwabz2"),Q(n,"class","results-view svelte-pwabz2")},m($,F){Ot(t,$,F),Ct($,s,F),Ct($,n,F),V(n,r),V(r,o),V(o,i),V(i,l),V(o,c),V(o,u),V(u,d),V(r,f),V(r,p),V(p,g),V(g,m),V(g,y),V(p,v),V(p,b),V(b,w),V(b,S),V(b,_),V(p,A),V(p,O),V(O,P),V(O,R),V(O,X),V(p,B),V(p,H),V(H,j),V(H,K),V(p,nt),V(p,ht),V(ht,St),V(ht,U),V(r,N),V(r,E),Ot(L,E,null),V(E,D),Ot(x,E,null),C=!0},p($,[F]){(!C||F&1)&&a!==(a=$[0].meta.title+"")&&ne(l,a),(!C||F&1)&&h!==(h=$[0].meta.artist+"")&&ne(d,h),(!C||F&16)&&ne(y,$[4]),(!C||F&32)&&ne(S,$[5]),(!C||F&2)&&ne(R,$[1]),(!C||F&4)&&ne(K,$[2]),(!C||F&8)&&ne(U,$[3]);const Y={};F&2048&&(Y.$$scope={dirty:F,ctx:$}),L.$set(Y);const ct={};F&2048&&(ct.$$scope={dirty:F,ctx:$}),x.$set(ct)},i($){C||(dt(t.$$.fragment,$),dt(L.$$.fragment,$),dt(x.$$.fragment,$),C=!0)},o($){gt(t.$$.fragment,$),gt(L.$$.fragment,$),gt(x.$$.fragment,$),C=!1},d($){$&&(xt(s),xt(n)),Tt(t,$),Tt(L),Tt(x)}}}function Pj(e,t,s){let n,r,o,{beatmapReference:i=null}=t,{score:a}=t,{accuracy:l}=t,{maxCombo:c}=t,{misses:u}=t,{unstableRate:h}=t;function d(){nn.set(bc,{})}function f(){nn.set(nA,{beatmap:i})}return e.$$set=p=>{"beatmapReference"in p&&s(0,i=p.beatmapReference),"score"in p&&s(8,a=p.score),"accuracy"in p&&s(9,l=p.accuracy),"maxCombo"in p&&s(1,c=p.maxCombo),"misses"in p&&s(2,u=p.misses),"unstableRate"in p&&s(10,h=p.unstableRate)},e.$$.update=()=>{e.$$.dirty&512&&s(5,n=(Math.round(l*100)/100).toFixed(2)),e.$$.dirty&256&&s(4,r=Math.round(a).toString().padStart(7,"0")),e.$$.dirty&1024&&s(3,o=(Math.round(h*100)/100).toFixed(2))},[i,c,u,o,r,n,d,f,a,l,h]}class Mj extends ye{constructor(t){super(),ge(this,t,Pj,Tj,ce,{beatmapReference:0,score:8,accuracy:9,maxCombo:1,misses:2,unstableRate:10})}get beatmapReference(){return this.$$.ctx[0]}set beatmapReference(t){this.$$set({beatmapReference:t}),ft()}get score(){return this.$$.ctx[8]}set score(t){this.$$set({score:t}),ft()}get accuracy(){return this.$$.ctx[9]}set accuracy(t){this.$$set({accuracy:t}),ft()}get maxCombo(){return this.$$.ctx[1]}set maxCombo(t){this.$$set({maxCombo:t}),ft()}get misses(){return this.$$.ctx[2]}set misses(t){this.$$set({misses:t}),ft()}get unstableRate(){return this.$$.ctx[10]}set unstableRate(t){this.$$set({unstableRate:t}),ft()}}function Ij(e){let t,s,n,r,o,i,a,l,c,u,h;t=new Hl({});let d={beatmap:e[0],elapsedTime:e[2]};return r=new sj({props:d}),e[12](r),i=new ij({props:{accuracy:e[3].accuracy,combo:e[3].combo,score:e[3].score}}),l=new hj({}),l.$on("trackhold",e[13]),l.$on("trackrelease",e[14]),{c(){Pt(t.$$.fragment),s=it(),n=q("div"),Pt(r.$$.fragment),o=it(),Pt(i.$$.fragment),a=it(),Pt(l.$$.fragment),Q(n,"class","game-view svelte-1yg17g5")},m(f,p){Ot(t,f,p),Ct(f,s,p),Ct(f,n,p),Ot(r,n,null),V(n,o),Ot(i,n,null),Ct(f,a,p),Ot(l,f,p),c=!0,u||(h=[kC(cj.call(null,window)),Te(window,"keyhold",e[10]),Te(window,"keyrelease",e[11])],u=!0)},p(f,[p]){const g={};p&1&&(g.beatmap=f[0]),p&4&&(g.elapsedTime=f[2]),r.$set(g);const m={};p&8&&(m.accuracy=f[3].accuracy),p&8&&(m.combo=f[3].combo),p&8&&(m.score=f[3].score),i.$set(m)},i(f){c||(dt(t.$$.fragment,f),dt(r.$$.fragment,f),dt(i.$$.fragment,f),dt(l.$$.fragment,f),c=!0)},o(f){gt(t.$$.fragment,f),gt(r.$$.fragment,f),gt(i.$$.fragment,f),gt(l.$$.fragment,f),c=!1},d(f){f&&(xt(s),xt(n),xt(a)),Tt(t,f),e[12](null),Tt(r),Tt(i),Tt(l,f),u=!1,Tn(h)}}}function Ej(e,t,s){let n,r,{beatmap:o}=t,i;const[a,l]=Y_(o.startTimestamp);en(e,l,B=>s(2,n=B));const c=new q3(o),[u,h]=xj(o.notes.length);en(e,h,B=>s(3,r=B)),Tr(async()=>{a.on("tick",d),a.on("pause",f),a.on("resume",p),c.on("judgedhold",b),c.on("judgedcombo",w),c.on("judgedrelease",S),c.on("judgement",_),await Lt.load(o.meta.audioURI),a.start()});function d(){!Lt.playing&&n>=0&&p(),n>=o.endTimestamp&&(a.pause(),Lt.pause(),nn.set(Mj,{beatmapReference:o,score:r.score,accuracy:r.accuracy,maxCombo:r.maxCombo,misses:r.misses,unstableRate:r.unstableRate})),c.update(n)}function f(){n<o.endTimestamp&&Lt.pauseImmediately()}async function p(){await Lt.play(),Lt.seek(a.elapsedTime)}function g(B){if(B==="Escape"){nn.set(bc);return}if(!vc.includes(B))return;const H=vc.getTrackIndex(B);y(H)}function m(B){if(!vc.includes(B))return;const H=vc.getTrackIndex(B);v(H)}function y(B){c.holdKey(B),i.holdHitButton(B),dm.playPrimaryHitSound()}function v(B){c.releaseKey(B),i.releaseHitButton(B)}function b(B,H){i.holdNote(B,H)}function w(){u.considerCombo(),dm.playSecondaryHitSound()}function S(B,H){i.releaseNote(B,H),dm.playSecondaryHitSound()}function _(B,H,j){u.considerJudgement(H,j),i.judgeNote(B,H),i.displayJudgement(H,j)}const A=({detail:B})=>g(B),O=({detail:B})=>m(B);function P(B){sn[B?"unshift":"push"](()=>{i=B,s(1,i)})}const R=({detail:B})=>y(B),X=({detail:B})=>v(B);return e.$$set=B=>{"beatmap"in B&&s(0,o=B.beatmap)},[o,i,n,r,l,h,g,m,y,v,A,O,P,R,X]}class nA extends ye{constructor(t){super(),ge(this,t,Ej,Ij,ce,{beatmap:0})}get beatmap(){return this.$$.ctx[0]}set beatmap(t){this.$$set({beatmap:t}),ft()}}function rA(e,t,s){const n=e.slice();return n[11]=t[s].id,n}function $j(e){let t;return{c(){t=vt("New Beatmap")},m(s,n){Ct(s,t,n)},d(s){s&&xt(t)}}}function Rj(e){let t;return{c(){t=vt("Import Beatmap")},m(s,n){Ct(s,t,n)},d(s){s&&xt(t)}}}function oA(e,t){let s,n,r;function o(){return t[8](t[11])}function i(){return t[9](t[11])}function a(){return t[10](t[11])}return n=new RE({props:{metadata:Ws.parseMetadata(ts.get(t[11])),selected:t[11]===t[0],valid:Ws.checkStructure(ts.get(t[11]))===""}}),n.$on("click",o),n.$on("delete",i),n.$on("edit",a),{key:e,first:null,c(){s=ml(),Pt(n.$$.fragment),this.first=s},m(l,c){Ct(l,s,c),Ot(n,l,c),r=!0},p(l,c){t=l;const u={};c&2&&(u.metadata=Ws.parseMetadata(ts.get(t[11]))),c&3&&(u.selected=t[11]===t[0]),c&2&&(u.valid=Ws.checkStructure(ts.get(t[11]))===""),n.$set(u)},i(l){r||(dt(n.$$.fragment,l),r=!0)},o(l){gt(n.$$.fragment,l),r=!1},d(l){l&&xt(s),Tt(n,l)}}}function Dj(e){let t,s,n,r,o,i,a,l,c,u,h,d=[],f=new Map,p;t=new Hl({}),a=new Wl({props:{icon:"Add",$$slots:{default:[$j]},$$scope:{ctx:e}}}),a.$on("click",e[7]),c=new Wl({props:{icon:"Upload_File",$$slots:{default:[Rj]},$$scope:{ctx:e}}}),c.$on("click",e[5]);let g=bl(e[1]);const m=y=>y[11];for(let y=0;y<g.length;y+=1){let v=rA(e,g,y),b=m(v);f.set(b,d[y]=oA(b,v))}return{c(){Pt(t.$$.fragment),s=it(),n=q("div"),r=q("div"),r.innerHTML='<h1 class="svelte-c1dds7">Arghmania</h1> <p class="svelte-c1dds7">A dumb 4-key mania clone.</p>',o=it(),i=q("div"),Pt(a.$$.fragment),l=it(),Pt(c.$$.fragment),u=it(),h=q("div");for(let y=0;y<d.length;y+=1)d[y].c();Q(r,"class","title-container svelte-c1dds7"),Q(i,"class","button-container svelte-c1dds7"),Q(h,"class","beatmap-list frs-hide-scroll svelte-c1dds7"),Q(n,"class","home-view svelte-c1dds7")},m(y,v){Ot(t,y,v),Ct(y,s,v),Ct(y,n,v),V(n,r),V(n,o),V(n,i),Ot(a,i,null),V(i,l),Ot(c,i,null),V(n,u),V(n,h);for(let b=0;b<d.length;b+=1)d[b]&&d[b].m(h,null);p=!0},p(y,[v]){const b={};v&16384&&(b.$$scope={dirty:v,ctx:y}),a.$set(b);const w={};v&16384&&(w.$$scope={dirty:v,ctx:y}),c.$set(w),v&91&&(g=bl(y[1]),Ii(),d=GC(d,v,m,1,y,g,f,h,zC,oA,null,rA),Ei())},i(y){if(!p){dt(t.$$.fragment,y),dt(a.$$.fragment,y),dt(c.$$.fragment,y);for(let v=0;v<g.length;v+=1)dt(d[v]);p=!0}},o(y){gt(t.$$.fragment,y),gt(a.$$.fragment,y),gt(c.$$.fragment,y);for(let v=0;v<d.length;v+=1)gt(d[v]);p=!1},d(y){y&&(xt(s),xt(n)),Tt(t,y),Tt(a),Tt(c);for(let v=0;v<d.length;v+=1)d[v].d()}}}const fm=Mn(null);function Nj(e,t,s){let n,r;en(e,fm,u=>s(0,n=u)),en(e,ts,u=>s(1,r=u)),Tr(()=>{var u,h;if(n!==null){const d=ts.get(n).assets;(u=d.audio)!=null&&u.uri&&Lt.crossfade(d.audio.uri),(h=d.background)!=null&&h.uri&&nf(d.background.uri)}});function o(){Lt.pause();const u=ts.new();nn.set(Q_,{beatmapId:u})}function i(u){ts.delete(u),c(null)}function a(u){Lt.pause(),fm.set(u),nn.set(Q_,{beatmapId:u})}function l(){const u=document.createElement("input");u.type="file",u.accept=".json",u.click(),u.addEventListener("change",()=>{const h=u.files[0],d=new FileReader;d.onload=async f=>{const p=f.target.result.toString(),g=await G3(p);c(g)},d.readAsText(h)})}function c(u){var p,g;if(u===null){Lt.pause(),rf();return}const h=n;fm.set(u);const d=ts.get(n);if(n!==h){const m=d.assets;(p=m.background)!=null&&p.uri?nf(m.background.uri):rf(),(g=m.audio)!=null&&g.uri?Lt.crossfade(m.audio.uri):Lt.pause();return}if(Ws.checkStructure(d)!=="")return;Lt.pause();const f=Ws.parseWhole(d);nn.set(nA,{beatmap:f})}return[n,r,o,i,a,l,c,()=>o(),u=>c(u),u=>i(u),u=>a(u)]}class bc extends ye{constructor(t){super(),ge(this,t,Nj,Dj,ce,{})}}const Lj=""+new URL("hit_button-88db9c82.png",import.meta.url).href,Bj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAFPGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpDb2xvclNwYWNlPSIxIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iMjAiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSIyMCIKICAgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIKICAgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIgogICB0aWZmOkltYWdlTGVuZ3RoPSIyMCIKICAgdGlmZjpJbWFnZVdpZHRoPSIyMCIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iOTYvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iOTYvMSIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNC0wNC0xNFQxNToxMjozNiswODowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjQtMDQtMTRUMTU6MTI6MzYrMDg6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgeG1wTU06YWN0aW9uPSJwcm9kdWNlZCIKICAgICAgeG1wTU06c29mdHdhcmVBZ2VudD0iQWZmaW5pdHkgUGhvdG8gMS4xMC42IgogICAgICB4bXBNTTp3aGVuPSIyMDI0LTA0LTEzVDIxOjUxOjAwKzA4OjAwIi8+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InByb2R1Y2VkIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZmZpbml0eSBQaG90byAxLjEwLjYiCiAgICAgIHN0RXZ0OndoZW49IjIwMjQtMDQtMTRUMTU6MTI6MzYrMDg6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0iciI/PlJTWLkAAAGAaUNDUHNSR0IgSUVDNjE5NjYtMi4xAAAokXWRzytEURTHP2aI/C4WFtIkrGY0qImNxcivwmI8ZbCZeTNvRs0br/dGkq2yVZTY+LXgL2CrrJUiUrKeNbFBz3nzpkYy53bu+dzvved077ngUTKqblUGQc/mzMh42DcfXfBV56mkES8dtMdUy5ieHVMoax8PVDjxLuDUKn/uX6tLJC0VKmqEh1XDzAlPCE+t5QyHd4Vb1XQsIXwu7DflgsL3jh53Oe9wyuUvh00lMgKeZmFf6hfHf7GaNnVheTldemZVLd7HeUl9Mjs3K7FTvB2LCOOE8THJKCOE6GNI5hAB+umVFWXyg4X8GVYkV5XZYB2TZVKkyeEXdVWqJyVqoidlZFh3+v+3r5Y20O9Wrw9D1Yttv3VD9Q58b9v257Ftf5+A9xmusqX8lSMYfBd9u6R1HULTJlxcl7T4HlxuQduTETNjBckr7tE0eD2Dhii03ELtotuz4j6nj6BsyFfdwP4B9Mj5pqUfRixn14g/LxEAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAI1SURBVDiNdZW7ThtBFIa/f4yoQEJyEVHxAsgUXGIJx8+QIKWJlI4oqdKmS0GXNlWiuEOiyQWewQTJCOx3oEIpLCHhymL3T7EXz67tac6cnXP+85/LzIraGo1GDaAp6RA4ktQBNiU1gDtJA+AC6Nse7+zsJLG/YmU4HK4Br4H3knYFK0hImVkkp8A18COEcL69vT2ZA7y9vX0GfBa8RVovAJRtSrAa8ANwBpy0Wq1/JeDw5mYthS+CY0mrFCAzhHmWgELA9lRSD/jUarUmuh4MGiGEN8BXpA3FLGKGuSyZVxk/Ah9tnwagafudYQMb2wAYwMaAI0mhx7b2OvBBUnPFdhd4HoUjt8r2NsoDSMJ2XVqSbO8ChwF4CawWbEqWsVz0PWPmgjH2CnAUDO0ipdImBinY1mSOJdvx6HUC9lYUWfX61euY1hnnZ2mmbwZDsgxkUbpEGSxoTiPYvl+WZumQ51PKBfUEjH0XgCsvSxNQXldnDgVAiRIFkGEQsH9jPy1sRFYbMXMoUpXnyzAFLgJwBQxt4zSt1KXeYafp0mYZBkA/pGk6tv0NeIxmqjIelTrO9HgGH5ymvSRJxuFFt5sg/TKcOqNd6eDcBMwaoPx8ajhDOt/f308CQKfTmThNT4Ce4WHhna5OgnLwR0NP0sne3t4Eag/s5eXlmuAV0jHQFqzWXx2yO/wkaYj03fbPdrs9/8AWq9/vNyQ1JXWV3fM20pYgQbqX9Bf4E6QrhTA+ODio/AL+A3AC/2Ohmh2aAAAAAElFTkSuQmCC",jj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAACYCAYAAACSwXslAAAEsmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjQyIgogICBleGlmOlBpeGVsWURpbWVuc2lvbj0iMTUyIgogICBleGlmOkNvbG9yU3BhY2U9IjEiCiAgIHRpZmY6SW1hZ2VXaWR0aD0iNDIiCiAgIHRpZmY6SW1hZ2VMZW5ndGg9IjE1MiIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iOTYvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iOTYvMSIKICAgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIKICAgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIgogICB4bXA6TW9kaWZ5RGF0ZT0iMjAyNC0wNC0xOFQyMToyNzowNyswODowMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNC0wNC0xOFQyMToyNzowNyswODowMCI+CiAgIDx4bXBNTTpIaXN0b3J5PgogICAgPHJkZjpTZXE+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InByb2R1Y2VkIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZmZpbml0eSBQaG90byAxLjEwLjYiCiAgICAgIHN0RXZ0OndoZW49IjIwMjQtMDQtMThUMjE6Mjc6MDcrMDg6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0iciI/PjWbNncAAAGBaUNDUHNSR0IgSUVDNjE5NjYtMi4xAAAokXWRu0sDQRCHv8SIogmKWlhYBFErFR8QTGOR4AvUIongq0kuuUTIJcddRIKtYCsoiDa+Cv0LtBWsBUFRBLFOrWijcs7lhIiYWWbn29/uDLuz4I5lFc30DICWKxiRiZB/fmHRX1fCQws+2gjGFVOfiY7HqGrv97jseNtn16p+7l9rTKZMBVz1wqOKbhSEJ4Wn1wq6zTvCbUomnhQ+E+415ILCd7aecLhkc9rhT5uNWCQM7mZhf/oXJ36xkjE0YXk5XVp2Vfm5j/0Sbyo3F5XYKd6BSYQJQviZYowwAQYJyhygjyH6ZUWV/IFy/ix5yVVk1ilisEKaDAV6RV2V6imJqugpGVmKdv//9tVUh4ec6t4Q1D5b1ms31G3D15ZlfRxZ1tcx1DzBZa6Snz+EkTfRtypa1wE0bcD5VUVL7MLFJrQ/6nEjXpZqxN2qCi+n4FuA1htoWHJ69rPPyQPE1uWrrmFvH3rkfNPyN46pZ/ijzlXmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABZ0lEQVR4nO3YQW4CMRBE0XIHJorEJjl1OA1bjkYgwVlwALwoqSnp/xM8dXuGMWMeT9+SPvXanUvSoVux0FdJ2ncrnjZ0KEmz2/G0qX1JunU7FtqVpHu3YqXqBixWGROd2koz4owqY6LKOaMjAzoe79GARpWGfrsZK6X8MsU8TEDthUDnRwg0ZqJh0Ne/iugBvXYjVopafURA3QF1lwINuTNJWwo0ZqIxZxSoPaDugLoD6g6oO6DugLoD6g6oO6DugLoD6g6oO6DugLoD6g6oO6DugLoD6g6oO6DugLpLgV5SoDETBWoPqDug7oC6A+ouCrp1I1YqSaMbsVLU6iMC6g6oO6DmfkKg4x4CzVk9UHtA3QF1FwUNuTNNvXUjVopafURA3aVAZwZ0zlsGVOIL3x5Qd0DdAXVXGnrvRqxUCplqBFIC6i8DOmL+yE35cFbK6gXUH1B3UdBdN2KlKGhEQK0NXTOg0t8/m20f6Che8wAAAAAASUVORK5CYII=",Fj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAACYCAYAAACSwXslAAAEsmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjQyIgogICBleGlmOlBpeGVsWURpbWVuc2lvbj0iMTUyIgogICBleGlmOkNvbG9yU3BhY2U9IjEiCiAgIHRpZmY6SW1hZ2VXaWR0aD0iNDIiCiAgIHRpZmY6SW1hZ2VMZW5ndGg9IjE1MiIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iOTYvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iOTYvMSIKICAgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIKICAgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIgogICB4bXA6TW9kaWZ5RGF0ZT0iMjAyNC0wNC0xOFQyMToyNzozMCswODowMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNC0wNC0xOFQyMToyNzozMCswODowMCI+CiAgIDx4bXBNTTpIaXN0b3J5PgogICAgPHJkZjpTZXE+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InByb2R1Y2VkIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZmZpbml0eSBQaG90byAxLjEwLjYiCiAgICAgIHN0RXZ0OndoZW49IjIwMjQtMDQtMThUMjE6Mjc6MzArMDg6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0iciI/Puuf9NUAAAGBaUNDUHNSR0IgSUVDNjE5NjYtMi4xAAAokXWRu0sDQRCHv8SIogmKWlhYBFErFR8QTGOR4AvUIongq0kuuUTIJcddRIKtYCsoiDa+Cv0LtBWsBUFRBLFOrWijcs7lhIiYWWbn29/uDLuz4I5lFc30DICWKxiRiZB/fmHRX1fCQws+2gjGFVOfiY7HqGrv97jseNtn16p+7l9rTKZMBVz1wqOKbhSEJ4Wn1wq6zTvCbUomnhQ+E+415ILCd7aecLhkc9rhT5uNWCQM7mZhf/oXJ36xkjE0YXk5XVp2Vfm5j/0Sbyo3F5XYKd6BSYQJQviZYowwAQYJyhygjyH6ZUWV/IFy/ix5yVVk1ilisEKaDAV6RV2V6imJqugpGVmKdv//9tVUh4ec6t4Q1D5b1ms31G3D15ZlfRxZ1tcx1DzBZa6Snz+EkTfRtypa1wE0bcD5VUVL7MLFJrQ/6nEjXpZqxN2qCi+n4FuA1htoWHJ69rPPyQPE1uWrrmFvH3rkfNPyN46pZ/ijzlXmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABcElEQVR4nO3aMU4DMRRF0esfkogCGkRLz+5SsxD2SkLyKaAfFw85T3p3BUdjz+jbmnH76FPDO3fcaD6r4XU1ZKuGtwKeVkM2G7wUcFzt2GrAc61GTPZQwGW1YqJDAdfViplcln4U0KsVW3VzLOC8GjJTAbfViJlc9qgJdLC3gA7Y+XxHh9Fbb1Gg6iygDY8WUDB5omAGvfsxD36h+eArC1RdoOoCFVcuUI8zE383JRYFqi5QdYGqC1RdoOoCVReoukDVBaouUHWBqgtUXaDqAlUXqLpA1QWqLlB1gaoLVF2g6gJVF6g6F+h3oOoCVReoukDVBaouUHVWUAtsAfvViJksniYEqi9QdYGqc4FeLaADLhZQoF2gNns0UHmBqgtUXQG71YiZquGwGjGT1dJbFKi6QJW1zeDcJkcRMFl6CFRfoOoCVVcYzaMeE/5qwGyBqrOAjsGXBZTcj/5DgaoLVJ0V1GYoya8aygIVd3aBXn8AAf4jPqy45UYAAAAASUVORK5CYII=",Vj=""+new URL("judgement_text_good-1b32d753.png",import.meta.url).href,zj=""+new URL("judgement_text_great-953c7b37.png",import.meta.url).href,Gj=""+new URL("judgement_text_miss-46370fbf.png",import.meta.url).href,Uj=""+new URL("judgement_text_ok-286ad2e7.png",import.meta.url).href,Hj=""+new URL("note_head_0-7bc74089.png",import.meta.url).href,Wj=""+new URL("note_head_1-c67682d3.png",import.meta.url).href,Xj=""+new URL("trick_note_head_0-5ab2d457.png",import.meta.url).href,Yj=""+new URL("trick_note_head_1-cdda0e07.png",import.meta.url).href,Zj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJoAAAAMCAIAAAAVojMeAAAEsmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjE1NCIKICAgZXhpZjpQaXhlbFlEaW1lbnNpb249IjEyIgogICBleGlmOkNvbG9yU3BhY2U9IjEiCiAgIHRpZmY6SW1hZ2VXaWR0aD0iMTU0IgogICB0aWZmOkltYWdlTGVuZ3RoPSIxMiIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iOTYvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iOTYvMSIKICAgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIKICAgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIgogICB4bXA6TW9kaWZ5RGF0ZT0iMjAyNC0wNC0xNFQxNjozNzo0NiswODowMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNC0wNC0xNFQxNjozNzo0NiswODowMCI+CiAgIDx4bXBNTTpIaXN0b3J5PgogICAgPHJkZjpTZXE+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InByb2R1Y2VkIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZmZpbml0eSBQaG90byAxLjEwLjYiCiAgICAgIHN0RXZ0OndoZW49IjIwMjQtMDQtMTRUMTY6Mzc6NDYrMDg6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0iciI/Pj4IxNsAAAGAaUNDUHNSR0IgSUVDNjE5NjYtMi4xAAAokXWRzytEURTHP2aI/C4WFtIkrGY0qImNxcivwmI8ZbCZeTNvRs0br/dGkq2yVZTY+LXgL2CrrJUiUrKeNbFBz3nzpkYy53bu+dzvved077ngUTKqblUGQc/mzMh42DcfXfBV56mkES8dtMdUy5ieHVMoax8PVDjxLuDUKn/uX6tLJC0VKmqEh1XDzAlPCE+t5QyHd4Vb1XQsIXwu7DflgsL3jh53Oe9wyuUvh00lMgKeZmFf6hfHf7GaNnVheTldemZVLd7HeUl9Mjs3K7FTvB2LCOOE8THJKCOE6GNI5hAB+umVFWXyg4X8GVYkV5XZYB2TZVKkyeEXdVWqJyVqoidlZFh3+v+3r5Y20O9Wrw9D1Yttv3VD9Q58b9v257Ftf5+A9xmusqX8lSMYfBd9u6R1HULTJlxcl7T4HlxuQduTETNjBckr7tE0eD2Dhii03ELtotuz4j6nj6BsyFfdwP4B9Mj5pqUfRixn14g/LxEAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAMKSURBVFiFrVhbktwwCGxcvncOkBOnSjb5kIyah+SZbPQxa1tANwgDXvn157eqgpcAt0IE/30J8ECpqogAEBFVhT6IJLO0YL/D1rMZTH3C5FWYBT7hlhVLrU9I7kGDBQFuPVtrYxcqkP7rtKDD3OA2d+1Ihu5zG3HJZm0fCNBmEABD7B3PLpjxWl4VEnezFybWt0oXGPdF4DmewiN/ctMgxaFkaA/PdrWZ6QpTY1f7dRezKMPehueYgxjz4IgUipwx6uTZt/le+hCUuRKBjLwPoguZxAiEi0kjuWCIOennVtei1Lf8iJFnSXJ8ClOEWeu82gVABFxx+bY7ouX7/kiS20vJrAjKjIDLFC12IrhVBcJilLmpaRA3b2387c9W770PQmF/VQeNlXe2cyiDUYh1RFIRQEXk1ruzDSid7XldV3f1kEMrcg9AXUi/WgK59d7b6fm4gRsJ+z20ac22/WNT4wlFtmT+OdC/UTLccZwAbtyuqlA1AGa5R6pF89oX7ZzxhRjJK9xutP9UMRYwMmxtMqeal63NfpY6Zcbag7ooSTxR4wMrwmGIY3xuKATNEHwKLozA2VoLdZlPi4t7XfeJ61wLg2PT32LWUrLDFqwx++Xs+NbO7X9GLU0ToV+GDpefBwe51ubg8EjhpoeqW7PLxpDNIrd5RObu7SxXDv1aNDLb2HRnkHdR1ZsgzCmchqMV+q6GU1va2dngBjFUAQnPV8bXazPhz+NU6CFHeWx8onEsrGb6zROrb4y1+pbIXwXZFDvJRlY+b74lXtEz0P7z7BVxM2NbWXLva3aZdrvi2Vrrr8stN3vivPLTMKg8Bv/zbfnNdOmVC+w+M8raHmp+yT+LlTn3SiA7lVVWipm/n8kL7145s5Y9mcXWZiqbIPY1dj/g9aHGBBwt/8U9g6JjGopTPqTPAgHilcOSeU4LmoxK4zx3lCT3cTD+wXj5T49ozea1p1uHqLLwc5wfdz5bM1+4H9CU9aZfS0aKNnGw8JahI6aAQo73M/6K5BLxhyv4tUUfgVLgmMH/C7xdl93VcXX8AAAAAElFTkSuQmCC",qj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAEsGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjM2IgogICBleGlmOlBpeGVsWURpbWVuc2lvbj0iMzYiCiAgIGV4aWY6Q29sb3JTcGFjZT0iMSIKICAgdGlmZjpJbWFnZVdpZHRoPSIzNiIKICAgdGlmZjpJbWFnZUxlbmd0aD0iMzYiCiAgIHRpZmY6UmVzb2x1dGlvblVuaXQ9IjIiCiAgIHRpZmY6WFJlc29sdXRpb249Ijk2LzEiCiAgIHRpZmY6WVJlc29sdXRpb249Ijk2LzEiCiAgIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiCiAgIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjQtMDQtMTRUMTY6Mzg6NTQrMDg6MDAiCiAgIHhtcDpNZXRhZGF0YURhdGU9IjIwMjQtMDQtMTRUMTY6Mzg6NTQrMDg6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJwcm9kdWNlZCIKICAgICAgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWZmaW5pdHkgUGhvdG8gMS4xMC42IgogICAgICBzdEV2dDp3aGVuPSIyMDI0LTA0LTE0VDE2OjM4OjU0KzA4OjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9InIiPz6cf6xdAAABgGlDQ1BzUkdCIElFQzYxOTY2LTIuMQAAKJF1kc8rRFEUxz9miPwuFhbSJKxmNKiJjcXIr8JiPGWwmXkzb0bNG6/3RpKtslWU2Pi14C9gq6yVIlKynjWxQc9586ZGMud27vnc773ndO+54FEyqm5VBkHP5szIeNg3H13wVeeppBEvHbTHVMuYnh1TKGsfD1Q48S7g1Cp/7l+rSyQtFSpqhIdVw8wJTwhPreUMh3eFW9V0LCF8Luw35YLC944edznvcMrlL4dNJTICnmZhX+oXx3+xmjZ1YXk5XXpmVS3ex3lJfTI7NyuxU7wdiwjjhPExySgjhOhjSOYQAfrplRVl8oOF/BlWJFeV2WAdk2VSpMnhF3VVqiclaqInZWRYd/r/t6+WNtDvVq8PQ9WLbb91Q/UOfG/b9uexbX+fgPcZrrKl/JUjGHwXfbukdR1C0yZcXJe0+B5cbkHbkxEzYwXJK+7RNHg9g4YotNxC7aLbs+I+p4+gbMhX3cD+AfTI+aalH0YsZ9eIPy8RAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADUUlEQVRYhc2YXUvrQBCG34nnTkREpFdBSpHin3Q3/kUJRUSk9EKKlCAxDd7snItm1sl206QfB89CIR+zM09m35ldBU4wvr+/TV3X5hS+jh51XZu6rrn5/S5UXddmvV7zer128vs1qKqqTFVVrH9fX19cVdVRmaJDJpVlaQBYovZ0ImJmbi7Jnp+fZ/8cqIExTVAP0LxmuW7eZRcXF3tB7QVUlqVhZqsDR51uYAgAE9FeUIOByrI0zjkNw4EfJiIws2SOFJi9vLwcBDUI6PPz0zCzUfYSCEpHHgLtZQMAYmZ7dXXVC9ULVBSFAWARWSYVsLn1GQlt5Fkv1E6goihEM4gAMTZfLoE3D5mRJInWEDQkEe2E6gQqikI04wOFZd4E8BlobLoEL6kkAPb6+joKFQVarVY6M52OBUaBiKj9Rwg0fgpB9BWF2gJarVY+MzqIn6BKGpElC8CjulJg9ubmpgXVMvz4+DDMbAMdhE7C+509qWPuDwBRC8obLZdLqaa+4Z2Lrnq0E5urbRlANhqNMg/0/v5uiMhiu5d4vfQJlpkpSRI45zxkkwExCK9Z+QUR2dFolNFyufSaCZ30rH947Ucwr2UT+pRexsx0dnZm/zjnPIj+WnXjL1VPkSDRJXLOkRJ5y0Z1eG7sSM3bGC8WC5skyYNysKtCWuC6uoIMbzXFYDKISGzgnHtM09R648ViYYlIDlZ6fcNNtCVmBdDZPJuqbWVbfzgzZ2maWh9AQzGziW0DkX6zVTHhVwf+dafWz7I0TbfLXsZ8PteZig05EsaWY1fpt4pBjiW3t7fdjVFBGQBbDbJHUz6waCtccq0551w2Ho9tOLnT+Xw+91276ROtUlbOw70NUFsKfl7KRCRJspWZXiAAeHt7a2lqwIj2qKCpRjMzCAgAXl9fLRE9xGx7Gmf0LDQejw8/oCkor6nI9qGrJ5Yhn5nJZGL7Yg1ei5eXl87qCzbZyGt+vLu764XZC6iB0pnyAQUmqC5gk53BMHsDAcDz87NoKjpfH+qYOZtOp4NhDgICgNlsZpMkedixVzGAbDqd9v7ZcxIggQqqz/cmIrKHwBwFJFDSp5Rusvv7e3uM36NGnuc2z3PO85xns9n/8V+0PM/N09OTPYWvv+cvvvRJ+5JdAAAAAElFTkSuQmCC",Qj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJoAAAAMCAIAAAAVojMeAAAEsmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjE1NCIKICAgZXhpZjpQaXhlbFlEaW1lbnNpb249IjEyIgogICBleGlmOkNvbG9yU3BhY2U9IjEiCiAgIHRpZmY6SW1hZ2VXaWR0aD0iMTU0IgogICB0aWZmOkltYWdlTGVuZ3RoPSIxMiIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iOTYvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iOTYvMSIKICAgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIKICAgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIgogICB4bXA6TW9kaWZ5RGF0ZT0iMjAyNC0wNC0xNFQxNjozNzo1MyswODowMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNC0wNC0xNFQxNjozNzo1MyswODowMCI+CiAgIDx4bXBNTTpIaXN0b3J5PgogICAgPHJkZjpTZXE+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InByb2R1Y2VkIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZmZpbml0eSBQaG90byAxLjEwLjYiCiAgICAgIHN0RXZ0OndoZW49IjIwMjQtMDQtMTRUMTY6Mzc6NTMrMDg6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0iciI/PkAjAqwAAAGAaUNDUHNSR0IgSUVDNjE5NjYtMi4xAAAokXWRzytEURTHP2aI/C4WFtIkrGY0qImNxcivwmI8ZbCZeTNvRs0br/dGkq2yVZTY+LXgL2CrrJUiUrKeNbFBz3nzpkYy53bu+dzvved077ngUTKqblUGQc/mzMh42DcfXfBV56mkES8dtMdUy5ieHVMoax8PVDjxLuDUKn/uX6tLJC0VKmqEh1XDzAlPCE+t5QyHd4Vb1XQsIXwu7DflgsL3jh53Oe9wyuUvh00lMgKeZmFf6hfHf7GaNnVheTldemZVLd7HeUl9Mjs3K7FTvB2LCOOE8THJKCOE6GNI5hAB+umVFWXyg4X8GVYkV5XZYB2TZVKkyeEXdVWqJyVqoidlZFh3+v+3r5Y20O9Wrw9D1Yttv3VD9Q58b9v257Ftf5+A9xmusqX8lSMYfBd9u6R1HULTJlxcl7T4HlxuQduTETNjBckr7tE0eD2Dhii03ELtotuz4j6nj6BsyFfdwP4B9Mj5pqUfRixn14g/LxEAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAMNSURBVFiFrVdLltwwCIR+vlmun9NkLbuykISKj9Sel7CYaUuoKEAGrH9+/wIgJCrinv+fMDIAVRURVWUCZ+t91/4OKNv1UC+ZvJc33P6XrZ8e72pXa20sAKI6/rLMCI1V2rWU9FPrMQhjVvgDNql1y2zii0/ZBQOv1aFpN3thamOrdIHXjwr9f6m2tsQpuDhUDG3xuu/GNOwYgP7y2O+ptt4AHR6Op6DGPAwtrXRN+JwqWyfCyWERr7Ze2mCIWCHABh99BNwPAs4umMW1IuHMQMaMlb0ACHZZkx03ZZ+adepq7V6B5CDZI6c6i6owYo73TtiPZJcpWuxEVfCIKKuttGWSxI3ROLECpAQXQajx954Vfk0S55OmNiz6I6qKHoFsRVWA675vEQHwsfOVAKDXfXH7Wv8cW5EHmGyyCVEdUYZLg1O2XnIu4SWs+aIzo8/rEp4JrBWKbFkJy/5XNrfpfoetXSudtWJ79+cnBpGrwbCAyV4qZdc8pMhYoebBeTfiz8jtOko4GPpiRlsjVdkpva2z0fMMYXwkzx85UFzhSkwbZaq7fLXWlEIJny1LAMeat5iryQ5QiIebZhMOI3SNPLK6TmMVkzy3xMAfEZ9yi45jSFErTNNt4CMuOHMjXi++dozg79a6N9WVYr+446y3s5Qc+q1mYnbA5BwUFit7QXmlIZe+vfXt7N1ZPQ+/KDW9vd2gJlVAwvoO/CT7vkLpBEQ/GzTi4LHqmf6wstoF2XpZmUsodpJBdj4fviW+WS8MVaX1BxazC9xluAFt9EOnAHC11mate6ydq+qMvOugcdSkoSaApyOr8qsqcBcFdujLxpeithONMMGak/y5UijPBLmOaL4TbUML5aMoh+S77Pi7mRwWc/ZOwyIlZXEPvWAVW1cQZiYOl7iocpv2EwK6+pyfrSx+NCWOoVSc89R0jxx2sm3Vm3ou4Vp9s9J3B3nqqU6HZ7G5uKuNbkhMUWXlkc73nc+Ex/1F5f23y0YzUqzG+TNDJgYRAfTzedP+35PcWfxHiX4drY9A+S/UvyFVq+Ku00hhAAAAAElFTkSuQmCC",Kj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJoAAAAMCAIAAAAVojMeAAAEsmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjE1NCIKICAgZXhpZjpQaXhlbFlEaW1lbnNpb249IjEyIgogICBleGlmOkNvbG9yU3BhY2U9IjEiCiAgIHRpZmY6SW1hZ2VXaWR0aD0iMTU0IgogICB0aWZmOkltYWdlTGVuZ3RoPSIxMiIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iOTYvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iOTYvMSIKICAgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIKICAgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIgogICB4bXA6TW9kaWZ5RGF0ZT0iMjAyNC0wNC0xNFQxNjozNzozNSswODowMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNC0wNC0xNFQxNjozNzozNSswODowMCI+CiAgIDx4bXBNTTpIaXN0b3J5PgogICAgPHJkZjpTZXE+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InByb2R1Y2VkIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZmZpbml0eSBQaG90byAxLjEwLjYiCiAgICAgIHN0RXZ0OndoZW49IjIwMjQtMDQtMTRUMTY6Mzc6MzUrMDg6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0iciI/PnsjCZIAAAGAaUNDUHNSR0IgSUVDNjE5NjYtMi4xAAAokXWRzytEURTHP2aI/C4WFtIkrGY0qImNxcivwmI8ZbCZeTNvRs0br/dGkq2yVZTY+LXgL2CrrJUiUrKeNbFBz3nzpkYy53bu+dzvved077ngUTKqblUGQc/mzMh42DcfXfBV56mkES8dtMdUy5ieHVMoax8PVDjxLuDUKn/uX6tLJC0VKmqEh1XDzAlPCE+t5QyHd4Vb1XQsIXwu7DflgsL3jh53Oe9wyuUvh00lMgKeZmFf6hfHf7GaNnVheTldemZVLd7HeUl9Mjs3K7FTvB2LCOOE8THJKCOE6GNI5hAB+umVFWXyg4X8GVYkV5XZYB2TZVKkyeEXdVWqJyVqoidlZFh3+v+3r5Y20O9Wrw9D1Yttv3VD9Q58b9v257Ftf5+A9xmusqX8lSMYfBd9u6R1HULTJlxcl7T4HlxuQduTETNjBckr7tE0eD2Dhii03ELtotuz4j6nj6BsyFfdwP4B9Mj5pqUfRixn14g/LxEAAAAJcEhZcwAADsQAAA7EAZUrDhsAAANLSURBVFiFpVjLktwwCGym/P+X/Fw+JTsVixwQTPOQN6noMCVjHk1LgHflx09VAAoAkP2zFAKIYClEYEttr1BTdLltdSvRg2wTyW9U8XLPtjehqZlwqwo7cw9uKASAdRzKB0BCmAEHgLBV7DQN0AYmgMUFVDfOCGwmhi1cB0ukSLAdcQEW+VgsuL6y3P2/fG9+luL6dad4cUyKKofTHXBNJ8i1zCMNXUdXcRAs0em3sB+ekV0pEgDkiHQ6nyxUs0+lDcWeEQqw3Dw4PSVSgPkRhlUiTRM5ciBt37CV1AS43ivRXWyEjm08lW5im5cbYrJliaP6+CkVWVa/s9J0GHbBVnTQFDjxk60luCZ5JDUg95obUXXScIZhymgYrq+V2DnhYxKRJd0K5/M4VU837A6TrdZXFe3kBGOO0dlI58VBeeIcUug5zrxRH67lkekdcxcMd4LVrvftIKSWfxHCB4a2zr6FObcYtDF4gOQtIoXhngcMMNRazqoZnnspmHt2VUj9QUoHBh2dprFSOYn4jUOmongQGn4f8DkoRx8IzOt60xyKeheq4nIHQweJ5KFD1tMFFk/vg04ptT4/xhI89YDY10+e3BgR/J5jnWqxckKuzEXvyT1rdnWq/niMcQBHHh7ScRZkmPJBJhrt7Wl1WLHKHHro3miv/io0famxVb+FPLGKvBPNwMpU60c4oHocDX8zL0rZvIDr6/4ovTLLQCrwYeq0W8lpd/3aajL0HjFMGDRyDqX1lSz62/HYBP5XGVGDfIQpBX+rpMkAzPswvFq+iR8A+SqwYZEPRS/2KeQPaCNQPAgjC0A26viS8OBBuwRlliAHSvdRakSkOImCWl7tusQaO3kHKZNCCb3f5tOVrDQqD8lOHf40Pgo/pU9c7zUPjDErZKe9C8Wr1a4tI1vTV1yHwQ4xcTrkScpxhaP7jbfnOSg75MQLgFFewJzUuucHW0yUhp/r973LU0RU1TbbTFXPX8+hP0pEZAH8qKrlF67AEdnJ/qdS1uSgzxhOi2GcJD2dkHfN0T+DB1ExEjJoNE0GcEr2uu8bAH2ip/3Dihj2byztvfUb+1mzQuyX8zuEDEyhUMjr+zP+J5CniP+5al6P0TdRChEJ8v8AtGSmSwjoh9oAAAAASUVORK5CYII=";await me.load([{alias:"hit_button",src:Lj},{alias:"hold_note_tail_mark",src:Bj},{alias:"hold_note_tail_0",src:jj},{alias:"hold_note_tail_1",src:Fj},{alias:"judgement_text_good",src:Vj},{alias:"judgement_text_great",src:zj},{alias:"judgement_text_miss",src:Gj},{alias:"judgement_text_ok",src:Uj},{alias:"note_head_0",src:Hj},{alias:"note_head_1",src:Wj},{alias:"trick_note_head_0",src:Xj},{alias:"trick_note_head_1",src:Yj},{alias:"ur_bar_good",src:Zj},{alias:"ur_bar_marker",src:qj},{alias:"ur_bar_ok",src:Qj},{alias:"ur_bar_perfect",src:Kj}]),new qC({target:document.body}),nn.set(bc)})();export{Hn as $,Cc as A,Qe as B,te as C,Ke as D,mt as E,mm as F,gm as G,Ha as H,is as I,Oc as J,le as K,he as L,Tc as M,ym as N,vr as O,ze as P,br as Q,Me as R,vm as S,eo as T,Wa as U,wr as V,bm as W,wm as X,so as Y,Ge as Z,Pc as _,dF as __tla,As as a,Bs as a0,Mc as a1,no as a2,xm as a3,Ic as a4,ro as b,_m as c,Ec as d,ps as e,$c as f,Am as g,Rc as h,An as i,Bt as j,Vt as k,km as l,Sm as m,yA as n,Cm as o,kn as p,ks as q,Om as r,Dc as s,Je as t,ke as u,Tm as v,Se as w,Pm as x,Mm as y,Nc as z};
